<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>visage</title>
<link>https://aditya-dahiya.github.io/visage/index.html/book_solutions.html</link>
<atom:link href="https://aditya-dahiya.github.io/visage/index.html/book_solutions.xml" rel="self" type="application/rss+xml"/>
<description>Visualizing Information and Spatial Analysis with ggplot2 Extensions</description>
<generator>quarto-1.5.57</generator>
<lastBuildDate>Thu, 09 Jan 2025 18:30:00 GMT</lastBuildDate>
<item>
  <title>Chapter 7: Reprojecting geographic data</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter7.html</link>
  <description><![CDATA[ 




<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sf)        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simple Features in R</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(terra)     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handling rasters in R</span></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyterra) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># For plotting rasters in ggplot2</span></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magrittr)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Using pipes with raster objects</span></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All things tidy; Data Wrangling</span></span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(spData)    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Spatial Datasets</span></span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(patchwork) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composing plots</span></span>
<span id="cb1-8"></span>
<span id="cb1-9">greenland <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rnaturalearth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ne_countries</span>(</span>
<span id="cb1-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geounit =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Greenland"</span>,</span>
<span id="cb1-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"medium"</span>,</span>
<span id="cb1-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">returnclass =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf"</span></span>
<span id="cb1-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(admin, name, iso_a3, geometry)</span>
<span id="cb1-15"></span>
<span id="cb1-16">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Condensed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>)</span>
<span id="cb1-17">showtext<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb1-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(</span>
<span id="cb1-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb1-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb1-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>,</span>
<span id="cb1-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_line_size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span></span>
<span id="cb1-23">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-24">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb1-25">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb1-26">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey20"</span></span>
<span id="cb1-27">      ),</span>
<span id="cb1-28">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb1-29">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb1-30">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lines"</span>)</span>
<span id="cb1-31">      ),</span>
<span id="cb1-32">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb1-33">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>,</span>
<span id="cb1-34">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lines"</span>),</span>
<span id="cb1-35">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb1-36">      )</span>
<span id="cb1-37">    )</span>
<span id="cb1-38">)</span></code></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>For the first few sections, I will use the map of Greenland as an example, since it is an extreme case (far away from equator, so a good use for CRS projections examples), as shown in Figure&nbsp;1.</p>
</div>
</div>
<section id="introduction" class="level3">
<h3 class="anchored" data-anchor-id="introduction">7.1 Introduction</h3>
<ul>
<li>Coordinate Reference Systems (CRSs): Two main types:
<ul>
<li><strong>Geographic CRS</strong>: A reference system that defines locations on the Earth using a spherical or ellipsoidal model. It specifies positions in terms of latitude and longitude, with angular measurements relative to the Earth’s center. Uses longitude/latitude (units in degrees)</li>
<li><strong>Projected CRS</strong>: A reference system that transforms the Earth’s curved surface into a flat map. It uses linear units like meters and focuses on minimizing distortions in specific aspects such as distance, area, or shape, depending on the map’s purpose. Uses meters from a datum (projected system).</li>
</ul></li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 39%">
<col style="width: 47%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Aspect</strong></th>
<th><strong>Geographic CRS</strong></th>
<th><strong>Projected CRS</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Definition</strong></td>
<td>Represents locations on the Earth’s surface using a spherical or ellipsoidal model.</td>
<td>Represents locations on a flat, two-dimensional surface using a projected system.</td>
</tr>
<tr class="even">
<td><strong>Units of Measurement</strong></td>
<td>Uses angular units (degrees of longitude and latitude).</td>
<td>Uses linear units (meters, feet, etc.).</td>
</tr>
<tr class="odd">
<td><strong>Coordinate Axes</strong></td>
<td>Longitude (x-axis) and Latitude (y-axis).</td>
<td>X (east-west) and Y (north-south) in a flat plane.</td>
</tr>
<tr class="even">
<td><strong>Purpose</strong></td>
<td>Ideal for global-scale mapping and geodetic calculations.</td>
<td>Ideal for local or regional mapping, where accurate distances, angles, and areas are required.</td>
</tr>
<tr class="odd">
<td><strong>Accuracy</strong></td>
<td>Retains accurate angular relationships but distorts distances and areas.</td>
<td>Distorts angular relationships but preserves distances, areas, or shapes (depending on projection).</td>
</tr>
<tr class="even">
<td><strong>Examples</strong></td>
<td>WGS84 (used in GPS), NAD83.</td>
<td>UTM (Universal Transverse Mercator), State Plane.</td>
</tr>
<tr class="odd">
<td><strong>Key Feature</strong></td>
<td>Geocentric, based on Earth’s shape as an ellipsoid.</td>
<td>Flat, derived by projecting the Earth onto a 2D surface using a mathematical formula.</td>
</tr>
<tr class="even">
<td><strong>Applications</strong></td>
<td>Satellite data, GPS, global navigation systems.</td>
<td>Engineering projects, land use planning, local/regional maps.</td>
</tr>
</tbody>
</table>
<ul>
<li><p><strong>Focus of the Chapter:</strong></p>
<ul>
<li>Setting and transforming CRSs in geographic data.</li>
<li>Highlighting issues caused by ignoring CRSs, especially with lon/lat data.</li>
</ul></li>
<li><p><strong>Practical Relevance:</strong></p>
<ul>
<li>Many projects don’t require conversion between CRSs but knowing whether your data is in a projected or geographic CRS is critical.</li>
<li>Understanding CRSs prevents errors and ensures smooth handling of geographic data.</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> greenland <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WGS84 / EPSG:4326"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Default geographic projection"</span>)</span>
<span id="cb2-5"></span>
<span id="cb2-6">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> greenland <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:3857"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:3857"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Web Mercator projection"</span>)</span>
<span id="cb2-11"></span>
<span id="cb2-12">g3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> greenland <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ESRI:102004"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ESRI:102004"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Lambert Conformal Conic"</span>)</span>
<span id="cb2-17"></span>
<span id="cb2-18">g4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> greenland <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ESRI:54030"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ESRI:54030"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Robinson projection"</span>)</span>
<span id="cb2-23"></span>
<span id="cb2-24">g5 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> greenland <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:3413"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:3413"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"North Pole Stereographic"</span>)</span>
<span id="cb2-29"></span>
<span id="cb2-30">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g5 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb2-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_levels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>,</span>
<span id="cb2-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_prefix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"("</span>,</span>
<span id="cb2-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_suffix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span></span>
<span id="cb2-36">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb2-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb2-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.tag =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb2-39">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>,</span>
<span id="cb2-40">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb2-41">    )</span>
<span id="cb2-42">  )</span>
<span id="cb2-43"></span>
<span id="cb2-44"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb2-45">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb2-46">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter7-1_1.png"</span>),</span>
<span id="cb2-47">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">600</span>,</span>
<span id="cb2-48">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2400</span>,</span>
<span id="cb2-49">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">unit =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb2-50">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb2-51">)</span></code></pre></div>
</details>
</div>
<div id="fig-7-1_1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-7-1_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter7-1_1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Map of Greenland, with different projections from (a) to (e)"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter7-1_1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-7-1_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Map of Greenland, with different projections from (a) to (e)
</figcaption>
</figure>
</div>
</section>
<section id="coordinate-reference-systems" class="level3">
<h3 class="anchored" data-anchor-id="coordinate-reference-systems">7.2 Coordinate Reference Systems</h3>
<ul>
<li><strong>CRS</strong>: Used to transform coordinates between systems.</li>
<li><strong>PROJ</strong>: Core library for CRS transformations; integrated into R-spatial packages and QGIS.</li>
<li><strong>Ways to Describe CRSs</strong>:
<ol type="1">
<li>Simple statements: E.g., “lon/lat coordinates” (ambiguous).</li>
<li>Proj4 strings: E.g., <code>+proj=longlat +datum=WGS84</code> (outdated).</li>
<li>Authority:Code strings: E.g., <code>EPSG:4326</code> (recommended).</li>
</ol></li>
<li><strong>Preferred Method</strong>: Authority:Code, e.g., <strong>EPSG:4326</strong>:
<ul>
<li>Understood by <code>sf</code>, <code>terra</code>, and other tools.</li>
<li>Easy to remember and search online (e.g., <a href="https://epsg.io/4326">epsg.io</a>).</li>
<li>Machine-readable and unambiguous.</li>
</ul></li>
<li><strong>Detailed CRS Representation</strong>: WKT (Well-Known Text):
<ul>
<li>Comprehensive format for CRS description (based on ISO 19111:2019).</li>
<li>Used for precision and includes all CRS details (datum, ellipsoid, units, etc.).</li>
<li>Example: <code>st_crs("EPSG:4326")</code> outputs full WKT string.</li>
</ul></li>
<li><strong>Authority Identifiers</strong>:
<ul>
<li><strong>EPSG</strong>: Most common authority; standardized CRSs list.</li>
<li>Other authorities: E.g., <code>ESRI:54030</code> (Robinson projection).</li>
<li>Identifiers are linked to detailed WKT strings for unambiguous use.</li>
</ul></li>
<li>WKT vs Identifiers: <strong>WKT Precedence</strong>: In case of conflict, WKT values override identifiers.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>From the <a href="https://inbo.github.io/tutorials/tutorials/spatial_crs_coding/">INBO blog</a> tutorial “<strong><em>Goodbye PROJ.4! How to specify a coordinate reference system in R?</em></strong>”</p>
<ul>
<li><strong>Understanding CRS</strong>:
<ul>
<li>A CRS interprets numeric coordinates as actual point locations on Earth.</li>
<li>Two main types:
<ul>
<li><em>Geodetic CRSs</em>: Locate coordinates relative to a 3D model of Earth’s surface.</li>
<li><em>Projected CRSs</em>: Convert geodetic coordinates to a 2D map.</li>
</ul></li>
</ul></li>
<li><strong>Components of a CRS</strong>:
<ul>
<li>Coordinate system.</li>
<li>Datum: Defines the position relative to Earth, including the ellipsoid.</li>
<li>For projected CRSs: Parameters for converting geodetic to projected coordinates.</li>
</ul></li>
<li><strong>CRS Identification</strong>: CRSs are cataloged globally, notably in the EPSG dataset, with each assigned a unique EPSG code.</li>
<li><strong>Best Practices</strong>:
<ul>
<li>Adopt WKT representations for CRS definitions to ensure compatibility and future-proofing.</li>
<li>Familiarize with the EPSG dataset for accurate CRS identification.</li>
<li>Utilize R’s <code>sf</code> package for handling spatial data and CRS specifications.</li>
</ul></li>
</ul>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>WktPretty <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] │ GEOGCS["WGS 84",
    │     DATUM["WGS_1984",
    │         SPHEROID["WGS 84",6378137,298.257223563]],
    │     PRIMEM["Greenwich",0],
    │     UNIT["degree",0.0174532925199433,
    │         AUTHORITY["EPSG","9122"]],
    │     AXIS["Latitude",NORTH],
    │     AXIS["Longitude",EAST],
    │     AUTHORITY["EPSG","4326"]]</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ESRI:102004"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>WktPretty <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] │ PROJCS["USA_Contiguous_Lambert_Conformal_Conic",
    │     GEOGCS["NAD83",
    │         DATUM["North_American_Datum_1983",
    │             SPHEROID["GRS 1980",6378137,298.257222101]],
    │         PRIMEM["Greenwich",0],
    │         UNIT["degree",0.0174532925199433,
    │             AUTHORITY["EPSG","9122"]],
    │         AUTHORITY["EPSG","4269"]],
    │     PROJECTION["Lambert_Conformal_Conic_2SP"],
    │     PARAMETER["latitude_of_origin",39],
    │     PARAMETER["central_meridian",-96],
    │     PARAMETER["standard_parallel_1",33],
    │     PARAMETER["standard_parallel_2",45],
    │     PARAMETER["false_easting",0],
    │     PARAMETER["false_northing",0],
    │     UNIT["metre",1],
    │     AXIS["Easting",EAST],
    │     AXIS["Northing",NORTH],
    │     AUTHORITY["ESRI","102004"]]</code></pre>
</div>
</div>
</section>
<section id="querying-and-setting-coordinate-systems" class="level3">
<h3 class="anchored" data-anchor-id="querying-and-setting-coordinate-systems">7.3 Querying and Setting Coordinate Systems</h3>
<ul>
<li><p><strong>CRS in R spatial objects:</strong> Coordinate Reference Systems (CRS) are queried and set in vector and raster geographic data using functions from the <code>sf</code> <span class="citation" data-cites="sf">(Pebesma and Bivand 2023a)</span> and <code>terra</code> <span class="citation" data-cites="terra-2">(Hijmans 2024a)</span> packages.</p></li>
<li><p><strong>Vector data CRS handling:</strong></p>
<ul>
<li>Use <a href="https://r-spatial.github.io/sf/reference/st_crs.html"><code>st_crs()</code></a> to query CRS in vector objects (e.g., EPSG:4326 for WGS 84).</li>
<li>CRS metadata includes <code>User input</code> (e.g., EPSG code, proj-string) and <code>wkt</code> (WKT string with complete CRS details).</li>
</ul></li>
<li><p>Additional CRS details can be retrieved: The <code>st_crs()</code> function from the <strong>sf</strong> package in R provides detailed information about the Coordinate Reference System (CRS) of spatial objects.</p></li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 62%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Attribute</th>
<th>Description</th>
<th>Example Usage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>IsGeographic</strong></td>
<td>Indicates if the CRS is geographic (TRUE) or projected (FALSE).</td>
<td><code>st_crs(new_vector)$IsGeographic</code></td>
</tr>
<tr class="even">
<td><strong>units_gdal</strong></td>
<td>Specifies the units of measurement used in the CRS, as recognized by GDAL.</td>
<td><code>st_crs(new_vector)$units_gdal</code></td>
</tr>
<tr class="odd">
<td><strong>srid</strong></td>
<td>Provides the Spatial Reference System Identifier (SRID) associated with the CRS, if available.</td>
<td><code>st_crs(new_vector)$srid</code></td>
</tr>
<tr class="even">
<td><strong>proj4string</strong></td>
<td>Returns the PROJ.4 string representation of the CRS, offering a concise textual description.</td>
<td><code>st_crs(new_vector)$proj4string</code></td>
</tr>
<tr class="odd">
<td><strong>WktPretty</strong></td>
<td>Provides a formatted Well-Known Text (WKT) representation of the CRS for easier readability.</td>
<td><code>st_crs(new_vector)$WktPretty</code></td>
</tr>
<tr class="even">
<td><strong>InvFlattening</strong></td>
<td>Provides the inverse flattening value of the ellipsoid, indicating its compression.</td>
<td><code>st_crs(new_vector)$InvFlattening</code></td>
</tr>
<tr class="odd">
<td><strong>Name</strong></td>
<td>Retrieves the official name of the CRS.</td>
<td><code>st_crs(new_vector)$Name</code></td>
</tr>
<tr class="even">
<td><strong>epsg</strong></td>
<td>Returns the EPSG code associated with the CRS, if available.</td>
<td><code>st_crs(new_vector)$epsg</code></td>
</tr>
<tr class="odd">
<td><strong>yx</strong></td>
<td>Indicates whether the axis order is latitude-longitude (TRUE) or longitude-latitude (FALSE).</td>
<td><code>st_crs(new_vector)$yx</code></td>
</tr>
<tr class="even">
<td><strong>ud_unit</strong></td>
<td>Returns the units object associated with the CRS, or NULL if units are missing.</td>
<td><code>st_crs(new_vector)$ud_unit</code></td>
</tr>
<tr class="odd">
<td><strong>axes</strong></td>
<td>Provides information about the axes of the CRS, including their names and units.</td>
<td><code>st_crs(new_vector)$axes</code></td>
</tr>
</tbody>
</table>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The WGS 84 / EPSG 4326 projection (default projection in {rnaturalearth})</span></span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>units_gdal</span>
<span id="cb7-3"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] "degree"</span></span>
<span id="cb7-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>IsGeographic</span>
<span id="cb7-5"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] TRUE</span></span>
<span id="cb7-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>proj4string</span>
<span id="cb7-7"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] "+proj=longlat +datum=WGS84 +no_defs"</span></span>
<span id="cb7-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>axes</span>
<span id="cb7-9"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##                 name orientation</span></span>
<span id="cb7-10"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1  Geodetic latitude           1</span></span>
<span id="cb7-11"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 2 Geodetic longitude           3</span></span>
<span id="cb7-12"></span>
<span id="cb7-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The EPSG:3857 Web Mercator Projection (used for maps and distances)</span></span>
<span id="cb7-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:3857"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>units_gdal</span>
<span id="cb7-15"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] "metre"</span></span>
<span id="cb7-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:3857"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>IsGeographic</span>
<span id="cb7-17"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] FALSE</span></span>
<span id="cb7-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:3857"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>proj4string</span>
<span id="cb7-19"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] "+proj=merc +a=6378137 +b=6378137 +lat_ts=0 +lon_0=0 +x_0=0 +y_0=0 +k=1 +units=m +nadgrids=@null +wktext +no_defs"</span></span>
<span id="cb7-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:3857"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>axes</span>
<span id="cb7-21"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       name orientation</span></span>
<span id="cb7-22"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1  Easting           3</span></span>
<span id="cb7-23"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 2 Northing           1</span></span>
<span id="cb7-24"></span>
<span id="cb7-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Robinson Projection ESRI:54030 </span></span>
<span id="cb7-26"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ESRI:54030"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>units_gdal</span>
<span id="cb7-27"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] "metre"</span></span>
<span id="cb7-28"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ESRI:54030"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>IsGeographic</span>
<span id="cb7-29"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] FALSE</span></span>
<span id="cb7-30"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ESRI:54030"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>proj4string</span>
<span id="cb7-31"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] "+proj=robin +lon_0=0 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs"</span></span>
<span id="cb7-32"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ESRI:54030"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>axes</span>
<span id="cb7-33"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       name orientation</span></span>
<span id="cb7-34"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1  Easting           3</span></span>
<span id="cb7-35"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 2 Northing           1</span></span></code></pre></div>
</details>
</div>
<ul>
<li><p><strong>Use <a href="https://r-spatial.github.io/sf/reference/st_set_crs.html"><code>st_set_crs()</code></a> to manually set or correct a CRS.</strong> Both <code>st_set_crs()</code> and the assignment method <code>st_crs(object) &lt;- value</code> are used to define or modify the Coordinate Reference System (CRS) of spatial objects.</p>
<ul>
<li><p><code>st_set_crs()</code> is a function call, which can be advantageous when using pipes (<code>|&gt;</code>) in a workflow.</p></li>
<li><p>Both methods assign CRS metadata to the spatial object without altering the actual coordinate values or geometries.</p></li>
<li><p>To transform the coordinates to a different CRS, the <code>st_transform()</code> function should be used.</p></li>
<li><p>Assigning a CRS is akin to labeling data with its existing coordinate system, whereas transforming reprojects the data into a new coordinate system.</p></li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> greenland <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_set_crs</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb8-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>,</span>
<span id="cb8-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The default CRS: a geographic CRS"</span></span>
<span id="cb8-8">  )</span>
<span id="cb8-9"></span>
<span id="cb8-10">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> greenland <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:3857"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb8-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"st_transform(`EPSG:3857`)"</span>,</span>
<span id="cb8-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Correct usage; EPSG:3857 CRS: a projected CRS"</span></span>
<span id="cb8-17">  )</span>
<span id="cb8-18"></span>
<span id="cb8-19">g3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> greenland <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_set_crs</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:3857"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb8-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"st_set_crs(`EPSG:3857`)"</span>,</span>
<span id="cb8-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Wrong usage; distorts and assigns CRS values"</span></span>
<span id="cb8-26">  )</span>
<span id="cb8-27"></span>
<span id="cb8-28">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb8-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_levels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>,</span>
<span id="cb8-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_prefix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"("</span>,</span>
<span id="cb8-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_suffix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span></span>
<span id="cb8-34">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb8-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb8-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.tag =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb8-37">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>,</span>
<span id="cb8-38">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb8-39">    ),</span>
<span id="cb8-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb8-41">  )</span>
<span id="cb8-42"></span>
<span id="cb8-43"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb8-44">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb8-45">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter7-3_1.png"</span>),</span>
<span id="cb8-46">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">600</span>,</span>
<span id="cb8-47">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2400</span>,</span>
<span id="cb8-48">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">unit =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span></span>
<span id="cb8-49">)</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/chapter7-3_1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Explaining the difference between the st_set_crs() and st_transform(). The figures show (a) The default map of Greenland as obtained from {rnaturalearth} with the CRS WGS84 (i.e.&nbsp;EPSG:4326). (b) The transformation using st_transform() which produces correct transformation. (c) The incorrect method using st_set_crs() which simply retains all data, but assumes them to be in the new assigned CRS. This leads to wrong latitude and longitude numbers. Thus, the only use of st_set_crs() is for assigning a CRS to a raw data, which we know for sure from outside sources."><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter7-3_1.png" class="img-fluid figure-img" alt="Explaining the difference between the st_set_crs() and st_transform(). The figures show (a) The default map of Greenland as obtained from {rnaturalearth} with the CRS WGS84 (i.e.&nbsp;EPSG:4326). (b) The transformation using st_transform() which produces correct transformation. (c) The incorrect method using st_set_crs() which simply retains all data, but assumes them to be in the new assigned CRS. This leads to wrong latitude and longitude numbers. Thus, the only use of st_set_crs() is for assigning a CRS to a raw data, which we know for sure from outside sources."></a></p>
<figcaption>Explaining the difference between the st_set_crs() and st_transform(). The figures show (a) The default map of Greenland as obtained from {rnaturalearth} with the CRS WGS84 (i.e.&nbsp;EPSG:4326). (b) The transformation using <code>st_transform()</code> which produces correct transformation. (c) The incorrect method using <code>st_set_crs()</code> which simply retains all data, but assumes them to be in the new assigned CRS. This leads to wrong latitude and longitude numbers. Thus, the only use of <code>st_set_crs()</code> is for assigning a CRS to a raw data, which we know for sure from outside sources.</figcaption>
</figure>
</div>
<ul>
<li><p><strong>Validate CRS with <code>st_is_longlat()</code>.</strong></p>
<ul>
<li><p>The function <strong><code>st_is_longlat()</code></strong> in the <strong>sf</strong> package is used to check whether the Coordinate Reference System (CRS) of a spatial object is based on a geographic coordinate system (latitude and longitude). It’s Return Value can be: —</p>
<ul>
<li><p>TRUE: The object has a geographic CRS (e.g., EPSG:4326).</p></li>
<li><p>FALSE: The object has a projected CRS.</p></li>
<li><p>NA: The CRS is undefined (e.g., no metadata about the coordinate system is set).</p></li>
</ul></li>
</ul></li>
<li><p><strong>Raster data CRS handling:</strong></p>
<ul>
<li>Use <code>crs()</code> from the {terra} package to query and set CRS for raster objects.</li>
<li>Outputs CRS as a WKT string.</li>
<li>Set CRS with EPSG codes, WKT strings, or CRSs from other objects (e.g., <code>crs(my_raster) = "EPSG:26912"</code>).</li>
</ul></li>
<li><p><strong>Important considerations:</strong></p>
<ul>
<li><code>st_crs()</code> and <code>crs()</code> only set metadata; they do not modify coordinate values or geometries.</li>
<li>Missing CRS in datasets (e.g., <code>NA</code> output in <code>st_is_longlat()</code>) indicates that CRS must be explicitly defined (e.g., using <code>st_set_crs()</code>).</li>
</ul></li>
<li><p>CRS assumptions: R avoids assumptions about CRS (e.g., unlike GeoJSON which defaults to <code>EPSG:4326</code>).</p></li>
</ul>
</section>
<section id="geometry-operations-on-projected-and-unprojected-data" class="level3">
<h3 class="anchored" data-anchor-id="geometry-operations-on-projected-and-unprojected-data">7.4 Geometry Operations on Projected and Unprojected Data</h3>
<ul>
<li><p>The <code>sf</code> package integrates with:</p>
<ul>
<li>The <a href="https://cran.r-project.org/web/packages/s2/">S2 spherical geometry engine</a> for <strong>geographic CRS data</strong> with longitude/latitude (lon/lat) CRSs.</li>
<li><a href="https://libgeos.org/">GEOS</a> is used for <strong>projected CRS or CRS-absent data</strong>.</li>
<li><strong>Default Behavior</strong>: S2 is enabled by default for geographic data but can be disabled using <a href="https://r-spatial.github.io/sf/reference/sf_use_s2.html"><code>sf::sf_use_s2(FALSE)</code></a>.</li>
</ul></li>
<li><p><strong>CRS Importance in Buffers</strong>: Buffers created on unprojected data (e.g., lon/lat) can result in distorted outputs (for example A.1 in Figure&nbsp;2) unless spherical geometry (S2) is used. Better still, always use a projected CRS for accurate distance / buffers calculation (as C.1 in Figure&nbsp;2).</p></li>
<li><p>Key Learnings:</p>
<ol type="1">
<li><p><strong>Incorrect buffer creation:</strong> Buffers on geographic data (Long / Lat data) without a specified CRS (thus, using GEOS) result in outputs in degrees (as A.1 &amp; A.3 in Figure&nbsp;2). <em>Note: Lon/lat buffers without S2 or projection may appear elongated (e.g., along the north-south axis).</em></p></li>
<li><p><strong>Correct buffer creation:</strong> S2 buffers (with Geographic CRS, i.e.&nbsp;Long / Lat data) calculate accurate distances (as B.1 in Figure&nbsp;2) but may create jagged boundaries (as B.3 in Figure&nbsp;2) (this can be tuned with <code>max_cells</code> or <code>nQuadSegs</code>).</p></li>
<li><p><strong>Ideal buffer creation:</strong> Use projected CRSs (as in C.1, C.2 &amp; C.3 in Figure&nbsp;2)) like British National Grid (<code>EPSG:27700</code>) for consistent distance-based operations, for example, in metres (m).</p></li>
</ol></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>Note: S2 buffers improve results but remain less precise than using projected CRSs and GEOS.</em></p>
</div>
</div>
<ul>
<li><p><strong>Visual Outcomes</strong>:</p>
<ul>
<li>Buffers based on S2 and projected CRSs produce more accurate, equidistant boundaries compared to lon/lat inputs without S2.</li>
<li>S2-derived buffers differ from projected GEOS buffers, and resolution depends on <code>max_cells</code> (default: 1000). (as B.3 in Figure&nbsp;2)</li>
</ul></li>
<li><p><strong>Best Practices</strong>:</p>
<ul>
<li>Use <code>sf::st_crs()</code> to check the CRS and <strong>verify units (e.g., degrees vs.&nbsp;meters) of the CRS</strong>. Reproject data to a projected CRS using suitable EPSG codes for precise geometric operations.</li>
<li>For distance-based operations like buffering, reproject data to a projected CRS.</li>
<li>Adjust <code>max_cells</code> in S2 for performance versus resolution trade-offs. (as B.1 in Figure&nbsp;2)</li>
</ul></li>
</ul>
<section id="fig-7-4-shows-an-example-buffer-zone-around-london" class="level4">
<h4 class="anchored" data-anchor-id="fig-7-4-shows-an-example-buffer-zone-around-london">Figure&nbsp;2 shows an example (buffer zone around London)</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">overall_title <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"When and How to Use S2 and GEOS Engines for Spatial Operations"</span></span>
<span id="cb9-2">overall_subtitle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GEOS handles projected or CRS-absent data; S2 defaults for geographic data but is optional."</span></span>
<span id="cb9-3"></span>
<span id="cb9-4"></span>
<span id="cb9-5">bts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Base Text Size</span></span>
<span id="cb9-6"></span>
<span id="cb9-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(</span>
<span id="cb9-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb9-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb9-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> bts,</span>
<span id="cb9-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_line_size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span></span>
<span id="cb9-12">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-13">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb9-14">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb9-15">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey20"</span></span>
<span id="cb9-16">      ),</span>
<span id="cb9-17">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb9-18">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.9</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb9-19">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lines"</span>)</span>
<span id="cb9-20">      ),</span>
<span id="cb9-21">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb9-22">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb9-23">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lines"</span>)</span>
<span id="cb9-24">      ),</span>
<span id="cb9-25">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb9-26">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb9-27">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb9-28">      ),</span>
<span id="cb9-29">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb9-30">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(</span>
<span id="cb9-31">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#caf0f8"</span>,</span>
<span id="cb9-32">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#caf0f8"</span></span>
<span id="cb9-33">      ),</span>
<span id="cb9-34">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb9-35">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb9-36">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>,</span>
<span id="cb9-37">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb9-38">      )</span>
<span id="cb9-39">    )</span>
<span id="cb9-40">)</span>
<span id="cb9-41"></span>
<span id="cb9-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a London data point - the coordiantes in Latitude</span></span>
<span id="cb9-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># and Longitude of London, UK</span></span>
<span id="cb9-44">london_sans_crs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lon =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lat =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">51.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coords =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lon"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lat"</span>))</span>
<span id="cb9-46"></span>
<span id="cb9-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Adding the CRS to London data point: values stay same</span></span>
<span id="cb9-48">london_with_crs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> london_sans_crs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_set_crs</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>)</span>
<span id="cb9-50"></span>
<span id="cb9-51"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># British National Grid</span></span>
<span id="cb9-52"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># st_crs("EPSG:27700")</span></span>
<span id="cb9-53"></span>
<span id="cb9-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Using the British National Grid CRS: values get changed</span></span>
<span id="cb9-55">london_british_crs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> london_sans_crs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_set_crs</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:27700"</span>)</span>
<span id="cb9-58"></span>
<span id="cb9-59"></span>
<span id="cb9-60"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create an approximate bounding box around 200 km around London</span></span>
<span id="cb9-61">bbox_near_london <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> london_sans_crs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-62">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_set_crs</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-63">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_buffer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-64">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_bbox</span>()</span>
<span id="cb9-65"></span>
<span id="cb9-66"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Crop and keep coastline map around London</span></span>
<span id="cb9-67">outline_map <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rnaturalearth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ne_countries</span>(</span>
<span id="cb9-68">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">continent =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Europe"</span>,</span>
<span id="cb9-69">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">returnclass =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf"</span>,</span>
<span id="cb9-70">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"large"</span></span>
<span id="cb9-71">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-72">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_union</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-73">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-74">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crop</span>(bbox_near_london)</span>
<span id="cb9-75"></span>
<span id="cb9-76"></span>
<span id="cb9-77">base_plot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-78">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb9-79">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> outline_map,</span>
<span id="cb9-80">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,</span>
<span id="cb9-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb9-82">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-83">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb9-84">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> london_with_crs,</span>
<span id="cb9-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb9-86">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#fb8500"</span></span>
<span id="cb9-87">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-88">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb9-89"></span>
<span id="cb9-90"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Without any CRS -------------------------------------------------</span></span>
<span id="cb9-91"></span>
<span id="cb9-92">row_1_title <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"London Data, without any CRS"</span></span>
<span id="cb9-93">row_1_subtitle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data in Long / Lat, but without a specified CRS, leads {sf} to use GEOS engine, as in (a) and (c)"</span></span>
<span id="cb9-94"></span>
<span id="cb9-95">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> base_plot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-96">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb9-97">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_buffer</span>(london_sans_crs, </span>
<span id="cb9-98">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-99">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_set_crs</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>),</span>
<span id="cb9-100">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ffb703"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>),</span>
<span id="cb9-101">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ffb703"</span></span>
<span id="cb9-102">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-103">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb9-104">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Incorrect: Using GEOS on Long/Lat data"</span>,</span>
<span id="cb9-105">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"st_buffer(london_sans_crs, dist = 1)"</span></span>
<span id="cb9-106">  )</span>
<span id="cb9-107"></span>
<span id="cb9-108">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> base_plot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-109">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb9-110">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> london_sans_crs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-111">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_set_crs</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-112">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_buffer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb9-113">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ffb703"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>),</span>
<span id="cb9-114">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ffb703"</span></span>
<span id="cb9-115">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-116">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb9-117">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Incorrect: Using S2 but wrong Buffer units"</span>,</span>
<span id="cb9-118">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"london_sans_crs |&gt; st_set_crs(`EPSG:4326`) |&gt; st_buffer(dist = 1)"</span></span>
<span id="cb9-119">  )</span>
<span id="cb9-120"></span>
<span id="cb9-121">g3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> base_plot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-122">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb9-123">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_buffer</span>(london_sans_crs, </span>
<span id="cb9-124">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb9-125">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nQuadSegs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-126">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_set_crs</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>),</span>
<span id="cb9-127">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ffb703"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>),</span>
<span id="cb9-128">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ffb703"</span></span>
<span id="cb9-129">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-130">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb9-131">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Incorrect: Using GEOS with nQuadSegs"</span>,</span>
<span id="cb9-132">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"st_buffer(london_sans_crs, dist = 1, nQuadSegs = 3)"</span></span>
<span id="cb9-133">  )</span>
<span id="cb9-134"></span>
<span id="cb9-135"></span>
<span id="cb9-136">row_2_title <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"London with a Geographic CRS `EPSG:4326`"</span></span>
<span id="cb9-137">row_2_subtitle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data in Long/Lat, but with CRS speficied, leads {sf}to use S2 (spherical geometry). Distance is in metres, now."</span></span>
<span id="cb9-138"></span>
<span id="cb9-139"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sf_use_s2</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb9-140">g4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> base_plot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-141">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb9-142">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_buffer</span>(london_with_crs, </span>
<span id="cb9-143">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e5</span>,</span>
<span id="cb9-144">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max_cells =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>),</span>
<span id="cb9-145">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb9-146">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ffb703"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>),</span>
<span id="cb9-147">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ffb703"</span></span>
<span id="cb9-148">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-149">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb9-150">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Correct: Buffer of 100 km using S2"</span>,</span>
<span id="cb9-151">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Using S2 engine (spherical geometry); Notice jagged buffer line."</span></span>
<span id="cb9-152">  )</span>
<span id="cb9-153"></span>
<span id="cb9-154"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sf_use_s2</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb9-155">g5 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> base_plot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-156">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb9-157">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_buffer</span>(london_with_crs, </span>
<span id="cb9-158">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb9-159">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max_cells =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>),</span>
<span id="cb9-160">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb9-161">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ffb703"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>),</span>
<span id="cb9-162">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ffb703"</span></span>
<span id="cb9-163">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-164">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb9-165">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Incorrect: Buffer of 1 degree with GEOS"</span>,</span>
<span id="cb9-166">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf_use_s2(FALSE):  Using GEOS engine on geographic CRS."</span></span>
<span id="cb9-167">  )</span>
<span id="cb9-168"></span>
<span id="cb9-169"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sf_use_s2</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb9-170">g6 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> base_plot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-171">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb9-172">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_buffer</span>(london_with_crs, </span>
<span id="cb9-173">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e5</span>,</span>
<span id="cb9-174">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max_cells =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>),</span>
<span id="cb9-175">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb9-176">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ffb703"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>),</span>
<span id="cb9-177">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ffb703"</span></span>
<span id="cb9-178">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-179">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb9-180">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Correct: Buffer of 100 km using S2"</span>,</span>
<span id="cb9-181">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reducing max_cells = 100 to save computation time."</span></span>
<span id="cb9-182">  )</span>
<span id="cb9-183"></span>
<span id="cb9-184">row_3_title <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"With a Projected CRS: British Grid (EPSG:27700)"</span></span>
<span id="cb9-185">row_3_subtitle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Using London data in Projected CRS results in ideal outputs. Accurate results with GEOS engine."</span></span>
<span id="cb9-186"></span>
<span id="cb9-187">g7 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> base_plot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-188">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb9-189">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_buffer</span>(london_british_crs, </span>
<span id="cb9-190">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e5</span>),</span>
<span id="cb9-191">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb9-192">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ffb703"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>),</span>
<span id="cb9-193">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ffb703"</span></span>
<span id="cb9-194">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-195">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb9-196">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ideal: 100 km Buffer on projected CRS"</span>,</span>
<span id="cb9-197">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"london_british_crs |&gt; st_buffer(dist = 1e5)"</span></span>
<span id="cb9-198">  )</span>
<span id="cb9-199"></span>
<span id="cb9-200">g8 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> base_plot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-201">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb9-202">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_buffer</span>(london_british_crs, </span>
<span id="cb9-203">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e5</span>,</span>
<span id="cb9-204">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nQuadSegs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb9-205">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb9-206">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ffb703"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>),</span>
<span id="cb9-207">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ffb703"</span></span>
<span id="cb9-208">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-209">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb9-210">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance in 4 directions only"</span>,</span>
<span id="cb9-211">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nQuadSegs = 1  (Number of segments per quadrant)."</span></span>
<span id="cb9-212">  )</span>
<span id="cb9-213"></span>
<span id="cb9-214">g9 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> base_plot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-215">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb9-216">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_buffer</span>(london_british_crs, </span>
<span id="cb9-217">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e5</span>,</span>
<span id="cb9-218">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nQuadSegs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb9-219">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb9-220">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ffb703"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>),</span>
<span id="cb9-221">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ffb703"</span></span>
<span id="cb9-222">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-223">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb9-224">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Save Computation Time: 100 km Buffer"</span>,</span>
<span id="cb9-225">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nQuadSegs = 2  (Number of segments per quadrant)."</span></span>
<span id="cb9-226">  )</span>
<span id="cb9-227"></span>
<span id="cb9-228"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A custom theme for each Row headings</span></span>
<span id="cb9-229">theme_row <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(...){</span>
<span id="cb9-230">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb9-231">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb9-232">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb9-233">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>,</span>
<span id="cb9-234">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb9-235">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb9-236">      ),</span>
<span id="cb9-237">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb9-238">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb9-239">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>,</span>
<span id="cb9-240">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb9-241">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb9-242">      ),</span>
<span id="cb9-243">    ...</span>
<span id="cb9-244">  )</span>
<span id="cb9-245">}</span>
<span id="cb9-246"></span>
<span id="cb9-247">theme_tag <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(...){</span>
<span id="cb9-248">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb9-249">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.tag =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb9-250">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb9-251">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb9-252">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>,</span>
<span id="cb9-253">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span></span>
<span id="cb9-254">    ),</span>
<span id="cb9-255">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.tag.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span></span>
<span id="cb9-256">  )</span>
<span id="cb9-257">}</span>
<span id="cb9-258"></span>
<span id="cb9-259"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compiling Plots for London data without CRS</span></span>
<span id="cb9-260">ga <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-261">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb9-262">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> row_1_title,</span>
<span id="cb9-263">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> row_1_subtitle,</span>
<span id="cb9-264">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_row</span>(),</span>
<span id="cb9-265">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_levels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1"</span>,</span>
<span id="cb9-266">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_prefix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A."</span></span>
<span id="cb9-267">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb9-268">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_tag</span>()</span>
<span id="cb9-269"></span>
<span id="cb9-270"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Save the 3 plots for 1st Row</span></span>
<span id="cb9-271"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb9-272">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> ga,</span>
<span id="cb9-273">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb9-274">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb9-275">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"temp_chapter7-4-1.png"</span>),</span>
<span id="cb9-276">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1050</span>,</span>
<span id="cb9-277">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2400</span>,</span>
<span id="cb9-278">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">unit =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb9-279">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb9-280">)</span>
<span id="cb9-281"></span>
<span id="cb9-282"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compiling Plots for London data with a Geographic CRS</span></span>
<span id="cb9-283">gb <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  g4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g5 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g6 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-284">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb9-285">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> row_2_title,</span>
<span id="cb9-286">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> row_2_subtitle,</span>
<span id="cb9-287">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_row</span>(),</span>
<span id="cb9-288">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_levels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1"</span>,</span>
<span id="cb9-289">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_prefix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B."</span></span>
<span id="cb9-290">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb9-291">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_tag</span>()</span>
<span id="cb9-292"></span>
<span id="cb9-293"></span>
<span id="cb9-294"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Save the 3 plots for 2nd Row</span></span>
<span id="cb9-295"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb9-296">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> gb,</span>
<span id="cb9-297">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb9-298">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb9-299">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"temp_chapter7-4-2.png"</span>),</span>
<span id="cb9-300">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1050</span>,</span>
<span id="cb9-301">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2400</span>,</span>
<span id="cb9-302">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">unit =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb9-303">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb9-304">)</span>
<span id="cb9-305"></span>
<span id="cb9-306"></span>
<span id="cb9-307"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compiling Plots for Projected (British Grid) CRS</span></span>
<span id="cb9-308"></span>
<span id="cb9-309">gc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  g7 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g8 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g9 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-310">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(</span>
<span id="cb9-311">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_level =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"new"</span></span>
<span id="cb9-312">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-313">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb9-314">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> row_3_title,</span>
<span id="cb9-315">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> row_3_subtitle,</span>
<span id="cb9-316">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_row</span>(),</span>
<span id="cb9-317">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_levels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1"</span>,</span>
<span id="cb9-318">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_prefix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C."</span></span>
<span id="cb9-319">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb9-320">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_tag</span>()</span>
<span id="cb9-321"></span>
<span id="cb9-322"></span>
<span id="cb9-323"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Save the 3 plots for 3rd Row</span></span>
<span id="cb9-324"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb9-325">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> gc,</span>
<span id="cb9-326">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb9-327">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb9-328">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"temp_chapter7-4-3.png"</span>),</span>
<span id="cb9-329">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1050</span>,</span>
<span id="cb9-330">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2400</span>,</span>
<span id="cb9-331">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">unit =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb9-332">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb9-333">)</span>
<span id="cb9-334"></span>
<span id="cb9-335"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compile the images</span></span>
<span id="cb9-336"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magick)</span>
<span id="cb9-337">ga <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb9-338">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb9-339">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"temp_chapter7-4-1.png"</span>))</span>
<span id="cb9-340">gb <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb9-341">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb9-342">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"temp_chapter7-4-2.png"</span>))</span>
<span id="cb9-343">gc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb9-344">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb9-345">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"temp_chapter7-4-3.png"</span>))</span>
<span id="cb9-346"></span>
<span id="cb9-347"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_append</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(ga, gb, gc), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stack =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-348">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_write</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb9-349">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb9-350">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter7-4.png"</span>))</span>
<span id="cb9-351"></span>
<span id="cb9-352"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clean up the temporary files</span></span>
<span id="cb9-353"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlink</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>,</span>
<span id="cb9-354">                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"temp_chapter7-4-1.png"</span>))</span>
<span id="cb9-355"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlink</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>,</span>
<span id="cb9-356">                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"temp_chapter7-4-2.png"</span>))</span>
<span id="cb9-357"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlink</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>,</span>
<span id="cb9-358">                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"temp_chapter7-4-3.png"</span>))</span></code></pre></div>
</details>
</div>
<div id="fig-7-4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-7-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter7-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;2: The different kinds of buffering - incorrect, correct and ideal using {sf} in R relying on two engines - Google’s S2 spherical geometry, or GEOS engine."><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter7-4.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-7-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: The different kinds of buffering - incorrect, correct and ideal using {sf} in R relying on two engines - Google’s S2 spherical geometry, or GEOS engine.
</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code below calculates the distances between lines of longitude (meridians) and latitude at different geographic points to demonstrate the distortion inherent in geographic coordinate systems (lon/lat CRSs).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load the required package</span></span>
<span id="cb10-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(geosphere)</span>
<span id="cb10-3"></span>
<span id="cb10-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1. Distance between two meridians (longitude lines) at the equator (0° latitude)</span></span>
<span id="cb10-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># From (0°E, 0°N) to (1°E, 0°N)</span></span>
<span id="cb10-6">distance_meridian_equator <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">distGeo</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) </span>
<span id="cb10-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance between meridians at the equator:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(distance_meridian_equator<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"km</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb10-8"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Distance between meridians at the equator: 111.32 km</span></span>
<span id="cb10-9"></span>
<span id="cb10-10"></span>
<span id="cb10-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2. Distance between two meridians at the latitude of London (51.5°N)</span></span>
<span id="cb10-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># From (0°E, 51.5°N) to (1°E, 51.5°N)</span></span>
<span id="cb10-13">distance_meridian_london <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">distGeo</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">51.5</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">51.5</span>)) </span>
<span id="cb10-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance between meridians at London's latitude:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(distance_meridian_london<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"km</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb10-15"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Distance between meridians at London's latitude: 69.44 km</span></span>
<span id="cb10-16"></span>
<span id="cb10-17"></span>
<span id="cb10-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3. Distance between two parallels (latitude lines) at any latitude</span></span>
<span id="cb10-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># From (0°E, 0°N) to (0°E, 1°N)</span></span>
<span id="cb10-20">distance_latitude <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">distGeo</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) </span>
<span id="cb10-21"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance between latitudes:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(distance_latitude<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"meters</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb10-22"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Distance between latitudes: 110.57 meters</span></span></code></pre></div>
</div>
<p>Thus, the distance between meridians varies with latitude, shrinking from approximately 111 km at the equator to zero at the poles, while lines of latitude remain equidistant.</p>
</div>
</div>
</section>
</section>
<section id="when-to-reproject" class="level3">
<h3 class="anchored" data-anchor-id="when-to-reproject">7.5 When to Reproject?</h3>
<ul>
<li>CRS Assignment: In practical daily work, CRSs are typically set automatically when data is read; hoever, if required, manual setting can be done using <a href="https://r-spatial.github.io/sf/reference/st_set_crs.html"><code>st_set_crs()</code></a>.</li>
<li>The main task, in daily work, involves transforming objects between CRSs to enable specific tasks. Transformation Necessity:
<ul>
<li><strong>Tranformation into a Geographic CRS</strong>
<ul>
<li>Essential when publishing online with packages like <a href="https://rstudio.github.io/leaflet/"><code>leaflet</code></a>. <span class="citation" data-cites="leaflet">(Cheng et al. 2024)</span></li>
<li>For projects with web mapping, we need to use <code>EPSG:4326</code> (a geographic CRS).</li>
<li>For projects needing Spherical Geometry operations, use Geographic CRS.</li>
</ul></li>
<li><strong>Tranformation into another Projected CRS</strong>
<ul>
<li>Projects needing planar geometry operations, like creating buffer zones with smooth edges.</li>
<li>Required when comparing or combining objects with different CRSs (e.g., using <a href="https://r-spatial.github.io/sf/reference/st_distance.html"><code>st_distance()</code></a>).</li>
</ul></li>
</ul></li>
<li><strong>CRS Selection</strong>: Geographic CRS is best for global and spherical geometry operations. Projected CRS is ideal for local/regional planar geometry operations and analyses requiring precise distance and area calculations. Table&nbsp;1 summarizes when to use geographic versus projected CRSs:</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tibble)</span>
<span id="cb11-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gt)</span>
<span id="cb11-3"></span>
<span id="cb11-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the table as a tibble</span></span>
<span id="cb11-5">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb11-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ID =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,</span>
<span id="cb11-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Scenario =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb11-8">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Global Mapping"</span>,</span>
<span id="cb11-9">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Great Circle Distances"</span>,</span>
<span id="cb11-10">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Angular Bearings"</span>,</span>
<span id="cb11-11">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Radius-based Proximity Queries (Spherical)"</span>,</span>
<span id="cb11-12">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Local Area Analysis"</span>,</span>
<span id="cb11-13">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Buffer Creation"</span>,</span>
<span id="cb11-14">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Overlay and Intersection Operations"</span>,</span>
<span id="cb11-15">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Planar Geometry Operations"</span>,</span>
<span id="cb11-16">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Area and Length Calculation"</span></span>
<span id="cb11-17">  ),</span>
<span id="cb11-18">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Geographic CRS</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb11-19">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Required for displaying data on web maps (e.g., with leaflet)."</span>,</span>
<span id="cb11-20">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Use for accurate calculation of shortest paths on the Earth's surface."</span>,</span>
<span id="cb11-21">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Essential for computing directions or angles between points."</span>,</span>
<span id="cb11-22">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Use for radius-based queries or geofencing on a global scale."</span>,</span>
<span id="cb11-23">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Not typically recommended unless working with global-scale spherical models."</span>,</span>
<span id="cb11-24">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Not recommended for smooth edges."</span>,</span>
<span id="cb11-25">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Limited to angular-based operations (e.g., great circle intersections)."</span>,</span>
<span id="cb11-26">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Not ideal for creating planar geometries like buffers or centroids."</span>,</span>
<span id="cb11-27">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Use for global-scale spherical areas (with corrections)."</span></span>
<span id="cb11-28">  ),</span>
<span id="cb11-29">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Projected CRS</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb11-30">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Not recommended due to distortions at global scales."</span>,</span>
<span id="cb11-31">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distances may be inaccurate due to planar projections."</span>,</span>
<span id="cb11-32">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distortions in angles make it unsuitable for such tasks."</span>,</span>
<span id="cb11-33">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Results can be distorted for large distances."</span>,</span>
<span id="cb11-34">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ideal for small-to-medium-scale analyses with minimal distortions."</span>,</span>
<span id="cb11-35">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Best for creating accurate and smooth planar buffers."</span>,</span>
<span id="cb11-36">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Preferred for planar intersections and overlays for precise alignment."</span>,</span>
<span id="cb11-37">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Essential for tasks like buffering and centroids in local projections."</span>,</span>
<span id="cb11-38">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Use for precise calculations in local or regional contexts."</span></span>
<span id="cb11-39">  )</span>
<span id="cb11-40">)</span>
<span id="cb11-41"></span>
<span id="cb11-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a beautiful table with gt</span></span>
<span id="cb11-43">data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(</span>
<span id="cb11-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Geographic vs Projected CRS"</span>,</span>
<span id="cb11-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A comparison of scenarios for applying Geographic and Projected CRSs"</span></span>
<span id="cb11-48">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-49">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_pff</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_style</span>(</span>
<span id="cb11-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cell_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weight =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb11-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">locations =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cells_body</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> Scenario)</span>
<span id="cb11-53">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_style</span>(</span>
<span id="cb11-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cell_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weight =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb11-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">locations =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cells_body</span>(</span>
<span id="cb11-57">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Geographic CRS</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>,        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Column 3</span></span>
<span id="cb11-58">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>                         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Rows 1-4</span></span>
<span id="cb11-59">    )</span>
<span id="cb11-60">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-61">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_style</span>(</span>
<span id="cb11-62">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cell_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weight =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb11-63">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">locations =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cells_body</span>(</span>
<span id="cb11-64">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Projected CRS</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>,        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Column 4</span></span>
<span id="cb11-65">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>                        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Rows 5-9</span></span>
<span id="cb11-66">    )</span>
<span id="cb11-67">  )</span></code></pre></div>
</details>
<div id="tbl-7-6" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-7-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Guidelines for Choosing Between Geographic and Projected CRSs
</figcaption>
<div aria-describedby="tbl-7-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="ulprjjbobf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#ulprjjbobf table {
  font-family: Roboto, system-ui, 'Segoe UI', Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ulprjjbobf thead, #ulprjjbobf tbody, #ulprjjbobf tfoot, #ulprjjbobf tr, #ulprjjbobf td, #ulprjjbobf th {
  border-style: none;
}

#ulprjjbobf p {
  margin: 0;
  padding: 0;
}

#ulprjjbobf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: rgba(255, 255, 255, 0);
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ulprjjbobf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ulprjjbobf .gt_title {
  color: #333333;
  font-size: 30px;
  font-weight: bold;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ulprjjbobf .gt_subtitle {
  color: #333333;
  font-size: 16px;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ulprjjbobf .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ulprjjbobf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ulprjjbobf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: rgba(255, 255, 255, 0);
  border-bottom-style: solid;
  border-bottom-width: 3px;
  border-bottom-color: rgba(255, 255, 255, 0);
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ulprjjbobf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 6px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ulprjjbobf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ulprjjbobf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ulprjjbobf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ulprjjbobf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 3px;
  border-bottom-color: rgba(255, 255, 255, 0);
  vertical-align: bottom;
  padding-top: 6px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ulprjjbobf .gt_spanner_row {
  border-bottom-style: hidden;
}

#ulprjjbobf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ulprjjbobf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ulprjjbobf .gt_from_md > :first-child {
  margin-top: 0;
}

#ulprjjbobf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ulprjjbobf .gt_row {
  padding-top: 6px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: rgba(255, 255, 255, 0);
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ulprjjbobf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ulprjjbobf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ulprjjbobf .gt_row_group_first td {
  border-top-width: 2px;
}

#ulprjjbobf .gt_row_group_first th {
  border-top-width: 2px;
}

#ulprjjbobf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ulprjjbobf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ulprjjbobf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ulprjjbobf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ulprjjbobf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ulprjjbobf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ulprjjbobf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ulprjjbobf .gt_striped {
  background-color: #F5F5F5;
}

#ulprjjbobf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ulprjjbobf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ulprjjbobf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ulprjjbobf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ulprjjbobf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ulprjjbobf .gt_left {
  text-align: left;
}

#ulprjjbobf .gt_center {
  text-align: center;
}

#ulprjjbobf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ulprjjbobf .gt_font_normal {
  font-weight: normal;
}

#ulprjjbobf .gt_font_bold {
  font-weight: bold;
}

#ulprjjbobf .gt_font_italic {
  font-style: italic;
}

#ulprjjbobf .gt_super {
  font-size: 65%;
}

#ulprjjbobf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ulprjjbobf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ulprjjbobf .gt_indent_1 {
  text-indent: 5px;
}

#ulprjjbobf .gt_indent_2 {
  text-indent: 10px;
}

#ulprjjbobf .gt_indent_3 {
  text-indent: 15px;
}

#ulprjjbobf .gt_indent_4 {
  text-indent: 20px;
}

#ulprjjbobf .gt_indent_5 {
  text-indent: 25px;
}

#ulprjjbobf .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ulprjjbobf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="4" class="gt_heading gt_title gt_font_normal">Geographic vs Projected CRS</th>
</tr>
<tr class="odd gt_heading">
<th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">A comparison of scenarios for applying Geographic and Projected CRSs</th>
</tr>
<tr class="header gt_col_headings">
<th id="ID" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="background-color: #585D63; color: #FFFFFF; font-size: 10px; font-weight: bold; border-bottom-width: 2.5px; border-bottom-style: solid; border-bottom-color: #585d63" scope="col">ID</th>
<th id="Scenario" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="background-color: #585D63; color: #FFFFFF; font-size: 10px; font-weight: bold; border-bottom-width: 2.5px; border-bottom-style: solid; border-bottom-color: #585d63" scope="col">Scenario</th>
<th id="Geographic CRS" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="background-color: #585D63; color: #FFFFFF; font-size: 10px; font-weight: bold; border-bottom-width: 2.5px; border-bottom-style: solid; border-bottom-color: #585d63" scope="col">Geographic CRS</th>
<th id="Projected CRS" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="background-color: #585D63; color: #FFFFFF; font-size: 10px; font-weight: bold; border-bottom-width: 2.5px; border-bottom-style: solid; border-bottom-color: #585d63" scope="col">Projected CRS</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="ID">1</td>
<td class="gt_row gt_left" headers="Scenario" style="font-weight: bold">Global Mapping</td>
<td class="gt_row gt_left" headers="Geographic CRS" style="font-weight: bold">Required for displaying data on web maps (e.g., with leaflet).</td>
<td class="gt_row gt_left" headers="Projected CRS">Not recommended due to distortions at global scales.</td>
</tr>
<tr class="even">
<td class="gt_row gt_right gt_striped" headers="ID">2</td>
<td class="gt_row gt_left gt_striped" headers="Scenario" style="font-weight: bold">Great Circle Distances</td>
<td class="gt_row gt_left gt_striped" headers="Geographic CRS" style="font-weight: bold">Use for accurate calculation of shortest paths on the Earth's surface.</td>
<td class="gt_row gt_left gt_striped" headers="Projected CRS">Distances may be inaccurate due to planar projections.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="ID">3</td>
<td class="gt_row gt_left" headers="Scenario" style="font-weight: bold">Angular Bearings</td>
<td class="gt_row gt_left" headers="Geographic CRS" style="font-weight: bold">Essential for computing directions or angles between points.</td>
<td class="gt_row gt_left" headers="Projected CRS">Distortions in angles make it unsuitable for such tasks.</td>
</tr>
<tr class="even">
<td class="gt_row gt_right gt_striped" headers="ID">4</td>
<td class="gt_row gt_left gt_striped" headers="Scenario" style="font-weight: bold">Radius-based Proximity Queries (Spherical)</td>
<td class="gt_row gt_left gt_striped" headers="Geographic CRS" style="font-weight: bold">Use for radius-based queries or geofencing on a global scale.</td>
<td class="gt_row gt_left gt_striped" headers="Projected CRS">Results can be distorted for large distances.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="ID">5</td>
<td class="gt_row gt_left" headers="Scenario" style="font-weight: bold">Local Area Analysis</td>
<td class="gt_row gt_left" headers="Geographic CRS">Not typically recommended unless working with global-scale spherical models.</td>
<td class="gt_row gt_left" headers="Projected CRS" style="font-weight: bold">Ideal for small-to-medium-scale analyses with minimal distortions.</td>
</tr>
<tr class="even">
<td class="gt_row gt_right gt_striped" headers="ID">6</td>
<td class="gt_row gt_left gt_striped" headers="Scenario" style="font-weight: bold">Buffer Creation</td>
<td class="gt_row gt_left gt_striped" headers="Geographic CRS">Not recommended for smooth edges.</td>
<td class="gt_row gt_left gt_striped" headers="Projected CRS" style="font-weight: bold">Best for creating accurate and smooth planar buffers.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="ID">7</td>
<td class="gt_row gt_left" headers="Scenario" style="font-weight: bold">Overlay and Intersection Operations</td>
<td class="gt_row gt_left" headers="Geographic CRS">Limited to angular-based operations (e.g., great circle intersections).</td>
<td class="gt_row gt_left" headers="Projected CRS" style="font-weight: bold">Preferred for planar intersections and overlays for precise alignment.</td>
</tr>
<tr class="even">
<td class="gt_row gt_right gt_striped" headers="ID">8</td>
<td class="gt_row gt_left gt_striped" headers="Scenario" style="font-weight: bold">Planar Geometry Operations</td>
<td class="gt_row gt_left gt_striped" headers="Geographic CRS">Not ideal for creating planar geometries like buffers or centroids.</td>
<td class="gt_row gt_left gt_striped" headers="Projected CRS" style="font-weight: bold">Essential for tasks like buffering and centroids in local projections.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="ID">9</td>
<td class="gt_row gt_left" headers="Scenario" style="font-weight: bold">Area and Length Calculation</td>
<td class="gt_row gt_left" headers="Geographic CRS">Use for global-scale spherical areas (with corrections).</td>
<td class="gt_row gt_left" headers="Projected CRS" style="font-weight: bold">Use for precise calculations in local or regional contexts.</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="which-crs-to-use" class="level3">
<h3 class="anchored" data-anchor-id="which-crs-to-use">7.6 Which CRS to use?</h3>
<ul>
<li>No single ‘best’ CRS: All projections involve distortions; the choice depends on the task.</li>
<li>Switch CRSs for different tasks: Use a CRS that aligns with your analysis or visualization goals.</li>
<li><strong>Geographic CRS: most commonly, use WGS84 (EPSG:4326):</strong>
<ul>
<li>Common for web mapping, GPS datasets, and most vector - raster datasets.</li>
<li>EPSG code: 4326 (useful for converting to a universal CRS).</li>
</ul></li>
<li><strong>Projected CRS: Often dictated by local mapping agencies.</strong>
<ul>
<li>To ensure compatibility: Preferable to work in CRS (in which the data was provided)</li>
<li><strong>UTM (Universal Transverse Mercator)</strong>: a set of Projected CRSs</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The Universal Transverse Mercator (UTM) set of projections</p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 83%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Feature</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Projection Name</td>
<td>Universal Transverse Mercator (UTM)</td>
</tr>
<tr class="even">
<td>Structure</td>
<td>Divides the Earth into 60 longitudinal zones (6° wide each) and 20 latitudinal segments.</td>
</tr>
<tr class="odd">
<td>CRS Type</td>
<td>Projected CRS. Uses the Transverse Mercator projection for each zone.</td>
</tr>
<tr class="even">
<td>EPSG Codes</td>
<td><p><strong>Northern Hemisphere</strong>: 32601 to 32660.</p>
<p><strong>Southern Hemisphere</strong>: 32701 to 32760.</p></td>
</tr>
<tr class="odd">
<td>Zone Numbering</td>
<td><p>Zones numbered 1 to 60 (<strong>longitude</strong>).</p>
<p><strong>Latitude</strong> segments labeled A to V (excluding I and O).</p></td>
</tr>
<tr class="even">
<td>Example Zones</td>
<td><p>Zone 60H: Northern New Zealand, EPSG: 32760.</p>
<p>Zone 30N: Covers London, EPSG: 32630.</p></td>
</tr>
<tr class="odd">
<td>Key Features</td>
<td><p><strong>Conformal projection</strong>: Preserves angles and shapes locally.</p>
<p>Suitable for small areas.</p></td>
</tr>
<tr class="even">
<td>Distortion</td>
<td>Increases with distance from the zone’s central meridian.</td>
</tr>
<tr class="odd">
<td>Use Cases</td>
<td>Small-scale mapping, local surveys, engineering, and construction projects.</td>
</tr>
<tr class="even">
<td>Limitations</td>
<td>Not suitable for regions spanning multiple zones.</td>
</tr>
</tbody>
</table>
<p>A mpa of the World with UTM projection Zones: —</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">lonlat2UTM <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(lonlat) {</span>
<span id="cb12-2">  utm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">floor</span>((lonlat[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb12-3">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (lonlat[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb12-4">    utm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32600</span></span>
<span id="cb12-5">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>{</span>
<span id="cb12-6">    utm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32700</span></span>
<span id="cb12-7">  }</span>
<span id="cb12-8">}</span></code></pre></div>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A code to plot UTM zones over the World Map in R</span></span>
<span id="cb13-2"></span>
<span id="cb13-3">world_map <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rnaturalearth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ne_countries</span>(</span>
<span id="cb13-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"small"</span>,</span>
<span id="cb13-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">returnclass =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf"</span></span>
<span id="cb13-6">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb13-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(name, geometry)</span>
<span id="cb13-8"></span>
<span id="cb13-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a tibble for the UTM Zone breaks</span></span>
<span id="cb13-10">utm_long_breaks <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb13-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Longitude_Start =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">174</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>),</span>
<span id="cb13-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Longitude_End =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">174</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>),</span>
<span id="cb13-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Zone_Number =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>)</span>
<span id="cb13-14">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb13-15">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb13-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb13-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mid_point_long =</span> (longitude_start <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> longitude_end)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb13-18">  )</span>
<span id="cb13-19"></span>
<span id="cb13-20">utm_lat_breaks <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb13-21">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Latitude_Start =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">72</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)),</span>
<span id="cb13-22">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Latitude_End =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">72</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">72</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">84</span>),</span>
<span id="cb13-23">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Zone_Letter =</span> LETTERS[<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>(LETTERS <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"I"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"O"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Y"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Z"</span>))]</span>
<span id="cb13-24">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb13-25">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb13-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb13-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mid_point_lat =</span> (latitude_start <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> latitude_end)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb13-28">  )</span>
<span id="cb13-29"></span>
<span id="cb13-30">bts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Base Text Size</span></span>
<span id="cb13-31"></span>
<span id="cb13-32">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(</span>
<span id="cb13-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> utm_lat_breaks,</span>
<span id="cb13-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb13-36">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> latitude_start</span>
<span id="cb13-37">    ),</span>
<span id="cb13-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb13-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb13-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey40"</span>,</span>
<span id="cb13-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb13-42">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(</span>
<span id="cb13-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> utm_long_breaks,</span>
<span id="cb13-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb13-46">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> longitude_start</span>
<span id="cb13-47">    ),</span>
<span id="cb13-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb13-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb13-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey40"</span>,</span>
<span id="cb13-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb13-52">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-53"></span>
<span id="cb13-54">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Longitude Labels</span></span>
<span id="cb13-55">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb13-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> utm_long_breaks,</span>
<span id="cb13-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb13-58">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> zone_number,</span>
<span id="cb13-59">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>,</span>
<span id="cb13-60">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> mid_point_long</span>
<span id="cb13-61">    ),</span>
<span id="cb13-62">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb13-63">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb13-64">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey20"</span></span>
<span id="cb13-65">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-66">  </span>
<span id="cb13-67">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Latitude Labels</span></span>
<span id="cb13-68">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb13-69">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> utm_lat_breaks,</span>
<span id="cb13-70">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb13-71">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> zone_letter,</span>
<span id="cb13-72">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">184</span>,</span>
<span id="cb13-73">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> mid_point_lat</span>
<span id="cb13-74">    ),</span>
<span id="cb13-75">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb13-76">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts,</span>
<span id="cb13-77">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey20"</span></span>
<span id="cb13-78">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-79">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb13-80">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> world_map,</span>
<span id="cb13-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb13-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#A8554EFF"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>),</span>
<span id="cb13-83">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#A8554EFF"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>)</span>
<span id="cb13-84">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-85">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(</span>
<span id="cb13-86">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(utm_long_breaks<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>longitude_start,</span>
<span id="cb13-87">                    utm_long_breaks<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>longitude_end)</span>
<span id="cb13-88">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-89">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb13-90">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Longitudanal Zones"</span>,</span>
<span id="cb13-91">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Latitudanal Segments"</span>,</span>
<span id="cb13-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"UTM Projection Zones"</span></span>
<span id="cb13-93">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-94">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb13-95">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb13-96">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> bts</span>
<span id="cb13-97">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-98">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb13-99">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb13-100">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, </span>
<span id="cb13-101">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb13-102">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb13-103">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb13-104">    ),</span>
<span id="cb13-105">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(</span>
<span id="cb13-106">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#FEF7C7FF"</span>,</span>
<span id="cb13-107">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb13-108">    ),</span>
<span id="cb13-109">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb13-110">    </span>
<span id="cb13-111">  )</span>
<span id="cb13-112"></span>
<span id="cb13-113"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb13-114">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb13-115">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter7-6.png"</span>),</span>
<span id="cb13-116">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">240</span>,</span>
<span id="cb13-117">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>,</span>
<span id="cb13-118">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">unit =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>,</span>
<span id="cb13-119">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb13-120">)</span></code></pre></div>
</details>
</div>
<ul>
<li><strong>Selecting CRSs with tools</strong>:
<ul>
<li>Use <code>crsuggest::suggest_crs()</code> <span class="citation" data-cites="crsuggest">(Walker 2022)</span> for recommended CRSs based on spatial objects.</li>
<li>Explore <a href="https://crs-explorer.proj.org/">CRS Explorer</a> by <a href="https://javier.jimenezshaw.com/">Javier Jimenez Shaw</a> for location-specific CRSs.</li>
</ul></li>
<li>Projection Recommendations Table</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 43%">
<col style="width: 35%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Name of Projection Type</strong></th>
<th><strong>When to Use</strong></th>
<th><strong>When Not to Use</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Lambert Azimuthal Equal-Area (LAEA)</strong></td>
<td>- For custom local projections.<br>
- When preserving area is crucial, e.g., for statistical mapping.</td>
<td><p>- When preserving shape or distance is critical.</p>
<p>- For areas extending thousands of kilometers.</p></td>
</tr>
<tr class="even">
<td><strong>Azimuthal Equidistant (AEQD)</strong></td>
<td>- For accurate straight-line distances from a central point.<br>
- Mapping distances for circular or radial features.</td>
<td><p>- For large-scale mapping beyond the immediate region of the center.</p>
<p>- When shape or area preservation matters.</p></td>
</tr>
<tr class="odd">
<td><strong>Lambert Conformal Conic (LCC)</strong></td>
<td>- For regions spanning thousands of kilometers (e.g., continents or large countries).<br>
- When preserving shape is important.</td>
<td><p>- For small-scale maps.</p>
<p>- When precise area calculations are required.</p></td>
</tr>
<tr class="even">
<td><strong>Stereographic (STERE)</strong></td>
<td><p>- For polar regions.</p>
<p>- When preserving shape for relatively small polar areas.</p></td>
<td><p>- For large-scale maps extending thousands of kilometers.</p>
<p>- For accurate area or distance calculations.</p></td>
</tr>
</tbody>
</table>
<ul>
<li><strong>Custom CRSs</strong>:
<ul>
<li>Suitable for local datasets, using center points for AEQD.</li>
<li>Caution: Not compatible with other datasets; may lose accuracy for large areas.</li>
</ul></li>
<li>Advanced options: Use <a href="https://proj.org/geodesic.html">geodesic calculations</a> for fallback if no CRS fits.</li>
</ul>
</section>
<section id="reprojecting-vector-geometries" class="level3">
<h3 class="anchored" data-anchor-id="reprojecting-vector-geometries">7.7 Reprojecting Vector Geometries</h3>
<ul>
<li><strong>Reprojection</strong>: Transforming the coordinates of vector geometries (points, lines, polygons). Example: Converting CRS of an object for accurate distance measurement.</li>
<li>Key Functionality in <code>sf</code> Package: Use <a href="https://r-spatial.github.io/sf/reference/st_transform.html"><code>st_transform()</code></a> to transform CRS.</li>
<li><strong>Querying and Setting CRS</strong>:
<ul>
<li>Retrieve CRS of <code>sf</code> objects using <a href="https://r-spatial.github.io/sf/reference/st_crs.html"><code>st_crs()</code></a>.</li>
<li>Output contains components like <code>User input</code> and <code>wkt</code>.</li>
<li>CRS objects are lists containing elements like <code>Name</code>, <code>proj4string</code>, <code>epsg</code>, and <code>$wkt</code>, as shown in table in Section 7.3 above.</li>
<li><code>$wkt</code> serves as the ultimate source of CRS details, queried via PROJ.</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>OGR Coordinate Reference Systems and Coordinate Transformation <a href="https://gdal.org/en/stable/tutorials/osr_api_tut.html">tutorial</a> provides insights into handling coordinate reference systems (CRS) and performing transformations using GDAL’s OGR library. Here’s how key concepts from the tutorial translate to <code>{sf}</code> in R:</p>
<ul>
<li>Defining a Geographic CRS:
<ul>
<li>In <code>{sf}</code>, you can assign a CRS to an <code>sf</code> object using the <code>st_set_crs()</code> function.</li>
</ul></li>
<li>Querying CRS Information:
<ul>
<li>In <code>{sf}</code>, you can retrieve CRS information using the <code>st_crs()</code> function:</li>
</ul></li>
<li>Transforming Coordinates Between CRSs:
<ul>
<li>In <code>{sf}</code>, the <code>st_transform()</code> function is used to transform geometries to a different CRS. For example, to transform to EPSG:27700:</li>
</ul></li>
<li>Handling Axis Order:
<ul>
<li><p>In <code>{sf}</code>, you can control axis order interpretation using the <code>st_axis_order()</code> function. To set it to traditional GIS order (longitude, latitude):</p>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_axis_order</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div></li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="reprojecting-raster-geometries" class="level3">
<h3 class="anchored" data-anchor-id="reprojecting-raster-geometries">7.8 Reprojecting Raster Geometries</h3>
<ul>
<li><p><strong>Raster Reprojection</strong>: Creates a new raster with potentially different dimensions. Involves two steps:</p>
<ol type="1">
<li><p>Extent Transformation: Adjusts raster extent (like vector reprojection).</p></li>
<li><p>Pixel Resampling: Re-estimates pixel values.</p></li>
</ol>
<ul>
<li>Recommendation: Prefer vector reprojection over raster reprojection when both data types are used.</li>
</ul></li>
<li><p><strong>Key Difference from vector re-projection:</strong> Raster reprojection creates a new raster with modified attributes (e.g., columns, rows) rather than altering individual pixel coordinates like vectors.</p></li>
<li><p><strong>Two Processes of raster reprojection:</strong></p>
<ul>
<li>Transformation: Adjusts grid geometry without changing pixel values, performed with the <a href="https://cran.r-project.org/package=stars">stars</a> package. Also called Extent Transformation: Similar to vector reprojection, adjusts raster extent. Can be done using {stars} package. <span class="citation" data-cites="stars">(Pebesma and Bivand 2023b)</span></li>
<li>Warping: Reprojects raster using methods like <code>project()</code> from the <a href="https://cran.r-project.org/package=terra">terra</a> package. Also called Pixel Resampling: Computes new pixel values using methods like nearest neighbor or bilinear re-sampling. Can be done with <code>terra::project()</code> from {terra} <span class="citation" data-cites="terra-3">(Hijmans 2024b)</span></li>
</ul></li>
<li><p>Categorical Raster: Method used is <code>nearest neighbor</code> which ensures categorical values remain unchanged during reprojection. Result: Changes in resolution, extent, and added NA values (not new categories). Example is shown in Figure&nbsp;3 .</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">cat_raster <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/nlcd.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>))</span>
<span id="cb15-2"></span>
<span id="cb15-3">cat_raster1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> cat_raster <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">project</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"near"</span>)</span>
<span id="cb15-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># crs(cat_raster) |&gt; </span></span>
<span id="cb15-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   str_view()</span></span>
<span id="cb15-6"></span>
<span id="cb15-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># PROJCRS["NAD83 / UTM zone 12N",</span></span>
<span id="cb15-8"></span>
<span id="cb15-9">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb15-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cat_raster</span>
<span id="cb15-12">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb15-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Original Categorical Raster"</span>,</span>
<span id="cb15-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CRS: NAD83 / UTM zone 12N"</span>,</span>
<span id="cb15-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Land Cover Type"</span></span>
<span id="cb15-17">  )</span>
<span id="cb15-18"></span>
<span id="cb15-19">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb15-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cat_raster1</span>
<span id="cb15-22">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb15-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Transformed Raster"</span>,</span>
<span id="cb15-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CRS: WGS 84  (EPSG:4326)"</span>,</span>
<span id="cb15-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Land Cover Type"</span></span>
<span id="cb15-27">  )</span>
<span id="cb15-28"></span>
<span id="cb15-29"></span>
<span id="cb15-30">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(</span>
<span id="cb15-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb15-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guides =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"collect"</span></span>
<span id="cb15-34">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb15-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Land Cover for a small area in Utah, USA; National Land Cover Database 2011"</span>,</span>
<span id="cb15-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb15-38">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb15-39">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb15-40">      )</span>
<span id="cb15-41">    )</span>
<span id="cb15-42">  )</span>
<span id="cb15-43"></span>
<span id="cb15-44"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb15-45">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb15-46">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter7-8.png"</span>),</span>
<span id="cb15-47">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">800</span>,</span>
<span id="cb15-48">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1200</span>,</span>
<span id="cb15-49">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">unit =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb15-50">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb15-51">)</span></code></pre></div>
</details>
</div>
<div id="fig-8-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-8-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter7-8.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;3: Warping or Re-sampling categorical rasters (akin to reprojection) using terra::project() which uses near method - estimates re-sampled raster values using the value from the nearest original cell."><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter7-8.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-8-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: <strong>Warping or Re-sampling</strong> categorical rasters (akin to reprojection) using <code>terra::project()</code> which uses near method - estimates re-sampled raster values using the value from the nearest original cell.
</figcaption>
</figure>
</div>
<ul>
<li>Continuous Raster: Method used is <code>bilinear</code>, computes pixel values as weighted averages of neighboring cells. Result: Modifications to mean values, resolution, and extent. Example is shown in Figure&nbsp;4 .</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">srtm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/srtm.tif"</span>, </span>
<span id="cb16-2">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>))</span>
<span id="cb16-3"></span>
<span id="cb16-4">srtm1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> srtm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">project</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:32612"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bilinear"</span>)</span>
<span id="cb16-5"></span>
<span id="cb16-6">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb16-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> srtm</span>
<span id="cb16-9">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb16-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Original Elevation Raster"</span>,</span>
<span id="cb16-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Geographic CRS: WGS 84 (EPSG:4326)"</span>,</span>
<span id="cb16-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Elevation (metres)"</span></span>
<span id="cb16-15">  )</span>
<span id="cb16-16"></span>
<span id="cb16-17">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb16-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> srtm1</span>
<span id="cb16-20">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb16-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Transformed Continuous Values Raster"</span>,</span>
<span id="cb16-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Projected CRS: UTM zone 12N (EPSG:32612)"</span>,</span>
<span id="cb16-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Elevation (metres)"</span></span>
<span id="cb16-26">  )</span>
<span id="cb16-27"></span>
<span id="cb16-28"></span>
<span id="cb16-29">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(</span>
<span id="cb16-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb16-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guides =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"collect"</span></span>
<span id="cb16-33">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb16-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Elevation, above sea level in metres, from the Shuttle Radar Topography Mission (SRTM)"</span>,</span>
<span id="cb16-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb16-37">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb16-38">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb16-39">      )</span>
<span id="cb16-40">    )</span>
<span id="cb16-41">  )</span>
<span id="cb16-42"></span>
<span id="cb16-43"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb16-44">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb16-45">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter7-8_1.png"</span>),</span>
<span id="cb16-46">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">800</span>,</span>
<span id="cb16-47">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1200</span>,</span>
<span id="cb16-48">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">unit =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb16-49">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb16-50">)</span></code></pre></div>
</details>
</div>
<div id="fig-8-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-8-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter7-8_1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;4: Warping or Re-sampling a continuous value raster (akin to reprojection) using terra::project() which uses bilinear method - estimates re-sampled raster values using distance weighted mean from nearest 4 cells."><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter7-8_1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-8-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: <strong>Warping or Re-sampling</strong> a continuous value raster (akin to reprojection) using <code>terra::project()</code> which uses bilinear method - estimates re-sampled raster values using distance weighted mean from nearest 4 cells.
</figcaption>
</figure>
</div>
<ul>
<li>Projection Selection: Depends on the task. Use equal-area projections for density calculations, such as points per grid cell or inhabitants per grid cell.</li>
<li>Key Functions:
<ul>
<li><code>project()</code> (<a href="https://cran.r-project.org/package=terra">terra</a>): Reprojects rasters.</li>
<li><code>st_transform()</code> (<a href="https://cran.r-project.org/package=sf">sf</a>): Reprojects vector data.</li>
</ul></li>
<li>A more apparent example is shown in Figure&nbsp;5 for Greenland’s elevation data from {geodata} <span class="citation" data-cites="geodata-2">(Hijmans et al. 2024)</span> using <code>terra::project()</code></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">greenland_raster <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> geodata<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">elevation_30s</span>(</span>
<span id="cb17-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GRL"</span>,</span>
<span id="cb17-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tempdir</span>()</span>
<span id="cb17-4">  )</span>
<span id="cb17-5"></span>
<span id="cb17-6">greenland_raster1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> greenland_raster <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-7">  terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">project</span>(</span>
<span id="cb17-8">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:3413"</span>,</span>
<span id="cb17-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bilinear"</span></span>
<span id="cb17-10">  )</span>
<span id="cb17-11"></span>
<span id="cb17-12">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb17-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> greenland_raster</span>
<span id="cb17-15">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb17-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Original Elevation Raster"</span>,</span>
<span id="cb17-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Geographic CRS: WGS 84 (EPSG:4326)"</span>,</span>
<span id="cb17-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Elevation (metres)"</span></span>
<span id="cb17-21">  )</span>
<span id="cb17-22"></span>
<span id="cb17-23">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb17-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> greenland_raster1</span>
<span id="cb17-26">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb17-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Transformed Continuous Values Raster"</span>,</span>
<span id="cb17-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Projected CRS: EPSG:3413 (North Pole Stereographic)"</span>,</span>
<span id="cb17-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Elevation (metres)"</span></span>
<span id="cb17-32">  )</span>
<span id="cb17-33"></span>
<span id="cb17-34"></span>
<span id="cb17-35">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(</span>
<span id="cb17-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb17-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guides =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"collect"</span></span>
<span id="cb17-39">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb17-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Elevation, above sea level in metres from {geodata}"</span>,</span>
<span id="cb17-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb17-43">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb17-44">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb17-45">      )</span>
<span id="cb17-46">    )</span>
<span id="cb17-47">  )</span>
<span id="cb17-48"></span>
<span id="cb17-49"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb17-50">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb17-51">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter7-8_2.png"</span>),</span>
<span id="cb17-52">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">700</span>,</span>
<span id="cb17-53">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1400</span>,</span>
<span id="cb17-54">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">unit =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb17-55">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb17-56">)</span></code></pre></div>
</details>
</div>
<div id="fig-8-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-8-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter7-8_2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;5: Warping or Re-sampling elevation data for Greenland (obtained from {geodata} package) using terra::project() which uses bilinear method - estimates re-sampled raster values using distance weighted mean from nearest 4 cells."><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter7-8_2.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-8-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Warping or Re-sampling elevation data for Greenland (obtained from {geodata} package) using <code>terra::project()</code> which uses bilinear method - estimates re-sampled raster values using distance weighted mean from nearest 4 cells.
</figcaption>
</figure>
</div>
</section>
<section id="custom-map-projections" class="level3">
<h3 class="anchored" data-anchor-id="custom-map-projections">7.9 Custom Map Projections</h3>
<ul>
<li>Established CRSs (e.g., <code>EPSG:4326</code>) are widely used but may not always fit specific needs; custom CRSs are an alternative.</li>
<li><strong>Custom CRS Creation</strong>: Modify existing WKT CRS definitions, example shown in Figure&nbsp;6, with:
<ul>
<li>For vector objects: <code>sf::st_crs()</code> and <code>sf::st_transform()</code></li>
<li>For raster objects: <code>terra::crs()</code> and <code>terra::project()</code></li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example creating a custom azimuthal equidistant (AEQD) CRS projection focussed on Greenland</span></span>
<span id="cb18-2"></span>
<span id="cb18-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Deduce the centre of Greenland</span></span>
<span id="cb18-4">greenland <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb18-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_centroid</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb18-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_geometry</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb18-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_text</span>()</span>
<span id="cb18-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "POINT (-41.81367 73.08122)"</span></span>
<span id="cb18-9"></span>
<span id="cb18-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(greenland)</span>
<span id="cb18-11"></span>
<span id="cb18-12">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> greenland <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb18-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb18-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WGS 84 (Geographic) CRS"</span>,</span>
<span id="cb18-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Default Geographic CRS in the data"</span></span>
<span id="cb18-18">  )</span>
<span id="cb18-19"></span>
<span id="cb18-20">custom_crs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PROJCS["Custom_AEQD",</span></span>
<span id="cb18-21"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> GEOGCS["GCS_WGS_1984",</span></span>
<span id="cb18-22"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  DATUM["WGS_1984",</span></span>
<span id="cb18-23"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   SPHEROID["WGS_1984",6378137.0,298.257223563]],</span></span>
<span id="cb18-24"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  PRIMEM["Greenwich",0.0],</span></span>
<span id="cb18-25"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  UNIT["Degree",0.0174532925199433]],</span></span>
<span id="cb18-26"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> PROJECTION["Azimuthal_Equidistant"],</span></span>
<span id="cb18-27"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> PARAMETER["Central_Meridian",-41.81367],</span></span>
<span id="cb18-28"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> PARAMETER["Latitude_Of_Origin",73.08122],</span></span>
<span id="cb18-29"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> UNIT["Meter",1.0]]'</span>)</span>
<span id="cb18-30"></span>
<span id="cb18-31">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> greenland <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb18-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_centroid</span>(greenland), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> custom_crs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb18-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Custom AEQD CRS"</span>,</span>
<span id="cb18-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Focussed around the centroid of Greenland (black dot)"</span></span>
<span id="cb18-39">  )</span>
<span id="cb18-40"></span>
<span id="cb18-41">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(</span>
<span id="cb18-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb18-44">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb18-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Creating a custom AEQD CRS for Greenland"</span>,</span>
<span id="cb18-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_levels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>,</span>
<span id="cb18-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_prefix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"("</span>,</span>
<span id="cb18-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_suffix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span>,</span>
<span id="cb18-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb18-51">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>)</span>
<span id="cb18-52">    )</span>
<span id="cb18-53">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb18-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb18-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb18-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.tag =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb18-57">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>, </span>
<span id="cb18-58">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb18-59">    )</span>
<span id="cb18-60">  )</span>
<span id="cb18-61"></span>
<span id="cb18-62"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb18-63">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb18-64">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter7-9_1.png"</span>),</span>
<span id="cb18-65">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">700</span>,</span>
<span id="cb18-66">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1400</span>,</span>
<span id="cb18-67">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">unit =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb18-68">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb18-69">)</span></code></pre></div>
</details>
</div>
<div id="fig-9_1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-9_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter7-9_1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;6: An example creating a custom azimuthal equidistant (AEQD) CRS projection focussed on Greenland"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter7-9_1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-9_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: An example creating a custom azimuthal equidistant (AEQD) CRS projection focussed on Greenland
</figcaption>
</figure>
</div>
<ul>
<li><strong>Projection Wizard</strong>:
<ul>
<li>Interactive tool for selecting spatial extents and distortion properties (<a href="https://projectionwizard.org/">Projection Wizard</a>).</li>
<li>Generates WKT definitions for re-projections.</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Key Learnings from the Projection Wizard <a href="https://projectionwizard.org/#">Website</a></strong></p>
<ul>
<li>Interactive Custom Projections: Simplifies the creation of custom map projections based on user-defined extents and purposes.</li>
<li>User Guidance: Recommends optimal projections for specific geographic areas to minimize distortions.</li>
<li>Multiple Criteria: Supports area, distance, direction, or local shape preservation in projections.</li>
<li>Export Options: Provides projection strings (e.g., WKT, PROJ) for direct use in GIS and programming tools.</li>
<li>Educational Resource: Visualizes distortions to enhance understanding of projection impacts.</li>
</ul>
</div>
</div>
<ul>
<li><strong>PROJ Strings</strong>:
<ul>
<li>Create projections with <code>+proj=</code> strings (<a href="https://proj.org/">PROJ documentation</a>) as shown in an example in Figure&nbsp;7</li>
<li>Common projections for World Maps:
<ul>
<li><strong>Mollweide</strong> (<code>+proj=moll</code>): Preserves area relationships.</li>
<li><strong>Winkel Tripel</strong> (<code>+proj=wintri</code>): Minimizes distortion across spatial properties.</li>
<li><strong>Lambert Azimuthal Equal-Area</strong> (<code>+proj=laea</code>): Centered with <code>+lon_0</code> and <code>+lat_0</code> parameters. The parameters can be changed to suit the location you want to focus on, as shown in example below.</li>
</ul></li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># An example to plot the World map focussed around 4 major cities</span></span>
<span id="cb19-2"></span>
<span id="cb19-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Getting the World Map</span></span>
<span id="cb19-4">world_map <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rnaturalearth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ne_countries</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"small"</span>)</span>
<span id="cb19-5"></span>
<span id="cb19-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a tibble of major cities with their latitude and longitude</span></span>
<span id="cb19-7">major_cities <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> tibble<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb19-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">city =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"New York"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"London"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tokyo"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sydney"</span>),</span>
<span id="cb19-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">latitude =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">40.7128</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">51.5074</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">35.6895</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">33.8688</span>),</span>
<span id="cb19-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">longitude =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">74.0060</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1278</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">139.6917</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">151.2093</span>)</span>
<span id="cb19-11">)</span>
<span id="cb19-12"></span>
<span id="cb19-13">cities_geometry <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> major_cities <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coords =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"longitude"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"latitude"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_set_crs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>)</span>
<span id="cb19-16"></span>
<span id="cb19-17"></span>
<span id="cb19-18">custom_plot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(city_name){</span>
<span id="cb19-19">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Select the city</span></span>
<span id="cb19-20">  city_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> major_cities <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(city <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> city_name)</span>
<span id="cb19-21">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create custom LAEA projection focussed around the city coordinates</span></span>
<span id="cb19-22">  new_crs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"+proj=laea +x_0=0 +y_0=0 +lon_0="</span>, </span>
<span id="cb19-23">                   city_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>longitude, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" +lat_0="</span>, </span>
<span id="cb19-24">                   city_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>latitude)</span>
<span id="cb19-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-26">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> world_map) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-27">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb19-28">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cities_geometry <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(city <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> city_name),</span>
<span id="cb19-29">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, </span>
<span id="cb19-30">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span></span>
<span id="cb19-31">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-32">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> new_crs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-33">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb19-34">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> city_name,</span>
<span id="cb19-35">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Custom LAEA projection centered around "</span>, city_name)</span>
<span id="cb19-36">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-37">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb19-38">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb19-39">    )</span>
<span id="cb19-40">}</span>
<span id="cb19-41"></span>
<span id="cb19-42">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-43">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> world_map) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-44">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb19-45">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"World Map"</span>,</span>
<span id="cb19-46">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Default Geographic CRS: WGS 84"</span></span>
<span id="cb19-47">    )</span>
<span id="cb19-48">g6 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-49">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(world_map, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ESRI:54009"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-50">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb19-51">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"World Map (ESRI:54009)"</span>,</span>
<span id="cb19-52">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mollweide Projection"</span></span>
<span id="cb19-53">    )</span>
<span id="cb19-54"></span>
<span id="cb19-55">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">custom_plot</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"New York"</span>)</span>
<span id="cb19-56">g3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">custom_plot</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"London"</span>)</span>
<span id="cb19-57">g4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">custom_plot</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tokyo"</span>)</span>
<span id="cb19-58">g5 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">custom_plot</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sydney"</span>)</span>
<span id="cb19-59"></span>
<span id="cb19-60">my_design <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb19-61"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">AAFF</span></span>
<span id="cb19-62"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">BCDE</span></span>
<span id="cb19-63"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb19-64"></span>
<span id="cb19-65">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wrap_plots</span>(g1, g2, g3, g4, g5, g6) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-66">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(</span>
<span id="cb19-67">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">design =</span> my_design,</span>
<span id="cb19-68">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">heights =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb19-69">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-70">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb19-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Creating custom projections with {sf} in R"</span>,</span>
<span id="cb19-72">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Lambert azimuthal equal-area projection, customized to be centered on any City around the globe"</span>,</span>
<span id="cb19-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_levels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>,</span>
<span id="cb19-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_prefix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"("</span>,</span>
<span id="cb19-75">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_suffix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span>,</span>
<span id="cb19-76">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb19-77">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb19-78">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>)</span>
<span id="cb19-79">    )</span>
<span id="cb19-80">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb19-81">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb19-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb19-83">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.tag =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb19-84">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>, </span>
<span id="cb19-85">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb19-86">    ),</span>
<span id="cb19-87">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt"</span>)</span>
<span id="cb19-88">  )</span>
<span id="cb19-89"></span>
<span id="cb19-90"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb19-91">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb19-92">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter7-9_2.png"</span>),</span>
<span id="cb19-93">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1400</span>,</span>
<span id="cb19-94">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>,</span>
<span id="cb19-95">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">unit =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb19-96">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb19-97">)</span></code></pre></div>
</details>
</div>
<div id="fig-9_2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-9_2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter7-9_2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;7: An array of maps to demonstrate the power of R and {sf} to create custom projections. Part (a) shows the world map in Geographic CRS, best used for web-mapping. Part (b) shows the Mollweide Projection, showing the global map. The parts (c), (d), (e) and (f) are world maps focussed around a city around the globe in the Lambert Azimuthal Equal-Area projection, created using a custom function with coord_sf() and &quot;+proj&quot; strings."><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter7-9_2.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-9_2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: An array of maps to demonstrate the power of R and {sf} to create custom projections. Part <strong>(a)</strong> shows the world map in Geographic CRS, best used for web-mapping. Part <strong>(b)</strong> shows the Mollweide Projection, showing the global map. The parts <strong>(c)</strong>, <strong>(d)</strong>, <strong>(e)</strong> and <strong>(f)</strong> are world maps focussed around a city around the globe in the Lambert Azimuthal Equal-Area projection, created using a custom function with <code>coord_sf()</code> and <code>"+proj"</code> strings.
</figcaption>
</figure>
</div>
<ul>
<li><strong>Other Resources</strong>:
<ul>
<li>Learn about custom CRS definitions with <strong>WKT strings</strong> (<a href="https://www.ogc.org/">OGC documentation</a>).</li>
<li>Explore PROJ parameters and CRS modifications (<a href="https://proj.org/">PROJ documentation</a>).</li>
</ul></li>
</ul>
</section>
<section id="exercises" class="level3">
<h3 class="anchored" data-anchor-id="exercises">7.10 Exercises</h3>
</section>
<section id="e1." class="level3">
<h3 class="anchored" data-anchor-id="e1.">E1.</h3>
<p><strong>Create a new object called <code>nz_wgs</code> by transforming <code>nz</code> object into the WGS84 CRS.</strong></p>
<ul>
<li><p><strong>Create an object of class <code>crs</code> for both and use this to query their CRSs.</strong></p></li>
<li><p><strong>With reference to the bounding box of each object, what units does each CRS use?</strong></p></li>
<li><p><strong>Remove the CRS from <code>nz_wgs</code> and plot the result: what is wrong with this map of New Zealand and why?</strong></p></li>
</ul>
<p>The code chunk below shows the method to transform the CRS on <code>nz</code> object into <code>WGS84</code> and querying their CRS using <code>st_crs()$WktPretty |&gt; str_view()</code>. The New Zealand Transverse Mercator 2000 projection uses 1 metre as a unit, and WGS84 uses 1 degree of longitude / latitude as a unit. The result of removing the CRS from the <code>nz_wgs</code> object is plotted, along with original <code>nz_wgs</code> object, in Figure&nbsp;8 .</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nz"</span>)</span>
<span id="cb20-2">nz_wgs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nz <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb20-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>)</span>
<span id="cb20-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(nz)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>WktPretty <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] │ PROJCS["NZGD2000 / New Zealand Transverse Mercator 2000",
    │     GEOGCS["NZGD2000",
    │         DATUM["New_Zealand_Geodetic_Datum_2000",
    │             SPHEROID["GRS 1980",6378137,298.257222101,
    │                 AUTHORITY["EPSG","7019"]],
    │             TOWGS84[0,0,0,0,0,0,0],
    │             AUTHORITY["EPSG","6167"]],
    │         PRIMEM["Greenwich",0,
    │             AUTHORITY["EPSG","8901"]],
    │         UNIT["degree",0.0174532925199433,
    │             AUTHORITY["EPSG","9122"]],
    │         AUTHORITY["EPSG","4167"]],
    │     PROJECTION["Transverse_Mercator"],
    │     PARAMETER["latitude_of_origin",0],
    │     PARAMETER["central_meridian",173],
    │     PARAMETER["scale_factor",0.9996],
    │     PARAMETER["false_easting",1600000],
    │     PARAMETER["false_northing",10000000],
    │     UNIT["metre",1,
    │         AUTHORITY["EPSG","9001"]],
    │     AXIS["Easting",EAST],
    │     AXIS["Northing",NORTH],
    │     AUTHORITY["EPSG","2193"]]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(nz_wgs)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>WktPretty <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] │ GEOGCS["WGS 84",
    │     DATUM["WGS_1984",
    │         SPHEROID["WGS 84",6378137,298.257223563]],
    │     PRIMEM["Greenwich",0],
    │     UNIT["degree",0.0174532925199433,
    │         AUTHORITY["EPSG","9122"]],
    │     AXIS["Latitude",NORTH],
    │     AXIS["Longitude",EAST],
    │     AUTHORITY["EPSG","4326"]]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(nz)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>units</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "m"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(nz_wgs)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>units</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> nz_wgs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb28-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WGS84 Projection (Geographic)"</span>,</span>
<span id="cb28-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The map is shown in aspect ratio as per the projection."</span></span>
<span id="cb28-6">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb28-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span></span>
<span id="cb28-9">  )</span>
<span id="cb28-10"></span>
<span id="cb28-11">nz_wgs1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nz_wgs</span>
<span id="cb28-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(nz_wgs1) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb28-13"></span>
<span id="cb28-14">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> nz_wgs1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb28-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Same Map without projection (NA)"</span>,</span>
<span id="cb28-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The map loses its fixed aspect ratio, and converts to equal axes spacing."</span></span>
<span id="cb28-19">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb28-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span></span>
<span id="cb28-22">  )</span>
<span id="cb28-23"></span>
<span id="cb28-24">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(</span>
<span id="cb28-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb28-27">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb28-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Removing the CRS from New Zealand Map"</span>,</span>
<span id="cb28-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_levels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>,</span>
<span id="cb28-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_prefix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"("</span>,</span>
<span id="cb28-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_suffix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span>,</span>
<span id="cb28-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb28-34">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>)</span>
<span id="cb28-35">    )</span>
<span id="cb28-36">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb28-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb28-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb28-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.tag =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb28-40">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>, </span>
<span id="cb28-41">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb28-42">    )</span>
<span id="cb28-43">  )</span>
<span id="cb28-44"></span>
<span id="cb28-45"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb28-46">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb28-47">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter7-ex1.png"</span>),</span>
<span id="cb28-48">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">700</span>,</span>
<span id="cb28-49">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1400</span>,</span>
<span id="cb28-50">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">unit =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb28-51">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb28-52">)</span></code></pre></div>
</details>
</div>
<div id="fig-ex1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ex1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter7-ex1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Figure&nbsp;8: Removing the CRS from a map causes coord_sf() to use coord_equal() instead of desirable aspect ratio prescribed in the original CRS displays."><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter7-ex1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ex1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Removing the CRS from a map causes coord_sf() to use coord_equal() instead of desirable aspect ratio prescribed in the original CRS displays.
</figcaption>
</figure>
</div>
</section>
<section id="e2." class="level3">
<h3 class="anchored" data-anchor-id="e2.">E2.</h3>
<p><strong>Transform the <code>world</code> dataset to the transverse Mercator projection (<code>"+proj=tmerc"</code>) and plot the result. What has changed and why? Try to transform it back into WGS 84 and plot the new object. Why does the new object differ from the original one?</strong></p>
<p>The Figure&nbsp;9 shows the entire result of transforming a Geographic CRS: map (a) in Figure&nbsp;9, into Transverse Mercator Projection: map (b) in Figure&nbsp;9, and then re-projecting it back into the same geographic CRS WGS84: map (c) in Figure&nbsp;9 .</p>
<p>While geographic (GCS) and projected (PCS) systems allow versatile transformations, they are not perfectly reversible in real-world data due to floating-point precision limits and approximations inherent in projection algorithms. After transforming back to WGS 84, some distortions may appear because the process involves approximations during the transformation, especially if the intermediate PCS introduced distortion.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1">world <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rnaturalearth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ne_countries</span>(</span>
<span id="cb29-2">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"small"</span>, </span>
<span id="cb29-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">returnclass =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf"</span></span>
<span id="cb29-4">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb29-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(name, geometry)</span>
<span id="cb29-6">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Removing Indonesia for easy plotting</span></span>
<span id="cb29-7">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># filter(name != "Indonesia")</span></span>
<span id="cb29-8"></span>
<span id="cb29-9">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> world) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb29-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Original World Map"</span>,</span>
<span id="cb29-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Geographic CRS: WGS84"</span></span>
<span id="cb29-14">  )</span>
<span id="cb29-15"></span>
<span id="cb29-16">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> world <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"+proj=tmerc"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb29-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Transverse Mercator Projection"</span>,</span>
<span id="cb29-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Using st_crs(</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">proj=tmerc</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">)"</span></span>
<span id="cb29-21">  )</span>
<span id="cb29-22"></span>
<span id="cb29-23">g3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb29-24">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> world <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb29-25">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"+proj=tmerc"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb29-26">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WGS84"</span>)</span>
<span id="cb29-27">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb29-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Back to original CRS (WGS84)"</span>,</span>
<span id="cb29-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Russian and Antarctica segments are distorted."</span></span>
<span id="cb29-32">  )</span>
<span id="cb29-33"></span>
<span id="cb29-34">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(</span>
<span id="cb29-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb29-37">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb29-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Transforming, and reverting back from a Transverse Mercator to Geographic CRS"</span>,</span>
<span id="cb29-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_levels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>,</span>
<span id="cb29-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_prefix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"("</span>,</span>
<span id="cb29-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_suffix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span>,</span>
<span id="cb29-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb29-44">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb29-45">    )</span>
<span id="cb29-46">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb29-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb29-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb29-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.tag =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb29-50">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>, </span>
<span id="cb29-51">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb29-52">    )</span>
<span id="cb29-53">  )</span>
<span id="cb29-54"></span>
<span id="cb29-55"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb29-56">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb29-57">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter7-ex2.png"</span>),</span>
<span id="cb29-58">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">700</span>,</span>
<span id="cb29-59">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2400</span>,</span>
<span id="cb29-60">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">unit =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb29-61">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb29-62">)</span></code></pre></div>
</details>
</div>
<div id="fig-ex2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ex2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter7-ex2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Figure&nbsp;9: The entire result of transforming a Geographic CRS: original map (a), into (b) Transverse Mercator Projection, and then (c) back into the same geographic CRS WGS84."><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter7-ex2.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ex2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: The entire result of transforming a Geographic CRS: original map (a), into (b) Transverse Mercator Projection, and then (c) back into the same geographic CRS WGS84.
</figcaption>
</figure>
</div>
</section>
<section id="e3." class="level3">
<h3 class="anchored" data-anchor-id="e3.">E3.</h3>
<p><strong>Transform the continuous raster (<code>con_raster</code>) into NAD83 / UTM zone 12N using the nearest neighbor interpolation method. What has changed? How does it influence the results?</strong></p>
<p>The code below, with the results shown in Figure&nbsp;10, depicts an <strong>original continuous raster</strong> (<code>con_raster</code>) in part (a) of Figure&nbsp;10, then the raster transformed into NAD83 / UTM Zone 12N with <strong>nearest neighbour method</strong> in part (b) of Figure&nbsp;10, and finally, the raster transformed into NAD83 / UTM Zone 12N with <strong>bilinear method</strong> in part (c) of Figure&nbsp;10 .</p>
<p>Changes:</p>
<ol type="1">
<li><p>The spatial alignment and resolution may change depending on the target CRS and grid size.</p></li>
<li><p>The edges of the raster may introduce distortions or artifacts, especially if the original CRS and UTM grid are significantly different.</p></li>
</ol>
<p>Impact on Results:</p>
<ol type="1">
<li><p>Advantages: Nearest neighbor preserves the exact original values, which is critical for discrete data.</p></li>
<li><p>Disadvantages: For continuous rasters, it may introduce blocky artifacts, reducing the smoothness and potentially affecting analyses like slope or gradient computation.</p></li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1">con_raster <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/srtm.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>))</span>
<span id="cb30-2"></span>
<span id="cb30-3">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb30-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> con_raster) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb30-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb30-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb30-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Original Raster"</span>,</span>
<span id="cb30-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Geographic CRS: WGS84"</span>,</span>
<span id="cb30-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Elevation (m)"</span></span>
<span id="cb30-10">  )</span>
<span id="cb30-11"></span>
<span id="cb30-12">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb30-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb30-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> con_raster <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb30-15">      terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">project</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:32612"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"near"</span>)</span>
<span id="cb30-16">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb30-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb30-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb30-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NAD83 / UTM zone 12N"</span>,</span>
<span id="cb30-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Using method = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">near</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,</span>
<span id="cb30-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Elevation (m)"</span></span>
<span id="cb30-22">  )</span>
<span id="cb30-23"></span>
<span id="cb30-24">g3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb30-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb30-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> con_raster <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb30-27">      terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">project</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:32612"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bilinear"</span>)</span>
<span id="cb30-28">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb30-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb30-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb30-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NAD83 / UTM zone 12N"</span>,</span>
<span id="cb30-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Using method = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">bilinear</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,</span>
<span id="cb30-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Elevation (m)"</span></span>
<span id="cb30-34">  )</span>
<span id="cb30-35"></span>
<span id="cb30-36">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb30-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(</span>
<span id="cb30-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb30-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guides =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"collect"</span></span>
<span id="cb30-40">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb30-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb30-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Transforming a continuous raster using the nearest neighbor interpolation method."</span>,</span>
<span id="cb30-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_levels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>,</span>
<span id="cb30-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_prefix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"("</span>,</span>
<span id="cb30-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_suffix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span>,</span>
<span id="cb30-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb30-47">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb30-48">    )</span>
<span id="cb30-49">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb30-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb30-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb30-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.tag =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb30-53">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>, </span>
<span id="cb30-54">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb30-55">    ),</span>
<span id="cb30-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt"</span>)</span>
<span id="cb30-57">  )</span>
<span id="cb30-58"></span>
<span id="cb30-59"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb30-60">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb30-61">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter7-ex3.png"</span>),</span>
<span id="cb30-62">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">700</span>,</span>
<span id="cb30-63">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1800</span>,</span>
<span id="cb30-64">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">unit =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb30-65">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb30-66">)</span></code></pre></div>
</details>
</div>
<div id="fig-ex3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ex3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter7-ex3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Figure&nbsp;10: "><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter7-ex3.png" id="fig-ex3" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-ex3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10
</figcaption>
</figure>
</div>
</section>
<section id="e4." class="level3">
<h3 class="anchored" data-anchor-id="e4.">E4.</h3>
<p><strong>Transform the categorical raster (<code>cat_raster</code>) into WGS 84 using the bilinear interpolation method. What has changed? How does it influence the results?</strong></p>
<p>Transforming a categorical raster (<code>cat_raster</code>) from its original coordinate reference system (CRS) (NAD83 / UTM Zone 12N) (shown in (a) of Figure&nbsp;11) into another CRS (such as WGS 84) using bilinear interpolation significantly alters its characteristics and interpretation, as shown in (b) of Figure&nbsp;11.</p>
<ol type="1">
<li>Conversion of Raster Values:
<ul>
<li>A categorical raster represents discrete classes, such as land cover types (e.g., forest, urban, water), using integer values that act as category identifiers.</li>
<li>When transformed using bilinear interpolation, the algorithm treats these integers as continuous numeric values. It calculates a weighted average of the values from the nearest four cells in the input raster to assign values to the output raster.</li>
<li>This process results in non-integer values in the output raster, which no longer correspond to the original categories.</li>
</ul></li>
<li>Loss of Categorical Meaning: The integer values in the original raster have a specific meaning tied to the categories they represent (e.g., 1 = forest, 2 = urban). After bilinear interpolation, the resulting non-integer values are meaningless in the context of categorical data because they no longer map directly to the predefined classes.</li>
<li>Blurring of Boundaries: Bilinear interpolation introduces smoothing between adjacent cells, which creates gradual transitions between values. This results in blurred boundaries between distinct categories, further distorting the original discrete nature of the data.</li>
<li>Introduction of Artefacts: The process can introduce artificial gradients or intermediate values that did not exist in the original data. For example, if the original raster has categories 1 (forest) and 2 (urban), interpolation might produce values like 1.5, which have no real-world significance.</li>
</ol>
<p>This influences the results in the following ways: —</p>
<ol type="1">
<li>Inappropriate Representation: The output raster is now a continuous raster, which is unsuitable for applications requiring categorical data, such as land cover analysis or habitat classification. This could lead to misinterpretations if the data is used without understanding the transformation process.</li>
<li>Loss of Original Information: The categorical structure and associated metadata (e.g., legends, class descriptions) are effectively destroyed, rendering the raster unusable for its original purpose.</li>
<li>Impact on Analysis: Any analysis that relies on the classification of discrete land cover types (e.g., area statistics, habitat mapping) would yield invalid results, as the categories no longer exist in their original form.</li>
</ol>
<p>Thus, for transforming categorical rasters between CRSs, nearest-neighbor interpolation (show in part (c) of Figure&nbsp;11) should be used instead of bilinear interpolation. Nearest-neighbor interpolation preserves the integer values of the categories, ensuring that the categorical meaning of the data is retained.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1">cat_raster <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/nlcd.tif"</span>, </span>
<span id="cb31-2">                               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>))</span>
<span id="cb31-3"></span>
<span id="cb31-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the CRS of the raster</span></span>
<span id="cb31-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crs</span>(cat_raster) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>()</span>
<span id="cb31-6"></span>
<span id="cb31-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check associated colours with the raster</span></span>
<span id="cb31-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># has.colors(cat_raster)</span></span>
<span id="cb31-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># coltab(cat_raster)</span></span>
<span id="cb31-10"></span>
<span id="cb31-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># My custom palette for uniformity</span></span>
<span id="cb31-12">mypal <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#008ee0"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkred"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey80"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgreen"</span>,</span>
<span id="cb31-13">           <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#858f42"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#90bf7e"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#d9e86b"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#96defa"</span>)</span>
<span id="cb31-14">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb31-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cat_raster) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb31-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> mypal) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb31-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb31-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb31-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Categorical Raster"</span>,</span>
<span id="cb31-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CRS NAD83 / UTM Zone 12 N"</span>,</span>
<span id="cb31-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Land Cover Type"</span></span>
<span id="cb31-22">  )</span>
<span id="cb31-23"></span>
<span id="cb31-24"></span>
<span id="cb31-25">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb31-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb31-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cat_raster <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb31-28">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">project</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WGS84"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bilinear"</span>)</span>
<span id="cb31-29">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb31-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb31-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_princess_c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb31-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb31-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Projected Raster (bilinear)"</span>,</span>
<span id="cb31-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Raster converted into a Continuous Raster.</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Categories are Lost !"</span>,</span>
<span id="cb31-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Value"</span></span>
<span id="cb31-36">  )</span>
<span id="cb31-37"></span>
<span id="cb31-38">g3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb31-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb31-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cat_raster <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb31-41">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">project</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WGS84"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"near"</span>)</span>
<span id="cb31-42">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb31-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb31-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> mypal, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb31-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb31-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Projected Raster (nearest neighbour)"</span>,</span>
<span id="cb31-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Interpolation into Geographic CRS: WGS84.</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">A new category of `NA` is introduced, as expected."</span>,</span>
<span id="cb31-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Land Cover Type"</span></span>
<span id="cb31-49">  )</span>
<span id="cb31-50"></span>
<span id="cb31-51"></span>
<span id="cb31-52">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb31-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(</span>
<span id="cb31-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb31-55">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb31-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb31-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Transforming a categorical raster using the nearest neighbor and bilinear interpolation method."</span>,</span>
<span id="cb31-58">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bilinear interpolation computes averages, and leads the raster to lose all meaning, and convert into a continuous raster. (NA values are in black)."</span>,</span>
<span id="cb31-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_levels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>,</span>
<span id="cb31-60">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_prefix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"("</span>,</span>
<span id="cb31-61">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_suffix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span>,</span>
<span id="cb31-62">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb31-63">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>),</span>
<span id="cb31-64">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>)</span>
<span id="cb31-65">    )</span>
<span id="cb31-66">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb31-67">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb31-68">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb31-69">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.tag =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb31-70">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>, </span>
<span id="cb31-71">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb31-72">    ),</span>
<span id="cb31-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt"</span>),</span>
<span id="cb31-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt"</span>),</span>
<span id="cb31-75">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt"</span>),</span>
<span id="cb31-76">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.box.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt"</span>)</span>
<span id="cb31-77">  )</span>
<span id="cb31-78"></span>
<span id="cb31-79"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb31-80">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb31-81">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter7-ex4.png"</span>),</span>
<span id="cb31-82">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">800</span>,</span>
<span id="cb31-83">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2100</span>,</span>
<span id="cb31-84">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">unit =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb31-85">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb31-86">)</span></code></pre></div>
</details>
</div>
<div id="fig-ex4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ex4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter7-ex4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Figure&nbsp;11: "><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter7-ex4.png" id="fig-ex4" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-ex4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11
</figcaption>
</figure>
</div>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-leaflet" class="csl-entry">
Cheng, Joe, Barret Schloerke, Bhaskar Karambelkar, and Yihui Xie. 2024. <span>“Leaflet: Create Interactive Web Maps with the JavaScript ’Leaflet’ Library.”</span> <a href="https://CRAN.R-project.org/package=leaflet">https://CRAN.R-project.org/package=leaflet</a>.
</div>
<div id="ref-terra-2" class="csl-entry">
Hijmans, Robert J. 2024a. <span>“Terra: Spatial Data Analysis.”</span> <a href="https://CRAN.R-project.org/package=terra">https://CRAN.R-project.org/package=terra</a>.
</div>
<div id="ref-terra-3" class="csl-entry">
———. 2024b. <span>“Terra: Spatial Data Analysis.”</span> <a href="https://CRAN.R-project.org/package=terra">https://CRAN.R-project.org/package=terra</a>.
</div>
<div id="ref-geodata-2" class="csl-entry">
Hijmans, Robert J., Márcia Barbosa, Aniruddha Ghosh, and Alex Mandel. 2024. <span>“Geodata: Download Geographic Data.”</span> <a href="https://CRAN.R-project.org/package=geodata">https://CRAN.R-project.org/package=geodata</a>.
</div>
<div id="ref-sf" class="csl-entry">
Pebesma, Edzer, and Roger Bivand. 2023a. <span>“<span></span>Spatial Data Science: With Applications in r<span></span>.”</span> <a href="https://doi.org/10.1201/9780429459016">https://doi.org/10.1201/9780429459016</a>.
</div>
<div id="ref-stars" class="csl-entry">
———. 2023b. <span>“<span></span>Spatial Data Science: With Applications in r<span></span>,”</span> 352. <a href="https://doi.org/10.1201/9780429459016">https://doi.org/10.1201/9780429459016</a>.
</div>
<div id="ref-crsuggest" class="csl-entry">
Walker, Kyle. 2022. <span>“Crsuggest: Obtain Suggested Coordinate Reference System Information for Spatial Data.”</span> <a href="https://CRAN.R-project.org/package=crsuggest">https://CRAN.R-project.org/package=crsuggest</a>.
</div>
</div></section></div> ]]></description>
  <category>Geocomputation with R</category>
  <category>Textbook Solutions</category>
  <guid>https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter7.html</guid>
  <pubDate>Thu, 09 Jan 2025 18:30:00 GMT</pubDate>
</item>
<item>
  <title>Chapter 6: Raster-vector interactions</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter6.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">6.1 Introduction</h2>
<ul>
<li>Focuses on <strong>interactions</strong> between <a href="https://r-spatial.github.io/raster">raster</a> and <a href="https://r-spatial.github.io/sf/">vector</a> data models, first introduced in <a href="https://r.geocompx.org/">Chapter 2</a>.</li>
<li>Covers three main techniques:
<ul>
<li>Raster cropping and masking using vector objects (<a href="https://r.geocompx.org/">Section 6.2</a>).</li>
<li>Extracting raster values based on vector data (<a href="https://r.geocompx.org/">Section 6.3</a>).</li>
<li>Raster-vector conversions, explained in <a href="https://r.geocompx.org/">Sections 6.4</a> and <a href="https://r.geocompx.org/">6.5</a>.</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sf)        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simple Features in R</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(terra)     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handling rasters in R</span></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyterra) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># For plotting rasters in ggplot2</span></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magrittr)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Using pipes with raster objects</span></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All things tidy; Data Wrangling</span></span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(spData)    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Spatial Datasets</span></span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(patchwork) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composing plots</span></span></code></pre></div>
</details>
</div>
</section>
<section id="raster-cropping" class="level2">
<h2 class="anchored" data-anchor-id="raster-cropping">6.2 Raster Cropping</h2>
<ul>
<li><p>Raster cropping and masking unify spatial extents of data, reduce memory use, and optimize computational resources, especially for <strong>remote sensing rasters</strong> and <strong>vector boundaries</strong> integration.</p></li>
<li><p><strong>Applications</strong>:</p>
<ul>
<li>Crop rasters to fit an area of interest.</li>
<li>Mask values outside specified bounds.</li>
<li>Essential preprocessing for creating maps and analyses.</li>
</ul></li>
<li><p><strong>Projection Alignment</strong>:</p>
<ul>
<li>Rasters and vectors must share the same projection.</li>
<li>Use <code>st_transform()</code> from <strong>sf</strong> for re-projection.</li>
</ul></li>
<li><p><strong>Typical Workflow</strong>: shown in Figure&nbsp;1</p>
<ol type="1">
<li>Crop raster to the area of interest: <code>terra::crop()</code>.</li>
<li>Mask values outside the area: <code>terra::mask()</code>.</li>
<li>Combined operation ensures raster extent fits the area and external values are replaced with <code>NA</code>.</li>
</ol></li>
<li><p><strong><code>terra::crop()</code></strong></p>
<ul>
<li><p><strong>Purpose</strong>: Reduces the extent of a raster object to match a defined area of interest.</p></li>
<li><p><strong>Key Arguments</strong>:</p>
<ul>
<li><strong><code>x</code></strong>: The raster object to be cropped (e.g., a <code>SpatRaster</code>).</li>
<li><strong><code>y</code></strong>: The spatial object (e.g., <code>SpatRaster</code>, <code>sf</code>, or extent) defining the cropping area.</li>
<li><strong><code>snap</code></strong>: Adjusts alignment of the cropped raster to match the target (options: <code>"near"</code>, <code>"out"</code>, <code>"in"</code>).</li>
</ul></li>
<li><p><strong>Output</strong>: A cropped raster limited to the extent defined by <code>y</code>.</p></li>
</ul></li>
<li><p><strong><code>terra::mask()</code></strong></p>
<ul>
<li><p><strong>Purpose</strong>: Sets raster cell values outside the defined spatial object to <code>NA</code> or a specified value.</p></li>
<li><p><strong>Key Arguments</strong>:</p>
<ul>
<li><strong><code>x</code></strong>: The raster object to be masked.</li>
<li><strong><code>mask</code></strong>: The spatial object (e.g., <code>SpatRaster</code>, <code>sf</code>, or extent) defining the masking bounds.</li>
<li><strong><code>inverse</code></strong>: If <code>TRUE</code>, masks values <em>inside</em> the bounds instead of outside.</li>
<li><strong><code>updatevalue</code></strong>: Sets a custom value (e.g., <code>0</code>) for masked areas instead of <code>NA</code>.</li>
</ul></li>
<li><p><strong>Output</strong>: A raster with specified cells masked based on the spatial bounds of the second argument.</p></li>
</ul></li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Aspect</th>
<th><code>crop() |&gt; mask()</code></th>
<th><code>mask()</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Extent Modification</strong></td>
<td>Reduces raster extent to vector’s bounding box</td>
<td>Retains original raster extent</td>
</tr>
<tr class="even">
<td><strong>Output Size</strong></td>
<td>Smaller raster (optimized for memory)</td>
<td>Larger raster (original extent retained)</td>
</tr>
<tr class="odd">
<td><strong>Use Case</strong></td>
<td>When reducing raster size is desired</td>
<td>When full raster extent is needed but irrelevant cells must be excluded</td>
</tr>
</tbody>
</table>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Condensed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>)</span>
<span id="cb2-2">showtext<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(</span>
<span id="cb2-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb2-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb2-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb2-8">  )</span>
<span id="cb2-9">)</span>
<span id="cb2-10"></span>
<span id="cb2-11">theme_custom <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(...){</span>
<span id="cb2-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb2-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb2-14">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb2-15">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb2-16">    ),</span>
<span id="cb2-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb2-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb2-19">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span></span>
<span id="cb2-20">    ),</span>
<span id="cb2-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb2-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb2-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb2-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb2-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb2-26">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb2-27">    ),</span>
<span id="cb2-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb2-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.box.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb2-30">  )</span>
<span id="cb2-31">}</span>
<span id="cb2-32"></span>
<span id="cb2-33">srtm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/srtm.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>))</span>
<span id="cb2-34">zion <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_sf</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"vector/zion.gpkg"</span>, </span>
<span id="cb2-35">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(srtm))</span>
<span id="cb2-37"></span>
<span id="cb2-38">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> srtm) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> zion, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Base Map: Raster and Vector"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_whitebox_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb2-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">113.25</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">112.85</span>),</span>
<span id="cb2-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.14</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.51</span>),</span>
<span id="cb2-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span></span>
<span id="cb2-47">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>()</span>
<span id="cb2-49"></span>
<span id="cb2-50">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> srtm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crop</span>(zion)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> zion, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"terra::crop()"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_whitebox_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-55">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb2-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">113.25</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">112.85</span>),</span>
<span id="cb2-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.14</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.51</span>),</span>
<span id="cb2-58">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span></span>
<span id="cb2-59">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-60">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>()</span>
<span id="cb2-61"></span>
<span id="cb2-62">g3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-63">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> srtm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crop</span>(zion) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mask</span>(zion)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-64">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> zion, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-65">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"crop() |&gt; mask()"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-66">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_whitebox_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-67">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb2-68">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">113.25</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">112.85</span>),</span>
<span id="cb2-69">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.14</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.51</span>),</span>
<span id="cb2-70">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span></span>
<span id="cb2-71">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-72">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>()</span>
<span id="cb2-73"></span>
<span id="cb2-74">g4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-75">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> srtm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mask</span>(zion)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-76">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> zion, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-77">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mask()"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-78">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_whitebox_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-79">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb2-80">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">113.25</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">112.85</span>),</span>
<span id="cb2-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.14</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.51</span>),</span>
<span id="cb2-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span></span>
<span id="cb2-83">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-84">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>()</span>
<span id="cb2-85"></span>
<span id="cb2-86">g5 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-87">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> srtm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mask</span>(zion, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inverse =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-88">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> zion, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-89">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mask(inverse = TRUE)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-90">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_whitebox_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-91">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb2-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">113.25</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">112.85</span>),</span>
<span id="cb2-93">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.14</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.51</span>),</span>
<span id="cb2-94">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span></span>
<span id="cb2-95">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-96">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>()</span>
<span id="cb2-97"></span>
<span id="cb2-98">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g5 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-99">  patchwork<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(</span>
<span id="cb2-100">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-101">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guides =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"collect"</span></span>
<span id="cb2-102">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-103">  patchwork<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb2-104">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cropping and masking rasters with vectors"</span>,</span>
<span id="cb2-105">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb2-106">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb2-107">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb2-108">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>, </span>
<span id="cb2-109">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb2-110">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb2-111">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb2-112">      )</span>
<span id="cb2-113">    )</span>
<span id="cb2-114">  )</span>
<span id="cb2-115"></span>
<span id="cb2-116"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb2-117">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb2-118">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb2-119">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6_2_1.png"</span>),</span>
<span id="cb2-120">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb2-121">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">800</span>,</span>
<span id="cb2-122">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2200</span>,</span>
<span id="cb2-123">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb2-124">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb2-125">)</span></code></pre></div>
</details>
</div>
<div id="fig-6-2-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6-2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter6_2_1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: The workflows and outputs when cropping and masking rasters with vectors."><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter6_2_1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6-2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: The workflows and outputs when cropping and masking rasters with vectors.
</figcaption>
</figure>
</div>
</section>
<section id="raster-extraction" class="level2">
<h2 class="anchored" data-anchor-id="raster-extraction">6.3 Raster Extraction</h2>
<ul>
<li><p>Raster extraction retrieves raster values at specified locations using a geographic selector (typically vector objects like points, lines, or polygons). Uses the <code>terra::extract()</code> function (<a href="https://rspatial.org/terra/"><code>terra</code> package</a>).</p></li>
<li><p><strong>Point Selector</strong>: Extracts raster cell values for specified points. Example: Extracting elevation values for 20 sample points in Zion National Park using <code>st_sample()</code> as shown in Figure&nbsp;2</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Condensed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>)</span>
<span id="cb3-2">showtext<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(</span>
<span id="cb3-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb3-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb3-6">  )</span>
<span id="cb3-7">)</span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Elevation Raster for Zion National Park and nearby areas</span></span>
<span id="cb3-9">srtm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/srtm.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>))</span>
<span id="cb3-10"></span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Zion National Park Boundaries, converted into CRS of `srtm`</span></span>
<span id="cb3-12">zion <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_sf</span>(</span>
<span id="cb3-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(</span>
<span id="cb3-14">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"vector/zion.gpkg"</span>, </span>
<span id="cb3-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span></span>
<span id="cb3-16">    )</span>
<span id="cb3-17">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(srtm))</span>
<span id="cb3-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ----------------------------------------------------------------</span></span>
<span id="cb3-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Basic data display</span></span>
<span id="cb3-21">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> srtm) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb3-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> zion, </span>
<span id="cb3-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, </span>
<span id="cb3-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb3-27">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>(</span>
<span id="cb3-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Elevation (m)"</span>,</span>
<span id="cb3-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">big.mark =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>)</span>
<span id="cb3-31">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb3-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Raw Data"</span>,</span>
<span id="cb3-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Elevation Raster and Zion National Park boundaries"</span></span>
<span id="cb3-36">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb3-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb3-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb3-40">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,</span>
<span id="cb3-41">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb3-42">    ),</span>
<span id="cb3-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb3-44">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb3-45">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb3-46">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span></span>
<span id="cb3-47">    ),</span>
<span id="cb3-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb3-49">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb3-50">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb3-51">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span></span>
<span id="cb3-52">    ),</span>
<span id="cb3-53">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb3-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb3-55">  )</span>
<span id="cb3-56"></span>
<span id="cb3-57"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ----------------------------------------------------------------</span></span>
<span id="cb3-58"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Mask to display only Zion National Park, and</span></span>
<span id="cb3-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display the elevations of randomly selected 20 points</span></span>
<span id="cb3-60"></span>
<span id="cb3-61"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get 20 random points inside Zion National Park</span></span>
<span id="cb3-62"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>)</span>
<span id="cb3-63">random_points <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sample</span>(zion, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-64">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sf</span>()</span>
<span id="cb3-65"></span>
<span id="cb3-66">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-67">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> srtm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mask</span>(zion)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-68">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb3-69">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> zion, </span>
<span id="cb3-70">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, </span>
<span id="cb3-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb3-72">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-73">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb3-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> random_points,</span>
<span id="cb3-75">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb3-76">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb3-77">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span></span>
<span id="cb3-78">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-79">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>(</span>
<span id="cb3-80">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Elevation (m)"</span>,</span>
<span id="cb3-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">big.mark =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>)</span>
<span id="cb3-82">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-83">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-84">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb3-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sampling 20 Random Points"</span>,</span>
<span id="cb3-86">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Getting rndom poitns from sf::st_sample()"</span></span>
<span id="cb3-87">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-88">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb3-89">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb3-90">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb3-91">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,</span>
<span id="cb3-92">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb3-93">    ),</span>
<span id="cb3-94">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb3-95">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb3-96">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb3-97">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span></span>
<span id="cb3-98">    ),</span>
<span id="cb3-99">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb3-100">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb3-101">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb3-102">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span></span>
<span id="cb3-103">    ),</span>
<span id="cb3-104">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb3-105">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb3-106">  )</span>
<span id="cb3-107"></span>
<span id="cb3-108"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># --------------------------------------------------------------</span></span>
<span id="cb3-109"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract heights for these 20 points</span></span>
<span id="cb3-110">random_points <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> random_points <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-111">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-112">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">elevation =</span> terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">extract</span>(srtm, random_points) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(srtm)</span>
<span id="cb3-113">  )</span>
<span id="cb3-114"></span>
<span id="cb3-115">g3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-116">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> srtm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mask</span>(zion)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-117">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb3-118">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> zion, </span>
<span id="cb3-119">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, </span>
<span id="cb3-120">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb3-121">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-122">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb3-123">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> random_points,</span>
<span id="cb3-124">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> elevation),</span>
<span id="cb3-125">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stroke =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb3-126">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb3-127">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb3-128">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb3-129">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-130">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf_text</span>(</span>
<span id="cb3-131">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> random_points,</span>
<span id="cb3-132">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> elevation),</span>
<span id="cb3-133">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb3-134">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb3-135">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb3-136">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb3-137">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb3-138">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_y =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.002</span></span>
<span id="cb3-139">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-140">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>(</span>
<span id="cb3-141">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Elevation (m)"</span>,</span>
<span id="cb3-142">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">big.mark =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>)</span>
<span id="cb3-143">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-144">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_paletteer_c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggthemes::Red"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-145">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-146">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-147">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb3-148">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Extracting elevation on points from rasters"</span>,</span>
<span id="cb3-149">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Using terra::extract() to get elevations on 20 points"</span>,</span>
<span id="cb3-150">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb3-151">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-152">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb3-153">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb3-154">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb3-155">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,</span>
<span id="cb3-156">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb3-157">    ),</span>
<span id="cb3-158">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb3-159">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb3-160">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb3-161">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span></span>
<span id="cb3-162">    ),</span>
<span id="cb3-163">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb3-164">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb3-165">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb3-166">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span></span>
<span id="cb3-167">    ),</span>
<span id="cb3-168">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb3-169">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb3-170">  )</span>
<span id="cb3-171"></span>
<span id="cb3-172">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-173">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(</span>
<span id="cb3-174">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb3-175">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guides =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"collect"</span></span>
<span id="cb3-176">  )</span>
<span id="cb3-177"></span>
<span id="cb3-178"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb3-179">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb3-180">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb3-181">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6_3_1.png"</span>),</span>
<span id="cb3-182">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb3-183">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">600</span>,</span>
<span id="cb3-184">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1500</span>,</span>
<span id="cb3-185">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb3-186">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb3-187">)</span>
<span id="cb3-188"></span>
<span id="cb3-189"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(g, g1, g2, g3)</span></code></pre></div>
</details>
</div>
<div id="fig-6-3-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6-3-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter6_3_1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: Using {sf} and {terra} to get 20 random points in Zion National Park, and displaying their elevation (above sea level, in metres)."><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter6_3_1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6-3-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Using {sf} and {terra} to get 20 random points in Zion National Park, and displaying their elevation (above sea level, in metres).
</figcaption>
</figure>
</div>
<ul>
<li><strong>Line Selector</strong>: Extracts raster values for each cell touched by a line. Recommendation: Split lines into points (using <code>st_segmentize()</code> and <code>st_cast()</code> from <a href="https://r-spatial.github.io/sf/">sf package</a>) for accurate extraction along transects, such as creating elevation profiles for hiking routes, as shown in Figure&nbsp;3</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get Latitude and Longitude of these random points</span></span>
<span id="cb4-2">df1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> random_points <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sfc</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_coordinates</span>(random_points))</span>
<span id="cb4-7"></span>
<span id="cb4-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tibble of northern, sourthern, eastern and western-most points</span></span>
<span id="cb4-9">df2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_rows</span>(</span>
<span id="cb4-10">  df1[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which.min</span>(df1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>X), ] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dir =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"west"</span>),</span>
<span id="cb4-11">  df1[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which.max</span>(df1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>X), ] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dir =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"east"</span>),</span>
<span id="cb4-12">  df1[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which.min</span>(df1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Y), ] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dir =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"south"</span>),</span>
<span id="cb4-13">  df1[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which.max</span>(df1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Y), ] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dir =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"north"</span>),</span>
<span id="cb4-14">)</span>
<span id="cb4-15"></span>
<span id="cb4-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get two paths: east to west, north to south</span></span>
<span id="cb4-17">paths <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_rows</span>(</span>
<span id="cb4-18">  df2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(dir <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"west"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"east"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_union</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_cast</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LINESTRING"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-23">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"West to East"</span>),</span>
<span id="cb4-24"></span>
<span id="cb4-25">  df2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-26">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(dir <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"south"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"north"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-27">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_union</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-28">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_cast</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LINESTRING"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-29">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-30">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"South to North"</span>)</span>
<span id="cb4-31">)</span>
<span id="cb4-32"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(df1, df2)</span>
<span id="cb4-33"></span>
<span id="cb4-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Mid-point Check: Whether the CRS'es match</span></span>
<span id="cb4-35"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(srtm) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(paths)</span>
<span id="cb4-36"></span>
<span id="cb4-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot of the paths</span></span>
<span id="cb4-38">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> srtm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mask</span>(zion)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb4-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> zion, </span>
<span id="cb4-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, </span>
<span id="cb4-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb4-44">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb4-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> paths,</span>
<span id="cb4-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> path),</span>
<span id="cb4-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>))</span>
<span id="cb4-50">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb4-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> random_points,</span>
<span id="cb4-53">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb4-54">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-55">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>(</span>
<span id="cb4-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Elevation (m)"</span>,</span>
<span id="cb4-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">big.mark =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>)</span>
<span id="cb4-58">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-59">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_paletteer_d</span>(</span>
<span id="cb4-60">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nbapalettes::cavaliers_retro"</span></span>
<span id="cb4-61">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-62">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-63">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-64">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb4-65">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Selecting 2 Paths"</span>,</span>
<span id="cb4-66">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sing st_cast() and st_coordinates()"</span>,</span>
<span id="cb4-67">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb4-68">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-69">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb4-70">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-72">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,</span>
<span id="cb4-73">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb4-74">    ),</span>
<span id="cb4-75">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-76">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-77">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-78">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span></span>
<span id="cb4-79">    ),</span>
<span id="cb4-80">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-81">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-82">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-83">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span></span>
<span id="cb4-84">    ),</span>
<span id="cb4-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-86">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb4-87">  )</span>
<span id="cb4-88"></span>
<span id="cb4-89"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A {sf} object of various waypoints along the paths</span></span>
<span id="cb4-90"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># to be able to extract elevation</span></span>
<span id="cb4-91">path_points <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> paths <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-92">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Break into line segments of 100 metres each</span></span>
<span id="cb4-93">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_segmentize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dfMaxLength =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-94">  </span>
<span id="cb4-95">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert each line segment into a central point</span></span>
<span id="cb4-96">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># to be able to extract its elevation</span></span>
<span id="cb4-97">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_cast</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"POINT"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-98">  </span>
<span id="cb4-99">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Group by path to be able to calculate distance</span></span>
<span id="cb4-100">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># along the path</span></span>
<span id="cb4-101">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(path) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-102">  </span>
<span id="cb4-103">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract only the first column (i.e. the distance from</span></span>
<span id="cb4-104">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># first point alone). Otherwise, st_distance() </span></span>
<span id="cb4-105">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># returns a distance matrix As expected, distance grows </span></span>
<span id="cb4-106">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># by approx. less than dfMaxLength amount per points</span></span>
<span id="cb4-107">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_distance</span>(x)[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-108">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>()</span>
<span id="cb4-109"></span>
<span id="cb4-110"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract the actual elevation using terra::extract</span></span>
<span id="cb4-111">path_points <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> path_points <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-112">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb4-113">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">elevation =</span> terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">extract</span>(srtm, path_points) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-114">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(srtm),</span>
<span id="cb4-115">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(dist)</span>
<span id="cb4-116">  )</span>
<span id="cb4-117"></span>
<span id="cb4-118">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> path_points <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-119">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb4-120">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-121">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> dist,</span>
<span id="cb4-122">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> elevation,</span>
<span id="cb4-123">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> path</span>
<span id="cb4-124">    )</span>
<span id="cb4-125">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-126">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(</span>
<span id="cb4-127">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span></span>
<span id="cb4-128">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-129">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(</span>
<span id="cb4-130">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span></span>
<span id="cb4-131">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-132">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>path, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-133">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(</span>
<span id="cb4-134">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_number</span>(</span>
<span id="cb4-135">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.001</span></span>
<span id="cb4-136">    )</span>
<span id="cb4-137">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-138">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(</span>
<span id="cb4-139">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_number</span>(</span>
<span id="cb4-140">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">big.mark =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span></span>
<span id="cb4-141">    )</span>
<span id="cb4-142">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-143">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_paletteer_d</span>(</span>
<span id="cb4-144">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nbapalettes::cavaliers_retro"</span></span>
<span id="cb4-145">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-146">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb4-147">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance along the path (km)"</span>,</span>
<span id="cb4-148">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Elevation (m)"</span>,</span>
<span id="cb4-149">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Elevation Profile along two paths"</span>,</span>
<span id="cb4-150">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Using st_segmentize() &amp; terra::extract()"</span></span>
<span id="cb4-151">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-152">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-153">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb4-154">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-155">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,</span>
<span id="cb4-156">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb4-157">    ),</span>
<span id="cb4-158">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-159">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-160">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-161">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span></span>
<span id="cb4-162">    ),</span>
<span id="cb4-163">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-164">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-165">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-166">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span></span>
<span id="cb4-167">    ),</span>
<span id="cb4-168">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-169">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-170">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-171">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb4-172">    )</span>
<span id="cb4-173">  )</span>
<span id="cb4-174"></span>
<span id="cb4-175">my_design <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ABB"</span></span>
<span id="cb4-176"></span>
<span id="cb4-177">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wrap_plots</span>(g1, g2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-178">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">design =</span> my_design, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guides =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"collect"</span>) </span>
<span id="cb4-179"></span>
<span id="cb4-180"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb4-181">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb4-182">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb4-183">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6_3_2.png"</span>),</span>
<span id="cb4-184">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb4-185">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">600</span>,</span>
<span id="cb4-186">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1500</span>,</span>
<span id="cb4-187">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb4-188">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb4-189">)</span>
<span id="cb4-190"></span>
<span id="cb4-191"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(g, g1, g2, paths, path_points)</span></code></pre></div>
</details>
</div>
<div id="fig-6-3-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6-3-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter6_3_2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;3: Creating elevation profiles along routes using st_segmentize() and terra::extract() from Northern most to Southernmost point; and from Westernmost to Easternmost point (amongst the 20 random points generated)."><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter6_3_2.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6-3-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Creating elevation profiles along routes using st_segmentize() and terra::extract() from Northern most to Southernmost point; and from Westernmost to Easternmost point (amongst the 20 random points generated).
</figcaption>
</figure>
</div>
<ul>
<li><strong>Polygon Selector</strong>: Extracts multiple raster values per polygon. Example: Summarizing elevation statistics (min, mean, max) for Zion National Park polygons using <code>group_by()</code> and <code>summarize()</code> from <a href="https://dplyr.tidyverse.org/">dplyr</a> as shown in Figure&nbsp;4</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Creating circles around the 20 random points</span></span>
<span id="cb5-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Each circle of 1.5 km radius</span></span>
<span id="cb5-3">circles <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> random_points <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_buffer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1500</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ID =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>())</span>
<span id="cb5-6"></span>
<span id="cb5-7"></span>
<span id="cb5-8">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> srtm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mask</span>(zion)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb5-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> zion, </span>
<span id="cb5-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, </span>
<span id="cb5-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb5-14">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb5-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> circles, </span>
<span id="cb5-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>)</span>
<span id="cb5-18">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>(</span>
<span id="cb5-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Elevation (m)"</span>,</span>
<span id="cb5-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">big.mark =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>)</span>
<span id="cb5-22">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb5-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Circles of 3 km diameter"</span>,</span>
<span id="cb5-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Around 20 random points with st_buffer()"</span>,</span>
<span id="cb5-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb5-29">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb5-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-33">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,</span>
<span id="cb5-34">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb5-35">    ),</span>
<span id="cb5-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-37">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-38">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-39">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span></span>
<span id="cb5-40">    ),</span>
<span id="cb5-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-42">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-43">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-44">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span></span>
<span id="cb5-45">    ),</span>
<span id="cb5-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb5-48">  )</span>
<span id="cb5-49"></span>
<span id="cb5-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A custom function for rounded off mean</span></span>
<span id="cb5-51">mean_r <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x){<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(x), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)}</span>
<span id="cb5-52"></span>
<span id="cb5-53"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Getting minimum, mean and maximum height for each area</span></span>
<span id="cb5-54">circles <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> circles <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-55">  </span>
<span id="cb5-56">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add minimum maximum and mean heights for each circle</span></span>
<span id="cb5-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(</span>
<span id="cb5-58">    terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">extract</span>(srtm, circles) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-59">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-60">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Grouping by each polygon / circle</span></span>
<span id="cb5-61">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(ID) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-62">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(srtm, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> min, </span>
<span id="cb5-63">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> mean_r, </span>
<span id="cb5-64">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> max)))</span>
<span id="cb5-65">  )</span>
<span id="cb5-66"></span>
<span id="cb5-67">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-68">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> srtm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mask</span>(zion)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-69">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb5-70">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> zion, </span>
<span id="cb5-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, </span>
<span id="cb5-72">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb5-73">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-74">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb5-75">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> circles, </span>
<span id="cb5-76">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb5-77">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-78">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf_text</span>(</span>
<span id="cb5-79">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> circles,</span>
<span id="cb5-80">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb5-81">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb5-82">        srtm_max, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, srtm_min</span>
<span id="cb5-83">      )</span>
<span id="cb5-84">    ),</span>
<span id="cb5-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb5-86">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb5-87">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>,</span>
<span id="cb5-88">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">check_overlap =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb5-89">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-90">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>(</span>
<span id="cb5-91">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Elevation (m)"</span>,</span>
<span id="cb5-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">big.mark =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>)</span>
<span id="cb5-93">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-94">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-95">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-96">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb5-97">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Maximum and Minimum elevations for each circle"</span>,</span>
<span id="cb5-98">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Using st_buffer(), terra::extract() and dplyr::summarize()"</span>,</span>
<span id="cb5-99">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb5-100">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-101">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb5-102">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-103">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-104">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,</span>
<span id="cb5-105">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb5-106">    ),</span>
<span id="cb5-107">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-108">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-109">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-110">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span></span>
<span id="cb5-111">    ),</span>
<span id="cb5-112">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-113">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-114">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-115">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span></span>
<span id="cb5-116">    ),</span>
<span id="cb5-117">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-118">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb5-119">  )</span>
<span id="cb5-120"></span>
<span id="cb5-121">g3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-122">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> srtm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mask</span>(zion)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-123">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb5-124">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> zion, </span>
<span id="cb5-125">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, </span>
<span id="cb5-126">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb5-127">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-128">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb5-129">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> circles, </span>
<span id="cb5-130">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb5-131">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-132">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf_text</span>(</span>
<span id="cb5-133">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> circles,</span>
<span id="cb5-134">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb5-135">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">number</span>(srtm_mean, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">big.mark =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" m"</span>)</span>
<span id="cb5-136">    ),</span>
<span id="cb5-137">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb5-138">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb5-139">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb5-140">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">check_overlap =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb5-141">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-142">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>(</span>
<span id="cb5-143">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Elevation (m)"</span>,</span>
<span id="cb5-144">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">big.mark =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>)</span>
<span id="cb5-145">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-146">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-147">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-148">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb5-149">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Average elevation for each circle"</span>,</span>
<span id="cb5-150">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Using summarise()"</span>,</span>
<span id="cb5-151">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb5-152">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-153">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb5-154">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-155">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-156">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,</span>
<span id="cb5-157">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb5-158">    ),</span>
<span id="cb5-159">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-160">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-161">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-162">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span></span>
<span id="cb5-163">    ),</span>
<span id="cb5-164">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-165">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-166">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-167">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span></span>
<span id="cb5-168">    ),</span>
<span id="cb5-169">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-170">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb5-171">  )</span>
<span id="cb5-172"></span>
<span id="cb5-173">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-174">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(</span>
<span id="cb5-175">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guides =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"collect"</span></span>
<span id="cb5-176">  )</span>
<span id="cb5-177"></span>
<span id="cb5-178"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb5-179">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb5-180">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb5-181">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6_3_3.png"</span>),</span>
<span id="cb5-182">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb5-183">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">600</span>,</span>
<span id="cb5-184">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1500</span>,</span>
<span id="cb5-185">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb5-186">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb5-187">)</span></code></pre></div>
</details>
</div>
<div id="fig-6-3-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6-3-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter6_3_3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;4: Computing average elevation, minimum and maximum elevations within specified areas, like polygons, or in this case circles of diameter 3 km each around the 20 random points."><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter6_3_3.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6-3-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Computing average elevation, minimum and maximum elevations within specified areas, like polygons, or in this case circles of diameter 3 km each around the 20 random points.
</figcaption>
</figure>
</div>
<ul>
<li><strong>Categorical Raster Extraction</strong>: Counts occurrences of raster categories (e.g., land cover) within polygons. Example: Analyzing land cover types in Zion National Park using <code>terra::extract()</code> as shown in Figure&nbsp;5</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">nlcd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/nlcd.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>))</span>
<span id="cb6-2"></span>
<span id="cb6-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get Zion Park Boundary transformed into CRS of NLCD Raster</span></span>
<span id="cb6-4">zion <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> zion <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(nlcd))</span>
<span id="cb6-5"></span>
<span id="cb6-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get polygons (circles) transformed into CRS of NLCD Raster</span></span>
<span id="cb6-7">circles1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> circles <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(ID) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(nlcd))</span>
<span id="cb6-10"></span>
<span id="cb6-11">cat_circles <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">extract</span>(nlcd, circles1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(ID) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(levels) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perc =</span> n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(n))</span>
<span id="cb6-16"></span>
<span id="cb6-17">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> nlcd <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mask</span>(zion)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb6-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> zion, </span>
<span id="cb6-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, </span>
<span id="cb6-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb6-23">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb6-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> circles, </span>
<span id="cb6-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>)</span>
<span id="cb6-27">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf_text</span>(</span>
<span id="cb6-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> circles, </span>
<span id="cb6-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> ID),</span>
<span id="cb6-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb6-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb6-33">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-34">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_d</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MoMAColors::VanGogh"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb6-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Circles of 3 km diameter"</span>,</span>
<span id="cb6-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Around 20 random points with st_buffer()"</span>,</span>
<span id="cb6-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb6-41">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb6-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb6-44">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,</span>
<span id="cb6-45">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb6-46">    ),</span>
<span id="cb6-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb6-48">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb6-49">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb6-50">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span></span>
<span id="cb6-51">    ),</span>
<span id="cb6-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb6-53">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb6-54">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb6-55">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span></span>
<span id="cb6-56">    ),</span>
<span id="cb6-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb6-58">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb6-59">  )</span>
<span id="cb6-60"></span>
<span id="cb6-61">g4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> cat_circles <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-62">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> levels)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-63">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>(</span>
<span id="cb6-64">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">position_stack</span>(),</span>
<span id="cb6-65">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>,</span>
<span id="cb6-66">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span></span>
<span id="cb6-67">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-68">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ID) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-69">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_polar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theta =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-70">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>(</span>
<span id="cb6-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb6-72">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-73">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb6-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb6-75">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Land Cover Pie charts for 20 zones"</span>,</span>
<span id="cb6-76">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Each zone of diameter 3 km, identified by an ID"</span></span>
<span id="cb6-77">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-78">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_d</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MoMAColors::VanGogh"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-79">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb6-80">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb6-81">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb6-82">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb6-83">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span></span>
<span id="cb6-84">    ),</span>
<span id="cb6-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb6-86">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb6-87">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb6-88">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span></span>
<span id="cb6-89">    ),</span>
<span id="cb6-90">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb6-91">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb6-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb6-93">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb6-94">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span></span>
<span id="cb6-95">    ),</span>
<span id="cb6-96">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb6-97">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.box.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb6-98">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb6-99">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>,</span>
<span id="cb6-100">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb6-101">    )</span>
<span id="cb6-102">  )</span>
<span id="cb6-103"></span>
<span id="cb6-104">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-105">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(</span>
<span id="cb6-106">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">design =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ABB"</span></span>
<span id="cb6-107">  )</span>
<span id="cb6-108"></span>
<span id="cb6-109"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb6-110">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb6-111">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb6-112">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6_3_4.png"</span>),</span>
<span id="cb6-113">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb6-114">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">600</span>,</span>
<span id="cb6-115">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1500</span>,</span>
<span id="cb6-116">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb6-117">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb6-118">)</span></code></pre></div>
</details>
</div>
<div id="fig-6-3-4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6-3-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter6_3_4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;5: Computing pie charts of different land use types in circles of diameter 3 km around the 20 random points, and using st_transform() for rasters and vectors while performing raster extraction."><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter6_3_4.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6-3-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Computing pie charts of different land use types in circles of diameter 3 km around the 20 random points, and using st_transform() for rasters and vectors while performing raster extraction.
</figcaption>
</figure>
</div>
<p>Combining the work done in this section to produce a composite graphic shown in Figure&nbsp;6 for publishing a code demonstration</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magick)</span>
<span id="cb7-2"></span>
<span id="cb7-3">i1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>,</span>
<span id="cb7-4">                            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6_3_1.png"</span>))</span>
<span id="cb7-5">i2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>,</span>
<span id="cb7-6">                            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6_3_2.png"</span>))</span>
<span id="cb7-7">i3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>,</span>
<span id="cb7-8">                            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6_3_3.png"</span>))</span>
<span id="cb7-9">i4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>,</span>
<span id="cb7-10">                            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6_3_4.png"</span>))</span>
<span id="cb7-11"></span>
<span id="cb7-12"></span>
<span id="cb7-13">c_imgs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(i1, i2, i3, i4)</span>
<span id="cb7-14"></span>
<span id="cb7-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_append</span>(</span>
<span id="cb7-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_scale</span>(c_imgs, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1500x"</span>),</span>
<span id="cb7-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stack =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb7-18">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_write</span>(</span>
<span id="cb7-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>,</span>
<span id="cb7-21">                            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6_3_5.png"</span>)</span>
<span id="cb7-22">  )</span></code></pre></div>
</details>
</div>
<div id="fig-6-3-5" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6-3-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter6_3_5.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;6: A composite image of all the work done: extracting raster values from vector points with {terra} and {sf} for points (locations), linestrings (along journey paths) and within polygons (areas) and compiling results with {magick}"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter6_3_5.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="750"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6-3-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: A composite image of all the work done: extracting raster values from vector points with {terra} and {sf} for points (locations), linestrings (along journey paths) and within polygons (areas) and compiling results with {magick}
</figcaption>
</figure>
</div>
<ul>
<li><p>Further details: —</p>
<ul>
<li><p><code>exactextractr::exact_extract()</code> (<a href="https://github.com/isciences/exactextractr">exactextractr package</a>):</p>
<ul>
<li>Faster than <code>terra::extract()</code> for large datasets.</li>
<li>Computes precise polygon overlap fractions for weighted statistics.</li>
</ul></li>
<li><p><code>terra::extract(exact = TRUE)</code> adds a <code>fraction</code> column for detailed overlap calculations. Useful for weighted means or precise coverage estimates but computationally intensive.</p></li>
</ul></li>
</ul>
</section>
<section id="rasterization" class="level2">
<h2 class="anchored" data-anchor-id="rasterization">6.4 Rasterization</h2>
<ul>
<li><p>Rasterization converts vector objects into raster format, often for analysis (e.g., terrain) or modeling. It simplifies data by standardizing spatial resolution, serving as geographic data aggregation.</p></li>
<li><p><strong>Key Function</strong>: <a href="https://rspatial.github.io/terra/reference/rasterize.html"><code>rasterize()</code></a> in the <code>{terra}</code> package handles rasterization.</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>terra::rasterize()</code>: <strong>Converts vector data into raster format by transferring values from vector geometries to raster cells.</strong></p>
<p><strong>Key Arguments</strong>:</p>
<ol type="1">
<li><strong><code>x</code></strong>: Input vector data: A <code>SpatVector</code> or a two-column matrix (coordinates for points). Defines the geometries to be rasterized.</li>
<li><strong><code>y</code></strong>: <strong>Template raster</strong>: A <code>SpatRaster</code> that determines the extent, resolution, and CRS of the output raster.</li>
<li><strong><code>field</code></strong>: Specifies the values to transfer to raster:
<ul>
<li>As a <strong>character</strong>: Variable name from <code>x</code> (e.g., a column in the vector dataset).</li>
<li>As a <strong>numeric</strong>: Direct values or indices recycled to match <code>nrow(x)</code>.</li>
</ul></li>
<li><strong><code>values</code></strong> (for matrix input <code>x</code>): Numeric values used for rasterization, recycled if fewer than <code>nrow(x)</code>. Can also be a matrix or data frame.</li>
<li><strong><code>fun</code></strong>: Summarizing function for overlapping geometries in a cell:
<ul>
<li>For <strong>lines and polygons</strong>: “<code>min</code>”, “<code>max</code>”, “<code>mean</code>”, “<code>count</code>”, “<code>sum</code>”.</li>
<li>For <strong>points</strong>: Any function returning a single value (e.g., <code>mean</code>, <code>length</code>, <code>min</code>). The <code>fun = "length"</code> means a count of the number of points in that cell.</li>
</ul></li>
<li><strong><code>background</code></strong>: Default cell value for areas not covered by any features in <code>x</code>. Default: <code>NA</code>.</li>
<li><strong><code>touches</code></strong>: <strong>Logical</strong>: If <code>TRUE</code>, includes all cells touched by a feature (lines/polygons), not just those where centroids fall.</li>
<li><strong><code>update</code></strong>: <strong>Logical</strong>: If <code>TRUE</code>, updates existing values in the template raster.</li>
<li><strong><code>cover</code></strong>: <strong>Logical</strong>: For polygons, returns the fraction of a cell covered by a feature. Uses sub-cell presence/absence checks.</li>
<li><strong><code>by</code></strong>: Groups vector data into layers:
<ul>
<li>For <code>SpatVector</code>: Column name or index.</li>
<li>For matrices: Vector defining group membership.</li>
</ul></li>
</ol>
<hr>
<ul>
<li><strong>Default Behaviour of <code>rasterize()</code></strong>:
<ul>
<li>If no <code>fun</code> is specified, the last value is used in case of overlaps (<code>fun = "last"</code>).</li>
<li>When <code>field</code> is empty, raster cells reflect presence/absence of geometries.</li>
</ul></li>
</ul>
<p><strong>Common Use Cases</strong>:</p>
<ol type="1">
<li>Presence/absence rasters: Determine where features exist.</li>
<li>Summary statistics: Aggregate multiple values in a single cell (e.g., <code>sum</code>, <code>mean</code>).</li>
<li>Fractional coverage: Estimate the proportion of a raster cell covered by polygons.</li>
</ol>
</div>
</div>
<ul>
<li><p><strong>Resolution Considerations</strong>:</p>
<ul>
<li>Low resolution (large cells): Misses geographic variability.</li>
<li>High resolution (small cells): Increases computation time.</li>
<li>Resolution choice depends on intended use or alignment with other rasters.</li>
</ul></li>
<li><p><strong>Flexibility</strong>: Rasterization varies by:</p>
<ol type="1">
<li>Template raster properties (extent, resolution, CRS).</li>
<li>Input vector type (points, polygons).</li>
<li>Function arguments (e.g., <code>fun</code>, <code>field</code>).</li>
</ol></li>
<li><p><strong>Points Rasterization:</strong> can be done in three further methods depicted in Figure&nbsp;7: —</p>
<ol type="1">
<li><strong>Presence/Absence Raster</strong>:
<ul>
<li>Raster indicates whether cells contain cycle hire points.</li>
</ul></li>
<li><strong>Count Raster</strong>:
<ul>
<li>Uses <code>fun = "length"</code> to count cycle hire points per grid cell.</li>
</ul></li>
<li><strong>Summary Statistic Raster</strong>:
<ul>
<li>Calculates sum of a variable (e.g., <code>capacity</code>) using <code>field</code> and <code>fun = sum</code>.</li>
</ul></li>
</ol></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Condensed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>)</span>
<span id="cb8-2">showtext<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb8-3"></span>
<span id="cb8-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(</span>
<span id="cb8-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb8-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb8-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span></span>
<span id="cb8-8">  )</span>
<span id="cb8-9">)</span>
<span id="cb8-10"></span>
<span id="cb8-11">theme_custom <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(...){</span>
<span id="cb8-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb8-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.height =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb8-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb8-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb8-16">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb8-17">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb8-18">    ),</span>
<span id="cb8-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb8-20">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>,</span>
<span id="cb8-21">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb8-22">    ),</span>
<span id="cb8-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb8-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb8-25">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb8-26">    ),</span>
<span id="cb8-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>),</span>
<span id="cb8-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb8-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>,</span>
<span id="cb8-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)),</span>
<span id="cb8-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)),</span>
<span id="cb8-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb8-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.box.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb8-34">  )</span>
<span id="cb8-35">}</span>
<span id="cb8-36"></span>
<span id="cb8-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get cycle hiring points data for London</span></span>
<span id="cb8-38">cycles <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> spData<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>cycle_hire_osm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-39">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Transform into CRS of EPSG:27700 - British National Grid</span></span>
<span id="cb8-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:27700"</span>)</span>
<span id="cb8-41"></span>
<span id="cb8-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a template raster for using in rasterization</span></span>
<span id="cb8-43">template_raster <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(</span>
<span id="cb8-44">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Spat Extent of the Vector data</span></span>
<span id="cb8-45">  terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ext</span>(cycles),</span>
<span id="cb8-46">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Required resolution of the raster</span></span>
<span id="cb8-47">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resolution =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>,</span>
<span id="cb8-48">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># CRS for the raster</span></span>
<span id="cb8-49">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crs</span>(cycles)</span>
<span id="cb8-50">)</span>
<span id="cb8-51"></span>
<span id="cb8-52">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb8-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cycles,</span>
<span id="cb8-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb8-56">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> capacity</span>
<span id="cb8-57">    ),</span>
<span id="cb8-58">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>,</span>
<span id="cb8-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb8-60">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.001</span></span>
<span id="cb8-61">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-62">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb8-63">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggthemes::Red"</span>,</span>
<span id="cb8-64">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb8-65">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-66">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb8-67">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cycle Hire Points (London)"</span>,</span>
<span id="cb8-68">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OSM Vector data, plotted with {sf}"</span></span>
<span id="cb8-69">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-70">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>()</span>
<span id="cb8-71"></span>
<span id="cb8-72">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-73">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb8-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cycles <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rasterize</span>(template_raster)</span>
<span id="cb8-75">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-76">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb8-77">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggthemes::Red"</span>,</span>
<span id="cb8-78">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>,</span>
<span id="cb8-79">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hiring points present?"</span></span>
<span id="cb8-80">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-81">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb8-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Presence / Absence Raster"</span>,</span>
<span id="cb8-83">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Default rasterize(); i.e. (fun = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">last</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">)"</span></span>
<span id="cb8-84">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-85">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>()</span>
<span id="cb8-86"></span>
<span id="cb8-87">g3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-88">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb8-89">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cycles <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rasterize</span>(template_raster,</span>
<span id="cb8-90">                                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"length"</span>)</span>
<span id="cb8-91">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-92">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb8-93">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggthemes::Red"</span>,</span>
<span id="cb8-94">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>,</span>
<span id="cb8-95">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb8-96">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of hiring points"</span></span>
<span id="cb8-97">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-98">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb8-99">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Count raster (vector points per cell)"</span>,</span>
<span id="cb8-100">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rasterize(fun = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">length</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">)"</span></span>
<span id="cb8-101">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-102">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>()</span>
<span id="cb8-103"></span>
<span id="cb8-104">g4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-105">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb8-106">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cycles <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rasterize</span>(</span>
<span id="cb8-107">      template_raster,</span>
<span id="cb8-108">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">field =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"capacity"</span>,</span>
<span id="cb8-109">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sum"</span>)</span>
<span id="cb8-110">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-111">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb8-112">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggthemes::Red"</span>,</span>
<span id="cb8-113">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>,</span>
<span id="cb8-114">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cycles Capacity"</span></span>
<span id="cb8-115">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-116">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb8-117">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Summary Statistic raster"</span>,</span>
<span id="cb8-118">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rasterize(field = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">capacity</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">, fun = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">length</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">)"</span></span>
<span id="cb8-119">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-120">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>()</span>
<span id="cb8-121"></span>
<span id="cb8-122">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-123">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-124">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb8-125">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_levels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>,</span>
<span id="cb8-126">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Vectorizing rasters into points - 3 types"</span>,</span>
<span id="cb8-127">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb8-128">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb8-129">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">48</span>,</span>
<span id="cb8-130">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb8-131">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb8-132">      )</span>
<span id="cb8-133">    )</span>
<span id="cb8-134">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb8-135">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb8-136">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.tag =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb8-137">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb8-138">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb8-139">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb8-140">    )</span>
<span id="cb8-141">  )</span>
<span id="cb8-142"></span>
<span id="cb8-143"></span>
<span id="cb8-144"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb8-145">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb8-146">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb8-147">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6_4_1.png"</span>),</span>
<span id="cb8-148">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb8-149">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">700</span>,</span>
<span id="cb8-150">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2200</span>,</span>
<span id="cb8-151">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb8-152">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb8-153">)</span></code></pre></div>
</details>
</div>
<div id="fig-6-4-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6-4-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter6_4_1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;7: Rasterizing points geometry of {sf} with terra::rasterize() with three methods. (a) Base vector object, (b) Presence-Absence Raster, (c) Count Raster - number of objects per cell, and, (d) Summary Statistic Raster - a summary statistic calculated for each cell, using a field (of sf object) and function."><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter6_4_1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6-4-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Rasterizing points geometry of {sf} with <code>terra::rasterize()</code> with three methods. (a) Base vector object, (b) Presence-Absence Raster, (c) Count Raster - number of objects per cell, and, (d) Summary Statistic Raster - a summary statistic calculated for each cell, using a field (of sf object) and function.
</figcaption>
</figure>
</div>
<ul>
<li><p><strong>Line and Polygon Rasterization</strong> is shown in Figure&nbsp;8. The polygon rasterization can proceed in two ways, depending on the argument <code>touches = TRUE / FALSE</code> as shown in Figure&nbsp;8 .</p>
<ul>
<li><code>touches = TRUE</code>: Includes all cells touched by lines/polygons.</li>
<li>Default (<code>touches = FALSE</code>): Selects cells where centroids fall inside polygons.</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Condensed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>)</span>
<span id="cb9-2">showtext<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb9-3"></span>
<span id="cb9-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(</span>
<span id="cb9-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb9-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb9-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span></span>
<span id="cb9-8">  )</span>
<span id="cb9-9">)</span>
<span id="cb9-10"></span>
<span id="cb9-11">theme_custom <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(...){</span>
<span id="cb9-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb9-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.height =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb9-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb9-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb9-16">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb9-17">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb9-18">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb9-19">    ),</span>
<span id="cb9-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb9-21">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>,</span>
<span id="cb9-22">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb9-23">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb9-24">    ),</span>
<span id="cb9-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb9-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb9-27">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb9-28">    ),</span>
<span id="cb9-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>),</span>
<span id="cb9-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span></span>
<span id="cb9-31">  )</span>
<span id="cb9-32">}</span>
<span id="cb9-33"></span>
<span id="cb9-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#----------------------------------------------------------------</span></span>
<span id="cb9-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get vector data on State of California from `us_states` data</span></span>
<span id="cb9-36">california <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(NAME <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"California"</span>)</span>
<span id="cb9-38"></span>
<span id="cb9-39">california_border <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> california <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_cast</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MULTILINESTRING"</span>)</span>
<span id="cb9-41"></span>
<span id="cb9-42">template_raster <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(</span>
<span id="cb9-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ext</span>(california),</span>
<span id="cb9-44">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(california)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>wkt, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use crs(california) or st_crs(california)$wkt</span></span>
<span id="cb9-45">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resolution =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Give resolution in degrees</span></span>
<span id="cb9-46">)</span>
<span id="cb9-47"></span>
<span id="cb9-48"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crs</span>(california)</span>
<span id="cb9-49"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(california)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>wkt</span>
<span id="cb9-50"></span>
<span id="cb9-51">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> california) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"California Map (vector)</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">plotted with {sf}"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>()</span>
<span id="cb9-55"></span>
<span id="cb9-56">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb9-58">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> california_border <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rasterize</span>(template_raster)</span>
<span id="cb9-59">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-60">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb9-61">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggthemes::Classic Red"</span>,</span>
<span id="cb9-62">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb9-63">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-64">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Multi-Linestring</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">with terra::rasterize()"</span>,</span>
<span id="cb9-65">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cells touched by Linestring are coloured"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-66">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>()</span>
<span id="cb9-67"></span>
<span id="cb9-68">g3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-69">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb9-70">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> california <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rasterize</span>(template_raster,</span>
<span id="cb9-71">                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">touches =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb9-72">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-73">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb9-74">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggthemes::Classic Red"</span>,</span>
<span id="cb9-75">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb9-76">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-77">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Multipolygon</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">terra::rasterize(touches = FALSE)"</span>,</span>
<span id="cb9-78">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Only colours raster cells whose</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">centroids are inside multi-polygon"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-79">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>()</span>
<span id="cb9-80"></span>
<span id="cb9-81">g4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-82">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb9-83">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> california <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rasterize</span>(template_raster,</span>
<span id="cb9-84">                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">touches =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb9-85">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-86">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb9-87">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggthemes::Classic Red"</span>,</span>
<span id="cb9-88">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb9-89">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-90">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Multipolygon</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">terra::rasterize(touches = TRUE)"</span>,</span>
<span id="cb9-91">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Colours all raster cells which</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">are touched by the multi-polygon"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-92">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>()</span>
<span id="cb9-93"></span>
<span id="cb9-94">rast1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> california <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rasterize</span>(</span>
<span id="cb9-95">  template_raster,</span>
<span id="cb9-96">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">touches =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb9-97">  )</span>
<span id="cb9-98"></span>
<span id="cb9-99">rast2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> california_border <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-100">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rasterize</span>(</span>
<span id="cb9-101">    (rast1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>),</span>
<span id="cb9-102">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">update =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb9-103">  )</span>
<span id="cb9-104"></span>
<span id="cb9-105">g5 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-106">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb9-107">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> rast2</span>
<span id="cb9-108">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-109">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb9-110">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggthemes::Classic Red"</span>,</span>
<span id="cb9-111">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb9-112">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-113">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Polygon &amp; Linestring</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">terra::rasterize(update = TRUE)"</span>,</span>
<span id="cb9-114">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rasterized polygon updated with a rasterized linestring"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-115">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>()</span>
<span id="cb9-116"></span>
<span id="cb9-117"></span>
<span id="cb9-118">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g5 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-119">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guides =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"collect"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-120">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb9-121">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_levels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>,</span>
<span id="cb9-122">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Techniques for Rasterizing lines and polygons with {terra}"</span>,</span>
<span id="cb9-123">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb9-124">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb9-125">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">48</span>,</span>
<span id="cb9-126">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb9-127">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb9-128">      )</span>
<span id="cb9-129">    )</span>
<span id="cb9-130">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb9-131">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb9-132">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.tag =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb9-133">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb9-134">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb9-135">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb9-136">    ),</span>
<span id="cb9-137">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb9-138">  )</span>
<span id="cb9-139"></span>
<span id="cb9-140"></span>
<span id="cb9-141"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb9-142">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb9-143">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb9-144">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6_4_2.png"</span>),</span>
<span id="cb9-145">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb9-146">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">700</span>,</span>
<span id="cb9-147">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2200</span>,</span>
<span id="cb9-148">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb9-149">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb9-150">)</span></code></pre></div>
</details>
</div>
<div id="fig-6-4-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6-4-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter6_4_2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;8: Rasterizing Multi-Linestrings and Multi-Polygons from {sf} using terra::rasterize(). The figure show: (a) The base vector map of California, (b) Rasterization of California’s borders (LINESTRING) generated from map using sf::st_cast(), (c) A multi-polygon (map of California) rasterized using terra::rasterize(touches = FALSE) colours only the cells whose centroids fall within the multi-polygon, (d) Using terra::rasterize(touches = TRUE) colours all cells which are touched by the multi-polygon, and, (e) Using terra::rasterize(update = TRUE) to compile and update a previous raster of multi-polygon (values halved to maintain colour levels) with a border multi-linestring."><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter6_4_2.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6-4-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Rasterizing Multi-Linestrings and Multi-Polygons from <code>{sf}</code> using <code>terra::rasterize()</code>. The figure show: (a) The base vector map of California, (b) Rasterization of California’s borders (LINESTRING) generated from map using <code>sf::st_cast()</code>, (c) A multi-polygon (map of California) rasterized using <code>terra::rasterize(touches = FALSE)</code> colours only the cells whose centroids fall within the multi-polygon, (d) Using <code>terra::rasterize(touches = TRUE)</code> colours all cells which are touched by the multi-polygon, and, (e) Using <code>terra::rasterize(update = TRUE)</code> to compile and update a previous raster of multi-polygon (values halved to maintain colour levels) with a border multi-linestring.
</figcaption>
</figure>
</div>
</section>
<section id="spatial-vectorization" class="level2">
<h2 class="anchored" data-anchor-id="spatial-vectorization">6.5 Spatial Vectorization</h2>
<ul>
<li>Converts raster data (spatially continuous) into vector data (spatially discrete: points, lines, polygons). Opposite process of rasterization. It can be of three types – (1) points, (2) lines, and (3) polygons.</li>
<li><strong>(1) Points from Raster Centroids</strong>:
<ul>
<li>Use <code>terra::as.points()</code> <span class="citation" data-cites="terra">(Hijmans 2024)</span> for converting raster cells (non-NA) to points. It produces a <code>SpatVector</code> class of object, which can then be converted into an {sf} <span class="citation" data-cites="sf-4">(Pebesma and Bivand 2023)</span> object using <code>sf::st_as_sf()</code> .</li>
<li>Example: Elevation raster visualized as points in Figure&nbsp;9.</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">theme_custom <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(...){</span>
<span id="cb10-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb10-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.height =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb10-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb10-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb10-6">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb10-7">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb10-8">    ),</span>
<span id="cb10-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb10-10">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>,</span>
<span id="cb10-11">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb10-12">    ),</span>
<span id="cb10-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb10-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb10-15">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb10-16">    ),</span>
<span id="cb10-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>),</span>
<span id="cb10-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb10-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>,</span>
<span id="cb10-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)),</span>
<span id="cb10-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)),</span>
<span id="cb10-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb10-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.box.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb10-24">    ...</span>
<span id="cb10-25">  )</span>
<span id="cb10-26">}</span>
<span id="cb10-27"></span>
<span id="cb10-28">elev <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/elev.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spData"</span>))</span>
<span id="cb10-29"></span>
<span id="cb10-30">g10 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_princess_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb10-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Base raster"</span>,</span>
<span id="cb10-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Class SpatRaster (elev)"</span>,</span>
<span id="cb10-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb10-37">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>()</span>
<span id="cb10-39"></span>
<span id="cb10-40">g11 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb10-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.points</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>(),</span>
<span id="cb10-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb10-44">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_princess_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb10-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Vectorization without raster values"</span>,</span>
<span id="cb10-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Using terra::as.points(values = FALSE)"</span>,</span>
<span id="cb10-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb10-50">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>()</span>
<span id="cb10-52"></span>
<span id="cb10-53">g12 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb10-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.points</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>(),</span>
<span id="cb10-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> elev),</span>
<span id="cb10-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb10-58">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_princess_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-60">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb10-61">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Vectorization, retaining values as attributes"</span>,</span>
<span id="cb10-62">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Using terra::as.points() [default behaviour]"</span>,</span>
<span id="cb10-63">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb10-64">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-65">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>()</span>
<span id="cb10-66"></span>
<span id="cb10-67"></span>
<span id="cb10-68">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g10 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g11 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g12 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-69">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-70">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb10-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_levels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>,</span>
<span id="cb10-72">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Vectorizing rasters into points, with or without values"</span>,</span>
<span id="cb10-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb10-74">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb10-75">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">48</span>,</span>
<span id="cb10-76">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb10-77">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb10-78">      )</span>
<span id="cb10-79">    )</span>
<span id="cb10-80">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb10-81">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb10-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.tag =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb10-83">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb10-84">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb10-85">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb10-86">    ),</span>
<span id="cb10-87">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb10-88">  )</span>
<span id="cb10-89"></span>
<span id="cb10-90"></span>
<span id="cb10-91"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb10-92">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb10-93">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb10-94">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6_5_1.png"</span>),</span>
<span id="cb10-95">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb10-96">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">700</span>,</span>
<span id="cb10-97">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2200</span>,</span>
<span id="cb10-98">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb10-99">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb10-100">)</span></code></pre></div>
</details>
</div>
<div id="fig-6-5-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6-5-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter6_5_1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Figure&nbsp;9: Vectorization of raster into points using terra::as_points() with or without retention of raster values."><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter6_5_1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6-5-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Vectorization of raster into points using <code>terra::as_points()</code> with or without retention of raster values.
</figcaption>
</figure>
</div>
<ul>
<li><strong>(2) Contour Lines (Isolines)</strong>:
<ul>
<li>Represent lines of constant values (e.g., elevation, temperature).</li>
<li>Use <code>terra::as.contour()</code> which creates a <code>SpatVector</code>, which then is converted into an {sf} object using <code>sf::st_as_sf()</code> which shows contour lines as <code>LINESTRING</code> or <code>MULTILINESTRING</code> geometry featuers, with an additional column on <code>level</code> (every 100 metres)</li>
<li>Or, <code>rasterVis::contourplot()</code> for creating and overlaying contours. For example, visualize DEMs with hillshading and contours in Figure&nbsp;10</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Digital elevation showing the southern flank of Mt. Mongón.</span></span>
<span id="cb11-2">dem <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/dem.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>))</span>
<span id="cb11-3"></span>
<span id="cb11-4">g13 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dem) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb11-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Base raster"</span>,</span>
<span id="cb11-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Class SpatRaster (dem)"</span>,</span>
<span id="cb11-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb11-11">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>()</span>
<span id="cb11-13"></span>
<span id="cb11-14"></span>
<span id="cb11-15">dem_contour <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.contour</span>(dem, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nlevels =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>()</span>
<span id="cb11-17"></span>
<span id="cb11-18">g14 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb11-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dem_contour,</span>
<span id="cb11-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> level),</span>
<span id="cb11-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb11-23">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf_label</span>(</span>
<span id="cb11-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dem_contour,</span>
<span id="cb11-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb11-27">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> level,</span>
<span id="cb11-28">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> level</span>
<span id="cb11-29">    ),</span>
<span id="cb11-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>),</span>
<span id="cb11-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>,</span>
<span id="cb11-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb11-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb11-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.padding =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lines"</span>)</span>
<span id="cb11-35">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_wiki_c</span>(</span>
<span id="cb11-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(dem_contour<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>level)</span>
<span id="cb11-38">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb11-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Contour Lines with {sf}"</span>,</span>
<span id="cb11-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Using terra::as.contour(nlevels = 10)"</span>,</span>
<span id="cb11-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb11-43">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb11-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb11-47">  )</span>
<span id="cb11-48"></span>
<span id="cb11-49">dem_contour <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.contour</span>(dem, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nlevels =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>()</span>
<span id="cb11-51"></span>
<span id="cb11-52">g15 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb11-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dem_contour,</span>
<span id="cb11-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> level),</span>
<span id="cb11-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb11-57">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-58">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_wiki_c</span>(</span>
<span id="cb11-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(dem_contour<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>level)</span>
<span id="cb11-60">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-61">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb11-62">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Contour Lines with {sf}"</span>,</span>
<span id="cb11-63">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Using terra::as.contour(nlevels = 30)"</span>,</span>
<span id="cb11-64">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb11-65">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-66">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-67">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb11-68">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb11-69">  )</span>
<span id="cb11-70"></span>
<span id="cb11-71">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g13 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g14 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g15 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-72">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(</span>
<span id="cb11-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb11-74">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-75">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb11-76">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_levels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>,</span>
<span id="cb11-77">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Vectorizing rasters into lines - Contour Lines"</span>,</span>
<span id="cb11-78">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb11-79">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb11-80">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">48</span>,</span>
<span id="cb11-81">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb11-82">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span></span>
<span id="cb11-83">      )</span>
<span id="cb11-84">    )</span>
<span id="cb11-85">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb11-86">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb11-87">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.tag =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb11-88">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb11-89">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb11-90">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb11-91">    ),</span>
<span id="cb11-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb11-93">  )</span>
<span id="cb11-94"></span>
<span id="cb11-95"></span>
<span id="cb11-96"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb11-97">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb11-98">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb11-99">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6_5_2_1.png"</span>),</span>
<span id="cb11-100">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb11-101">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">800</span>,</span>
<span id="cb11-102">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1600</span>,</span>
<span id="cb11-103">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb11-104">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb11-105">)</span>
<span id="cb11-106"></span>
<span id="cb11-107"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># File name to save the PNG</span></span>
<span id="cb11-108">output_file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb11-109">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb11-110">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6_5_2_2.png"</span>)</span>
<span id="cb11-111"></span>
<span id="cb11-112"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">png</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> output_file, </span>
<span id="cb11-113">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">600</span>, </span>
<span id="cb11-114">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">800</span>,</span>
<span id="cb11-115">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>)</span>
<span id="cb11-116"></span>
<span id="cb11-117"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate the contour plot</span></span>
<span id="cb11-118">rasterVis<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">contourplot</span>(dem, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rasterVis::contourplot()"</span>)</span>
<span id="cb11-119"></span>
<span id="cb11-120"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Close the graphics device</span></span>
<span id="cb11-121"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dev.off</span>()</span>
<span id="cb11-122"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magick)</span>
<span id="cb11-123"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read the two images</span></span>
<span id="cb11-124">img1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb11-125">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb11-126">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6_5_2_1.png"</span>))</span>
<span id="cb11-127">img2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb11-128">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb11-129">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6_5_2_2.png"</span>))</span>
<span id="cb11-130"></span>
<span id="cb11-131"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(img1, img2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-132">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_append</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-133">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_write</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb11-134">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb11-135">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6_5_2.png"</span>))</span>
<span id="cb11-136"></span>
<span id="cb11-137"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlink</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb11-138">                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb11-139">                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6_5_2_1.png"</span>))</span>
<span id="cb11-140"></span>
<span id="cb11-141"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlink</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb11-142">                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb11-143">                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6_5_2_2.png"</span>))</span></code></pre></div>
</details>
</div>
<div id="fig-6-5-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6-5-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter6_5_2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Figure&nbsp;10: "><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter6_5_2.png" id="fig-6-5-2" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-6-5-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10
</figcaption>
</figure>
</div>
<ul>
<li><strong>(3) Polygons from Rasters</strong>:
<ul>
<li>Use <code>terra::as.polygons()</code> to convert raster cells to polygons with five coordinates per cell.</li>
<li>Aggregation: Dissolve boundaries with the same attribute values (<code>aggregate</code> argument). Example: Grain raster converted to polygons in Figure&nbsp;11.</li>
</ul></li>
<li><strong>Further enhacement: Polygon Smoothing</strong>: Use <code>smoothr::smooth()</code> <span class="citation" data-cites="smoothr-3">(Strimas-Mackey 2023)</span> (with method = <code>"chaikin"</code>, <code>"ksmooth"</code> or <code>"spline"</code>) to remove sharp edges. But remember, Smoothing alters spatial coverage; analyse cautiously.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">grain <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/grain.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spData"</span>))</span>
<span id="cb12-2"></span>
<span id="cb12-3">g16 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dat =</span> grain) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_princess_d</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb12-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Base raster; Qualitative"</span>,</span>
<span id="cb12-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"With three discrete values"</span>,</span>
<span id="cb12-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb12-10">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>)</span>
<span id="cb12-14"></span>
<span id="cb12-15">g17 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb12-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> grain <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.polygons</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">aggregate =</span> T) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>(),</span>
<span id="cb12-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> grain),</span>
<span id="cb12-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>,</span>
<span id="cb12-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb12-21">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_princess_d</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb12-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Vectorized as aggregated polygons"</span>,</span>
<span id="cb12-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Using terra::as.polygons(aggregate = TRUE)"</span>,</span>
<span id="cb12-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb12-27">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>)</span>
<span id="cb12-31"></span>
<span id="cb12-32">g18 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb12-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> grain <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.polygons</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">aggregate =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>(),</span>
<span id="cb12-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> grain),</span>
<span id="cb12-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>,</span>
<span id="cb12-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb12-38">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_princess_d</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb12-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Vectorized as polygons"</span>,</span>
<span id="cb12-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Using terra::as.polygons(aggregate = FALSE)"</span>,</span>
<span id="cb12-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb12-44">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>)</span>
<span id="cb12-48"></span>
<span id="cb12-49">g19 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb12-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> grain <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb12-52">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.polygons</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">aggregate =</span> T) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb12-53">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb12-54">            smoothr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">smooth</span>(),</span>
<span id="cb12-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> grain),</span>
<span id="cb12-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>,</span>
<span id="cb12-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb12-58">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_princess_d</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-60">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb12-61">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Vectorized as smoothed polygons"</span>,</span>
<span id="cb12-62">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"terra::as.polygons() &amp; smoothr::smooth()"</span>,</span>
<span id="cb12-63">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb12-64">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-65">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-66">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-67">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>)</span>
<span id="cb12-68"></span>
<span id="cb12-69">g20 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-70">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb12-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> grain <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb12-72">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.polygons</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">aggregate =</span> T) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb12-73">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb12-74">            smoothr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spline"</span>),</span>
<span id="cb12-75">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> grain),</span>
<span id="cb12-76">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>,</span>
<span id="cb12-77">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb12-78">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-79">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_princess_d</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-80">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb12-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Vectorized as smoothed polygons"</span>,</span>
<span id="cb12-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"smoothr::smooth(method = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">spline</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">)"</span>,</span>
<span id="cb12-83">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb12-84">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-85">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"off"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-86">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-87">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>)</span>
<span id="cb12-88"></span>
<span id="cb12-89">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g16 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g17 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g18 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g19 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g20 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-90">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-91">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb12-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Vectorizing rasters into polygons (aggregation)"</span>,</span>
<span id="cb12-93">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_levels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>,</span>
<span id="cb12-94">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb12-95">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb12-96">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">48</span>,</span>
<span id="cb12-97">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb12-98">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb12-99">      )</span>
<span id="cb12-100">    )</span>
<span id="cb12-101">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb12-102">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb12-103">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.tag =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb12-104">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb12-105">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb12-106">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb12-107">    ),</span>
<span id="cb12-108">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb12-109">  )</span>
<span id="cb12-110"></span>
<span id="cb12-111"></span>
<span id="cb12-112"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb12-113">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb12-114">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb12-115">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6_5_3.png"</span>),</span>
<span id="cb12-116">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb12-117">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">700</span>,</span>
<span id="cb12-118">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2200</span>,</span>
<span id="cb12-119">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb12-120">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb12-121">)</span></code></pre></div>
</details>
</div>
<div id="fig-6-5-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6-5-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter6_5_3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Figure&nbsp;11: "><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter6_5_3.png" id="fig-6-5-3" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-6-5-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11
</figcaption>
</figure>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magick)</span>
<span id="cb13-2"></span>
<span id="cb13-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read the two images</span></span>
<span id="cb13-4">img1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb13-5">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb13-6">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6_4_1.png"</span>))</span>
<span id="cb13-7">img2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb13-8">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb13-9">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6_4_2.png"</span>))</span>
<span id="cb13-10">img3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb13-11">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb13-12">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6_5_1.png"</span>))</span>
<span id="cb13-13">img4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb13-14">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb13-15">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6_5_2.png"</span>))</span>
<span id="cb13-16">img5 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb13-17">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb13-18">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6_5_3.png"</span>))</span>
<span id="cb13-19"></span>
<span id="cb13-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(img1, img2, img3, img4, img5) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb13-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_append</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stack =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb13-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_write</span>(</span>
<span id="cb13-23">    here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>,</span>
<span id="cb13-24">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>,</span>
<span id="cb13-25">               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6_5.png"</span>)</span>
<span id="cb13-26">  )</span></code></pre></div>
</details>
</div>
<section id="compilation-plot-with-magick" class="level3">
<h3 class="anchored" data-anchor-id="compilation-plot-with-magick">Compilation Plot with {magick}</h3>
<p>A compilation plot of the techniques in the last two sections is shown in Figure&nbsp;12</p>
<div id="fig-6-5" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter6_5.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Figure&nbsp;12: A compiled image for all the techniques of raster-vector interaction: Rasterization and Vectorization."><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter6_5.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: A compiled image for all the techniques of raster-vector interaction: Rasterization and Vectorization.
</figcaption>
</figure>
</div>
</section>
</section>
<section id="exercise-solutions" class="level2">
<h2 class="anchored" data-anchor-id="exercise-solutions">Exercise Solutions</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sf)             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simple Features in R</span></span>
<span id="cb14-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(terra)          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Rasters in R (with tidy workflow)</span></span>
<span id="cb14-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyterra)      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tidy workflow and ggplot2 with rasters</span></span>
<span id="cb14-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(spData)         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Getting data</span></span>
<span id="cb14-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data Wrangling and {ggplot2}</span></span>
<span id="cb14-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(patchwork)      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compiling Plots</span></span>
<span id="cb14-7"></span>
<span id="cb14-8">zion_points_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(</span>
<span id="cb14-9">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"vector/zion_points.gpkg"</span>, </span>
<span id="cb14-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span></span>
<span id="cb14-11">  )</span>
<span id="cb14-12"></span>
<span id="cb14-13">zion_points <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_sf</span>(zion_points_path)</span>
<span id="cb14-14"></span>
<span id="cb14-15">srtm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/srtm.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>))</span>
<span id="cb14-16"></span>
<span id="cb14-17">ch <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_combine</span>(zion_points) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb14-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_convex_hull</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb14-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>()</span>
<span id="cb14-20"></span>
<span id="cb14-21">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Condensed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>)</span>
<span id="cb14-22">showtext<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb14-23"></span>
<span id="cb14-24"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(</span>
<span id="cb14-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb14-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb14-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span></span>
<span id="cb14-28">  )</span>
<span id="cb14-29">)</span>
<span id="cb14-30"></span>
<span id="cb14-31">theme_custom <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(...){</span>
<span id="cb14-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb14-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.height =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb14-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb14-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb14-36">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb14-37">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb14-38">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb14-39">    ),</span>
<span id="cb14-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb14-41">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>,</span>
<span id="cb14-42">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb14-43">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb14-44">    ),</span>
<span id="cb14-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb14-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb14-47">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb14-48">    ),</span>
<span id="cb14-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>),</span>
<span id="cb14-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb14-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>,</span>
<span id="cb14-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)),</span>
<span id="cb14-53">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)),</span>
<span id="cb14-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb14-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.box.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb14-56">  )</span>
<span id="cb14-57">}</span></code></pre></div>
</details>
</div>
<section id="e1." class="level3">
<h3 class="anchored" data-anchor-id="e1.">E1.</h3>
<p><strong>Crop the <code>srtm</code> raster using (1) the <code>zion_points</code> dataset and (2) the <code>ch</code> dataset. Are there any differences in the output maps? Next, mask <code>srtm</code> using these two datasets. Can you see any difference now? How can you explain that?</strong></p>
<p>The Figure&nbsp;13 (b) shows the <code>srtm</code> raster cropped using <code>zion_points</code> dataset. The Figure&nbsp;13 (c) shows the raster <code>srtm</code> cropped using <code>ch</code> dataset. There seem to be no differences between the two output cropped maps.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> srtm) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> ch, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> zion_points, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb15-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb15-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">113.25</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">112.83</span>),</span>
<span id="cb15-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.11</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.53</span>)</span>
<span id="cb15-10">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb15-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Base datasets"</span>,</span>
<span id="cb15-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"srtm: Elevation Raster; ch: convex hull;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">zion_points: blue points"</span></span>
<span id="cb15-14">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>()</span>
<span id="cb15-16"></span>
<span id="cb15-17">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> srtm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crop</span>(zion_points)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-19">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># geom_sf(data = ch, alpha = 0.5, fill = "white") +</span></span>
<span id="cb15-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> zion_points, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb15-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb15-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">113.25</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">112.83</span>),</span>
<span id="cb15-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.11</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.53</span>)</span>
<span id="cb15-26">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb15-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cropping by points"</span>,</span>
<span id="cb15-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"srtm |&gt; crop(zion_points)"</span></span>
<span id="cb15-30">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>()</span>
<span id="cb15-32"></span>
<span id="cb15-33">g3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> srtm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crop</span>(zion_points)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> ch, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-36">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># geom_sf(data = zion_points, colour = "blue", alpha = 0.5) +</span></span>
<span id="cb15-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb15-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb15-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">113.25</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">112.83</span>),</span>
<span id="cb15-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.11</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.53</span>)</span>
<span id="cb15-42">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb15-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cropping by Convex hull"</span>,</span>
<span id="cb15-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"srtm |&gt; crop(ch)"</span></span>
<span id="cb15-46">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>()</span>
<span id="cb15-48"></span>
<span id="cb15-49"></span>
<span id="cb15-50">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_levels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>)</span>
<span id="cb15-53"></span>
<span id="cb15-54"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb15-55">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>,</span>
<span id="cb15-56">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6-e1-1.png"</span>),</span>
<span id="cb15-57">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>,</span>
<span id="cb15-58">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>,</span>
<span id="cb15-59">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span></span>
<span id="cb15-60">)</span></code></pre></div>
</details>
</div>
<div id="fig-e1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-e1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter6-e1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Figure&nbsp;13: "><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter6-e1-1.png" id="fig-e1" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-e1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13
</figcaption>
</figure>
</div>
<p>However, the Figure&nbsp;14 (a) shows masking of the raster with points - showing that masking by points results in selected points on the raster, thus resulting in no visible result. The Figure&nbsp;14 (b) shows masking of a raster by a polygon, a more expected result.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> srtm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mask</span>(zion_points)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-3">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># geom_sf(data = ch, alpha = 0.5, fill = "white") +</span></span>
<span id="cb16-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> zion_points, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, </span>
<span id="cb16-5">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb16-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb16-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">113.25</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">112.83</span>),</span>
<span id="cb16-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.11</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.53</span>)</span>
<span id="cb16-11">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb16-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Masking a raster by points"</span>,</span>
<span id="cb16-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"srtm |&gt; mask(zion_points)"</span></span>
<span id="cb16-15">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>()</span>
<span id="cb16-17"></span>
<span id="cb16-18">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> srtm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mask</span>(ch)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-20">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># geom_sf(data = ch, alpha = 0.5, fill = "white") +</span></span>
<span id="cb16-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> zion_points, </span>
<span id="cb16-22">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb16-23">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb16-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb16-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">113.25</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">112.83</span>),</span>
<span id="cb16-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.11</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.53</span>)</span>
<span id="cb16-29">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb16-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Masking a raster by a polygon"</span>,</span>
<span id="cb16-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"srtm |&gt; mask(ch)"</span></span>
<span id="cb16-33">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>()</span>
<span id="cb16-35"></span>
<span id="cb16-36"></span>
<span id="cb16-37">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_levels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>)</span>
<span id="cb16-40"></span>
<span id="cb16-41"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb16-42">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>,</span>
<span id="cb16-43">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6-e1-2.png"</span>),</span>
<span id="cb16-44">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">800</span>,</span>
<span id="cb16-45">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1600</span>,</span>
<span id="cb16-46">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span></span>
<span id="cb16-47">)</span></code></pre></div>
</details>
</div>
<div id="fig-e1a" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-e1a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter6-e1-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Figure&nbsp;14: "><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter6-e1-2.png" id="fig-e1a" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-e1a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14
</figcaption>
</figure>
</div>
<p>The distinction between masking and cropping can be better understood by examining how they interact with polygons and points:</p>
<ol type="1">
<li><p><strong>Masking</strong>: When masking with a <strong>polygon</strong>, the output includes all the raster cells that fall within the interior or lie on the boundaries of the polygon. In contrast, masking with <strong>points</strong> produces an output that includes only the specific raster cells that align directly with those points, without considering the area around them.</p></li>
<li><p><strong>Cropping</strong>: Cropping, whether by points or polygons, yields the same result. This is because cropping considers the <strong>bounding box</strong>, which is the smallest rectangle that can enclose the given geometry. For a set of points and their convex hull (a polygon that encloses the points), the bounding box remains identical. Consequently, the raster output produced by cropping is consistent regardless of whether the input geometry is a polygon or a set of points.</p></li>
</ol>
</section>
<section id="e2." class="level3">
<h3 class="anchored" data-anchor-id="e2.">E2.</h3>
<p><strong>Firstly, extract values from <code>srtm</code> at the points represented in <code>zion_points</code>. Next, extract average values of <code>srtm</code> using a 90 buffer around each point from <code>zion_points</code> and compare these two sets of values. When would extracting values by buffers be more suitable than by points alone?</strong></p>
<p><strong>Bonus: Implement extraction using the <code>exactextractr</code> package and compare the results.</strong></p>
<p>The Table&nbsp;1 compares the two values from rasters - extracted from the points and extracted from the buffer zone (90 metres) around the points. It would be better to use the buffer around the points, since it removes the chance error or randomness.</p>
<p>Further, the use of <code>exactextractr</code> package helps us calculate even better weighted mean of the buffer zone, by calculating how much of a raster cell’s proportion fall within the buffer zone.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">df1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> srtm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-2">  terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">extract</span>(zion_points) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height_on_points =</span> srtm)</span>
<span id="cb17-5"></span>
<span id="cb17-6">df2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> srtm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-7">  terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">extract</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_buffer</span>(zion_points, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(ID) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb17-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_height_in_buffer_zone =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(srtm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> T)</span>
<span id="cb17-11">  )</span>
<span id="cb17-12"></span>
<span id="cb17-13">df3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> srtm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-14">  exactextractr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exact_extract</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_buffer</span>(zion_points, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-15">  purrr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">imap_dfr</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> .x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ID =</span> .y)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(ID) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb17-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_with_exact_fractions =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">weighted.mean</span>(value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">w =</span> coverage_fraction)</span>
<span id="cb17-20">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ID =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parse_number</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(ID)))</span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">df_all <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">structure</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ID =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, </span>
<span id="cb18-2"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">17</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">22</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">23</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">26</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">27</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>, </span>
<span id="cb18-3"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height_on_points =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1802</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2433</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1886</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1370</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1452</span>L, </span>
<span id="cb18-4"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1635</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1380</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2032</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1830</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1860</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1440</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2145</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1942</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1691</span>L, </span>
<span id="cb18-5"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1776</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2198</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1820</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1349</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1758</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1424</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2159</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1809</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1826</span>L, </span>
<span id="cb18-6"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1550</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1799</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2102</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2118</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1372</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1905</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1574</span>L), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_height_in_buffer_zone =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1803.5</span>, </span>
<span id="cb18-7"><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2418.75</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1875</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1385.66666666667</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1411.33333333333</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1629</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1378.25</span>, </span>
<span id="cb18-8"><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2040.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1812.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1863</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1485</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2163.25</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1930</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1689.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1770.6</span>, </span>
<span id="cb18-9"><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2197.75</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1820.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1342.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1755.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1432.25</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2163</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1799.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1815.5</span>, </span>
<span id="cb18-10"><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1557.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1818.75</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2084</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2112.75</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1381</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1906.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1568.75</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_with_exact_fractions =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1802.00133958487</span>, </span>
<span id="cb18-11"><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2424.45674770282</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1876.08426481862</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1392.71469762041</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1418.32776902309</span>, </span>
<span id="cb18-12"><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1634.65560885957</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1382.29661439712</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2036.58308765316</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1820.0303014567</span>, </span>
<span id="cb18-13"><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1862.25146840549</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1474.00216389597</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2156.26597640816</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1928.10327037732</span>, </span>
<span id="cb18-14"><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1690.96565049072</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1772.48742394502</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2199.49153660086</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1814.37498800353</span>, </span>
<span id="cb18-15"><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1346.31074580787</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1750.9561283278</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1432.07177081194</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2162.75811241747</span>, </span>
<span id="cb18-16"><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1799.24374331498</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1818.16628377294</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1555.46331837623</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1815.26746442256</span>, </span>
<span id="cb18-17"><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2084.60258183394</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2114.31006688883</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1382.04095054598</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1907.24485439106</span>, </span>
<span id="cb18-18"><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1568.26154119403</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">difference =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">14.25</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">15.6666666666667</span>, </span>
<span id="cb18-19"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">40.6666666666667</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.75</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8.25</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">17.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">18.25</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, </span>
<span id="cb18-20"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.75</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.40000000000009</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.75</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8.25</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, </span>
<span id="cb18-21"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9.75</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">19.75</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.25</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.25</span>)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row.names =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, </span>
<span id="cb18-22"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>L), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tbl_df"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tbl"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data.frame"</span>))</span>
<span id="cb18-23"></span>
<span id="cb18-24">df_all <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb18-25">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb18-26">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>(</span>
<span id="cb18-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>ID,</span>
<span id="cb18-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decimals =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb18-29">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb18-30">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label_with</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> snakecase<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>to_title_case) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb18-31">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>()</span></code></pre></div>
</details>
<div id="tbl-e2" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-e2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: A table on the height of points, mean height inside the buffer zone and difference between the two
</figcaption>
<div aria-describedby="tbl-e2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="stmvqkrnfm" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#stmvqkrnfm table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#stmvqkrnfm thead, #stmvqkrnfm tbody, #stmvqkrnfm tfoot, #stmvqkrnfm tr, #stmvqkrnfm td, #stmvqkrnfm th {
  border-style: none;
}

#stmvqkrnfm p {
  margin: 0;
  padding: 0;
}

#stmvqkrnfm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#stmvqkrnfm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#stmvqkrnfm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#stmvqkrnfm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#stmvqkrnfm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#stmvqkrnfm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#stmvqkrnfm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#stmvqkrnfm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#stmvqkrnfm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#stmvqkrnfm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#stmvqkrnfm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#stmvqkrnfm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#stmvqkrnfm .gt_spanner_row {
  border-bottom-style: hidden;
}

#stmvqkrnfm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#stmvqkrnfm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#stmvqkrnfm .gt_from_md > :first-child {
  margin-top: 0;
}

#stmvqkrnfm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#stmvqkrnfm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#stmvqkrnfm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#stmvqkrnfm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#stmvqkrnfm .gt_row_group_first td {
  border-top-width: 2px;
}

#stmvqkrnfm .gt_row_group_first th {
  border-top-width: 2px;
}

#stmvqkrnfm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#stmvqkrnfm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#stmvqkrnfm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#stmvqkrnfm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#stmvqkrnfm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#stmvqkrnfm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#stmvqkrnfm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#stmvqkrnfm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#stmvqkrnfm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#stmvqkrnfm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#stmvqkrnfm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#stmvqkrnfm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#stmvqkrnfm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#stmvqkrnfm .gt_left {
  text-align: left;
}

#stmvqkrnfm .gt_center {
  text-align: center;
}

#stmvqkrnfm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#stmvqkrnfm .gt_font_normal {
  font-weight: normal;
}

#stmvqkrnfm .gt_font_bold {
  font-weight: bold;
}

#stmvqkrnfm .gt_font_italic {
  font-style: italic;
}

#stmvqkrnfm .gt_super {
  font-size: 65%;
}

#stmvqkrnfm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#stmvqkrnfm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#stmvqkrnfm .gt_indent_1 {
  text-indent: 5px;
}

#stmvqkrnfm .gt_indent_2 {
  text-indent: 10px;
}

#stmvqkrnfm .gt_indent_3 {
  text-indent: 15px;
}

#stmvqkrnfm .gt_indent_4 {
  text-indent: 20px;
}

#stmvqkrnfm .gt_indent_5 {
  text-indent: 25px;
}
</style>
<div id="stmvqkrnfm" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="stmvqkrnfm">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"ID":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],"height_on_points":[1802,2433,1886,1370,1452,1635,1380,2032,1830,1860,1440,2145,1942,1691,1776,2198,1820,1349,1758,1424,2159,1809,1826,1550,1799,2102,2118,1372,1905,1574],"mean_height_in_buffer_zone":[1803.5,2418.75,1875,1385.66666666667,1411.33333333333,1629,1378.25,2040.25,1812.5,1863,1485,2163.25,1930,1689.25,1770.6,2197.75,1820.25,1342.25,1755.5,1432.25,2163,1799.25,1815.5,1557.25,1818.75,2084,2112.75,1381,1906.5,1568.75],"mean_with_exact_fractions":[1802.00133958487,2424.45674770282,1876.08426481862,1392.71469762041,1418.32776902309,1634.65560885957,1382.29661439712,2036.58308765316,1820.0303014567,1862.25146840549,1474.00216389597,2156.26597640816,1928.10327037732,1690.96565049072,1772.48742394502,2199.49153660086,1814.37498800353,1346.31074580787,1750.9561283278,1432.07177081194,2162.75811241747,1799.24374331498,1818.16628377294,1555.46331837623,1815.26746442256,2084.60258183394,2114.31006688883,1382.04095054598,1907.24485439106,1568.26154119403],"difference":[1.5,-14.25,-11,15.6666666666667,-40.6666666666667,-6,-1.75,8.25,-17.5,3,45,18.25,-12,-1.75,-5.40000000000009,-0.25,0.25,-6.75,-2.5,8.25,4,-9.75,-10.5,7.25,19.75,-18,-5.25,9,1.5,-5.25]},"columns":[{"id":"ID","name":"Id","type":"numeric","style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30"],"html":true,"align":"right","headerStyle":{"font-weight":"normal"}},{"id":"height_on_points","name":"Height on Points","type":"numeric","style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1,802","2,433","1,886","1,370","1,452","1,635","1,380","2,032","1,830","1,860","1,440","2,145","1,942","1,691","1,776","2,198","1,820","1,349","1,758","1,424","2,159","1,809","1,826","1,550","1,799","2,102","2,118","1,372","1,905","1,574"],"html":true,"align":"right","headerStyle":{"font-weight":"normal"}},{"id":"mean_height_in_buffer_zone","name":"Mean Height in Buffer Zone","type":"numeric","style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1,804","2,419","1,875","1,386","1,411","1,629","1,378","2,040","1,812","1,863","1,485","2,163","1,930","1,689","1,771","2,198","1,820","1,342","1,756","1,432","2,163","1,799","1,816","1,557","1,819","2,084","2,113","1,381","1,906","1,569"],"html":true,"align":"right","headerStyle":{"font-weight":"normal"}},{"id":"mean_with_exact_fractions","name":"Mean with Exact Fractions","type":"numeric","style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1,802","2,424","1,876","1,393","1,418","1,635","1,382","2,037","1,820","1,862","1,474","2,156","1,928","1,691","1,772","2,199","1,814","1,346","1,751","1,432","2,163","1,799","1,818","1,555","1,815","2,085","2,114","1,382","1,907","1,568"],"html":true,"align":"right","headerStyle":{"font-weight":"normal"}},{"id":"difference","name":"Difference","type":"numeric","style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["2","−14","−11","16","−41","−6","−2","8","−18","3","45","18","−12","−2","−5","0","0","−7","−2","8","4","−10","−10","7","20","−18","−5","9","2","−5"],"html":true,"align":"right","headerStyle":{"font-weight":"normal"}}],"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"showSortable":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"rgba(128,128,128,0.05)","style":{"fontFamily":"system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif"},"headerStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"}},"elementId":"stmvqkrnfm","dataKey":"08154326de97edd4c81e2f1339dae33b"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style","tag.attribs.columns.4.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="e3." class="level3">
<h3 class="anchored" data-anchor-id="e3.">E3.</h3>
<p><strong>Subset points higher than 3100 meters in New Zealand (the <code>nz_height</code> object) and create a template raster with a resolution of 3 km for the extent of the new point dataset. Using these two new objects:</strong></p>
<ul>
<li><p><strong>Count numbers of the highest points in each grid cell.</strong></p></li>
<li><p><strong>Find the maximum elevation in each grid cell.</strong></p></li>
</ul>
<p>The object <code>above_3100</code> contains the 19 peaks which are above 3100 metres. Further, the <code>template_raster</code> is a template raster with a resolution of 3 km and the extent of the new point dataset. The results for count and maximum height in each cell os new raster are shown in Figure&nbsp;15.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nz_height"</span>)</span>
<span id="cb19-2"></span>
<span id="cb19-3">above_3100 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(elevation <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3100</span>)</span>
<span id="cb19-5"></span>
<span id="cb19-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a template raster for using in rasterization</span></span>
<span id="cb19-7">template_raster <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(</span>
<span id="cb19-8">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Spat Extent of the Vector data</span></span>
<span id="cb19-9">  terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ext</span>(above_3100),</span>
<span id="cb19-10">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Required resolution of the raster</span></span>
<span id="cb19-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resolution =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3000</span>,</span>
<span id="cb19-12">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># CRS for the raster</span></span>
<span id="cb19-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crs</span>(above_3100)</span>
<span id="cb19-14">)</span>
<span id="cb19-15"></span>
<span id="cb19-16">elevation_raster <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> above_3100 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rasterize</span>(template_raster)</span>
<span id="cb19-17">elevation_raster_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> above_3100 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rasterize</span>(template_raster, </span>
<span id="cb19-18">                                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"length"</span>)</span>
<span id="cb19-19">elevation_raster_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> above_3100 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rasterize</span>(</span>
<span id="cb19-21">    template_raster,</span>
<span id="cb19-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">field =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"elevation"</span>,</span>
<span id="cb19-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max"</span>)</span>
<span id="cb19-24"></span>
<span id="cb19-25">df1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> elevation_raster_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cell_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">drop_na</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(</span>
<span id="cb19-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">numer_of_peaks =</span> V1_length,</span>
<span id="cb19-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cell_ID =</span> cell_id</span>
<span id="cb19-33">  )</span>
<span id="cb19-34"></span>
<span id="cb19-35">df2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> elevation_raster_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cell_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">drop_na</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(</span>
<span id="cb19-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">maximum_height_of_peaks =</span> max,</span>
<span id="cb19-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cell_ID =</span> cell_id</span>
<span id="cb19-43">  )</span>
<span id="cb19-44"></span>
<span id="cb19-45">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elevation_raster_1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_viridis_c</span>(</span>
<span id="cb19-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb19-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb19-50">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb19-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of peaks per cell"</span>,</span>
<span id="cb19-53">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Raster created using rasterize(fun = `length`)"</span></span>
<span id="cb19-54">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-55">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb19-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span></span>
<span id="cb19-58">  ) </span>
<span id="cb19-59"></span>
<span id="cb19-60">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-61">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elevation_raster_2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-62">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_princess_c</span>(</span>
<span id="cb19-63">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb19-64">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-65">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb19-66">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Maximum height per cell"</span>,</span>
<span id="cb19-67">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Using rasterize(field = `elevation`, fun = `max`)"</span></span>
<span id="cb19-68">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-69">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-70">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb19-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span></span>
<span id="cb19-72">  )</span>
<span id="cb19-73"></span>
<span id="cb19-74">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-75">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-76">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb19-77">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_levels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>,</span>
<span id="cb19-78">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_prefix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"("</span>,</span>
<span id="cb19-79">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_suffix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span></span>
<span id="cb19-80">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb19-81">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb19-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.tag =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb19-83">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>,</span>
<span id="cb19-84">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb19-85">    )</span>
<span id="cb19-86">  )</span>
<span id="cb19-87"></span>
<span id="cb19-88"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb19-89">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>,</span>
<span id="cb19-90">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6-e3.png"</span>),</span>
<span id="cb19-91">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">800</span>,</span>
<span id="cb19-92">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1600</span>,</span>
<span id="cb19-93">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span></span>
<span id="cb19-94">)</span></code></pre></div>
</details>
</div>
<div id="fig-e3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-e3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter6-e3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Figure&nbsp;15: Figure showing the two rasters (a) Raster with each cell of resolution of 3 km, and colour (fill) depicting the count of peaks, i.e., the number of peaks above 3100 metres within that cell. (b) Raster with each cell of same resolution, where each cell’s colour (fill) depicts the maximum elevation (height) within that each cell."><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter6-e3.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-e3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15: Figure showing the two rasters (a) Raster with each cell of resolution of 3 km, and colour (fill) depicting the count of peaks, i.e., the number of peaks above 3100 metres within that cell. (b) Raster with each cell of same resolution, where each cell’s colour (fill) depicts the maximum elevation (height) within that each cell.
</figcaption>
</figure>
</div>
<p>The count of the number of highest points in each grid cell, and the maximum height in each grid cell is shown in Table&nbsp;2</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># dput(full_join(df1, df2))</span></span>
<span id="cb20-2"></span>
<span id="cb20-3">df12 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">structure</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">numer_of_peaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cell_ID =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>L, </span>
<span id="cb20-4"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">31</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">38</span>L, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>L), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">maximum_height_of_peaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3497</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3194</span>, </span>
<span id="cb20-5"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3199</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3724</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3593</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3151</span>)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tbl_df"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tbl"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data.frame"</span></span>
<span id="cb20-6">), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row.names =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>L))</span>
<span id="cb20-7"></span>
<span id="cb20-8">df12 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb20-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">relocate</span>(cell_ID) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb20-10">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb20-11">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label_with</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> snakecase<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>to_title_case)</span></code></pre></div>
</details>
<div id="tbl-e3" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-e3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Number of highest points in each grid cell.
</figcaption>
<div aria-describedby="tbl-e3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="scvpqluxkr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#scvpqluxkr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#scvpqluxkr thead, #scvpqluxkr tbody, #scvpqluxkr tfoot, #scvpqluxkr tr, #scvpqluxkr td, #scvpqluxkr th {
  border-style: none;
}

#scvpqluxkr p {
  margin: 0;
  padding: 0;
}

#scvpqluxkr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#scvpqluxkr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#scvpqluxkr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#scvpqluxkr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#scvpqluxkr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#scvpqluxkr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#scvpqluxkr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#scvpqluxkr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#scvpqluxkr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#scvpqluxkr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#scvpqluxkr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#scvpqluxkr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#scvpqluxkr .gt_spanner_row {
  border-bottom-style: hidden;
}

#scvpqluxkr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#scvpqluxkr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#scvpqluxkr .gt_from_md > :first-child {
  margin-top: 0;
}

#scvpqluxkr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#scvpqluxkr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#scvpqluxkr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#scvpqluxkr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#scvpqluxkr .gt_row_group_first td {
  border-top-width: 2px;
}

#scvpqluxkr .gt_row_group_first th {
  border-top-width: 2px;
}

#scvpqluxkr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#scvpqluxkr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#scvpqluxkr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#scvpqluxkr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#scvpqluxkr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#scvpqluxkr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#scvpqluxkr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#scvpqluxkr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#scvpqluxkr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#scvpqluxkr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#scvpqluxkr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#scvpqluxkr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#scvpqluxkr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#scvpqluxkr .gt_left {
  text-align: left;
}

#scvpqluxkr .gt_center {
  text-align: center;
}

#scvpqluxkr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#scvpqluxkr .gt_font_normal {
  font-weight: normal;
}

#scvpqluxkr .gt_font_bold {
  font-weight: bold;
}

#scvpqluxkr .gt_font_italic {
  font-style: italic;
}

#scvpqluxkr .gt_super {
  font-size: 65%;
}

#scvpqluxkr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#scvpqluxkr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#scvpqluxkr .gt_indent_1 {
  text-indent: 5px;
}

#scvpqluxkr .gt_indent_2 {
  text-indent: 10px;
}

#scvpqluxkr .gt_indent_3 {
  text-indent: 15px;
}

#scvpqluxkr .gt_indent_4 {
  text-indent: 20px;
}

#scvpqluxkr .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="Cell Id" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Cell Id</th>
<th id="Numer of Peaks" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Numer of Peaks</th>
<th id="Maximum Height of Peaks" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Maximum Height of Peaks</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="cell_ID">24</td>
<td class="gt_row gt_right" headers="numer_of_peaks">7</td>
<td class="gt_row gt_right" headers="maximum_height_of_peaks">3497</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="cell_ID">25</td>
<td class="gt_row gt_right" headers="numer_of_peaks">2</td>
<td class="gt_row gt_right" headers="maximum_height_of_peaks">3194</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="cell_ID">28</td>
<td class="gt_row gt_right" headers="numer_of_peaks">1</td>
<td class="gt_row gt_right" headers="maximum_height_of_peaks">3199</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="cell_ID">31</td>
<td class="gt_row gt_right" headers="numer_of_peaks">6</td>
<td class="gt_row gt_right" headers="maximum_height_of_peaks">3724</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="cell_ID">38</td>
<td class="gt_row gt_right" headers="numer_of_peaks">1</td>
<td class="gt_row gt_right" headers="maximum_height_of_peaks">3593</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="cell_ID">50</td>
<td class="gt_row gt_right" headers="numer_of_peaks">1</td>
<td class="gt_row gt_right" headers="maximum_height_of_peaks">3151</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="e4." class="level3">
<h3 class="anchored" data-anchor-id="e4.">E4.</h3>
<p><strong>Aggregate the raster counting high points in New Zealand (created in the previous exercise), reduce its geographic resolution by half (so cells are 6 x 6 km) and plot the result.</strong></p>
<ul>
<li><p><strong>Resample the lower resolution raster back to the original resolution of 3 km. How have the results changed?</strong></p></li>
<li><p><strong>Name two advantages and disadvantages of reducing raster resolution.</strong></p></li>
</ul>
<p>The code below aggregates the raster showing the count of high points into a resolution of 6 km, using <code>terra::resample()</code> with a <code>template_raster_2</code> of resolution 6 km. The results are shown in Figure&nbsp;16.<br>
<strong>Advantages of Reducing Raster Resolution</strong></p>
<ol type="1">
<li><p>Improved Computation Efficiency: Fewer cells reduce the data size, speeding up processing and analysis.</p></li>
<li><p>Simplification: Provides a coarser overview for large-scale analysis, which may be sufficient for specific applications like regional studies.</p></li>
</ol>
<p><strong>Disadvantages of Reducing Raster Resolution</strong></p>
<ol type="1">
<li><p>Loss of Detail: Fine spatial variations and features are lost, potentially affecting precision in applications requiring high detail.</p></li>
<li><p>Accuracy Trade-Off: Aggregated data may misrepresent localized phenomena, leading to potential inaccuracies in spatial analyses.</p></li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a template raster for using in rasterization</span></span>
<span id="cb21-2">template_raster_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(</span>
<span id="cb21-3">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Spat Extent of the Vector data</span></span>
<span id="cb21-4">  terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ext</span>(above_3100),</span>
<span id="cb21-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Required resolution of the raster</span></span>
<span id="cb21-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resolution =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6000</span>,</span>
<span id="cb21-7">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># CRS for the raster</span></span>
<span id="cb21-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crs</span>(above_3100)</span>
<span id="cb21-9">)</span>
<span id="cb21-10"></span>
<span id="cb21-11"></span>
<span id="cb21-12">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elevation_raster_1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_viridis_c</span>(</span>
<span id="cb21-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb21-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb21-17">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb21-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of peaks per cell"</span>,</span>
<span id="cb21-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Raster created using rasterize(fun = `length`)"</span></span>
<span id="cb21-21">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb21-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span></span>
<span id="cb21-25">  ) </span>
<span id="cb21-26"></span>
<span id="cb21-27"></span>
<span id="cb21-28">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb21-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elevation_raster_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb21-31">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># terra::aggregate(fact = 2, fun = mean)</span></span>
<span id="cb21-32">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">resample</span>(template_raster_2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bilinear"</span>)</span>
<span id="cb21-33">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_viridis_c</span>(</span>
<span id="cb21-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb21-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb21-37">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb21-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Aggregated raster (res = 6 km)"</span>,</span>
<span id="cb21-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Using resample(method = `bilinear`)"</span></span>
<span id="cb21-41">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb21-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span></span>
<span id="cb21-45">  )</span>
<span id="cb21-46"></span>
<span id="cb21-47">g3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb21-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elevation_raster_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb21-50">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">resample</span>(template_raster_2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bilinear"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb21-51">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">resample</span>(template_raster, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bilinear"</span>)</span>
<span id="cb21-52">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_viridis_c</span>(</span>
<span id="cb21-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb21-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb21-56">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb21-58">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Disaggregated raster (res = 3 km)"</span>,</span>
<span id="cb21-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reverting back to high res. leads to loss of data"</span></span>
<span id="cb21-60">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-61">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-62">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb21-63">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span></span>
<span id="cb21-64">  )</span>
<span id="cb21-65"></span>
<span id="cb21-66">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-67">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-68">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb21-69">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_levels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>,</span>
<span id="cb21-70">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_prefix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"("</span>,</span>
<span id="cb21-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_suffix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span></span>
<span id="cb21-72">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb21-73">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb21-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.tag =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb21-75">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>,</span>
<span id="cb21-76">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb21-77">    )</span>
<span id="cb21-78">  )</span>
<span id="cb21-79"></span>
<span id="cb21-80"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb21-81">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>,</span>
<span id="cb21-82">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6-e4.png"</span>),</span>
<span id="cb21-83">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">800</span>,</span>
<span id="cb21-84">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1800</span>,</span>
<span id="cb21-85">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span></span>
<span id="cb21-86">)</span></code></pre></div>
</details>
</div>
<div id="fig-e4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-e4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter6-e4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="Figure&nbsp;16: Figures showing the (a) Original raster of resolution 3 km, showing number of peaks above 3100 meters in each cell, (b) The raster aggregated to resolution of 6 km, (c) The same aggregted raster disaggregated back to resolution of 3 km, with considerable loss of information and data."><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter6-e4.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-e4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16: Figures showing the (a) Original raster of resolution 3 km, showing number of peaks above 3100 meters in each cell, (b) The raster aggregated to resolution of 6 km, (c) The same aggregted raster disaggregated back to resolution of 3 km, with considerable loss of information and data.
</figcaption>
</figure>
</div>
</section>
<section id="e5." class="level3">
<h3 class="anchored" data-anchor-id="e5.">E5.</h3>
<p><strong>Polygonize the <code>grain</code> dataset and filter all squares representing clay.</strong></p>
<ul>
<li><p><strong>Name two advantages and disadvantages of vector data over raster data.</strong></p></li>
<li><p><strong>When would it be useful to convert rasters to vectors in your work?</strong></p></li>
</ul>
<p>The code chunks below show the polygonization, and filtered data of all squares representing clay (using <code>as.polygon(aggregate = FALSE)</code>). The Figure&nbsp;17 shows the <code>grain</code> dataset and the polygonized <code>grain_sf</code> where each row represents a &lt;POLYGON&gt; (aggregated).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1">grain <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/grain.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spData"</span>))</span>
<span id="cb22-2"></span>
<span id="cb22-3">grain <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb22-4">  terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.polygons</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">aggregate =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb22-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb22-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_cast</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"POLYGON"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb22-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(grain <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"clay"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 10 features and 1 field
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: -1.5 ymin: -1.5 xmax: 1 ymax: 1.5
Geodetic CRS:  WGS 84
   grain                       geometry
1   clay POLYGON ((-1 1, -1 1.5, -0....
2   clay POLYGON ((-1.5 0.5, -1.5 1,...
3   clay POLYGON ((-0.5 0.5, -0.5 1,...
4   clay POLYGON ((0 0.5, 0 1, 0.5 1...
5   clay POLYGON ((-1.5 0, -1.5 0.5,...
6   clay POLYGON ((0 0, 0 0.5, 0.5 0...
7   clay POLYGON ((0.5 0, 0.5 0.5, 1...
8   clay POLYGON ((-1.5 -0.5, -1.5 0...
9   clay POLYGON ((-1 -0.5, -1 0, -0...
10  clay POLYGON ((0.5 -1.5, 0.5 -1,...</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1">grain <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/grain.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spData"</span>))</span>
<span id="cb24-2"></span>
<span id="cb24-3">grain_sf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> grain <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-4">  terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.polygons</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb24-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_cast</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"POLYGON"</span>)</span>
<span id="cb24-7"></span>
<span id="cb24-8">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> grain) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_princess_d</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb24-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Base raster; Qualitative"</span>,</span>
<span id="cb24-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"With three discrete values"</span>,</span>
<span id="cb24-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb24-15">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>)</span>
<span id="cb24-19"></span>
<span id="cb24-20">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb24-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> grain_sf,</span>
<span id="cb24-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> grain),</span>
<span id="cb24-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>,</span>
<span id="cb24-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb24-26">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_princess_d</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb24-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Vectorized as aggregated polygons"</span>,</span>
<span id="cb24-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"terra::as.polygons() |&gt; st_as_sf() |&gt; st_cast(`POLYGON`)"</span>,</span>
<span id="cb24-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb24-32">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>)</span>
<span id="cb24-36"></span>
<span id="cb24-37">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb24-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_levels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>,</span>
<span id="cb24-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_prefix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"("</span>,</span>
<span id="cb24-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_suffix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span></span>
<span id="cb24-43">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb24-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb24-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.tag =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb24-46">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>,</span>
<span id="cb24-47">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb24-48">    )</span>
<span id="cb24-49">  )</span>
<span id="cb24-50"></span>
<span id="cb24-51"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb24-52">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>,</span>
<span id="cb24-53">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter6-e5.png"</span>),</span>
<span id="cb24-54">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">800</span>,</span>
<span id="cb24-55">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1700</span>,</span>
<span id="cb24-56">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span></span>
<span id="cb24-57">)</span></code></pre></div>
</details>
</div>
<div id="fig-e5" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-e5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter6-e5.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17" title="Figure&nbsp;17: Figure showing the (a) raster data for `grain`, and (b) the polygonized data with as.polygons(aggregate = FALSE)"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter6-e5.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-e5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17: Figure showing the (a) raster data for `grain`, and (b) the polygonized data with <code>as.polygons(aggregate = FALSE)</code>
</figcaption>
</figure>
</div>
<p><strong>Advantages of Vector Data Over Raster Data</strong></p>
<ol type="1">
<li>Precision in Representation: Vector data precisely represents geographic features such as points, lines, and polygons. It is ideal for applications requiring exact boundaries (e.g., property lines, administrative borders).</li>
<li>Efficient Storage for Sparse Data: Vectors store only the coordinates of features, making them more efficient for sparse or irregularly distributed data compared to rasters, which store values for all cells, even those with no data.</li>
</ol>
<p><strong>Disadvantages of Vector Data Over Raster Data</strong></p>
<ol type="1">
<li>Complex Analysis: Performing spatial operations (e.g., overlay, buffering) is computationally more complex with vectors, especially with large datasets.</li>
<li>Inefficient for Continuous Data: Vector data struggles to efficiently represent continuous phenomena (e.g., elevation, temperature) that vary over space, for which raster data is better suited.</li>
</ol>
<p><strong>When to Convert Rasters to Vectors in Your Work</strong></p>
<ol type="1">
<li><p>Feature Extraction: If you need to delineate specific features (e.g., contours from a Digital Elevation Model (DEM) or boundaries of high-value areas), converting a raster to vector allows for precise representation and further analysis.</p></li>
<li><p>Integration with Vector Data: For projects requiring alignment or combination with existing vector datasets (e.g., administrative boundaries or transportation networks), converting rasters to vectors ensures compatibility.</p></li>
<li><p>Visual Clarity in Maps: Vectors are preferred for creating clear and professional maps where discrete features need labeling or editing.</p></li>
<li><p>Custom Analysis: If detailed geometric operations like buffering or intersection analysis are needed, converting rasters into vectors (e.g., polygons of land cover classes) enables such workflows.</p></li>
</ol>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-terra" class="csl-entry">
Hijmans, Robert J. 2024. <span>“Terra: Spatial Data Analysis.”</span> <a href="https://CRAN.R-project.org/package=terra">https://CRAN.R-project.org/package=terra</a>.
</div>
<div id="ref-sf-4" class="csl-entry">
Pebesma, Edzer, and Roger Bivand. 2023. <span>“<span></span>Spatial Data Science: With Applications in r<span></span>.”</span> <a href="https://doi.org/10.1201/9780429459016">https://doi.org/10.1201/9780429459016</a>.
</div>
<div id="ref-smoothr-3" class="csl-entry">
Strimas-Mackey, Matthew. 2023. <span>“Smoothr: Smooth and Tidy Spatial Features.”</span> <a href="https://CRAN.R-project.org/package=smoothr">https://CRAN.R-project.org/package=smoothr</a>.
</div>
</div></section></div> ]]></description>
  <category>Geocomputation with R</category>
  <category>Textbook Solutions</category>
  <guid>https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter6.html</guid>
  <pubDate>Thu, 26 Dec 2024 18:30:00 GMT</pubDate>
</item>
<item>
  <title>Chapter 5: Geometry operations</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter5.html</link>
  <description><![CDATA[ 




<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sf)        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simple Features in R</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(terra)     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handling rasters in R</span></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyterra) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># For plotting rasters in ggplot2</span></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magrittr)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Using pipes with raster objects</span></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All things tidy; Data Wrangling</span></span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(spData)    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Spatial Datasets</span></span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(patchwork) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composing plots</span></span></code></pre></div>
</details>
</div>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">5.1 Introduction</h2>
<ul>
<li>Previous chapters introduced geographic datasets’ structure (Chapter 2), attribute-based manipulation (Chapter 3), and spatial relations (Chapter 4).</li>
<li>Focus of this chapter: Manipulating geographic elements of spatial objects.
<ul>
<li>Examples: Creating buffers, simplifying/converting vector geometries, and raster aggregation/resampling.</li>
</ul></li>
<li>Section 5.2: Transforming vector geometries using:
<ul>
<li><strong>Unary operations:</strong> Simplifications, buffers, centroids, and affine transformations (Sections 5.2.1–5.2.4).</li>
<li><strong>Binary operations:</strong> Modifying geometries through clipping and unions (Sections 5.2.5–5.2.7).</li>
<li><strong>Type transformations:</strong> Converting geometry types, e.g., polygons to lines (Section 5.2.8).</li>
</ul></li>
<li>Section 5.3: Raster transformations:
<ul>
<li>Alter pixel size, resolution, extent, and origin.</li>
<li>Align raster datasets for map algebra.</li>
</ul></li>
</ul>
</section>
<section id="geometric-operations-on-vector-data" class="level2">
<h2 class="anchored" data-anchor-id="geometric-operations-on-vector-data">5.2 Geometric operations on vector data</h2>
<ul>
<li>Focus: Operations that modify the geometry of vector (<code>sf</code>) objects.</li>
<li>Key distinction: Works directly on geometry-level objects of class <code>sfc</code>, in addition to <code>sf</code> objects.</li>
<li>Examples: Drilling into geometry to transform, simplify, or reshape vector data.</li>
</ul>
<section id="simplification" class="level3">
<h3 class="anchored" data-anchor-id="simplification">5.2.1 Simplification</h3>
<ul>
<li>Generalizes vector geometries (lines/polygons) for smaller scale maps, reducing memory, disk space, and bandwidth usage. Useful for publishing interactive maps by simplifying complex geometries.</li>
<li><strong>Key Functions and Algorithms</strong>:
<ul>
<li><code>st_simplify()</code> from the <a href="https://r-spatial.github.io/sf/">sf package</a> <span class="citation" data-cites="sf-3">(Pebesma and Bivand 2023)</span>:
<ul>
<li><p>Implements the Douglas-Peucker algorithm (<a href="https://doi.org/10.3138/FM57-6770-U75U-7727">Douglas and Peucker 1973</a>).</p></li>
<li><p>Controlled by <code>dTolerance</code> (generalization level in metres, or map units).</p></li>
<li><p>Simplifies individual geometries but does <strong>not preserve topology</strong>, leading to overlaps or holes.</p></li>
</ul></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>topology (noun): the way in which parts of something are organized, arranged or connected</p>
</div>
</div>
<ul>
<li><code>ms_simplify()</code> from the <a href="https://github.com/ateucher/rmapshaper">rmapshaper package</a> <span class="citation" data-cites="rmapshaper">(Teucher and Russell 2023)</span>:
<ul>
<li>Uses the Visvalingam algorithm (<a href="https://doi.org/10.3138/FM57-6770-U75U-7727">Visvalingam and Whyatt 1993</a>).</li>
<li>Retains topology by default (<code>keep_shapes = TRUE</code>) and allows fine control over the vertex retention (<code>keep</code>: the % of vertices that are to be retained, given as a proportion).</li>
</ul></li>
<li><code>smooth()</code> from the <a href="https://cran.r-project.org/package=smoothr">smoothr package</a>:
<ul>
<li>Smooths edges using techniques like Gaussian kernel regression, Chaikin’s algorithm, or spline interpolation.</li>
<li>Does not reduce vertex count and does not preserve topology.</li>
<li>Key parameter: <code>smoothness</code> (controls Gaussian bandwidth).</li>
</ul></li>
<li>Examples of Simplification are shown in Figure&nbsp;1</li>
<li><strong>Applications of Smoothing</strong>:
<ul>
<li>Suitable for geometries derived from raster vectorization (e.g., Chapter 6).</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Download India's Official states' map from</span></span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://github.com/Aditya-Dahiya/projects_presentations/tree/main/data/india_map</span></span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#### Base Map</span></span>
<span id="cb2-5">india_states <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_sf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"India_State_Boundary.shp"</span>)</span>
<span id="cb2-6"></span>
<span id="cb2-7">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> india_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb2-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Base Map of India: in full detail"</span>,</span>
<span id="cb2-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Source: Census of India"</span></span>
<span id="cb2-14">  )</span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb2-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>,</span>
<span id="cb2-18">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ch5-2-1_1.png"</span>),</span>
<span id="cb2-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb2-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1600</span>,</span>
<span id="cb2-21">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1200</span>,</span>
<span id="cb2-22">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span></span>
<span id="cb2-23">)</span>
<span id="cb2-24"></span>
<span id="cb2-25"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#### st_simplify()</span></span>
<span id="cb2-26">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> india_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_simplify</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dTolerance =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span>    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 100 km tolerance</span></span>
<span id="cb2-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb2-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"India: st_simplify(dTolerance = 100000)"</span>,</span>
<span id="cb2-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Douglas-Peucker algorithm. Topology is lost."</span></span>
<span id="cb2-34">  )</span>
<span id="cb2-35"></span>
<span id="cb2-36"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb2-37">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>,</span>
<span id="cb2-38">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ch5-2-1_2.png"</span>),</span>
<span id="cb2-39">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb2-40">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1600</span>,</span>
<span id="cb2-41">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1200</span>,</span>
<span id="cb2-42">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span></span>
<span id="cb2-43">)</span>
<span id="cb2-44"></span>
<span id="cb2-45"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#### rmapshaper::ms_simplify()</span></span>
<span id="cb2-46">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> india_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-47">  rmapshaper<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ms_simplify</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">keep =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0001</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">keep_shapes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span>    </span>
<span id="cb2-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb2-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"India: rmapshaper::ms_simplify(keep_shapes = TRUE)"</span>,</span>
<span id="cb2-53">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Visvalingam algorithm. Topology is retained."</span></span>
<span id="cb2-54">  )</span>
<span id="cb2-55"></span>
<span id="cb2-56"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb2-57">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>,</span>
<span id="cb2-58">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ch5-2-1_3.png"</span>),</span>
<span id="cb2-59">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb2-60">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1600</span>,</span>
<span id="cb2-61">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1200</span>,</span>
<span id="cb2-62">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span></span>
<span id="cb2-63">)</span>
<span id="cb2-64"></span>
<span id="cb2-65"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#### smoothr::smooth() - 3 methods</span></span>
<span id="cb2-66">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> india_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-67">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_simplify</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dTolerance =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># To save computing time</span></span>
<span id="cb2-68">  smoothr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ksmooth"</span>,</span>
<span id="cb2-69">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">smoothness =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span>    </span>
<span id="cb2-70">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-71">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-72">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-73">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb2-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"smoothr::smooth(method = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">ksmooth</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">)"</span>,</span>
<span id="cb2-75">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gaussian kernel regression. Topology is lost."</span></span>
<span id="cb2-76">  )</span>
<span id="cb2-77"></span>
<span id="cb2-78"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb2-79">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>,</span>
<span id="cb2-80">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ch5-2-1_4.png"</span>),</span>
<span id="cb2-81">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb2-82">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1600</span>,</span>
<span id="cb2-83">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1200</span>,</span>
<span id="cb2-84">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span></span>
<span id="cb2-85">)</span>
<span id="cb2-86"></span>
<span id="cb2-87">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> india_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-88">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_simplify</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dTolerance =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># To save computing time</span></span>
<span id="cb2-89">  smoothr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chaikin"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span>    </span>
<span id="cb2-90">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-91">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-92">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-93">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb2-94">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"smoothr::smooth(method = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">chaikin</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">)"</span>,</span>
<span id="cb2-95">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Chaikin’s corner cutting algorithm. Topology is lost."</span></span>
<span id="cb2-96">  )</span>
<span id="cb2-97"></span>
<span id="cb2-98"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb2-99">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>,</span>
<span id="cb2-100">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ch5-2-1_5.png"</span>),</span>
<span id="cb2-101">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb2-102">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1600</span>,</span>
<span id="cb2-103">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1200</span>,</span>
<span id="cb2-104">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span></span>
<span id="cb2-105">)</span>
<span id="cb2-106"></span>
<span id="cb2-107">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> india_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-108">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_simplify</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dTolerance =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># To save computing time</span></span>
<span id="cb2-109">  smoothr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spline"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span>    </span>
<span id="cb2-110">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-111">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-112">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-113">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb2-114">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"smoothr::smooth(method = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">spline</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">)"</span>,</span>
<span id="cb2-115">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Spline interpolation. Topology is lost."</span></span>
<span id="cb2-116">  )</span>
<span id="cb2-117"></span>
<span id="cb2-118"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb2-119">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>,</span>
<span id="cb2-120">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ch5-2-1_6.png"</span>),</span>
<span id="cb2-121">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb2-122">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1600</span>,</span>
<span id="cb2-123">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1200</span>,</span>
<span id="cb2-124">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span></span>
<span id="cb2-125">)</span></code></pre></div>
</details>
</div>
<div id="fig-simplified" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-simplified-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/ch5-2-1_1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Official Map of India (full details)"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/ch5-2-1_1.png" class="img-fluid figure-img"></a></p>
<figcaption>Official Map of India (full details)</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/ch5-2-1_2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Using st_simplify(dTolerance = 100000), i.e.&nbsp;100 km resolution"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/ch5-2-1_2.png" class="img-fluid figure-img"></a></p>
<figcaption>Using st_simplify(dTolerance = 100000), i.e.&nbsp;100 km resolution</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/ch5-2-1_3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Using rmapshaper::ms_simplify(keep_shape = TRUE) to retain topology"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/ch5-2-1_3.png" class="img-fluid figure-img"></a></p>
<figcaption>Using rmapshaper::ms_simplify(keep_shape = TRUE) to retain topology</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/ch5-2-1_4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Using gaussian kernel regression with smoothr::smooth(method = “ksmooth”)"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/ch5-2-1_4.png" class="img-fluid figure-img"></a></p>
<figcaption>Using gaussian kernel regression with smoothr::smooth(method = “ksmooth”)</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/ch5-2-1_5.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Using Chalkin’s corner cutting algorithm with smoothr::smooth(method = “chalkin”)"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/ch5-2-1_5.png" class="img-fluid figure-img"></a></p>
<figcaption>Using Chalkin’s corner cutting algorithm with smoothr::smooth(method = “chalkin”)</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/ch5-2-1_6.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Using spline interpolation with smoothr::smooth(method = “spline”)"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/ch5-2-1_6.png" class="img-fluid figure-img"></a></p>
<figcaption>Using spline interpolation with smoothr::smooth(method = “spline”)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-simplified-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1
</figcaption>
</figure>
</div>
<section id="smoothr" class="level4">
<h4 class="anchored" data-anchor-id="smoothr"><code>smoothr</code></h4>
<p>A short note on the <strong>{smoothr}</strong> package <span class="citation" data-cites="smoothr-2">(Strimas-Mackey 2023)</span>, which uses three different types of algorithms:-.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sf)</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(smoothr)</span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Smooth polygons using different methods</span></span>
<span id="cb3-6">p_smooth_chaikin <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">smooth</span>(jagged_polygons, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chaikin"</span>)</span>
<span id="cb3-7">p_smooth_ksmooth <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">smooth</span>(jagged_polygons, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ksmooth"</span>)</span>
<span id="cb3-8">p_smooth_spline <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">smooth</span>(jagged_polygons, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spline"</span>)</span>
<span id="cb3-9"></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combine data for plotting</span></span>
<span id="cb3-11">plot_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_rows</span>(</span>
<span id="cb3-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>(p_smooth_chaikin), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chaikin"</span>),</span>
<span id="cb3-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>(p_smooth_ksmooth), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ksmooth"</span>),</span>
<span id="cb3-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>(p_smooth_spline), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spline"</span>),</span>
<span id="cb3-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>(jagged_polygons), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"original"</span>)</span>
<span id="cb3-16">)</span>
<span id="cb3-17"></span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Assign colors to methods</span></span>
<span id="cb3-19">method_colors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb3-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">chaikin =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E41A1C"</span>,</span>
<span id="cb3-21">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ksmooth =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#4DAF4A"</span>,</span>
<span id="cb3-22">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">spline =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#377EB8"</span></span>
<span id="cb3-23">)</span>
<span id="cb3-24"></span>
<span id="cb3-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert geometry for plotting</span></span>
<span id="cb3-26">plot_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plot_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sfc</span>(geometry)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>()</span>
<span id="cb3-29"></span>
<span id="cb3-30">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plot_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(method <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"original"</span>)</span>
<span id="cb3-32"></span>
<span id="cb3-33">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plot_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(method <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"original"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>method)</span>
<span id="cb3-36"></span>
<span id="cb3-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot with ggplot2</span></span>
<span id="cb3-38">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> p2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> geometry, </span>
<span id="cb3-40">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> method),</span>
<span id="cb3-41">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>,</span>
<span id="cb3-42">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb3-43">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb3-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> p1,</span>
<span id="cb3-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey50"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>),</span>
<span id="cb3-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb3-48">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> method_colors) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> method) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb3-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb3-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb3-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb3-57">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-58">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb3-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Simplification with {smoothr}"</span>,</span>
<span id="cb3-60">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Method"</span></span>
<span id="cb3-61">  )</span>
<span id="cb3-62"></span>
<span id="cb3-63"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb3-64">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>,</span>
<span id="cb3-65">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ch5-2-1_7.png"</span>),</span>
<span id="cb3-66">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb3-67">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>,</span>
<span id="cb3-68">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1200</span>,</span>
<span id="cb3-69">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span></span>
<span id="cb3-70">)</span></code></pre></div>
</details>
</div>
<p><a href="images/ch5-2-1_7.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/ch5-2-1_7.png" class="img-fluid"></a></p>
</div>
</div>
</section>
</section>
<section id="centroids" class="level3">
<h3 class="anchored" data-anchor-id="centroids">5.2.2 Centroids</h3>
<ul>
<li><p>Identify the center of geographic objects, creating single-point representations of complex geometries using <code>st_centroid()</code></p></li>
<li><p><strong>Types of Centroids</strong>: (shown in Figure&nbsp;2)</p>
<ol type="1">
<li><strong>Geographic Centroid</strong> (center of mass):
<ul>
<li>Balances a spatial object (like balancing a plate).</li>
<li>Useful for creating simple point representations or estimating distances between polygons.</li>
<li>Calculated with <code>st_centroid()</code> from the <a href="https://r-spatial.github.io/sf/">sf package</a>.</li>
<li>Limitation: Centroids may fall outside the object (e.g., doughnut-shaped polygons).</li>
</ul></li>
<li><strong>Point on Surface</strong>:
<ul>
<li>Ensures the point lies <strong>within</strong> the object boundaries.</li>
<li>Useful for labeling irregular polygons, such as islands or multipolygon geometries.</li>
<li>Calculated with <code>st_point_on_surface()</code>.</li>
</ul></li>
</ol></li>
<li><p><strong>Other Centroid Types</strong>: Chebyshev center and visual center</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Extra Condensed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>)</span>
<span id="cb4-2">showtext<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb4-3"></span>
<span id="cb4-4">ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(</span>
<span id="cb4-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb4-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>,</span>
<span id="cb4-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb4-8">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb4-10">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-11">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb4-12">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb4-13">      ),</span>
<span id="cb4-14">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span></span>
<span id="cb4-15">    )</span>
<span id="cb4-16">)</span>
<span id="cb4-17"></span>
<span id="cb4-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Focussing on the Island Chains of India</span></span>
<span id="cb4-19">andaman <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> india_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(</span>
<span id="cb4-21">    State_Name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Andaman &amp; Nicobar"</span></span>
<span id="cb4-22">  )</span>
<span id="cb4-23">  </span>
<span id="cb4-24">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(andaman) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb4-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Base Map"</span>,</span>
<span id="cb4-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Andaman &amp; Nicobar</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Islands (India)"</span></span>
<span id="cb4-29">  )</span>
<span id="cb4-30"></span>
<span id="cb4-31">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb4-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> andaman</span>
<span id="cb4-34">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb4-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_centroid</span>(andaman),</span>
<span id="cb4-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>,</span>
<span id="cb4-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, </span>
<span id="cb4-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stroke =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb4-41">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb4-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"st_centroid()"</span>,</span>
<span id="cb4-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Andaman &amp; Nicobar</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Islands (India)"</span></span>
<span id="cb4-45">  )</span>
<span id="cb4-46"></span>
<span id="cb4-47">g3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb4-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> andaman</span>
<span id="cb4-50">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb4-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_centroid</span>(andaman, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">of_largest_polygon =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb4-53">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>,</span>
<span id="cb4-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, </span>
<span id="cb4-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stroke =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb4-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb4-58">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb4-60">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"st_centroid</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(of_largest_polygon = TRUE)"</span>,</span>
<span id="cb4-61">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Andaman &amp; Nicobar</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Islands (India)"</span></span>
<span id="cb4-62">  )</span>
<span id="cb4-63"></span>
<span id="cb4-64">g4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-65">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb4-66">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> andaman</span>
<span id="cb4-67">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-68">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb4-69">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_point_on_surface</span>(andaman),</span>
<span id="cb4-70">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>,</span>
<span id="cb4-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, </span>
<span id="cb4-72">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stroke =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb4-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb4-75">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-76">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb4-77">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"st_point_on_surface()"</span>,</span>
<span id="cb4-78">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Andaman &amp; Nicobar</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Islands (India)"</span></span>
<span id="cb4-79">  )</span>
<span id="cb4-80"></span>
<span id="cb4-81"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb4-82">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb4-83">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb4-84">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter5-2-2_1.png"</span>),</span>
<span id="cb4-85">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> patchwork<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wrap_plots</span>(g1, g2, g3, g4, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb4-86">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1900</span>,</span>
<span id="cb4-87">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2400</span>,</span>
<span id="cb4-88">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span></span>
<span id="cb4-89">)</span></code></pre></div>
</details>
</div>
<div id="fig-5-2-2-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-5-2-2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter5-2-2_1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;2: Various centroids using st_centroid() and st_point_on_surface()"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter5-2-2_1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-5-2-2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Various centroids using st_centroid() and st_point_on_surface()
</figcaption>
</figure>
</div>
</section>
<section id="buffers" class="level3">
<h3 class="anchored" data-anchor-id="buffers">5.2.3 Buffers</h3>
<ul>
<li>Buffers are <strong>polygons</strong> representing areas within a specified distance from a geometric feature (point, line, or polygon).</li>
<li><strong>Purpose</strong>: Used for geographic <strong>data analysis</strong> (not just visualization). Examples:
<ul>
<li>How many points are within a given distance of a line?</li>
<li>Which demographic groups are within travel range of a new shop?</li>
</ul></li>
<li><strong><code>st_buffer()</code></strong> from the <a href="https://r-spatial.github.io/sf/">sf package</a>. Example Visualization is shown in Figure&nbsp;3
<ul>
<li><strong>Input</strong>: Geometry and <code>dist</code> (distance in CRS units, e.g., meters).</li>
<li><strong>Output</strong>: <strong>One buffer polygon per geometry feature.</strong></li>
</ul></li>
<li><strong>Other Key Arguments in <code>st_buffer()</code></strong>:
<ul>
<li><strong><code>nQuadSegs</code></strong> (GEOS engine):
<ul>
<li>Number of segments per quadrant (default: 30).</li>
<li>Adjust: Decrease for memory concerns, or increase for high resolution output.</li>
</ul></li>
<li><strong><code>max_cells</code></strong> (S2 engine):
<ul>
<li>Higher values create smoother buffers (slower computation).</li>
</ul></li>
<li><strong><code>endCapStyle</code> and <code>joinStyle</code></strong> (GEOS engine):
<ul>
<li>Control buffer edge appearance (useful for lines).</li>
</ul></li>
<li><strong><code>singleSide</code></strong> (GEOS engine):
<ul>
<li>Buffer on one or both sides of the geometry.</li>
</ul></li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">a1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> andaman <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_cast</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"POLYGON"</span>)</span>
<span id="cb5-3"></span>
<span id="cb5-4">a2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_buffer</span>(a1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_factor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>()))</span>
<span id="cb5-6"></span>
<span id="cb5-7">a3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_buffer</span>(a1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nQuadSegs =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_factor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>()))</span>
<span id="cb5-9"></span>
<span id="cb5-10">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> a1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb5-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Base Map with</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">st_cast(</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">POLYGON</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">)"</span>,</span>
<span id="cb5-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nicobar Islands"</span></span>
<span id="cb5-15">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb5-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9.5</span>),</span>
<span id="cb5-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span></span>
<span id="cb5-19">  )</span>
<span id="cb5-20"></span>
<span id="cb5-21">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb5-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> a2,</span>
<span id="cb5-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> id),</span>
<span id="cb5-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb5-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb5-27">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb5-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> a1</span>
<span id="cb5-30">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb5-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"With 20 km buffer</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> around each island"</span>,</span>
<span id="cb5-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nicobar Islands; each</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">buffer in separate colour"</span></span>
<span id="cb5-34">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb5-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9.5</span>),</span>
<span id="cb5-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span></span>
<span id="cb5-39">  )</span>
<span id="cb5-40"></span>
<span id="cb5-41"></span>
<span id="cb5-42">g3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb5-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> a3,</span>
<span id="cb5-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> id),</span>
<span id="cb5-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb5-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb5-48">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb5-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> a1</span>
<span id="cb5-51">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb5-53">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"With 20 km buffer</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> around each island"</span>,</span>
<span id="cb5-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nicobar Islands;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">arugment (nQuadSegs = 1)"</span></span>
<span id="cb5-55">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb5-58">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9.5</span>),</span>
<span id="cb5-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span></span>
<span id="cb5-60">  )</span>
<span id="cb5-61"></span>
<span id="cb5-62"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb5-63">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb5-64">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb5-65">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter5-2-3_1.png"</span>),</span>
<span id="cb5-66">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> patchwork<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wrap_plots</span>(g1, g2, g3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb5-67">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1200</span>,</span>
<span id="cb5-68">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>,</span>
<span id="cb5-69">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span></span>
<span id="cb5-70">)</span></code></pre></div>
</details>
</div>
<div id="fig-5-2-3-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-5-2-3-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter5-2-3_1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Figure&nbsp;3: Use of st_buffer()"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter5-2-3_1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-5-2-3-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Use of st_buffer()
</figcaption>
</figure>
</div>
</section>
<section id="affine-transformations" class="level3">
<h3 class="anchored" data-anchor-id="affine-transformations">5.2.4 Affine Transformations</h3>
<ul>
<li>Definition: Transformations that preserve <strong>lines and parallelism</strong> but not necessarily angles or lengths.</li>
<li><strong>Types of Affine Transformations</strong>:
<ol type="1">
<li><p><strong>Shifting (Translation)</strong>: Moves every point by a constant distance.</p>
<ul>
<li><p>Example: Adding a vector to shift all <strong>y-coordinates</strong> north by 400 km distance while keeping <strong>x-coordinates</strong> unchanged using:</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">n_shift <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> n1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400000</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_set_crs</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(n1))</span></code></pre></div></li>
<li><p><em>Note: This converts the CRS of the new sfc object to <code>NA</code> and thus needs <code>st_set_crs()</code> to return it back to the original CRS.</em></p></li>
</ul></li>
<li><p><strong>Scaling</strong>: Enlarges or shrinks geometries.</p>
<ul>
<li><strong>Global Scaling</strong>:
<ul>
<li>Multiplies all coordinates relative to the origin, preserving <strong>topological relations</strong>.</li>
</ul></li>
<li><strong>Local Scaling</strong>:
<ul>
<li><p>Scales geometries around specific points (e.g., centroids).</p></li>
<li><p>Steps:</p>
<ol type="1">
<li>Shift geometries so the centroid becomes (0,0).</li>
<li>Scale by a factor.</li>
<li>Shift back to original centroid coordinates.</li>
</ol></li>
</ul></li>
</ul></li>
<li><p><strong>Rotation</strong>: Rotates coordinates using a <strong>rotation matrix</strong>.</p>
<ul>
<li>Rotation matrix: Define a function to create the rotation matrix and apply it to the geometry. R=[cosθ/sinθ​ − sinθ/cosθ​]</li>
</ul></li>
</ol></li>
<li><strong>Replacing Old Geometry</strong>: Once the affine transformation has been completed, use <code>st_set_geometry()</code> from the <a href="https://r-spatial.github.io/sf/">sf package</a> to finally Replace original geometry with scaled versions (shifted, rotated or scaled)</li>
<li><strong>Applications</strong>:
<ul>
<li>Shifting: For <strong>label placement</strong>.</li>
<li>Scaling: In non-contiguous cartograms.</li>
<li>Rotation: Correcting distorted geometries during re-projection.</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Extra Condensed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>)</span>
<span id="cb7-2">showtext<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb7-3"></span>
<span id="cb7-4">ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(</span>
<span id="cb7-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb7-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>,</span>
<span id="cb7-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb7-8">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb7-10">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb7-11">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb7-12">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb7-13">      ),</span>
<span id="cb7-14">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb7-15">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb7-16">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb7-17">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb7-18">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span></span>
<span id="cb7-19">      )</span>
<span id="cb7-20">    )</span>
<span id="cb7-21">)</span>
<span id="cb7-22"></span>
<span id="cb7-23">df1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> andaman <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_cast</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"POLYGON"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb7-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb7-29">      id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nicobar Islands"</span>,</span>
<span id="cb7-30">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.default =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Andaman Islands"</span></span>
<span id="cb7-31">    )</span>
<span id="cb7-32">  )</span>
<span id="cb7-33"></span>
<span id="cb7-34"></span>
<span id="cb7-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pull out only sfc class (i.e. geometry for Andaman Islands)</span></span>
<span id="cb7-36">a1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Andaman Islands"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_geometry</span>()</span>
<span id="cb7-39"></span>
<span id="cb7-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pull out only sfc class (i.e. geometry for Nicobar Islands)</span></span>
<span id="cb7-41">n1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nicobar Islands"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_geometry</span>()</span>
<span id="cb7-44"></span>
<span id="cb7-45"></span>
<span id="cb7-46">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> name)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> id)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb7-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">13.5</span>),</span>
<span id="cb7-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span></span>
<span id="cb7-53">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb7-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Base Map"</span>,</span>
<span id="cb7-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10 Largest Islands amongst</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Andamand and Nicobar Island chain"</span>,</span>
<span id="cb7-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb7-58">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#89973DFF"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E8B92FFF"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-60">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb7-61">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left"</span></span>
<span id="cb7-62">  )</span>
<span id="cb7-63"></span>
<span id="cb7-64">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-65">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> a1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#89973DFF"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-66">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> n1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E8B92FFF"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-67">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb7-68">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">13.5</span>),</span>
<span id="cb7-69">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span></span>
<span id="cb7-70">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb7-71">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb7-72">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Plotting as separate</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">sfc objects"</span>,</span>
<span id="cb7-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10 Largest Islands"</span></span>
<span id="cb7-74">  )</span>
<span id="cb7-75"></span>
<span id="cb7-76"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#################### Shifting #########################</span></span>
<span id="cb7-77"></span>
<span id="cb7-78">n_shift <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> n1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-79">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400000</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-80">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_set_crs</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(n1))</span>
<span id="cb7-81"></span>
<span id="cb7-82">g3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-83">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> a1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#89973DFF"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-84">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb7-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> n_shift, </span>
<span id="cb7-86">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E8B92FFF"</span>, </span>
<span id="cb7-87">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb7-88">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-89">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb7-90">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">13.5</span>),</span>
<span id="cb7-91">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span></span>
<span id="cb7-92">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-93">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb7-94">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Shifting sfc objects"</span>,</span>
<span id="cb7-95">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bring Nicobar Islands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">closer to the Andamans"</span></span>
<span id="cb7-96">  )</span>
<span id="cb7-97"></span>
<span id="cb7-98"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#################### Scaling ##########################</span></span>
<span id="cb7-99"></span>
<span id="cb7-100">n1_centroid <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_centroid</span>(n1)</span>
<span id="cb7-101"></span>
<span id="cb7-102">n1_scale <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (n1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> n1_centroid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-103">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">multiply_by</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-104">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add</span>(n1_centroid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-105">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_set_crs</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(n1))</span>
<span id="cb7-106"></span>
<span id="cb7-107">g4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-108">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> a1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#89973DFF"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-109">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb7-110">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> n1_scale, </span>
<span id="cb7-111">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E8B92FFF"</span>, </span>
<span id="cb7-112">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb7-113">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-114">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb7-115">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">13.5</span>),</span>
<span id="cb7-116">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span></span>
<span id="cb7-117">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb7-118">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb7-119">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Scaling sfc objects"</span>,</span>
<span id="cb7-120">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Enlarging Nicobar Islands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">by 2.5 times."</span></span>
<span id="cb7-121">  )</span>
<span id="cb7-122"></span>
<span id="cb7-123"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##################### Rotation ########################</span></span>
<span id="cb7-124">rotation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(a){</span>
<span id="cb7-125">  r <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> a <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#degrees to radians</span></span>
<span id="cb7-126">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(r), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(r), <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(r), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(r)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb7-127">} </span>
<span id="cb7-128"></span>
<span id="cb7-129">n1_rotate <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (n1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> n1_centroid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-130">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">multiply_by</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rotation</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-131">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add</span>(n1_centroid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-132">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_set_crs</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(n1))</span>
<span id="cb7-133"></span>
<span id="cb7-134"></span>
<span id="cb7-135">g5 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-136">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> a1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#89973DFF"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-137">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb7-138">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> n1_rotate, </span>
<span id="cb7-139">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E8B92FFF"</span>, </span>
<span id="cb7-140">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb7-141">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-142">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb7-143">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">13.5</span>),</span>
<span id="cb7-144">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span></span>
<span id="cb7-145">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb7-146">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb7-147">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rotating sfc objects"</span>,</span>
<span id="cb7-148">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rotating Nicobar Islands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">clockwise by 90 degrees"</span></span>
<span id="cb7-149">  )</span>
<span id="cb7-150"></span>
<span id="cb7-151">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> patchwork<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wrap_plots</span>(g1, g3, g4, g5) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-152">  patchwork<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">widths =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb7-153"></span>
<span id="cb7-154"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb7-155">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb7-156">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb7-157">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter5-2-4_1.png"</span>),</span>
<span id="cb7-158">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb7-159">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1200</span>,</span>
<span id="cb7-160">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2500</span>,</span>
<span id="cb7-161">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span></span>
<span id="cb7-162">)</span></code></pre></div>
</details>
</div>
<p><a href="images/chapter5-2-4_1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter5-2-4_1.png" class="img-fluid"></a></p>
</section>
<section id="data-viz-demonstration" class="level3">
<h3 class="anchored" data-anchor-id="data-viz-demonstration">Data Viz demonstration</h3>
<p>Here’s a more visually appealing version of the same graphic, produced using complete <a href="https://aditya-dahiya.github.io/projects_presentations/data_vizs/sf_affine_transformations.html#how-i-made-this-graphic">code</a> given on <a href="https://aditya-dahiya.github.io/projects_presentations/data_vizs/sf_affine_transformations.html">this page</a>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/sf_affine_transformations.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="This plot demonstrates the application of spatial transformations on the Andaman and Nicobar Islands using the `sf` package in R. It showcases four techniques: base mapping, northward shifting, scaling (enlargement), and rotation (90° clockwise), highlighting their effects on spatial geometries. The `facet_wrap` function neatly organizes the transformations for comparison, while `geom_sf` and custom labels enhance the visualization."><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/sf_affine_transformations.png" class="img-fluid figure-img" alt="This plot demonstrates the application of spatial transformations on the Andaman and Nicobar Islands using the `sf` package in R. It showcases four techniques: base mapping, northward shifting, scaling (enlargement), and rotation (90° clockwise), highlighting their effects on spatial geometries. The `facet_wrap` function neatly organizes the transformations for comparison, while `geom_sf` and custom labels enhance the visualization."></a></p>
<figcaption>This plot demonstrates the application of spatial transformations on the Andaman and Nicobar Islands using the `sf` package in R. It showcases four techniques: base mapping, northward shifting, scaling (enlargement), and rotation (90° clockwise), highlighting their effects on spatial geometries. The `facet_wrap` function neatly organizes the transformations for comparison, while `geom_sf` and custom labels enhance the visualization.</figcaption>
</figure>
</div>
</section>
<section id="clipping" class="level3">
<h3 class="anchored" data-anchor-id="clipping">5.2.5 Clipping</h3>
<ul>
<li><p><strong>Definition</strong>: A form of spatial subsetting that modifies the geometry column of affected features. Applies to lines, polygons, and their multi equivalents (not points).</p></li>
<li><p><strong>Purpose</strong>: Identifies or extracts areas of overlap or subsets of spatial features. Commonly used in geographic data analysis to focus on regions of interest.</p></li>
<li><p><strong>Logical Operations and Spatial Equivalents</strong>. Inspired by <a href="https://r4ds.hadley.nz/logicals.html#fig-bool-ops">Figure 12.1</a> of <a href="https://r4ds.hadley.nz/"><em>R for Data Science (2e)</em></a>. Spatial equivalents to logical operators (e.g., AND, OR, NOT) allow flexible geometry subsetting (as shown in Figure&nbsp;4)</p>
<ul>
<li><p><strong>Intersection (AND)</strong>: <code>st_intersection()</code></p></li>
<li><p><strong>Union (OR)</strong>: <code>st_union()</code></p></li>
<li><p><strong>Difference (NOT)</strong>: <code>st_difference()</code></p></li>
<li><p><strong>Exclusive OR (XOR):</strong> <code>st_sym_difference()</code></p></li>
</ul></li>
<li><p><strong>Applications</strong>:</p>
<ul>
<li><p>Identifying overlapping regions.</p></li>
<li><p>Creating subsets of spatial data for specific analysis or visualization.</p></li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nova Mono"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>)</span>
<span id="cb8-2">showtext<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb8-3"></span>
<span id="cb8-4">theme_custom <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(...) {</span>
<span id="cb8-5">  ggthemes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_map</span>(</span>
<span id="cb8-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,</span>
<span id="cb8-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb8-8">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb8-10">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb8-11">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb8-13">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb8-14">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb8-15">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb8-16">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb8-17">      ),</span>
<span id="cb8-18">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb8-19">      ...</span>
<span id="cb8-20">    )</span>
<span id="cb8-21">}</span>
<span id="cb8-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the center points of the circles</span></span>
<span id="cb8-23">sf_circles <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb8-24">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>),</span>
<span id="cb8-25">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb8-26">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour_var =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"yellow"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"green"</span>),</span>
<span id="cb8-27">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label_var =</span> LETTERS[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]</span>
<span id="cb8-28">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-29">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert the points to an sf object</span></span>
<span id="cb8-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>(</span>
<span id="cb8-31">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coords =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>), </span>
<span id="cb8-32">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb8-33">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-34">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create circular geometries using st_buffer</span></span>
<span id="cb8-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_buffer</span>(geometry, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb8-36"></span>
<span id="cb8-37">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> sf_circles <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb8-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb8-40">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> label_var</span>
<span id="cb8-41">      )</span>
<span id="cb8-42">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb8-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>,</span>
<span id="cb8-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb8-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey10"</span></span>
<span id="cb8-47">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf_text</span>(</span>
<span id="cb8-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey10"</span>,</span>
<span id="cb8-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>,</span>
<span id="cb8-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>,</span>
<span id="cb8-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb8-53">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb8-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"5 overlapping circles plotted with {sf}"</span></span>
<span id="cb8-56">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb8-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>()</span>
<span id="cb8-58"></span>
<span id="cb8-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Naming the individual circles</span></span>
<span id="cb8-60"></span>
<span id="cb8-61">pull_a_circle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(ch_pick){</span>
<span id="cb8-62">  sf_circles <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-63">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(label_var <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> ch_pick)</span>
<span id="cb8-64">}</span>
<span id="cb8-65">a1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull_a_circle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>)  </span>
<span id="cb8-66">b1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull_a_circle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>)  </span>
<span id="cb8-67">c1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull_a_circle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C"</span>)  </span>
<span id="cb8-68">d1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull_a_circle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"D"</span>)  </span>
<span id="cb8-69">e1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull_a_circle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"E"</span>)  </span>
<span id="cb8-70"></span>
<span id="cb8-71">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-72">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb8-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> a1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_difference</span>(d1),</span>
<span id="cb8-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>)</span>
<span id="cb8-75">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-76">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A |&gt; st_difference(D)"</span>)</span>
<span id="cb8-77"></span>
<span id="cb8-78">g3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-79">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb8-80">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_difference</span>(a1),</span>
<span id="cb8-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>)</span>
<span id="cb8-82">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-83">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"D |&gt; st_difference(A)"</span>)</span>
<span id="cb8-84"></span>
<span id="cb8-85">g4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-86">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb8-87">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_difference</span>(a1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_difference</span>(b1),</span>
<span id="cb8-88">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>)</span>
<span id="cb8-89">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-90">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"D |&gt; st_difference(A) |&gt;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">st_difference(B)"</span>)</span>
<span id="cb8-91"></span>
<span id="cb8-92">g5 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-93">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb8-94">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> a1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_union</span>(d1),</span>
<span id="cb8-95">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>)</span>
<span id="cb8-96">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-97">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"st_union(A, D)"</span>)</span>
<span id="cb8-98"></span>
<span id="cb8-99">g6 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-100">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb8-101">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> a1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersection</span>(d1),</span>
<span id="cb8-102">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>)</span>
<span id="cb8-103">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-104">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"st_intersection(A, D)"</span>)</span>
<span id="cb8-105"></span>
<span id="cb8-106">g7 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-107">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb8-108">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sym_difference</span>(a1, d1),</span>
<span id="cb8-109">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>)</span>
<span id="cb8-110">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-111">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"st_sym_difference(A, D)"</span>)</span>
<span id="cb8-112"></span>
<span id="cb8-113">non_overlap <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> a1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-114">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sym_difference</span>(d1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-115">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sym_difference</span>(b1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-116">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sym_difference</span>(c1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-117">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sym_difference</span>(e1)</span>
<span id="cb8-118">g8 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-119">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb8-120">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> non_overlap,</span>
<span id="cb8-121">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>)</span>
<span id="cb8-122">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-123">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"An st_sym_difference() chain"</span>)</span>
<span id="cb8-124"></span>
<span id="cb8-125">overlap <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> a1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-126">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersection</span>(d1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-127">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_union</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersection</span>(d1, b1)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-128">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_union</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersection</span>(b1, e1)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-129">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_union</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersection</span>(e1, c1))</span>
<span id="cb8-130"></span>
<span id="cb8-131">g9 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-132">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb8-133">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> overlap,</span>
<span id="cb8-134">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>)</span>
<span id="cb8-135">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-136">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A st_union() and</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">st_interaction() chain"</span>)</span>
<span id="cb8-137"></span>
<span id="cb8-138">custom_layout_design <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb8-139"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  AAAAAA</span></span>
<span id="cb8-140"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  AAAAAA</span></span>
<span id="cb8-141"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  BBCCDD</span></span>
<span id="cb8-142"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  BBCCDD</span></span>
<span id="cb8-143"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  EEFFGG</span></span>
<span id="cb8-144"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  EEFFGG</span></span>
<span id="cb8-145"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  HHHIII</span></span>
<span id="cb8-146"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  HHHIII</span></span>
<span id="cb8-147"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb8-148"></span>
<span id="cb8-149">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> patchwork<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wrap_plots</span>(</span>
<span id="cb8-150">  g1, g2, g3, g4, g5, g6, g7, g8, g9</span>
<span id="cb8-151">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb8-152">  patchwork<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(</span>
<span id="cb8-153">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">design =</span> custom_layout_design</span>
<span id="cb8-154">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-155">  patchwork<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb8-156">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Clipping {sf} objects</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(Boolean Algebra examples)"</span>,</span>
<span id="cb8-157">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Using functions like st_intersection(), st_union(), st_difference()</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">&amp; st_sym_difference()"</span>,</span>
<span id="cb8-158">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb8-159">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb8-160">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb8-161">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">54</span>, </span>
<span id="cb8-162">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb8-163">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb8-164">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb8-165">      ),</span>
<span id="cb8-166">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb8-167">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb8-168">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, </span>
<span id="cb8-169">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb8-170">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb8-171">      )</span>
<span id="cb8-172">    )</span>
<span id="cb8-173">  )</span>
<span id="cb8-174"></span>
<span id="cb8-175"></span>
<span id="cb8-176"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb8-177">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb8-178">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb8-179">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter5-2-5_1.png"</span>),</span>
<span id="cb8-180">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb8-181">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>,</span>
<span id="cb8-182">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1600</span>,</span>
<span id="cb8-183">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb8-184">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb8-185">)</span></code></pre></div>
</details>
</div>
<div id="fig-5-2-5" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-5-2-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter5-2-5_1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Figure&nbsp;4: Various methods and examples (inspired by Boolean Algebra) for clipping {sf} objects in R"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter5-2-5_1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-5-2-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Various methods and examples (inspired by Boolean Algebra) for clipping {sf} objects in R
</figcaption>
</figure>
</div>
</section>
<section id="sub-setting-and-clipping" class="level3">
<h3 class="anchored" data-anchor-id="sub-setting-and-clipping">5.2.6 Sub-setting and Clipping</h3>
<ul>
<li><strong>Clipping</strong>: Modifies geometry to match a subsetting object. <strong>Subsetting</strong>: Selects features that intersect or partly intersect with a clipping object. An example: Points randomly distributed within the bounding box of the five concentric circles. Some points are inside one circle, some inside two circles, or neither. Then, we subset points intersecting with <strong>one, two or no circles.</strong></li>
<li><strong>Key Functions</strong>:
<ol type="1">
<li><code>st_sample()</code>: Generates random points within a geometry.</li>
<li><strong>Clipping and Subsetting Approaches</strong>:
<ul>
<li><strong>Way #1</strong>: Use the intersection of <code>x</code> and <code>y</code> (<code>x_and_y</code>) as a direct subsetting object: <code>p[x_and_y]</code></li>
<li><strong>Way #2</strong>: Find the intersection between points (<code>p</code>) and <code>x_and_y</code>, modifying overlapping geometries: <code>st_intersection(p, x_and_y)</code> , or, using <code>st_interesects()</code> when working in a pipe (<code>|&gt;</code>) chain.</li>
<li><strong>Way #3</strong>: Use <code>st_intersects()</code> to determine logical overlap between <code>p</code> and the subsetting objects: <code>sel_p_xy = st_intersects(p, x, sparse = FALSE)[, 1] &amp; st_intersects(p, y, sparse = FALSE)[, 1]</code> and then subset, using <code>p_xy3 = p[sel_p_xy]</code></li>
</ul></li>
</ol></li>
<li><strong>Preferred Implementation</strong>:
<ul>
<li><strong>Way #2</strong> (concise and efficient) and it is the tidyverse approach with <code>|&gt;</code> compatibility. Example shown in Figure&nbsp;5</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fira Sans Condensed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>)</span>
<span id="cb9-2">showtext<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb9-3"></span>
<span id="cb9-4">theme_custom <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(...) {</span>
<span id="cb9-5">  ggthemes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_map</span>(</span>
<span id="cb9-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,</span>
<span id="cb9-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb9-8">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb9-10">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb9-11">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb9-13">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb9-14">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb9-15">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb9-16">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb9-17">      ),</span>
<span id="cb9-18">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb9-19">      ...</span>
<span id="cb9-20">    )</span>
<span id="cb9-21">}</span>
<span id="cb9-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the center points of the circles</span></span>
<span id="cb9-23">sf_circles <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb9-24">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>),</span>
<span id="cb9-25">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb9-26">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour_var =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"yellow"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"green"</span>),</span>
<span id="cb9-27">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label_var =</span> LETTERS[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]</span>
<span id="cb9-28">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-29">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert the points to an sf object</span></span>
<span id="cb9-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>(</span>
<span id="cb9-31">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coords =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>), </span>
<span id="cb9-32">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb9-33">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-34">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create circular geometries using st_buffer</span></span>
<span id="cb9-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_buffer</span>(geometry, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb9-36"></span>
<span id="cb9-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Naming the individual circles</span></span>
<span id="cb9-38">pull_a_circle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(ch_pick){</span>
<span id="cb9-39">  sf_circles <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-40">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(label_var <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> ch_pick)</span>
<span id="cb9-41">}</span>
<span id="cb9-42">a1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull_a_circle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>)  </span>
<span id="cb9-43">b1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull_a_circle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>)  </span>
<span id="cb9-44">c1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull_a_circle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C"</span>)  </span>
<span id="cb9-45">d1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull_a_circle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"D"</span>)  </span>
<span id="cb9-46">e1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull_a_circle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"E"</span>)  </span>
<span id="cb9-47"></span>
<span id="cb9-48">one_circle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> a1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-49">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sym_difference</span>(d1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-50">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sym_difference</span>(b1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-51">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sym_difference</span>(c1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-52">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sym_difference</span>(e1)</span>
<span id="cb9-53">overlap <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> a1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersection</span>(d1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-55">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_union</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersection</span>(d1, b1)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_union</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersection</span>(b1, e1)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_union</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersection</span>(e1, c1))</span>
<span id="cb9-58"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(a1, b1, c1, d1, e1)</span>
<span id="cb9-59"></span>
<span id="cb9-60"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb9-61"></span>
<span id="cb9-62">random_points <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> sf_circles <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-63">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get a bounding box</span></span>
<span id="cb9-64">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_bbox</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-65">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Covert it into a polygon</span></span>
<span id="cb9-66">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sfc</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-67">  </span>
<span id="cb9-68">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get a sample of points within this polygon</span></span>
<span id="cb9-69">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sample</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-70">  </span>
<span id="cb9-71">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert into a sf object</span></span>
<span id="cb9-72">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-73">  </span>
<span id="cb9-74">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add identifiers for where the points fall</span></span>
<span id="cb9-75">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb9-76">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour_var =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb9-77">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersects</span>(x, overlap, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Two Circles"</span>,</span>
<span id="cb9-78">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersects</span>(x, one_circle, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"One Circle"</span>,</span>
<span id="cb9-79">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.default =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Outside"</span></span>
<span id="cb9-80">    ),</span>
<span id="cb9-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour_var =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct</span>(</span>
<span id="cb9-82">      colour_var,</span>
<span id="cb9-83">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb9-84">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Outside"</span>,</span>
<span id="cb9-85">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"One Circle"</span>,</span>
<span id="cb9-86">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Two Circles"</span></span>
<span id="cb9-87">      )</span>
<span id="cb9-88">    )</span>
<span id="cb9-89">  )</span>
<span id="cb9-90"></span>
<span id="cb9-91">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-92">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb9-93">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> sf_circles, </span>
<span id="cb9-94">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>,</span>
<span id="cb9-95">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb9-96">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey10"</span></span>
<span id="cb9-97">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-98">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb9-99">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> random_points,</span>
<span id="cb9-100">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb9-101">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> x,</span>
<span id="cb9-102">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> colour_var</span>
<span id="cb9-103">    ),</span>
<span id="cb9-104">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>,</span>
<span id="cb9-105">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>,</span>
<span id="cb9-106">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stroke =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span></span>
<span id="cb9-107">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-108">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb9-109">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Clipping and Subsetting"</span>,</span>
<span id="cb9-110">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Subsetting random points into those that overlap none, one or two circles"</span>,</span>
<span id="cb9-111">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Point lies within"</span></span>
<span id="cb9-112">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-113">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_paletteer_d</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"khroma::highcontrast"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-114">  ggthemes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_map</span>(</span>
<span id="cb9-115">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb9-116">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span></span>
<span id="cb9-117">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-118">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb9-119">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb9-120">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>,</span>
<span id="cb9-121">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb9-122">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb9-123">    ),</span>
<span id="cb9-124">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb9-125">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb9-126">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb9-127">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb9-128">    ),</span>
<span id="cb9-129">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inside"</span>,</span>
<span id="cb9-130">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position.inside =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb9-131">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.justification =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb9-132">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.direction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"horizontal"</span>,</span>
<span id="cb9-133">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb9-134">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb9-135">    ),</span>
<span id="cb9-136">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb9-137">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb9-138">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb9-139">    ),</span>
<span id="cb9-140">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb9-141">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.size =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt"</span>),</span>
<span id="cb9-142">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span></span>
<span id="cb9-143">  )</span>
<span id="cb9-144"></span>
<span id="cb9-145"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb9-146">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb9-147">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb9-148">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter5-2-6_1.png"</span>),</span>
<span id="cb9-149">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb9-150">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>,</span>
<span id="cb9-151">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">800</span>,</span>
<span id="cb9-152">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb9-153">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb9-154">)</span></code></pre></div>
</details>
</div>
<div id="fig-5-2-6" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-5-2-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter5-2-6_1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Figure&nbsp;5: Sub-setting points with clipped {sf} objects - an example"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter5-2-6_1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-5-2-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Sub-setting points with clipped {sf} objects - an example
</figcaption>
</figure>
</div>
</section>
<section id="geometry-unions" class="level3">
<h3 class="anchored" data-anchor-id="geometry-unions">5.2.7 Geometry Unions</h3>
<ul>
<li><strong>Spatial Aggregation and Geometry Dissolution:</strong>
<ul>
<li>Spatial aggregation dissolves boundaries of touching polygons within the same group automatically. Example: Aggregating 22 districts of the State of Haryana into an overall boundary map with <strong><code>aggregate()</code></strong> (base R approach) or <strong><code>summarize()</code></strong> (tidyverse approach), for example in Figure&nbsp;6</li>
<li>Geometric Operation Behind the Scenes: Functions <strong><code>aggregate()</code></strong> and <strong><code>summarize()</code></strong> internally call <strong><code>st_union()</code></strong> from the <a href="https://r-spatial.github.io/sf/">sf</a> package to dissolve boundaries and merge geometries.</li>
</ul></li>
<li><strong>Union of Geometries:</strong> Visualization Insight example is shown below.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fira Sans Condensed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>)</span>
<span id="cb10-2">showtext<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb10-3"></span>
<span id="cb10-4">haryana1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_sf</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb10-5">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"haryana_map"</span>,</span>
<span id="cb10-6">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HARYANA_DISTRICT_BDY.shp"</span></span>
<span id="cb10-7">))</span>
<span id="cb10-8"></span>
<span id="cb10-9">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> haryana1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb10-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb10-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> District)</span>
<span id="cb10-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-14">  ggthemes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_map</span>(</span>
<span id="cb10-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb10-16">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb10-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Districts of Haryana State (India)"</span>,</span>
<span id="cb10-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The raw map, showing each district."</span></span>
<span id="cb10-21">  )  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb10-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb10-24">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb10-25">    ),</span>
<span id="cb10-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb10-27">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb10-28">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.35</span></span>
<span id="cb10-29">    ),</span>
<span id="cb10-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span></span>
<span id="cb10-31">  )</span>
<span id="cb10-32"></span>
<span id="cb10-33">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> haryana1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb10-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_union</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb10-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-37">  ggthemes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_map</span>(</span>
<span id="cb10-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb10-39">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb10-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Boundary of Haryana State (India)"</span>,</span>
<span id="cb10-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Generated using sf::st_union()"</span></span>
<span id="cb10-44">  )  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb10-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb10-47">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb10-48">    ),</span>
<span id="cb10-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb10-50">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb10-51">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.35</span></span>
<span id="cb10-52">    ),</span>
<span id="cb10-53">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span></span>
<span id="cb10-54">  )</span>
<span id="cb10-55"></span>
<span id="cb10-56"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb10-57">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb10-58">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb10-59">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter5-2-7_2.png"</span>),</span>
<span id="cb10-60">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> (g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2),</span>
<span id="cb10-61">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>,</span>
<span id="cb10-62">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">600</span>,</span>
<span id="cb10-63">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb10-64">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb10-65">)</span></code></pre></div>
</details>
</div>
<div id="fig-5-2-7_2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-5-2-7_2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter5-2-7_2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Figure&nbsp;6: A district map of Haryana, converted into an outer boundary map using st_union()"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter5-2-7_2.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-5-2-7_2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: A district map of Haryana, converted into an outer boundary map using st_union()
</figcaption>
</figure>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fira Sans Condensed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>)</span>
<span id="cb11-2">showtext<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb11-3"></span>
<span id="cb11-4">haryana <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_sf</span>(</span>
<span id="cb11-5">  here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb11-6">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"haryana_map"</span>,</span>
<span id="cb11-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HARYANA_SUBDISTRICT_BDY.shp"</span></span>
<span id="cb11-8">  )</span>
<span id="cb11-9">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-10">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_simplify</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dTolerance =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb11-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">district =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace_all</span>(district, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&gt;"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>),</span>
<span id="cb11-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">district =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace_all</span>(district, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">|"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"I"</span>),</span>
<span id="cb11-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">district =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_to_title</span>(district),</span>
<span id="cb11-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tehsil =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_to_title</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace_all</span>(tehsil, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&gt;"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>))</span>
<span id="cb11-17">  )</span>
<span id="cb11-18"></span>
<span id="cb11-19">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> haryana, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-21">  ggthemes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_map</span>(</span>
<span id="cb11-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb11-23">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb11-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tehsils of Haryana State (India)"</span>,</span>
<span id="cb11-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The raw map, showing each tehsil /</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">subdivision of Haryana."</span></span>
<span id="cb11-28">  )  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb11-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb11-31">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb11-32">    ),</span>
<span id="cb11-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb11-34">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb11-35">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.35</span></span>
<span id="cb11-36">    )</span>
<span id="cb11-37">  )</span>
<span id="cb11-38"></span>
<span id="cb11-39">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> haryana <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(district) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb11-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span></span>
<span id="cb11-45">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-46">  ggthemes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_map</span>(</span>
<span id="cb11-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb11-48">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb11-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Districts of Haryana State (India)"</span>,</span>
<span id="cb11-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Aggregating tehsils with group_by(..) |&gt; summarise()</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">which uses st_union() at the backend."</span></span>
<span id="cb11-53">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb11-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb11-56">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb11-57">    ),</span>
<span id="cb11-58">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb11-59">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb11-60">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.35</span></span>
<span id="cb11-61">    )</span>
<span id="cb11-62">  )</span>
<span id="cb11-63"></span>
<span id="cb11-64">g3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> haryana <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-65">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(district) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-66">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-67">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_cast</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LINESTRING"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-68">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-69">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb11-70">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span></span>
<span id="cb11-71">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-72">  ggthemes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_map</span>(</span>
<span id="cb11-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb11-74">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-75">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-76">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb11-77">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Casting geometry into LINESTRING"</span>,</span>
<span id="cb11-78">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"group_by(district) |&gt; summarise() |&gt; st_cast(</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">LINESTRING</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">).</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Loss of some geometries, but internal slivers are removed."</span></span>
<span id="cb11-79">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-80">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb11-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb11-82">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb11-83">    ),</span>
<span id="cb11-84">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb11-85">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb11-86">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.35</span></span>
<span id="cb11-87">    )</span>
<span id="cb11-88">  )</span>
<span id="cb11-89"></span>
<span id="cb11-90"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb11-91">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb11-92">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb11-93">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter5-2-7_1.png"</span>),</span>
<span id="cb11-94">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> (g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g3),</span>
<span id="cb11-95">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>,</span>
<span id="cb11-96">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">900</span>,</span>
<span id="cb11-97">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb11-98">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb11-99">)</span></code></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>When using the <code>st_union()</code> function in spatial analysis, “inside small lines” or “slivers” appearing in the resulting combined geometry often indicates slight discrepancies in the input geometries, particularly at boundary points, causing the union operation to create small, extra line segments where the geometries nearly overlap but don’t perfectly align, as shown in Figure&nbsp;7</p>
</div>
</div>
<div id="fig-5-2-7" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-5-2-7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter5-2-7_1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Figure&nbsp;7: A sub-district / Tehsil map of Haryana, when converted into a district map with summarise() [which basically uses st_union() only] produces an imperfect result with internal slivers, as the boundary nodes are not overlapping amongst the sub-districts / tehsils. This depicts an inherent (limitation? / caution?) of sf::st_union()."><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter5-2-7_1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-5-2-7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: A sub-district / Tehsil map of Haryana, when converted into a district map with <code>summarise()</code> [which basically uses <code>st_union()</code> only] produces an imperfect result with internal slivers, as the boundary nodes are not overlapping amongst the sub-districts / tehsils. <strong>This depicts an inherent (limitation? / caution?) of <code>sf::st_union()</code>.</strong>
</figcaption>
</figure>
</div>
</section>
<section id="type-transformations" class="level3">
<h3 class="anchored" data-anchor-id="type-transformations">5.2.8 Type Transformations</h3>
<ul>
<li><p>Geometry Casting: Transform geometry types using <a href="https://r-spatial.github.io/sf/reference/st_cast.html">st_cast()</a> from the <strong>sf</strong> package.</p></li>
<li><p>Works on simple feature geometry (sfg), simple feature column (sfc), and simple feature objects (sf).</p></li>
<li><p><strong>Reversible Casting</strong>:</p>
<ul>
<li>Example: <code>st_cast(linestring, "MULTIPOINT")</code> reverts to multipoint geometry.</li>
<li>Retains original geometry for compatible transformations.</li>
</ul></li>
<li><p><strong>Feature Splitting</strong>:</p>
<ul>
<li>Converts multi-objects to non-multi-objects by splitting (e.g., MULTIPOINT to multiple POINTs).</li>
<li>Expands rows with duplicate attribute values during splitting.</li>
</ul></li>
<li><p><strong>Use cases:</strong></p>
<ul>
<li><strong>Multipoint to Linestring</strong>: For path length calculations from ordered points.</li>
<li><strong>Linestring to Polygon</strong>: To compute area, e.g., lake boundary.</li>
<li>Added attributes (e.g., road names, lengths) in case of feature splitting.</li>
<li>Measurements like <code>st_length()</code> for each LINESTRING.</li>
</ul></li>
<li><p>Geometry Type Transformations for Simple Features is shown in Table&nbsp;1 <em>(Credits: <a href="https://r.geocompx.org/">Geomputation with R</a>, Book <a href="https://r.geocompx.org/geometry-operations#tab:sfs-st-cast">Table 5.1</a>)</em></p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load necessary libraries</span></span>
<span id="cb12-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tibble)</span>
<span id="cb12-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gt)</span>
<span id="cb12-4"></span>
<span id="cb12-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the tibble</span></span>
<span id="cb12-6">geometry_table <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> tibble<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb12-7">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Input Geometry Type</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb12-8">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"POINT (1 point)"</span>,</span>
<span id="cb12-9">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MULTIPOINT (4 points)"</span>,</span>
<span id="cb12-10">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LINESTRING (1 linestring with 5 points)"</span>,</span>
<span id="cb12-11">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MULTILINESTRING (2 linestrings: one with 5 points, one with 2 points)"</span>,</span>
<span id="cb12-12">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"POLYGON (1 polygon with 5 points)"</span>,</span>
<span id="cb12-13">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MULTIPOLYGON (2 polygons: each with 5 points)"</span>,</span>
<span id="cb12-14">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GEOMETRYCOLLECTION (2 geometries: a MULTIPOINT with 4 points and a LINESTRING with 5 points)"</span></span>
<span id="cb12-15">  ),</span>
<span id="cb12-16">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">POINT</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>),</span>
<span id="cb12-17">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">MULTIPOINT</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb12-18">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">LINESTRING</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>),</span>
<span id="cb12-19">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">MULTI-LINESTRING</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>),</span>
<span id="cb12-20">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">POLYGON</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>),</span>
<span id="cb12-21">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">MULTI-POLYGON</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>),</span>
<span id="cb12-22">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GEOMETRY-COLLECTION</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb12-23">)</span>
<span id="cb12-24"></span>
<span id="cb12-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Render the table using gt</span></span>
<span id="cb12-26">geometry_table <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb12-27">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb12-28">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_missing</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">everything</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">missing_text =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb12-29">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_538</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb12-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_style</span>(</span>
<span id="cb12-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cell_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">px</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)), </span>
<span id="cb12-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">locations =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cells_body</span>(</span>
<span id="cb12-33">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Input Geometry Type</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, </span>
<span id="cb12-34">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">everything</span>()             </span>
<span id="cb12-35">    )</span>
<span id="cb12-36">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb12-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_style</span>(</span>
<span id="cb12-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cell_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">px</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb12-39">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>),</span>
<span id="cb12-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">locations =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb12-41">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cells_column_labels</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">everything</span>()), </span>
<span id="cb12-42">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cells_stub</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">everything</span>())             </span>
<span id="cb12-43">    )</span>
<span id="cb12-44">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb12-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_style</span>(</span>
<span id="cb12-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cell_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>), </span>
<span id="cb12-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">locations =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cells_body</span>(</span>
<span id="cb12-48">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Input Geometry Type</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, </span>
<span id="cb12-49">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rows =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">everything</span>()             </span>
<span id="cb12-50">    )</span>
<span id="cb12-51">  )</span></code></pre></div>
</details>
<div id="tbl-st-types" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-st-types-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: All possible combinations of Geometry type transformations for Simple Features
</figcaption>
<div aria-describedby="tbl-st-types-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="rvsgmbysku" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#rvsgmbysku table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rvsgmbysku thead, #rvsgmbysku tbody, #rvsgmbysku tfoot, #rvsgmbysku tr, #rvsgmbysku td, #rvsgmbysku th {
  border-style: none;
}

#rvsgmbysku p {
  margin: 0;
  padding: 0;
}

#rvsgmbysku .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rvsgmbysku .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rvsgmbysku .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rvsgmbysku .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rvsgmbysku .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rvsgmbysku .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rvsgmbysku .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rvsgmbysku .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rvsgmbysku .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rvsgmbysku .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rvsgmbysku .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rvsgmbysku .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rvsgmbysku .gt_spanner_row {
  border-bottom-style: hidden;
}

#rvsgmbysku .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rvsgmbysku .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#rvsgmbysku .gt_from_md > :first-child {
  margin-top: 0;
}

#rvsgmbysku .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rvsgmbysku .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rvsgmbysku .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#rvsgmbysku .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rvsgmbysku .gt_row_group_first td {
  border-top-width: 2px;
}

#rvsgmbysku .gt_row_group_first th {
  border-top-width: 2px;
}

#rvsgmbysku .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rvsgmbysku .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rvsgmbysku .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rvsgmbysku .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rvsgmbysku .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rvsgmbysku .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rvsgmbysku .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rvsgmbysku .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rvsgmbysku .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rvsgmbysku .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rvsgmbysku .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rvsgmbysku .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rvsgmbysku .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rvsgmbysku .gt_left {
  text-align: left;
}

#rvsgmbysku .gt_center {
  text-align: center;
}

#rvsgmbysku .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rvsgmbysku .gt_font_normal {
  font-weight: normal;
}

#rvsgmbysku .gt_font_bold {
  font-weight: bold;
}

#rvsgmbysku .gt_font_italic {
  font-style: italic;
}

#rvsgmbysku .gt_super {
  font-size: 65%;
}

#rvsgmbysku .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rvsgmbysku .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rvsgmbysku .gt_indent_1 {
  text-indent: 5px;
}

#rvsgmbysku .gt_indent_2 {
  text-indent: 10px;
}

#rvsgmbysku .gt_indent_3 {
  text-indent: 15px;
}

#rvsgmbysku .gt_indent_4 {
  text-indent: 20px;
}

#rvsgmbysku .gt_indent_5 {
  text-indent: 25px;
}

#rvsgmbysku .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#rvsgmbysku div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th id="Input Geometry Type" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="text-align: center; border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 10px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col">Input Geometry Type</th>
<th id="POINT" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="text-align: center; border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 10px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col">POINT</th>
<th id="MULTIPOINT" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="text-align: center; border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 10px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col">MULTIPOINT</th>
<th id="LINESTRING" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="text-align: center; border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 10px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col">LINESTRING</th>
<th id="MULTI-LINESTRING" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="text-align: center; border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 10px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col">MULTI-LINESTRING</th>
<th id="POLYGON" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="text-align: center; border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 10px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col">POLYGON</th>
<th id="MULTI-POLYGON" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="text-align: center; border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 10px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col">MULTI-POLYGON</th>
<th id="GEOMETRY-COLLECTION" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="text-align: center; border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 10px; vertical-align: bottom; font-weight: 200; text-transform: uppercase;" scope="col">GEOMETRY-COLLECTION</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Input Geometry Type" style="font-size: 10px">POINT (1 point)</td>
<td class="gt_row gt_right" style="text-align: center;" headers="POINT">1</td>
<td class="gt_row gt_right" style="text-align: center;" headers="MULTIPOINT">1</td>
<td class="gt_row gt_right" style="text-align: center;" headers="LINESTRING">1</td>
<td class="gt_row gt_right" style="text-align: center;" headers="MULTI-LINESTRING"><br>
</td>
<td class="gt_row gt_right" style="text-align: center;" headers="POLYGON"><br>
</td>
<td class="gt_row gt_right" style="text-align: center;" headers="MULTI-POLYGON"><br>
</td>
<td class="gt_row gt_right" style="text-align: center;" headers="GEOMETRY-COLLECTION"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Input Geometry Type" style="font-size: 10px">MULTIPOINT (4 points)</td>
<td class="gt_row gt_right" style="text-align: center;" headers="POINT">4</td>
<td class="gt_row gt_right" style="text-align: center;" headers="MULTIPOINT">1</td>
<td class="gt_row gt_right" style="text-align: center;" headers="LINESTRING">1</td>
<td class="gt_row gt_right" style="text-align: center;" headers="MULTI-LINESTRING">1</td>
<td class="gt_row gt_right" style="text-align: center;" headers="POLYGON"><br>
</td>
<td class="gt_row gt_right" style="text-align: center;" headers="MULTI-POLYGON"><br>
</td>
<td class="gt_row gt_right" style="text-align: center;" headers="GEOMETRY-COLLECTION"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Input Geometry Type" style="font-size: 10px">LINESTRING (1 linestring with 5 points)</td>
<td class="gt_row gt_right" style="text-align: center;" headers="POINT">5</td>
<td class="gt_row gt_right" style="text-align: center;" headers="MULTIPOINT">1</td>
<td class="gt_row gt_right" style="text-align: center;" headers="LINESTRING">1</td>
<td class="gt_row gt_right" style="text-align: center;" headers="MULTI-LINESTRING">1</td>
<td class="gt_row gt_right" style="text-align: center;" headers="POLYGON"><br>
</td>
<td class="gt_row gt_right" style="text-align: center;" headers="MULTI-POLYGON"><br>
</td>
<td class="gt_row gt_right" style="text-align: center;" headers="GEOMETRY-COLLECTION"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Input Geometry Type" style="font-size: 10px">MULTILINESTRING (2 linestrings: one with 5 points, one with 2 points)</td>
<td class="gt_row gt_right" style="text-align: center;" headers="POINT">7</td>
<td class="gt_row gt_right" style="text-align: center;" headers="MULTIPOINT">2</td>
<td class="gt_row gt_right" style="text-align: center;" headers="LINESTRING">2</td>
<td class="gt_row gt_right" style="text-align: center;" headers="MULTI-LINESTRING">1</td>
<td class="gt_row gt_right" style="text-align: center;" headers="POLYGON"><br>
</td>
<td class="gt_row gt_right" style="text-align: center;" headers="MULTI-POLYGON"><br>
</td>
<td class="gt_row gt_right" style="text-align: center;" headers="GEOMETRY-COLLECTION"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Input Geometry Type" style="font-size: 10px">POLYGON (1 polygon with 5 points)</td>
<td class="gt_row gt_right" style="text-align: center;" headers="POINT">5</td>
<td class="gt_row gt_right" style="text-align: center;" headers="MULTIPOINT">1</td>
<td class="gt_row gt_right" style="text-align: center;" headers="LINESTRING">1</td>
<td class="gt_row gt_right" style="text-align: center;" headers="MULTI-LINESTRING">1</td>
<td class="gt_row gt_right" style="text-align: center;" headers="POLYGON">1</td>
<td class="gt_row gt_right" style="text-align: center;" headers="MULTI-POLYGON"><br>
</td>
<td class="gt_row gt_right" style="text-align: center;" headers="GEOMETRY-COLLECTION"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Input Geometry Type" style="font-size: 10px">MULTIPOLYGON (2 polygons: each with 5 points)</td>
<td class="gt_row gt_right" style="text-align: center;" headers="POINT">10</td>
<td class="gt_row gt_right" style="text-align: center;" headers="MULTIPOINT">1</td>
<td class="gt_row gt_right" style="text-align: center;" headers="LINESTRING"><br>
</td>
<td class="gt_row gt_right" style="text-align: center;" headers="MULTI-LINESTRING">1</td>
<td class="gt_row gt_right" style="text-align: center;" headers="POLYGON">2</td>
<td class="gt_row gt_right" style="text-align: center;" headers="MULTI-POLYGON">1</td>
<td class="gt_row gt_right" style="text-align: center;" headers="GEOMETRY-COLLECTION">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Input Geometry Type" style="font-size: 10px">GEOMETRYCOLLECTION (2 geometries: a MULTIPOINT with 4 points and a LINESTRING with 5 points)</td>
<td class="gt_row gt_right" style="text-align: center;" headers="POINT">9</td>
<td class="gt_row gt_right" style="text-align: center;" headers="MULTIPOINT">1</td>
<td class="gt_row gt_right" style="text-align: center;" headers="LINESTRING"><br>
</td>
<td class="gt_row gt_right" style="text-align: center;" headers="MULTI-LINESTRING"><br>
</td>
<td class="gt_row gt_right" style="text-align: center;" headers="POLYGON"><br>
</td>
<td class="gt_row gt_right" style="text-align: center;" headers="MULTI-POLYGON"><br>
</td>
<td class="gt_row gt_right" style="text-align: center;" headers="GEOMETRY-COLLECTION">1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<p>An attempt to recreate this table graphically with {ggplot2} and {sf}. Unfortunately, it didn’t work out.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the bounding box limits</span></span>
<span id="cb13-2">xmin <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>; xmax <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>; ymin <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>; ymax <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb13-3"></span>
<span id="cb13-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create POINT</span></span>
<span id="cb13-5">tbl_poi <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb13-6">poi <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sfc</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(tbl_poi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x, tbl_poi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span>)</span>
<span id="cb13-7"></span>
<span id="cb13-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create MULTIPOINT</span></span>
<span id="cb13-9">tbl_mpoi <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb13-10">mpoi <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sfc</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_multipoint</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>(tbl_mpoi)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span>)</span>
<span id="cb13-11"></span>
<span id="cb13-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create LINESTRING</span></span>
<span id="cb13-13">tbl_lin <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(xmin, xmax, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(ymin, ymax, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>))</span>
<span id="cb13-14">lin <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sfc</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_linestring</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>(tbl_lin)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span>)</span>
<span id="cb13-15"></span>
<span id="cb13-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create MULTILINESTRING</span></span>
<span id="cb13-17">tbl_mlin1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(xmin, xmax, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(ymin, ymax, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>))</span>
<span id="cb13-18">tbl_mlin2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(xmin, xmax), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(ymax, ymin))</span>
<span id="cb13-19">mlin <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sfc</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_multilinestring</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>(tbl_mlin1), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>(tbl_mlin2))), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span>)</span>
<span id="cb13-20"></span>
<span id="cb13-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create POLYGON</span></span>
<span id="cb13-22">tbl_pol <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(xmin, xmax, xmax, xmin, xmin),</span>
<span id="cb13-23">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(ymin, ymin, ymax, ymax, ymin))</span>
<span id="cb13-24">pol <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sfc</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_polygon</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>(tbl_pol))), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span>)</span>
<span id="cb13-25"></span>
<span id="cb13-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create MULTIPOLYGON</span></span>
<span id="cb13-27">tbl_mpol1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb13-28">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb13-29">tbl_mpol2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb13-30">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb13-31">mpol <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sfc</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_multipolygon</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>(tbl_mpol1)), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>(tbl_mpol2)))), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span>)</span>
<span id="cb13-32"></span>
<span id="cb13-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create GEOMETRYCOLLECTION</span></span>
<span id="cb13-34">gc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sfc</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_geometrycollection</span>(</span>
<span id="cb13-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb13-36">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_multipoint</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>(tbl_mpoi)),</span>
<span id="cb13-37">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_linestring</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>(tbl_lin))</span>
<span id="cb13-38">  )</span>
<span id="cb13-39">), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span>)</span>
<span id="cb13-40"></span>
<span id="cb13-41">names_geometries <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb13-42">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"POINT"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MULTIPOINT"</span>,</span>
<span id="cb13-43">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LINESTRING"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MULTILINESTRING"</span>,</span>
<span id="cb13-44">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"POLYGON"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MULTIPOLYGON"</span>,</span>
<span id="cb13-45">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GEOMETRYCOLLECTION"</span></span>
<span id="cb13-46">  )</span>
<span id="cb13-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clean workspace</span></span>
<span id="cb13-48"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">list =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^tbl_"</span>))</span>
<span id="cb13-49"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">list =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"min|max"</span>))</span>
<span id="cb13-50"></span>
<span id="cb13-51"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combine all objects into an sf object for viewing</span></span>
<span id="cb13-52">sf_objects <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sf</span>(</span>
<span id="cb13-53">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(poi, mpoi, lin, mlin, pol, mpol, gc), </span>
<span id="cb13-54">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> names_geometries</span>
<span id="cb13-55">  )</span>
<span id="cb13-56"></span>
<span id="cb13-57"></span>
<span id="cb13-58">theme_custom <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(...){</span>
<span id="cb13-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-60">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb13-61">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb13-62">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb13-63">      ...</span>
<span id="cb13-64">      )</span>
<span id="cb13-65">}</span>
<span id="cb13-66"></span>
<span id="cb13-67"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># basic geometries made</span></span>
<span id="cb13-68">sf_objects <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb13-69">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-70">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-71">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>type)</span>
<span id="cb13-72"></span>
<span id="cb13-73">blank_numbers <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb13-74">  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb13-75">  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>,</span>
<span id="cb13-76">  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">26</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">27</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>,</span>
<span id="cb13-77">  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">33</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">34</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">38</span>,</span>
<span id="cb13-78">  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">41</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>, </span>
<span id="cb13-79">  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">46</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">47</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">48</span></span>
<span id="cb13-80">)</span>
<span id="cb13-81"></span>
<span id="cb13-82"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>){</span>
<span id="cb13-83">  original_geometry <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> names_geometries[i]</span>
<span id="cb13-84"></span>
<span id="cb13-85">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (j <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>){</span>
<span id="cb13-86">    plot_number <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (i<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> j)</span>
<span id="cb13-87">  </span>
<span id="cb13-88">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (plot_number <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> blank_numbers) {</span>
<span id="cb13-89">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">assign</span>(</span>
<span id="cb13-90">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"g"</span>, ((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (i<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> j)),</span>
<span id="cb13-91">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>()</span>
<span id="cb13-92">      )</span>
<span id="cb13-93">    } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb13-94">      temp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> sf_objects <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb13-95">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(type <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> original_geometry) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb13-96">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_cast</span>(names_geometries[j])</span>
<span id="cb13-97">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">assign</span>(</span>
<span id="cb13-98">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"g"</span>, ((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (i<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> j)),</span>
<span id="cb13-99">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(temp) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-100">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-101">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-102">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>()</span>
<span id="cb13-103">        )</span>
<span id="cb13-104">      }</span>
<span id="cb13-105">    }</span>
<span id="cb13-106">}</span>
<span id="cb13-107"></span>
<span id="cb13-108">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> patchwork<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wrap_plots</span>(</span>
<span id="cb13-109">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mget</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"g"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">49</span>))</span>
<span id="cb13-110">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-111">  patchwork<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(</span>
<span id="cb13-112">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span></span>
<span id="cb13-113">  )</span>
<span id="cb13-114"></span>
<span id="cb13-115"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb13-116">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb13-117">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb13-118">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter5-2-8_1.png"</span>),</span>
<span id="cb13-119">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb13-120">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7800</span>,</span>
<span id="cb13-121">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7800</span>,</span>
<span id="cb13-122">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb13-123">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb13-124">)</span></code></pre></div>
</details>
</div>
</section>
</section>
<section id="geometric-operations-on-raster-data" class="level2">
<h2 class="anchored" data-anchor-id="geometric-operations-on-raster-data">5.3 Geometric operations on raster data</h2>
<ul>
<li>Geometric raster operations include shifting, flipping, mirroring, scaling, rotation, and warping of images. Purpose:
<ul>
<li>Enable georeferencing for overlaying images on accurate maps with a known CRS (Coordinate Reference System).</li>
<li>Applications include georectification, orthorectification, and image registration.</li>
</ul></li>
<li>Techniques:
<ul>
<li><strong>Georectification</strong>: Uses known ground control points for alignment <em>(Liu and Mason 2009)</em> <span class="citation" data-cites="loecher2015">(Loecher and Ropkins 2015)</span><em>.</em></li>
<li><strong>Orthorectification</strong>: Accounts for local topography.</li>
<li><strong>Image Registration</strong>: Aligns images from different sensors by matching their coordinate systems and resolutions.</li>
</ul></li>
<li><strong>Suitability of R</strong>:
<ul>
<li>Manual operations like georectification and orthorectification are better handled in GIS software like <a href="https://www.qgistutorials.com/en/docs/3/georeferencing_basics.html">QGIS</a>.</li>
<li>R is suitable for aligning multiple images by modifying extent, resolution, and origin.</li>
</ul></li>
</ul>
<section id="geometric-intersections" class="level3">
<h3 class="anchored" data-anchor-id="geometric-intersections">5.3.1 Geometric Intersections</h3>
<ul>
<li><p>Purpose:</p>
<ul>
<li><p><strong>Extract raster values</strong>: Use spatial objects overlaid on a raster to extract values with subsetting syntax.</p></li>
<li><p><strong>Keep spatial output</strong>: To retain a spatial output (e.g., raster structure), set <code>drop = FALSE</code> during subsetting.</p></li>
<li><p><strong>Raster midpoints</strong>: Returns a raster object containing cells whose <strong>midpoints</strong> overlap with the clip area.</p></li>
</ul></li>
<li><p>Comparison of Base R <code>[]</code> vs.&nbsp;<code>terra::crop()</code> shown in Figure&nbsp;8</p></li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Feature</th>
<th>Base R <code>[]</code> Subsetting</th>
<th><code>terra::crop()</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Purpose</strong></td>
<td>General selection of raster values</td>
<td>Spatial clipping of rasters</td>
</tr>
<tr class="even">
<td><strong>Spatial Metadata</strong></td>
<td>Requires manual handling</td>
<td>Automatically preserved</td>
</tr>
<tr class="odd">
<td><strong>Syntax</strong></td>
<td><code>raster[condition, drop = FALSE]</code></td>
<td><code>terra::crop(raster, extent)</code></td>
</tr>
<tr class="even">
<td><strong>Key Functionality</strong></td>
<td>Selects raster cells by condition</td>
<td>Clips raster to the provided extent</td>
</tr>
<tr class="odd">
<td><strong>Recommended For</strong></td>
<td>Basic operations, custom workflows</td>
<td>Efficient raster clipping in geospatial analyses</td>
</tr>
</tbody>
</table>
<p><code>terra::crop()</code> is often more efficient and user-friendly for spatial raster workflows with pipe operator (<code>|&gt;</code>) compared to base R’s <code>[]</code> subsetting.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">elev <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/elev.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spData"</span>))</span>
<span id="cb14-2">clip <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb14-3">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resolution =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vals =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>))</span>
<span id="cb14-4"></span>
<span id="cb14-5"></span>
<span id="cb14-6">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_grass_c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"elev raster"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>)</span>
<span id="cb14-13"></span>
<span id="cb14-14">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> clip) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_grass_c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"clip raster"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>)</span>
<span id="cb14-21"></span>
<span id="cb14-22">g3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev[clip, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">drop =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_grass_c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"elev[clip, drop = FALSE]"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>)</span>
<span id="cb14-29"></span>
<span id="cb14-30">g4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crop</span>(clip)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_grass_c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"elev |&gt; terra::crop(clip)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb14-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.height =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt"</span>),</span>
<span id="cb14-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt"</span>)</span>
<span id="cb14-39">  )</span>
<span id="cb14-40"></span>
<span id="cb14-41">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(</span>
<span id="cb14-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb14-44">  )</span>
<span id="cb14-45"></span>
<span id="cb14-46"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb14-47">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb14-48">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb14-49">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter5-3-1_1.png"</span>),</span>
<span id="cb14-50">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb14-51">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">700</span>,</span>
<span id="cb14-52">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1800</span>,</span>
<span id="cb14-53">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb14-54">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb14-55">)</span></code></pre></div>
</details>
</div>
<div id="fig-5-3-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-5-3-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter5-3-1_1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="Figure&nbsp;8: Comparing base R [] and terra::crop() for subsetting rasters"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter5-3-1_1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-5-3-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Comparing base R <code>[]</code> and <code>terra::crop()</code> for subsetting rasters
</figcaption>
</figure>
</div>
</section>
<section id="extent-and-origin" class="level3">
<h3 class="anchored" data-anchor-id="extent-and-origin">5.3.2 Extent and Origin</h3>
<ul>
<li><strong>Raster alignment necessity</strong>: Mismatches in resolution, projection, origin, or extent must be addressed for map algebra or merging. For example, Adding a raster with a 0.2-degree resolution to one with a 1-degree resolution is impossible without alignment.</li>
<li><strong>Extent mismatch</strong>: Extending a raster adds rows/columns filled with <code>NA</code> values. Use <a href="https://rspatial.github.io/terra/reference/extend.html"><code>extend()</code></a> from the <code>terra</code> package for this.</li>
<li><strong>Extent alignment</strong>: Performing operations on rasters with differing extents throws an error. Solution: Use another raster as a reference to align extents via <code>terra::extend()</code>.
<ul>
<li>The <code>terra::extend()</code> function in R enlarges the spatial extent of a <code>SpatRaster</code> or <code>SpatExtent</code>. It can add rows and columns, with values filled using the <code>fill</code> argument (default <code>NA</code>). The <code>y</code> argument specifies how much to extend, either as an extent object or numeric values indicating rows/columns to add. The <code>snap</code> argument controls alignment (“near”, “in”, “out”). Outputs can be saved using <code>filename</code> and <code>overwrite</code>.</li>
</ul></li>
<li><strong>Origin</strong>:
<ul>
<li>The <strong>origin</strong> is the raster cell corner closest to coordinates (0, 0). Use <a href="https://rspatial.github.io/terra/reference/origin.html"><code>terra::origin()</code></a> to retrieve or modify the raster origin.</li>
<li>Misaligned origins cause raster cells not to overlap, making map algebra impossible. Adjust the origin with <code>origin()</code> to ensure proper alignment.</li>
<li>If two rasters are marginally apart, change <code>tolerance</code> argument for <code>terra::terraOptions()</code>.</li>
</ul></li>
<li><strong>Visualization</strong>: Figure&nbsp;9 illustrates raster extension and Figure&nbsp;10 shows the effect of origin changes.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fira Sans Condensed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>)</span>
<span id="cb15-2">showtext<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb15-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(</span>
<span id="cb15-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb15-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb15-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span></span>
<span id="cb15-7">  )</span>
<span id="cb15-8">)</span>
<span id="cb15-9">elev <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/elev.tif"</span>, </span>
<span id="cb15-10">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spData"</span>))</span>
<span id="cb15-11">elev2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> elev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">extend</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>)</span>
<span id="cb15-12"></span>
<span id="cb15-13">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_grass_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb15-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Base Raster elev"</span></span>
<span id="cb15-18">  )</span>
<span id="cb15-19"></span>
<span id="cb15-20">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">extend</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_grass_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb15-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"elev |&gt; extend(c(1,2), fill = 36) "</span></span>
<span id="cb15-25">  )</span>
<span id="cb15-26"></span>
<span id="cb15-27">g3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">extend</span>(elev2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_grass_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb15-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"elev |&gt; extend(elev2)"</span></span>
<span id="cb15-32">  )</span>
<span id="cb15-33"></span>
<span id="cb15-34">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(</span>
<span id="cb15-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guides =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"collect"</span></span>
<span id="cb15-37">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb15-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb15-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Extending rasters with terra::extend()"</span>,</span>
<span id="cb15-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb15-41">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb15-42">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb15-43">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span></span>
<span id="cb15-44">      ),</span>
<span id="cb15-45">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb15-46">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span></span>
<span id="cb15-47">      )</span>
<span id="cb15-48">    )</span>
<span id="cb15-49">  )</span>
<span id="cb15-50"></span>
<span id="cb15-51"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb15-52">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb15-53">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb15-54">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter5-3-2_2.png"</span>),</span>
<span id="cb15-55">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb15-56">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">800</span>,</span>
<span id="cb15-57">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>,</span>
<span id="cb15-58">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb15-59">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb15-60">)</span></code></pre></div>
</details>
</div>
<div id="fig-extent" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-extent-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter5-3-2_2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17" title="Figure&nbsp;9: Use of terra::extend() to increase or decrease size of rasters"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter5-3-2_2.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-extent-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Use of <code>terra::extend()</code> to increase or decrease size of rasters
</figcaption>
</figure>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fira Sans Condensed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>)</span>
<span id="cb16-2">showtext<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb16-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(</span>
<span id="cb16-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb16-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb16-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span></span>
<span id="cb16-7">  )</span>
<span id="cb16-8">)</span>
<span id="cb16-9"></span>
<span id="cb16-10">elev <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/elev.tif"</span>, </span>
<span id="cb16-11">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spData"</span>))</span>
<span id="cb16-12"></span>
<span id="cb16-13">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb16-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev,</span>
<span id="cb16-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span></span>
<span id="cb16-17">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_grass_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Original Raster"</span>)</span>
<span id="cb16-20"></span>
<span id="cb16-21">elev2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> elev</span>
<span id="cb16-22"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">origin</span>(elev2) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span> , <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>)</span>
<span id="cb16-23">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb16-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb16-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev2,</span>
<span id="cb16-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span></span>
<span id="cb16-27">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb16-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Origin shifted by c(0.2, 0.2)"</span>,</span>
<span id="cb16-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Shifting along x and y axes."</span>)</span>
<span id="cb16-31"></span>
<span id="cb16-32">elev3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> elev</span>
<span id="cb16-33"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">origin</span>(elev3) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span> , <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span>
<span id="cb16-34">g3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb16-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev3,</span>
<span id="cb16-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span></span>
<span id="cb16-38">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb16-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Origin shifted by c(0.6, 0.1)"</span>,</span>
<span id="cb16-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Shifting by remainder beyond division by resolution."</span>)</span>
<span id="cb16-42"></span>
<span id="cb16-43">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(</span>
<span id="cb16-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guides =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"collect"</span></span>
<span id="cb16-46">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb16-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb16-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Effects of changing terra::origin() of a SpatRaster"</span>,</span>
<span id="cb16-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Changing by more than half of resolution results in shifting by +/- amount of remainder of division of origin shift by resolution"</span>,</span>
<span id="cb16-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb16-51">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb16-52">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb16-53">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span></span>
<span id="cb16-54">      ),</span>
<span id="cb16-55">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb16-56">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span></span>
<span id="cb16-57">      )</span>
<span id="cb16-58">    )</span>
<span id="cb16-59">  )</span>
<span id="cb16-60"></span>
<span id="cb16-61"></span>
<span id="cb16-62"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb16-63">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb16-64">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb16-65">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter5-3-2_1.png"</span>),</span>
<span id="cb16-66">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb16-67">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">800</span>,</span>
<span id="cb16-68">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>,</span>
<span id="cb16-69">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb16-70">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb16-71">)</span></code></pre></div>
</details>
</div>
<div id="fig-origin" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-origin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter5-3-2_1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Figure&nbsp;10: Using terra::origin() to change origin of a raster in relation to c(0,0)"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter5-3-2_1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-origin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Using <code>terra::origin()</code> to change origin of a raster in relation to c(0,0)
</figcaption>
</figure>
</div>
</section>
<section id="aggregation-and-disaggregation" class="level3">
<h3 class="anchored" data-anchor-id="aggregation-and-disaggregation">5.3.3 Aggregation and Disaggregation</h3>
<ul>
<li>Raster Resolution Adjustments:
<ul>
<li><strong>Aggregation</strong>: Decreases raster resolution using the <code>aggregate()</code> function.</li>
<li><strong>Disaggregation</strong>: Increases raster resolution using the <code>disagg()</code> function.</li>
</ul></li>
<li><strong>Aggregation Details</strong>: The output cell values represent the mean of input cells. Other functions like <code>median()</code>, <code>sum()</code>, etc., can also be applied.
<ul>
<li>Effect on Resolution: Aggregation increases resolution by reducing rows and columns.</li>
</ul></li>
<li>Disaggregation Details: 2 Methods are shown in Figure&nbsp;11
<ul>
<li><strong>Default</strong> (<code>method = "near"</code>): Duplicates input cell values, creating a ‘blocky’ output.</li>
<li><strong>Bilinear</strong> (<code>method = "bilinear"</code>): Computes output values using a weighted average of the four nearest input pixel centers.</li>
<li><strong>Accuracy</strong>: Results in finer resolution, but values are interpolations of the lower-resolution source.</li>
</ul></li>
<li><strong>Comparison of Rasters</strong>:
<ul>
<li>Aggregated and disaggregated rasters differ from the original raster.</li>
<li>Use functions like <code>compareGeom()</code> or <code>all.equal()</code> to identify differences.</li>
</ul></li>
<li><strong>Key Considerations</strong>:
<ul>
<li>Aggregation simplifies data, while disaggregation interpolates it, often leading to approximate values based on the source resolution.</li>
<li>Resolution changes impact raster extent, dimensions, and data accuracy.</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">original_raster <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/dem.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>))</span>
<span id="cb17-2"></span>
<span id="cb17-3">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> original_raster) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb17-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Original Raster"</span>,</span>
<span id="cb17-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb17-9">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Resolution: "</span>, </span>
<span id="cb17-10">      terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">res</span>(original_raster) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-11">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-12">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", "</span>),</span>
<span id="cb17-13">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Dimensions: "</span>,</span>
<span id="cb17-14">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(original_raster)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-15">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", "</span>)</span>
<span id="cb17-16">    )</span>
<span id="cb17-17">  )</span>
<span id="cb17-18"></span>
<span id="cb17-19">agg_raster <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aggregate</span>(</span>
<span id="cb17-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> original_raster, </span>
<span id="cb17-21">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fact =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, </span>
<span id="cb17-22">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> mean</span>
<span id="cb17-23">  )</span>
<span id="cb17-24"></span>
<span id="cb17-25">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> agg_raster) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb17-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Aggregation by factor of 5"</span>,</span>
<span id="cb17-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb17-31">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Resolution: "</span>, </span>
<span id="cb17-32">      terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">res</span>(agg_raster) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-33">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-34">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", "</span>),</span>
<span id="cb17-35">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Dimensions: "</span>,</span>
<span id="cb17-36">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(agg_raster)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-37">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", "</span>)</span>
<span id="cb17-38">    )</span>
<span id="cb17-39">  )</span>
<span id="cb17-40"></span>
<span id="cb17-41"></span>
<span id="cb17-42">disagg_raster1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">disagg</span>(</span>
<span id="cb17-43">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> agg_raster,</span>
<span id="cb17-44">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fact =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb17-45">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"near"</span></span>
<span id="cb17-46">)</span>
<span id="cb17-47"></span>
<span id="cb17-48">g3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> disagg_raster1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb17-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dis-Aggregation (method = near)"</span>,</span>
<span id="cb17-53">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb17-54">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Resolution: "</span>, </span>
<span id="cb17-55">      terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">res</span>(disagg_raster1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-56">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-57">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", "</span>),</span>
<span id="cb17-58">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Dimensions: "</span>,</span>
<span id="cb17-59">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(disagg_raster1)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-60">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", "</span>)</span>
<span id="cb17-61">    )</span>
<span id="cb17-62">  )</span>
<span id="cb17-63"></span>
<span id="cb17-64">disagg_raster2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">disagg</span>(</span>
<span id="cb17-65">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> agg_raster,</span>
<span id="cb17-66">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fact =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb17-67">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bilinear"</span></span>
<span id="cb17-68">)</span>
<span id="cb17-69"></span>
<span id="cb17-70">g4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-71">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> disagg_raster2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-72">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-73">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb17-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dis-Aggregation (method = bilinear)"</span>,</span>
<span id="cb17-75">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb17-76">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Resolution: "</span>, </span>
<span id="cb17-77">      terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">res</span>(disagg_raster2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-78">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-79">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", "</span>),</span>
<span id="cb17-80">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Dimensions: "</span>,</span>
<span id="cb17-81">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(disagg_raster2)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-82">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", "</span>)</span>
<span id="cb17-83">    )</span>
<span id="cb17-84">  )</span>
<span id="cb17-85"></span>
<span id="cb17-86">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-87">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(</span>
<span id="cb17-88">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guides =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"collect"</span>,</span>
<span id="cb17-89">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb17-90">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb17-91">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb17-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Aggregating and Disaggregating rasters"</span>,</span>
<span id="cb17-93">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Disaggregating a raster will not revert to original details as some data is lost."</span>,</span>
<span id="cb17-94">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb17-95">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb17-96">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb17-97">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span></span>
<span id="cb17-98">      ),</span>
<span id="cb17-99">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb17-100">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span></span>
<span id="cb17-101">      )</span>
<span id="cb17-102">    )</span>
<span id="cb17-103">  )</span>
<span id="cb17-104"></span>
<span id="cb17-105"></span>
<span id="cb17-106"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb17-107">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb17-108">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb17-109">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter5-3-3_1.png"</span>),</span>
<span id="cb17-110">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb17-111">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1800</span>,</span>
<span id="cb17-112">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5400</span>,</span>
<span id="cb17-113">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb17-114">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb17-115">)</span></code></pre></div>
</details>
</div>
<div id="fig-agg-disagg" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-agg-disagg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter5-3-3_1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19" title="Figure&nbsp;11: Aggregating and Disaggregating a raster by a factor of 5. Note the superiority of blinear method of disaggregatiion."><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter5-3-3_1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-agg-disagg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Aggregating and Disaggregating a raster by a factor of 5. Note the superiority of blinear method of disaggregatiion.
</figcaption>
</figure>
</div>
</section>
<section id="resampling" class="level3">
<h3 class="anchored" data-anchor-id="resampling">5.3.4 Resampling</h3>
<ul>
<li><p><strong>Purpose</strong>: Adjusts pixel values for a target raster with different resolution and origin than the original raster (<a href="https://rspatial.org/terra/">terra</a>). Useful for combining rasters with varying resolutions/origins.</p></li>
<li><p><strong>Methods</strong>: A comparison table on resampling methods available in the <code>{terra}</code> package’s <code>resample()</code> function with examples in Figure&nbsp;12</p></li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>No.</th>
<th><strong>Method</strong></th>
<th><strong>Description</strong></th>
<th><strong>Suitable For</strong></th>
<th><strong>Complexity</strong></th>
<th><strong>Use Case</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td><strong>Nearest Neighbor</strong></td>
<td>Assigns the value of the nearest cell of the original raster to the target cell.</td>
<td>Categorical rasters</td>
<td>Simple</td>
<td>Discrete data like land-use classifications</td>
</tr>
<tr class="even">
<td>2</td>
<td><strong>Bilinear Interpolation</strong></td>
<td>Computes a weighted average of the four nearest cells from the original raster for the target cell.</td>
<td>Continuous rasters</td>
<td>Moderate</td>
<td>Continuous data; smoother transitions, elevation models or temperature data.</td>
</tr>
<tr class="odd">
<td>3</td>
<td><strong>Cubic Interpolation</strong></td>
<td>Uses the values of the 16 nearest cells, applying third-order polynomial functions for smooth output.</td>
<td>Continuous rasters</td>
<td>Higher</td>
<td>Continuous data requiring smoother surfaces; resampling satellite imagery.</td>
</tr>
<tr class="even">
<td>4</td>
<td><strong>Cubic Spline Interpolation</strong></td>
<td>Uses the 16 nearest cells, applying cubic splines (piece-wise third-order polynomial functions).</td>
<td>Continuous rasters</td>
<td>Higher</td>
<td>Continuous data where smoothness is crucial; terrain modeling.</td>
</tr>
<tr class="odd">
<td>5</td>
<td><strong>Lanczos Resampling</strong></td>
<td>Uses the 36 nearest cells with a Lanczos windowed sinc function for smoother outputs.</td>
<td>Continuous rasters</td>
<td>High</td>
<td>Best for high-quality image scaling; maintains sharpness and reduces aliasing in photographic images.</td>
</tr>
<tr class="even">
<td>6</td>
<td><strong>Sum</strong></td>
<td>Calculates the weighted sum of all non-NA contributing grid cells.</td>
<td>Spatially extensive variables</td>
<td>Variable</td>
<td>Aggregating data like population counts; ensures the total sum remains consistent.</td>
</tr>
<tr class="odd">
<td>7</td>
<td><strong>Min</strong></td>
<td>Finds the minimum value among all non-NA contributing grid cells.</td>
<td>Continuous rasters</td>
<td>Variable</td>
<td>Where the minimum value is of interest, such as finding the lowest temperature in a region.</td>
</tr>
<tr class="even">
<td>8</td>
<td><strong>Q1 (First Quartile)</strong></td>
<td>Computes the first quartile value of all non-NA contributing grid cells.</td>
<td>Continuous rasters</td>
<td>Variable</td>
<td>To understand the lower distribution of data values.</td>
</tr>
<tr class="odd">
<td>9</td>
<td><strong>Median (Med)</strong></td>
<td>Computes the median value of all non-NA contributing grid cells.</td>
<td>Continuous rasters</td>
<td>Variable</td>
<td>Reducing the impact of outliers; in skewed data distributions.</td>
</tr>
<tr class="even">
<td>10</td>
<td><strong>Q3 (Third Quartile)</strong></td>
<td>Computes the third quartile value of all non-NA contributing grid cells.</td>
<td>Continuous rasters</td>
<td>Variable</td>
<td>Focussing on the upper distribution of data values.</td>
</tr>
<tr class="odd">
<td>11</td>
<td><strong>Max</strong></td>
<td>Finds the maximum value among all non-NA contributing grid cells.</td>
<td>Continuous rasters</td>
<td>Variable</td>
<td>Identifying peak values, such as maximum elevation or highest temperature.</td>
</tr>
<tr class="even">
<td>12</td>
<td><strong>Average</strong></td>
<td>Calculates the mean value of all non-NA contributing grid cells.</td>
<td>Continuous rasters</td>
<td>Variable</td>
<td>For smoothing data; provides an overall average.</td>
</tr>
<tr class="odd">
<td>13</td>
<td><strong>Mode</strong></td>
<td>Identifies the most frequent value among all non-NA contributing grid cells.</td>
<td>Continuous rasters</td>
<td>Variable</td>
<td>For categorical data; to determine the most common land cover type.</td>
</tr>
<tr class="even">
<td>14</td>
<td><strong>RMS (Root Mean Square)</strong></td>
<td>Computes the root mean square of all non-NA contributing grid cells.</td>
<td>Continuous rasters</td>
<td>Variable</td>
<td>In error analysis; For assessing the variability in data values.</td>
</tr>
</tbody>
</table>
<ul>
<li><p><strong>Notes:</strong></p>
<ul>
<li><strong>Nearest Neighbor</strong> is the preferred method for categorical data to prevent the creation of non-existent categories.</li>
<li><strong>Bilinear, Cubic, Cubic Spline, and Lanczos methods</strong> are more appropriate for continuous data, offering varying degrees of smoothness and detail preservation.</li>
</ul></li>
<li><p><strong>Categorical vs.&nbsp;Continuous</strong>:</p>
<ul>
<li>Only <em>nearest neighbor</em> is suitable for categorical rasters.</li>
<li>Other methods can be used for continuous rasters but vary in outcomes, complexity, and processing time.</li>
</ul></li>
<li><p><strong>Additional Options</strong>:</p>
<ul>
<li><strong>Statistical Resampling</strong>:
<ul>
<li>Methods like sum, min, med, mode, and rms compute statistics over contributing cells.</li>
<li>Example: <code>sum</code> ensures the total remains unchanged for spatially extensive variables (e.g., population).</li>
</ul></li>
</ul></li>
<li><p><strong>Implementation in terra</strong>:</p>
<ul>
<li>Use the <code>resample()</code> function (<a href="https://rspatial.org/terra/reference/resample.html">documentation</a>).</li>
<li>Requires:
<ul>
<li><strong>Input Raster (x)</strong>: Original raster.</li>
<li><strong>Target Raster (y)</strong>: Raster with desired resolution/origin.</li>
<li><strong>Method</strong>: Resampling method (e.g., “bilinear”).</li>
</ul></li>
</ul></li>
<li><p>Note: Raster Re-projection is a special case of raster re-sampling. A specific type of re-sampling used for target rasters with different Coordinate Reference Systems (CRS).</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Encode Sans Condensed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>)</span>
<span id="cb18-2">showtext<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb18-3">original_raster <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/dem.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>))</span>
<span id="cb18-4"></span>
<span id="cb18-5">resampling_methods_tbl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb18-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb18-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"near"</span>,</span>
<span id="cb18-8">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bilinear"</span>,</span>
<span id="cb18-9">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cubic"</span>,</span>
<span id="cb18-10">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cubicspline"</span>,</span>
<span id="cb18-11">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lanczos"</span>,</span>
<span id="cb18-12">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sum"</span>,</span>
<span id="cb18-13">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"min"</span>,</span>
<span id="cb18-14">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q1"</span>,</span>
<span id="cb18-15">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"median"</span>,</span>
<span id="cb18-16">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q3"</span>,</span>
<span id="cb18-17">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max"</span>,</span>
<span id="cb18-18">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"average"</span>,</span>
<span id="cb18-19">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mode"</span>,</span>
<span id="cb18-20">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rms"</span></span>
<span id="cb18-21">  ),</span>
<span id="cb18-22">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">description =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb18-23">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nearest Neighbor"</span>,</span>
<span id="cb18-24">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bilinear Interpolation"</span>,</span>
<span id="cb18-25">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cubic Interpolation"</span>,</span>
<span id="cb18-26">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cubic Spline Interpolation"</span>,</span>
<span id="cb18-27">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Lanczos Resampling"</span>,</span>
<span id="cb18-28">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sum"</span>,</span>
<span id="cb18-29">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Minimum"</span>,</span>
<span id="cb18-30">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"First Quartile"</span>,</span>
<span id="cb18-31">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Median"</span>,</span>
<span id="cb18-32">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Third Quartile"</span>,</span>
<span id="cb18-33">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Maximum"</span>,</span>
<span id="cb18-34">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Average (Mean)"</span>,</span>
<span id="cb18-35">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mode"</span>,</span>
<span id="cb18-36">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Root Mean Square"</span></span>
<span id="cb18-37">  )</span>
<span id="cb18-38">)</span>
<span id="cb18-39"></span>
<span id="cb18-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A Target Raster for re-sampling</span></span>
<span id="cb18-41">target_rast <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">794650</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">798250</span>, </span>
<span id="cb18-42">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8931750</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8935350</span>,</span>
<span id="cb18-43">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resolution =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:32717"</span>)</span>
<span id="cb18-44"></span>
<span id="cb18-45">theme_custom <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(...){</span>
<span id="cb18-46">  ggthemes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_map</span>(</span>
<span id="cb18-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb18-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span></span>
<span id="cb18-49">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-50">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb18-51">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb18-52">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>, </span>
<span id="cb18-53">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb18-54">      ),</span>
<span id="cb18-55">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb18-56">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb18-57">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb18-58">      ),</span>
<span id="cb18-59">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb18-60">      ...</span>
<span id="cb18-61">    )</span>
<span id="cb18-62">}</span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> original_raster) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb19-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Original Raster"</span></span>
<span id="cb19-7">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>()</span>
<span id="cb19-10"></span>
<span id="cb19-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>)) {</span>
<span id="cb19-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">assign</span>(</span>
<span id="cb19-13">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"g"</span>, i),</span>
<span id="cb19-14">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-15">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb19-16">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">resample</span>(</span>
<span id="cb19-17">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> original_raster,</span>
<span id="cb19-18">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> target_rast,</span>
<span id="cb19-19">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> resampling_methods_tbl<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>name[i]</span>
<span id="cb19-20">        )</span>
<span id="cb19-21">      ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-22">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-23">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-24">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb19-25">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(resampling_methods_tbl<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>description[i]),</span>
<span id="cb19-26">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb19-27">      ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-28">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>(</span>
<span id="cb19-29">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.height =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb19-30">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb19-31">      )</span>
<span id="cb19-32">  )</span>
<span id="cb19-33">}</span>
<span id="cb19-34"></span>
<span id="cb19-35">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g5 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g7 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g12 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g13 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g14 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb19-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(</span>
<span id="cb19-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guides =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"collect"</span>,</span>
<span id="cb19-38">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb19-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb19-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methods for Re-sampling rasters with {terra}"</span>,</span>
<span id="cb19-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb19-42">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb19-43">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb19-44">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>,</span>
<span id="cb19-45">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb19-46">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb19-47">      ),</span>
<span id="cb19-48">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span></span>
<span id="cb19-49">    )</span>
<span id="cb19-50">  )</span>
<span id="cb19-51"></span>
<span id="cb19-52"></span>
<span id="cb19-53"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb19-54">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb19-55">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb19-56">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter5-3-4_1.png"</span>),</span>
<span id="cb19-57">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb19-58">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2400</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb19-59">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2400</span>,</span>
<span id="cb19-60">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb19-61">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb19-62">)</span></code></pre></div>
</details>
</div>
<div id="fig-resample" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-resample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter5-3-4_1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20" title="Figure&nbsp;12: Various methods for re-sampling a raster with terra::resample()"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter5-3-4_1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-resample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: Various methods for re-sampling a raster with <code>terra::resample()</code>
</figcaption>
</figure>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load required libraries</span></span>
<span id="cb20-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tibble)</span>
<span id="cb20-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gt)</span>
<span id="cb20-4"></span>
<span id="cb20-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the resampling methods table as a tibble</span></span>
<span id="cb20-6">resampling_methods <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> tibble<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb20-7">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Resampling Method</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb20-8">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nearest Neighbor"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bilinear Interpolation"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cubic Interpolation"</span>, </span>
<span id="cb20-9">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cubic Spline Interpolation"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Lanczos Resampling"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sum"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Min"</span>, </span>
<span id="cb20-10">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Q1 (First Quartile)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Median (Med)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Q3 (Third Quartile)"</span>, </span>
<span id="cb20-11">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Max"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Average"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mode"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RMS (Root Mean Square)"</span></span>
<span id="cb20-12">  ),</span>
<span id="cb20-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Description =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb20-14">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Assigns the value of the nearest cell of the original raster to the target cell."</span>,</span>
<span id="cb20-15">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Computes a weighted average of the four nearest cells from the original raster for the target cell."</span>,</span>
<span id="cb20-16">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Uses the values of the 16 nearest cells, applying third-order polynomial functions for smooth output."</span>,</span>
<span id="cb20-17">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Uses the 16 nearest cells, applying cubic splines (piece-wise third-order polynomial functions)."</span>,</span>
<span id="cb20-18">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Uses the 36 nearest cells with a Lanczos windowed sinc function for smoother outputs."</span>,</span>
<span id="cb20-19">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Calculates the weighted sum of all non-NA contributing grid cells."</span>,</span>
<span id="cb20-20">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Finds the minimum value among all non-NA contributing grid cells."</span>,</span>
<span id="cb20-21">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Computes the first quartile value of all non-NA contributing grid cells."</span>,</span>
<span id="cb20-22">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Computes the median value of all non-NA contributing grid cells."</span>,</span>
<span id="cb20-23">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Computes the third quartile value of all non-NA contributing grid cells."</span>,</span>
<span id="cb20-24">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Finds the maximum value among all non-NA contributing grid cells."</span>,</span>
<span id="cb20-25">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Calculates the mean value of all non-NA contributing grid cells."</span>,</span>
<span id="cb20-26">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Identifies the most frequent value among all non-NA contributing grid cells."</span>,</span>
<span id="cb20-27">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Computes the root mean square of all non-NA contributing grid cells."</span></span>
<span id="cb20-28">  ),</span>
<span id="cb20-29">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Suitable For</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb20-30">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Categorical rasters"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Continuous rasters"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Continuous rasters"</span>, </span>
<span id="cb20-31">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Continuous rasters"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Continuous rasters"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Spatially extensive variables"</span>, </span>
<span id="cb20-32">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Continuous rasters"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Continuous rasters"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Continuous rasters"</span>, </span>
<span id="cb20-33">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Continuous rasters"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Continuous rasters"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Continuous rasters"</span>, </span>
<span id="cb20-34">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Continuous rasters"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Continuous rasters"</span></span>
<span id="cb20-35">  ),</span>
<span id="cb20-36">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Complexity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb20-37">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Simple"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Moderate"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Higher"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Higher"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"High"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variable"</span>, </span>
<span id="cb20-38">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variable"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variable"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variable"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variable"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variable"</span>, </span>
<span id="cb20-39">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variable"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variable"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variable"</span></span>
<span id="cb20-40">  ),</span>
<span id="cb20-41">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Processing Time</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb20-42">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fast"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fast"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Moderate"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Moderate"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"High"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variable"</span>, </span>
<span id="cb20-43">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variable"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variable"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variable"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variable"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variable"</span>, </span>
<span id="cb20-44">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variable"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variable"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variable"</span></span>
<span id="cb20-45">  ),</span>
<span id="cb20-46">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Use Case</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb20-47">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ideal for discrete data like land-use classifications; preserves original values without alteration."</span>,</span>
<span id="cb20-48">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Suitable for continuous data; provides smoother transitions, useful for elevation models or temperature data."</span>,</span>
<span id="cb20-49">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Appropriate for continuous data requiring smoother surfaces; beneficial for resampling satellite imagery."</span>,</span>
<span id="cb20-50">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Effective for continuous data where smoothness is crucial; often used in terrain modeling."</span>,</span>
<span id="cb20-51">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Best for high-quality image scaling; maintains sharpness and reduces aliasing in photographic images."</span>,</span>
<span id="cb20-52">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Useful for aggregating data like population counts; ensures the total sum remains consistent after resampling."</span>,</span>
<span id="cb20-53">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Applied in scenarios where the minimum value is of interest, such as finding the lowest temperature in a region."</span>,</span>
<span id="cb20-54">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Useful in statistical analyses to understand the lower distribution of data values."</span>,</span>
<span id="cb20-55">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ideal for reducing the impact of outliers; provides a central tendency measure in skewed data distributions."</span>,</span>
<span id="cb20-56">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Beneficial for statistical analyses focusing on the upper distribution of data values."</span>,</span>
<span id="cb20-57">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Suitable for identifying peak values, such as maximum elevation or highest temperature in a dataset."</span>,</span>
<span id="cb20-58">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Commonly used for smoothing data; provides an overall average, useful in environmental data analyses."</span>,</span>
<span id="cb20-59">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Effective for categorical data to determine the most common category, such as predominant land cover type."</span>,</span>
<span id="cb20-60">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Applied in error analysis; useful for assessing the magnitude of variability in data values."</span></span>
<span id="cb20-61">  )</span>
<span id="cb20-62">)</span>
<span id="cb20-63"></span>
<span id="cb20-64"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display the table using gt</span></span>
<span id="cb20-65">resampling_methods <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb20-66">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb20-67">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(</span>
<span id="cb20-68">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Resampling Methods for rasters in {terra}"</span></span>
<span id="cb20-69">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb20-70">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_espn</span>()</span></code></pre></div>
</details>
<div id="tbl-resample1" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-resample1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Comparison of Resampling Methods for rasters in
</figcaption>
<div aria-describedby="tbl-resample1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="ceqqvrykkc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#ceqqvrykkc table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ceqqvrykkc thead, #ceqqvrykkc tbody, #ceqqvrykkc tfoot, #ceqqvrykkc tr, #ceqqvrykkc td, #ceqqvrykkc th {
  border-style: none;
}

#ceqqvrykkc p {
  margin: 0;
  padding: 0;
}

#ceqqvrykkc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ceqqvrykkc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ceqqvrykkc .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ceqqvrykkc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ceqqvrykkc .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ceqqvrykkc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ceqqvrykkc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ceqqvrykkc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ceqqvrykkc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ceqqvrykkc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ceqqvrykkc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ceqqvrykkc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ceqqvrykkc .gt_spanner_row {
  border-bottom-style: hidden;
}

#ceqqvrykkc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ceqqvrykkc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ceqqvrykkc .gt_from_md > :first-child {
  margin-top: 0;
}

#ceqqvrykkc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ceqqvrykkc .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ceqqvrykkc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ceqqvrykkc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ceqqvrykkc .gt_row_group_first td {
  border-top-width: 2px;
}

#ceqqvrykkc .gt_row_group_first th {
  border-top-width: 2px;
}

#ceqqvrykkc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ceqqvrykkc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ceqqvrykkc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ceqqvrykkc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ceqqvrykkc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ceqqvrykkc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ceqqvrykkc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ceqqvrykkc .gt_striped {
  background-color: #FAFAFA;
}

#ceqqvrykkc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ceqqvrykkc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ceqqvrykkc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ceqqvrykkc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ceqqvrykkc .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ceqqvrykkc .gt_left {
  text-align: left;
}

#ceqqvrykkc .gt_center {
  text-align: center;
}

#ceqqvrykkc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ceqqvrykkc .gt_font_normal {
  font-weight: normal;
}

#ceqqvrykkc .gt_font_bold {
  font-weight: bold;
}

#ceqqvrykkc .gt_font_italic {
  font-style: italic;
}

#ceqqvrykkc .gt_super {
  font-size: 65%;
}

#ceqqvrykkc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ceqqvrykkc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ceqqvrykkc .gt_indent_1 {
  text-indent: 5px;
}

#ceqqvrykkc .gt_indent_2 {
  text-indent: 10px;
}

#ceqqvrykkc .gt_indent_3 {
  text-indent: 15px;
}

#ceqqvrykkc .gt_indent_4 {
  text-indent: 20px;
}

#ceqqvrykkc .gt_indent_5 {
  text-indent: 25px;
}

#ceqqvrykkc .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ceqqvrykkc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="6" class="gt_heading gt_title gt_font_normal gt_bottom_border">Resampling Methods for rasters in {terra}</th>
</tr>
<tr class="odd gt_col_headings">
<th id="Resampling Method" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Resampling Method</th>
<th id="Description" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Description</th>
<th id="Suitable For" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Suitable For</th>
<th id="Complexity" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Complexity</th>
<th id="Processing Time" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Processing Time</th>
<th id="Use Case" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Use Case</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Resampling Method">Nearest Neighbor</td>
<td class="gt_row gt_left" headers="Description">Assigns the value of the nearest cell of the original raster to the target cell.</td>
<td class="gt_row gt_left" headers="Suitable For">Categorical rasters</td>
<td class="gt_row gt_left" headers="Complexity">Simple</td>
<td class="gt_row gt_left" headers="Processing Time">Fast</td>
<td class="gt_row gt_left" headers="Use Case">Ideal for discrete data like land-use classifications; preserves original values without alteration.</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" headers="Resampling Method">Bilinear Interpolation</td>
<td class="gt_row gt_left gt_striped" headers="Description">Computes a weighted average of the four nearest cells from the original raster for the target cell.</td>
<td class="gt_row gt_left gt_striped" headers="Suitable For">Continuous rasters</td>
<td class="gt_row gt_left gt_striped" headers="Complexity">Moderate</td>
<td class="gt_row gt_left gt_striped" headers="Processing Time">Fast</td>
<td class="gt_row gt_left gt_striped" headers="Use Case">Suitable for continuous data; provides smoother transitions, useful for elevation models or temperature data.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Resampling Method">Cubic Interpolation</td>
<td class="gt_row gt_left" headers="Description">Uses the values of the 16 nearest cells, applying third-order polynomial functions for smooth output.</td>
<td class="gt_row gt_left" headers="Suitable For">Continuous rasters</td>
<td class="gt_row gt_left" headers="Complexity">Higher</td>
<td class="gt_row gt_left" headers="Processing Time">Moderate</td>
<td class="gt_row gt_left" headers="Use Case">Appropriate for continuous data requiring smoother surfaces; beneficial for resampling satellite imagery.</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" headers="Resampling Method">Cubic Spline Interpolation</td>
<td class="gt_row gt_left gt_striped" headers="Description">Uses the 16 nearest cells, applying cubic splines (piece-wise third-order polynomial functions).</td>
<td class="gt_row gt_left gt_striped" headers="Suitable For">Continuous rasters</td>
<td class="gt_row gt_left gt_striped" headers="Complexity">Higher</td>
<td class="gt_row gt_left gt_striped" headers="Processing Time">Moderate</td>
<td class="gt_row gt_left gt_striped" headers="Use Case">Effective for continuous data where smoothness is crucial; often used in terrain modeling.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Resampling Method">Lanczos Resampling</td>
<td class="gt_row gt_left" headers="Description">Uses the 36 nearest cells with a Lanczos windowed sinc function for smoother outputs.</td>
<td class="gt_row gt_left" headers="Suitable For">Continuous rasters</td>
<td class="gt_row gt_left" headers="Complexity">High</td>
<td class="gt_row gt_left" headers="Processing Time">High</td>
<td class="gt_row gt_left" headers="Use Case">Best for high-quality image scaling; maintains sharpness and reduces aliasing in photographic images.</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" headers="Resampling Method">Sum</td>
<td class="gt_row gt_left gt_striped" headers="Description">Calculates the weighted sum of all non-NA contributing grid cells.</td>
<td class="gt_row gt_left gt_striped" headers="Suitable For">Spatially extensive variables</td>
<td class="gt_row gt_left gt_striped" headers="Complexity">Variable</td>
<td class="gt_row gt_left gt_striped" headers="Processing Time">Variable</td>
<td class="gt_row gt_left gt_striped" headers="Use Case">Useful for aggregating data like population counts; ensures the total sum remains consistent after resampling.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Resampling Method">Min</td>
<td class="gt_row gt_left" headers="Description">Finds the minimum value among all non-NA contributing grid cells.</td>
<td class="gt_row gt_left" headers="Suitable For">Continuous rasters</td>
<td class="gt_row gt_left" headers="Complexity">Variable</td>
<td class="gt_row gt_left" headers="Processing Time">Variable</td>
<td class="gt_row gt_left" headers="Use Case">Applied in scenarios where the minimum value is of interest, such as finding the lowest temperature in a region.</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" headers="Resampling Method">Q1 (First Quartile)</td>
<td class="gt_row gt_left gt_striped" headers="Description">Computes the first quartile value of all non-NA contributing grid cells.</td>
<td class="gt_row gt_left gt_striped" headers="Suitable For">Continuous rasters</td>
<td class="gt_row gt_left gt_striped" headers="Complexity">Variable</td>
<td class="gt_row gt_left gt_striped" headers="Processing Time">Variable</td>
<td class="gt_row gt_left gt_striped" headers="Use Case">Useful in statistical analyses to understand the lower distribution of data values.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Resampling Method">Median (Med)</td>
<td class="gt_row gt_left" headers="Description">Computes the median value of all non-NA contributing grid cells.</td>
<td class="gt_row gt_left" headers="Suitable For">Continuous rasters</td>
<td class="gt_row gt_left" headers="Complexity">Variable</td>
<td class="gt_row gt_left" headers="Processing Time">Variable</td>
<td class="gt_row gt_left" headers="Use Case">Ideal for reducing the impact of outliers; provides a central tendency measure in skewed data distributions.</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" headers="Resampling Method">Q3 (Third Quartile)</td>
<td class="gt_row gt_left gt_striped" headers="Description">Computes the third quartile value of all non-NA contributing grid cells.</td>
<td class="gt_row gt_left gt_striped" headers="Suitable For">Continuous rasters</td>
<td class="gt_row gt_left gt_striped" headers="Complexity">Variable</td>
<td class="gt_row gt_left gt_striped" headers="Processing Time">Variable</td>
<td class="gt_row gt_left gt_striped" headers="Use Case">Beneficial for statistical analyses focusing on the upper distribution of data values.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Resampling Method">Max</td>
<td class="gt_row gt_left" headers="Description">Finds the maximum value among all non-NA contributing grid cells.</td>
<td class="gt_row gt_left" headers="Suitable For">Continuous rasters</td>
<td class="gt_row gt_left" headers="Complexity">Variable</td>
<td class="gt_row gt_left" headers="Processing Time">Variable</td>
<td class="gt_row gt_left" headers="Use Case">Suitable for identifying peak values, such as maximum elevation or highest temperature in a dataset.</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" headers="Resampling Method">Average</td>
<td class="gt_row gt_left gt_striped" headers="Description">Calculates the mean value of all non-NA contributing grid cells.</td>
<td class="gt_row gt_left gt_striped" headers="Suitable For">Continuous rasters</td>
<td class="gt_row gt_left gt_striped" headers="Complexity">Variable</td>
<td class="gt_row gt_left gt_striped" headers="Processing Time">Variable</td>
<td class="gt_row gt_left gt_striped" headers="Use Case">Commonly used for smoothing data; provides an overall average, useful in environmental data analyses.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Resampling Method">Mode</td>
<td class="gt_row gt_left" headers="Description">Identifies the most frequent value among all non-NA contributing grid cells.</td>
<td class="gt_row gt_left" headers="Suitable For">Continuous rasters</td>
<td class="gt_row gt_left" headers="Complexity">Variable</td>
<td class="gt_row gt_left" headers="Processing Time">Variable</td>
<td class="gt_row gt_left" headers="Use Case">Effective for categorical data to determine the most common category, such as predominant land cover type.</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" headers="Resampling Method">RMS (Root Mean Square)</td>
<td class="gt_row gt_left gt_striped" headers="Description">Computes the root mean square of all non-NA contributing grid cells.</td>
<td class="gt_row gt_left gt_striped" headers="Suitable For">Continuous rasters</td>
<td class="gt_row gt_left gt_striped" headers="Complexity">Variable</td>
<td class="gt_row gt_left gt_striped" headers="Processing Time">Variable</td>
<td class="gt_row gt_left gt_striped" headers="Use Case">Applied in error analysis; useful for assessing the magnitude of variability in data values.</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Alternatives to <code>{terra}</code> Functions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Why Alternatives?</strong> While <code>{terra}</code> is user-friendly and performs well for large rasters, it may not be the most efficient for extensive rasters or numerous raster files.</li>
<li><strong>Key Alternatives via C++ Library GDAL (accessed via <code>{gdalUtilities}</code> or <a href="https://r-spatial.github.io/sf/reference/gdal_utils.html"><code>sf::gdal_utils()</code></a> function)</strong>:
<ul>
<li><strong><code>gdalinfo</code></strong>:
<ul>
<li>Provides detailed information about a raster file (e.g., resolution, CRS, bounding box).</li>
<li>Useful for metadata exploration.</li>
</ul></li>
<li><strong><code>gdal_translate</code></strong>:
<ul>
<li>Converts raster files between formats.</li>
<li>Can also modify properties like compression or CRS (e.g., <code>t_srs = "EPSG:4326"</code>).</li>
</ul></li>
<li><strong><code>gdal_rasterize</code></strong>:
<ul>
<li>Converts vector data into raster format.</li>
<li>Ideal for creating rasterized maps from vector datasets.</li>
</ul></li>
<li><strong><code>gdalwarp</code></strong>:
<ul>
<li>Performs raster mosaicing, cropping, resampling, and reprojection.</li>
<li>Essential for combining rasters, altering extents, or changing resolutions.</li>
</ul></li>
</ul></li>
<li><strong>Integration with R</strong>:
<ul>
<li>GDAL functions are written in C++ but can be accessed in R using:
<ul>
<li><strong><code>sf::gdal_utils()</code></strong>: Wrapper for calling GDAL functions.</li>
<li><strong><code>gdalUtilities</code></strong> package: Dedicated functions for common GDAL tasks.</li>
<li><strong>System Commands</strong>: Directly call GDAL commands from the terminal within R.</li>
</ul></li>
<li>Input/output handling:
<ul>
<li>GDAL functions work with file paths. Output is often saved as a file rather than in-memory objects like <code>{terra}</code>’s <code>SpatRaster</code>.</li>
</ul></li>
</ul></li>
<li><strong>When to Use GDAL</strong>:
<ul>
<li>For handling very large datasets or batch processing of raster files.</li>
<li>When advanced raster operations (e.g., raster mosaics) are required.</li>
<li>For compatibility with diverse raster file formats and global standards.</li>
</ul></li>
</ul>
</div>
</div>
</section>
</section>
<section id="exercises" class="level2">
<h2 class="anchored" data-anchor-id="exercises">5.4 Exercises</h2>
<section id="e1." class="level3">
<h3 class="anchored" data-anchor-id="e1.">E1.</h3>
<p><strong>Generate and plot simplified versions of the <code>nz</code> dataset. Experiment with different values of <code>keep</code> (ranging from 0.5 to 0.00005) for <code>ms_simplify()</code> and <code>dTolerance</code> (from 100 to 100,000) <a href="https://r-spatial.github.io/sf/reference/geos_unary.html"><code>st_simplify()</code></a>.</strong></p>
<p>The plots for different levels of <code>keep</code> in <code>ms_simplify()</code> are shown in Figure&nbsp;13.</p>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nz"</span>)</span>
<span id="cb21-2"></span>
<span id="cb21-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.005</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0005</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00005</span>)) {</span>
<span id="cb21-4">  g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb21-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> nz <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> rmapshaper<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ms_simplify</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">keep =</span> i)</span>
<span id="cb21-6">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb21-10">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb21-11">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, </span>
<span id="cb21-12">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb21-13">      )</span>
<span id="cb21-14">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb21-16">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"st_simplify(keep = "</span>, i, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span>)</span>
<span id="cb21-17">    )</span>
<span id="cb21-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(g)</span>
<span id="cb21-19">}</span></code></pre></div>
</details>
<div id="fig-e1-ms-simplify" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-e1-ms-simplify-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-e1-ms-simplify" style="flex-basis: 20.0%;justify-content: flex-start;">
<div id="fig-e1-ms-simplify-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e1-ms-simplify-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter5_files/figure-html/fig-e1-ms-simplify-1.png" class="lightbox" data-gallery="fig-e1-ms-simplify" title="Figure&nbsp;13&nbsp;(a): keep = 0.5"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter5_files/figure-html/fig-e1-ms-simplify-1.png" class="img-fluid figure-img" data-ref-parent="fig-e1-ms-simplify" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e1-ms-simplify-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) keep = 0.5
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-e1-ms-simplify" style="flex-basis: 20.0%;justify-content: flex-start;">
<div id="fig-e1-ms-simplify-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e1-ms-simplify-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter5_files/figure-html/fig-e1-ms-simplify-2.png" class="lightbox" data-gallery="fig-e1-ms-simplify" title="Figure&nbsp;13&nbsp;(b): keep = 0.05"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter5_files/figure-html/fig-e1-ms-simplify-2.png" class="img-fluid figure-img" data-ref-parent="fig-e1-ms-simplify" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e1-ms-simplify-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) keep = 0.05
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-e1-ms-simplify" style="flex-basis: 20.0%;justify-content: flex-start;">
<div id="fig-e1-ms-simplify-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e1-ms-simplify-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter5_files/figure-html/fig-e1-ms-simplify-3.png" class="lightbox" data-gallery="fig-e1-ms-simplify" title="Figure&nbsp;13&nbsp;(c): keep = 0.005"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter5_files/figure-html/fig-e1-ms-simplify-3.png" class="img-fluid figure-img" data-ref-parent="fig-e1-ms-simplify" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e1-ms-simplify-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) keep = 0.005
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-e1-ms-simplify" style="flex-basis: 20.0%;justify-content: flex-start;">
<div id="fig-e1-ms-simplify-4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e1-ms-simplify-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter5_files/figure-html/fig-e1-ms-simplify-4.png" class="lightbox" data-gallery="fig-e1-ms-simplify" title="Figure&nbsp;13&nbsp;(d): keep = 0.0005"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter5_files/figure-html/fig-e1-ms-simplify-4.png" class="img-fluid figure-img" data-ref-parent="fig-e1-ms-simplify" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e1-ms-simplify-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d) keep = 0.0005
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-e1-ms-simplify" style="flex-basis: 20.0%;justify-content: flex-start;">
<div id="fig-e1-ms-simplify-5" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e1-ms-simplify-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter5_files/figure-html/fig-e1-ms-simplify-5.png" class="lightbox" data-gallery="fig-e1-ms-simplify" title="Figure&nbsp;13&nbsp;(e): keep = 0.00005"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter5_files/figure-html/fig-e1-ms-simplify-5.png" class="img-fluid figure-img" data-ref-parent="fig-e1-ms-simplify" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e1-ms-simplify-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(e) keep = 0.00005
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-e1-ms-simplify-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13: Different keep levels in rmapshaper::ms_simplify()
</figcaption>
</figure>
</div>
<p>The plots for different levels of <code>dTolerance</code> within <code>st_simplify()</code> are in Figure&nbsp;14.</p>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nz"</span>)</span>
<span id="cb22-2"></span>
<span id="cb22-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100000</span>)) {</span>
<span id="cb22-4">  g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb22-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> nz <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_simplify</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dTolerance =</span> i)</span>
<span id="cb22-6">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb22-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb22-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb22-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb22-10">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb22-11">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, </span>
<span id="cb22-12">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb22-13">      )</span>
<span id="cb22-14">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb22-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb22-16">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"st_simplify(dTolerance = "</span>, i, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span>)</span>
<span id="cb22-17">    )</span>
<span id="cb22-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(g)</span>
<span id="cb22-19">}</span></code></pre></div>
</details>
<div id="fig-e1-st-simplify" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-e1-st-simplify-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-e1-st-simplify" style="flex-basis: 25.0%;justify-content: flex-start;">
<div id="fig-e1-st-simplify-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e1-st-simplify-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter5_files/figure-html/fig-e1-st-simplify-1.png" class="lightbox" data-gallery="fig-e1-st-simplify" title="Figure&nbsp;14&nbsp;(a): dTolerance = 100"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter5_files/figure-html/fig-e1-st-simplify-1.png" class="img-fluid figure-img" data-ref-parent="fig-e1-st-simplify" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e1-st-simplify-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) dTolerance = 100
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-e1-st-simplify" style="flex-basis: 25.0%;justify-content: flex-start;">
<div id="fig-e1-st-simplify-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e1-st-simplify-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter5_files/figure-html/fig-e1-st-simplify-2.png" class="lightbox" data-gallery="fig-e1-st-simplify" title="Figure&nbsp;14&nbsp;(b): dTolerance = 1000"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter5_files/figure-html/fig-e1-st-simplify-2.png" class="img-fluid figure-img" data-ref-parent="fig-e1-st-simplify" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e1-st-simplify-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) dTolerance = 1000
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-e1-st-simplify" style="flex-basis: 25.0%;justify-content: flex-start;">
<div id="fig-e1-st-simplify-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e1-st-simplify-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter5_files/figure-html/fig-e1-st-simplify-3.png" class="lightbox" data-gallery="fig-e1-st-simplify" title="Figure&nbsp;14&nbsp;(c): dTolerance = 10000"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter5_files/figure-html/fig-e1-st-simplify-3.png" class="img-fluid figure-img" data-ref-parent="fig-e1-st-simplify" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e1-st-simplify-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) dTolerance = 10000
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-e1-st-simplify" style="flex-basis: 25.0%;justify-content: flex-start;">
<div id="fig-e1-st-simplify-4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e1-st-simplify-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter5_files/figure-html/fig-e1-st-simplify-4.png" class="lightbox" data-gallery="fig-e1-st-simplify" title="Figure&nbsp;14&nbsp;(d): dTolerance = 100000"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter5_files/figure-html/fig-e1-st-simplify-4.png" class="img-fluid figure-img" data-ref-parent="fig-e1-st-simplify" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e1-st-simplify-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d) dTolerance = 100000
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-e1-st-simplify-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14: Different dTolerance levels in st_simplify()
</figcaption>
</figure>
</div>
<ul>
<li><p><strong>At what value does the form of the result start to break down for each method, making New Zealand unrecognizable?</strong></p>
<p>For the <code>rmapshaper::ms_simplify()</code> method, the result starts to break down at <code>keep = 0.005</code> . For the <code>sf::st_simplify()</code> method, the result starts to break down around <code>dTolerance = 10000</code> .</p></li>
<li><p><strong>Advanced: What is different about the geometry type of the results from <a href="https://r-spatial.github.io/sf/reference/geos_unary.html"><code>st_simplify()</code></a> compared with the geometry type of <code>ms_simplify()</code>? What problems does this create and how can this be resolved?</strong></p>
<p>The results from <code>st_simplify()</code> can be of multiple geometry types: MULTIPOLYGON or POLYGON, where as the results from <code>ms_simplify()</code> are always of a single geometry type: POLYGON.</p>
<p>Problems Created by <code>st_simplify()</code></p>
<ul>
<li><p>The invalid geometries produced by <code>st_simplify()</code> can lead to errors in subsequent spatial operations, such as overlays, spatial joins, or intersections.</p></li>
<li><p>For example, functions like <code>st_intersection()</code> or <code>st_union()</code> may fail or produce incorrect results when operating on invalid geometries.</p></li>
</ul>
<p>Resolution: Using <code>st_cast()</code> to convert all geometries into a single type.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Number of features in New Zealand Dataset</span></span>
<span id="cb23-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(nz)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># New Zealand data after st_simplify(): some features are MULTIPLOYGON, and some are POLYGON</span></span>
<span id="cb25-2">nz <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb25-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_simplify</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dTolerance =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb25-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sfc</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Geometry set for 16 features 
Geometry type: GEOMETRY
Dimension:     XY
Bounding box:  xmin: 1090144 ymin: 4748537 xmax: 2089533 ymax: 6191874
Projected CRS: NZGD2000 / New Zealand Transverse Mercator 2000
First 5 geometries:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Resolution: cast them into any one type using st_cast()</span></span>
<span id="cb27-2">nz <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb27-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_simplify</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dTolerance =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb27-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sfc</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb27-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_cast</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"POLYGON"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Geometry set for 16 features 
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 1090144 ymin: 4823273 xmax: 2089533 ymax: 6191874
Projected CRS: NZGD2000 / New Zealand Transverse Mercator 2000
First 5 geometries:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1">nz <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb29-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_simplify</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dTolerance =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb29-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sfc</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb29-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_cast</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MULTIPOLYGON"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Geometry set for 16 features 
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 1090144 ymin: 4748537 xmax: 2089533 ymax: 6191874
Projected CRS: NZGD2000 / New Zealand Transverse Mercator 2000
First 5 geometries:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1">nz <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb31-2">  rmapshaper<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ms_simplify</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">keep =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.005</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb31-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sfc</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Geometry set for 14 features 
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 1091224 ymin: 4830067 xmax: 2049387 ymax: 6001802
Projected CRS: NZGD2000 / New Zealand Transverse Mercator 2000
First 5 geometries:</code></pre>
</div>
</div>
</section>
<section id="e2." class="level3">
<h3 class="anchored" data-anchor-id="e2.">E2.</h3>
<p><strong>In the first exercise in Chapter Spatial Data Operations it was established that Canterbury region had 70 of the 101 highest points in New Zealand. Using <a href="https://r-spatial.github.io/sf/reference/geos_unary.html"><code>st_buffer()</code></a>, how many points in <code>nz_height</code> are within 100 km of Canterbury?</strong></p>
<p>Out of the 101 heights, 95 of them fall within 100 km of the Canterbury region, as explained in the code below, and as shown in Figure&nbsp;15</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nz_height"</span>)</span>
<span id="cb33-2"></span>
<span id="cb33-3">nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 101</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1">canterbury_bf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nz <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb35-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canterbury"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb35-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_buffer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100000</span>)</span>
<span id="cb35-4"></span>
<span id="cb35-5">nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb35-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_filter</span>(canterbury_bf) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb35-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 95</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1">selected <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb37-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_filter</span>(canterbury_bf) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb37-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(t50_fid)</span>
<span id="cb37-4"></span>
<span id="cb37-5">nz_height <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb37-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour_var =</span> t50_fid <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> selected)</span>
<span id="cb37-7"></span>
<span id="cb37-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb37-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> nz) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb37-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb37-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> canterbury_bf,</span>
<span id="cb37-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span>
<span id="cb37-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb37-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb37-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> nz_height,</span>
<span id="cb37-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> colour_var),</span>
<span id="cb37-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>,</span>
<span id="cb37-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">17</span></span>
<span id="cb37-19">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb37-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_manual</span>(</span>
<span id="cb37-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span>
<span id="cb37-22">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb37-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb37-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Within 100 km</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">of Canterbury?"</span></span>
<span id="cb37-25">  )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-e2" class="quarto-float quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-e2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter5_files/figure-html/fig-e2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-30" title="Figure&nbsp;15: "><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter5_files/figure-html/fig-e2-1.png" id="fig-e2" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-e2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="e3." class="level3">
<h3 class="anchored" data-anchor-id="e3.">E3.</h3>
<p><strong>Find the geographic centroid of New Zealand. How far is it from the geographic centroid of Canterbury?</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(nz)</span>
<span id="cb38-2"></span>
<span id="cb38-3">nz_centre <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nz <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb38-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combining entire New Zealand into a geometry</span></span>
<span id="cb38-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_union</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb38-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_centroid</span>()</span>
<span id="cb38-7"></span>
<span id="cb38-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Geographic Centroid of New Zealand</span></span>
<span id="cb38-9">nz_centre <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb38-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb38-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_vector</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb38-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb38-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" Longitude;  "</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" Latitude"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "172.842 Longitude;  -41.684 Latitude"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1">canterbury_centre <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nz <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb40-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canterbury"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb40-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_centroid</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb40-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sfc</span>()</span>
<span id="cb40-5"></span>
<span id="cb40-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Geographic Centroid of Canterbury</span></span>
<span id="cb40-7">canterbury_centre <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb40-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb40-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_vector</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb40-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb40-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" Longitude;  "</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" Latitude"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)  </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "171.572 Longitude;  -43.573 Latitude"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Distance between the two centroid</span></span>
<span id="cb42-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_distance</span>(nz_centre, canterbury_centre) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.vector</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">multiply_by</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.001</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" km"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "234.19 km"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1">line_centres <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_union</span>(</span>
<span id="cb44-2">  nz_centre,</span>
<span id="cb44-3">  canterbury_centre</span>
<span id="cb44-4">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb44-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_cast</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LINESTRING"</span>)</span>
<span id="cb44-6"></span>
<span id="cb44-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb44-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> nz, </span>
<span id="cb44-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canterbury"</span>),</span>
<span id="cb44-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb44-12">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>), </span>
<span id="cb44-14">                               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> nz_centre, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> canterbury_centre, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> line_centres, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb44-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance = "</span>,</span>
<span id="cb44-20">                   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_distance</span>(nz_centre, canterbury_centre) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb44-21">                      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.vector</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb44-22">                      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">multiply_by</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.001</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb44-23">                      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb44-24">                      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" km"</span>)</span>
<span id="cb44-25">                  )</span>
<span id="cb44-26">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-27">  ggthemes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_map</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb44-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span></span>
<span id="cb44-30">  )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter5_files/figure-html/unnamed-chunk-25-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-31"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter5_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="e4." class="level3">
<h3 class="anchored" data-anchor-id="e4.">E4.</h3>
<p><strong>Most world maps have a north-up orientation. A world map with a south-up orientation could be created by a reflection (one of the affine transformations not mentioned in this chapter) of the <code>world</code> object’s geometry. Write code to do so. Hint: you can to use the <code>rotation()</code> function from this chapter for this transformation. Bonus: create an upside-down map of your country.</strong></p>
<p>The multiplication of an <code>sfc</code> object with custom function <code>rotation(180)</code> can be used to create a world map with south-up orientation, as shown in Figure&nbsp;16 (b)</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use the rotation function from the textbook</span></span>
<span id="cb45-2">rotation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(a){</span>
<span id="cb45-3">  r <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> a <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#degrees to radians</span></span>
<span id="cb45-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(r), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(r), <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(r), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(r)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb45-5">} </span>
<span id="cb45-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"world"</span>)</span>
<span id="cb45-7">world_up <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> world <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb45-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_geometry</span>()</span>
<span id="cb45-9"></span>
<span id="cb45-10">world_rotate <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (world_up <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rotation</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb45-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_set_crs</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(world_up))</span>
<span id="cb45-12"></span>
<span id="cb45-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb45-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> world_up) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb45-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ESRI:54009"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb45-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span>
<span id="cb45-17"></span>
<span id="cb45-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb45-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> world_rotate) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb45-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ESRI:54009"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb45-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
</details>
<div id="fig-world-rotate" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-world-rotate-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="fig-world-rotate-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-world-rotate-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter5_files/figure-html/fig-world-rotate-1.png" class="lightbox" data-gallery="fig-world-rotate" title="Figure&nbsp;16&nbsp;(a): World map upright"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter5_files/figure-html/fig-world-rotate-1.png" class="img-fluid figure-img" data-ref-parent="fig-world-rotate" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-world-rotate-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) World map upright
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-world-rotate-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-world-rotate-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter5_files/figure-html/fig-world-rotate-2.png" class="lightbox" data-gallery="fig-world-rotate" title="Figure&nbsp;16&nbsp;(b): World map upside-down"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter5_files/figure-html/fig-world-rotate-2.png" class="img-fluid figure-img" data-ref-parent="fig-world-rotate" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-world-rotate-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) World map upside-down
</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-world-rotate-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16: Using a custom rotation() and multiplying the sfc object with rotation(180)
</figcaption>
</figure>
</div>
</div>
</section>
<section id="e5." class="level3">
<h3 class="anchored" data-anchor-id="e5.">E5.</h3>
<p><strong>Run the code in Section <a href="https://r.geocompx.org/geometry-operations#subsetting-and-clipping">5.2.6</a>. With reference to the objects created in that section, subset the point in <code>p</code> that is contained within <code>x</code><em>and</em><code>y</code>.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the two points</span></span>
<span id="cb46-2">b <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sfc</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))) </span>
<span id="cb46-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create circles around those points</span></span>
<span id="cb46-4">b <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_buffer</span>(b, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb46-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Name x and y -- the two circles</span></span>
<span id="cb46-6">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> b[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb46-7">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> b[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb46-8">x_and_y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersection</span>(x, y)</span>
<span id="cb46-9"></span>
<span id="cb46-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Bounding box of x and y</span></span>
<span id="cb46-11">bb <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_bbox</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_union</span>(x, y))</span>
<span id="cb46-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Covert bounding box into a polygon</span></span>
<span id="cb46-13">box <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sfc</span>(bb)</span>
<span id="cb46-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2024</span>)</span>
<span id="cb46-15">p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sample</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> box, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span></code></pre></div>
</div>
<ul>
<li><p><strong>Using base subsetting operators.</strong> Answer is shown in Figure&nbsp;17</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1">p_xy1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> p[x_and_y]</span>
<span id="cb47-2"></span>
<span id="cb47-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb47-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> b, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb47-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> p, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb47-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> p_xy1, </span>
<span id="cb47-7">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>,</span>
<span id="cb47-8">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>,</span>
<span id="cb47-9">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb47-10">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,</span>
<span id="cb47-11">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stroke =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-e5-a" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-e5-a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter5_files/figure-html/fig-e5-a-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-34" title="Figure&nbsp;17: Using base r [] operator"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter5_files/figure-html/fig-e5-a-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-e5-a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17: Using base r [] operator
</figcaption>
</figure>
</div>
</div>
</div></li>
<li><p><strong>Using an intermediary object created with <a href="https://r-spatial.github.io/sf/reference/geos_binary_ops.html"><code>st_intersection()</code></a>.</strong> Answer is shown in Figure&nbsp;18</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb48-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb48-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">highlight =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersects</span>(x, x_and_y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F))</span>
<span id="cb48-4"></span>
<span id="cb48-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb48-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> b, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb48-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb48-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> p1,</span>
<span id="cb48-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb48-10">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> highlight</span>
<span id="cb48-11">    ),</span>
<span id="cb48-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb48-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb48-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-e5-b" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-e5-b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter5_files/figure-html/fig-e5-b-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-35" title="Figure&nbsp;18: Using sf::st_intersection()"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter5_files/figure-html/fig-e5-b-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-e5-b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18: Using sf::st_intersection()
</figcaption>
</figure>
</div>
</div>
</div></li>
</ul>
</section>
<section id="e6." class="level3">
<h3 class="anchored" data-anchor-id="e6.">E6.</h3>
<p><strong>Calculate the length of the boundary lines of US states in meters. Which state has the longest border and which has the shortest? Hint: The <code>st_length</code> function computes the length of a <code>LINESTRING</code> or <code>MULTILINESTRING</code> geometry.</strong></p>
<p>The longest border is of Texas (4,959.8 km) and the shortest border is of District of Columbia (60.2 km). The complete list is at Table&nbsp;3 .</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"us_states"</span>)</span>
<span id="cb49-2"></span>
<span id="cb49-3">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb49-4">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb49-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_cast</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MULTILINESTRING"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb49-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">border =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_length</span>(geometry))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb49-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb49-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(name, region, border) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb49-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(border)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb49-10">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb49-11">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label</span>(</span>
<span id="cb49-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"State Name"</span>,</span>
<span id="cb49-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">region =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Region"</span>,</span>
<span id="cb49-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">border =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Length of Border (km)"</span></span>
<span id="cb49-15">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb49-16">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>(</span>
<span id="cb49-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> border</span>
<span id="cb49-18">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb49-19">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>()</span></code></pre></div>
</details>
<div id="tbl-e6" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-e6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: The border length of the different states in USA
</figcaption>
<div aria-describedby="tbl-e6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="zlrzuakcin" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#zlrzuakcin table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#zlrzuakcin thead, #zlrzuakcin tbody, #zlrzuakcin tfoot, #zlrzuakcin tr, #zlrzuakcin td, #zlrzuakcin th {
  border-style: none;
}

#zlrzuakcin p {
  margin: 0;
  padding: 0;
}

#zlrzuakcin .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zlrzuakcin .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zlrzuakcin .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zlrzuakcin .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zlrzuakcin .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zlrzuakcin .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zlrzuakcin .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zlrzuakcin .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zlrzuakcin .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zlrzuakcin .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zlrzuakcin .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zlrzuakcin .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zlrzuakcin .gt_spanner_row {
  border-bottom-style: hidden;
}

#zlrzuakcin .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zlrzuakcin .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zlrzuakcin .gt_from_md > :first-child {
  margin-top: 0;
}

#zlrzuakcin .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zlrzuakcin .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zlrzuakcin .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zlrzuakcin .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zlrzuakcin .gt_row_group_first td {
  border-top-width: 2px;
}

#zlrzuakcin .gt_row_group_first th {
  border-top-width: 2px;
}

#zlrzuakcin .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zlrzuakcin .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zlrzuakcin .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zlrzuakcin .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zlrzuakcin .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zlrzuakcin .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zlrzuakcin .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#zlrzuakcin .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zlrzuakcin .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zlrzuakcin .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zlrzuakcin .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zlrzuakcin .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zlrzuakcin .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zlrzuakcin .gt_left {
  text-align: left;
}

#zlrzuakcin .gt_center {
  text-align: center;
}

#zlrzuakcin .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zlrzuakcin .gt_font_normal {
  font-weight: normal;
}

#zlrzuakcin .gt_font_bold {
  font-weight: bold;
}

#zlrzuakcin .gt_font_italic {
  font-style: italic;
}

#zlrzuakcin .gt_super {
  font-size: 65%;
}

#zlrzuakcin .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#zlrzuakcin .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zlrzuakcin .gt_indent_1 {
  text-indent: 5px;
}

#zlrzuakcin .gt_indent_2 {
  text-indent: 10px;
}

#zlrzuakcin .gt_indent_3 {
  text-indent: 15px;
}

#zlrzuakcin .gt_indent_4 {
  text-indent: 20px;
}

#zlrzuakcin .gt_indent_5 {
  text-indent: 25px;
}

#zlrzuakcin .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#zlrzuakcin div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="zlrzuakcin" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="zlrzuakcin">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"name":["Texas","California","Michigan","Florida","Montana","Idaho","Minnesota","Virginia","New Mexico","Washington","Oklahoma","Nevada","Arizona","New York","North Carolina","Louisiana","Oregon","Missouri","Colorado","Nebraska","Wyoming","South Dakota","Utah","Kansas","Wisconsin","Illinois","Tennessee","Kentucky","North Dakota","Georgia","Alabama","Mississippi","Arkansas","Iowa","Maryland","West Virginia","Maine","Pennsylvania","Ohio","Indiana","South Carolina","Massachusetts","New Hampshire","Vermont","New Jersey","Connecticut","Delaware","Rhode Island","District of Columbia"],"region":["South","West","Midwest","South","West","West","Midwest","South","West","West","South","West","West","Norteast","South","South","West","Midwest","West","Midwest","West","Midwest","West","Midwest","Midwest","Midwest","South","South","Midwest","South","South","South","South","Midwest","South","South","Norteast","Norteast","Midwest","Midwest","South","Norteast","Norteast","Norteast","Norteast","Norteast","South","Norteast","South"],"border":[4959.81874658822,3793.17201646086,3574.84957190436,2960.4406890895,2822.8241029301,2565.82076325025,2564.43095489498,2404.68799904349,2378.95434200069,2342.54213460324,2332.53714283736,2332.38154944118,2295.91745725585,2295.06529363318,2219.88206030273,2214.43802940279,2196.78120122941,2111.17542663295,2100.12497958159,2047.92744776933,2026.78410503188,1995.13126715839,1971.65371753135,1954.65952964274,1898.42176751743,1858.99309026842,1850.72933092888,1833.81325441367,1767.64966326135,1750.96398103635,1714.13548193582,1712.41738831247,1679.29198017816,1654.72639825455,1637.78934559927,1588.96595991424,1562.27635218519,1499.49912928411,1465.72700317163,1434.64409493977,1277.64472597993,1021.36097348429,777.298423112844,775.321526974667,744.327441244202,514.424488795117,407.266100223944,303.444550643989,60.2621212662005]},"columns":[{"id":"name","name":"State Name","type":"character","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left","headerStyle":{"font-weight":"normal"}},{"id":"region","name":"Region","type":"factor","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"center","headerStyle":{"font-weight":"normal"}},{"id":"border","name":"Length of Border (km)","type":"numeric","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["4,959.82","3,793.17","3,574.85","2,960.44","2,822.82","2,565.82","2,564.43","2,404.69","2,378.95","2,342.54","2,332.54","2,332.38","2,295.92","2,295.07","2,219.88","2,214.44","2,196.78","2,111.18","2,100.12","2,047.93","2,026.78","1,995.13","1,971.65","1,954.66","1,898.42","1,858.99","1,850.73","1,833.81","1,767.65","1,750.96","1,714.14","1,712.42","1,679.29","1,654.73","1,637.79","1,588.97","1,562.28","1,499.50","1,465.73","1,434.64","1,277.64","1,021.36","777.30","775.32","744.33","514.42","407.27","303.44","60.26"],"html":true,"align":"right","headerStyle":{"font-weight":"normal"}}],"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"rgba(128,128,128,0.05)","style":{"fontFamily":"system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"}},"elementId":"zlrzuakcin","dataKey":"90047578a1752020ce753c133dd8de97"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="e7." class="level3">
<h3 class="anchored" data-anchor-id="e7.">E7.</h3>
<p><strong>Read the srtm.tif file into R (<code>srtm = rast(system.file("raster/srtm.tif", package = "spDataLarge"))</code>). This raster has a resolution of 0.00083 * 0.00083 degrees. Change its resolution to 0.01 * 0.01 degrees using all of the methods available in the <code>terra</code> package. Visualize the results. Can you notice any differences between the results of these re-sampling methods?</strong></p>
<p>The different methods of resampling rasters and their demonstration is in Figure&nbsp;19</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Encode Sans Condensed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>)</span>
<span id="cb50-2">showtext<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb50-3">srtm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/srtm.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>))</span>
<span id="cb50-4"></span>
<span id="cb50-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a target raster on which to re-sample</span></span>
<span id="cb50-6">target_rast <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(</span>
<span id="cb50-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xmin</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ext</span>(srtm)), </span>
<span id="cb50-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xmax</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ext</span>(srtm)), </span>
<span id="cb50-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ymin</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ext</span>(srtm)), </span>
<span id="cb50-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ymax</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ext</span>(srtm)),</span>
<span id="cb50-11">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># resolution = res(srtm), </span></span>
<span id="cb50-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resolution =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>),</span>
<span id="cb50-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crs</span>(srtm)</span>
<span id="cb50-14">  )</span>
<span id="cb50-15"></span>
<span id="cb50-16">original_raster <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> srtm</span>
<span id="cb50-17"></span>
<span id="cb50-18">resampling_methods_tbl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb50-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb50-20">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bilinear"</span>,</span>
<span id="cb50-21">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cubic"</span>,</span>
<span id="cb50-22">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lanczos"</span>,</span>
<span id="cb50-23">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"min"</span>,</span>
<span id="cb50-24">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"average"</span>,</span>
<span id="cb50-25">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mode"</span></span>
<span id="cb50-26">  ),</span>
<span id="cb50-27">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">description =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb50-28">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bilinear Interpolation"</span>,</span>
<span id="cb50-29">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cubic Interpolation"</span>,</span>
<span id="cb50-30">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Lanczos Resampling"</span>,</span>
<span id="cb50-31">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Minimum"</span>,</span>
<span id="cb50-32">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Average (Mean)"</span>,</span>
<span id="cb50-33">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mode"</span></span>
<span id="cb50-34">  )</span>
<span id="cb50-35">)</span>
<span id="cb50-36"></span>
<span id="cb50-37">theme_custom <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(...){</span>
<span id="cb50-38">  ggthemes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_map</span>(</span>
<span id="cb50-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb50-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span></span>
<span id="cb50-41">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb50-42">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb50-43">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb50-44">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>, </span>
<span id="cb50-45">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb50-46">      ),</span>
<span id="cb50-47">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb50-48">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb50-49">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb50-50">      ),</span>
<span id="cb50-51">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb50-52">      ...</span>
<span id="cb50-53">    )</span>
<span id="cb50-54">}</span>
<span id="cb50-55"></span>
<span id="cb50-56">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb50-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> original_raster) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb50-58">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb50-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb50-60">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb50-61">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Original Raster"</span></span>
<span id="cb50-62">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb50-63">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb50-64">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>()</span>
<span id="cb50-65"></span>
<span id="cb50-66"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) {</span>
<span id="cb50-67">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">assign</span>(</span>
<span id="cb50-68">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"g"</span>, i<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb50-69">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb50-70">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb50-71">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">resample</span>(</span>
<span id="cb50-72">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> original_raster,</span>
<span id="cb50-73">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> target_rast,</span>
<span id="cb50-74">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> resampling_methods_tbl<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>name[i]</span>
<span id="cb50-75">        )</span>
<span id="cb50-76">      ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb50-77">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb50-78">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb50-79">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb50-80">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(resampling_methods_tbl<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>description[i]),</span>
<span id="cb50-81">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb50-82">      ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb50-83">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_custom</span>(</span>
<span id="cb50-84">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.height =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb50-85">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb50-86">      )</span>
<span id="cb50-87">  )</span>
<span id="cb50-88">}</span>
<span id="cb50-89"></span>
<span id="cb50-90">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g5 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> g6 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb50-91">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(</span>
<span id="cb50-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guides =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"collect"</span>,</span>
<span id="cb50-93">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb50-94">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb50-95">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methods for Re-sampling rasters with {terra}"</span>,</span>
<span id="cb50-96">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb50-97">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb50-98">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb50-99">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>,</span>
<span id="cb50-100">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb50-101">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb50-102">      ),</span>
<span id="cb50-103">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span></span>
<span id="cb50-104">    )</span>
<span id="cb50-105">  )</span>
<span id="cb50-106"></span>
<span id="cb50-107"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb50-108">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb50-109">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb50-110">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter5-e7.png"</span>),</span>
<span id="cb50-111">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb50-112">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2400</span>,</span>
<span id="cb50-113">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2400</span>,</span>
<span id="cb50-114">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>,</span>
<span id="cb50-115">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb50-116">)</span></code></pre></div>
</details>
</div>
<div id="fig-e7-a" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-e7-a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter5-e7.png" class="lightbox" data-gallery="quarto-lightbox-gallery-36" title="Figure&nbsp;19: The various methods of resampling in the {terra} for rasters."><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter5-e7.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-e7-a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19: The various methods of resampling in the {terra} for rasters.
</figcaption>
</figure>
</div>
<p>Another method for converting into the resolution of (0.01, 0.01) is to use <code>terra::aggregate()</code> with <code>fact = 0.01 / 0.00083</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1">srtm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/srtm.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>))</span>
<span id="cb51-2"></span>
<span id="cb51-3">temp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> srtm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb51-4">  terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aggregate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fact =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0008333333</span>)</span>
<span id="cb51-5"></span>
<span id="cb51-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb51-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> temp) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb51-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb51-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb51-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-e8" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-e8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter5_files/figure-html/fig-e8-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-37" title="Figure&nbsp;20: Using terra::aggregate() to make resolution of 0.01"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter5_files/figure-html/fig-e8-1.png" class="img-fluid figure-img" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-e8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20: Using terra::aggregate() to make resolution of 0.01
</figcaption>
</figure>
</div>
</div>
</div>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-loecher2015" class="csl-entry">
Loecher, Markus, and Karl Ropkins. 2015. <span>“<span><strong>RgoogleMaps</strong></span>and<span><strong>loa</strong></span>: Unleashing<span><em>R</em></span>Graphics Power on Map Tiles.”</span> <em>Journal of Statistical Software</em> 63 (4). <a href="https://doi.org/10.18637/jss.v063.i04">https://doi.org/10.18637/jss.v063.i04</a>.
</div>
<div id="ref-sf-3" class="csl-entry">
Pebesma, Edzer, and Roger Bivand. 2023. <span>“<span></span>Spatial Data Science: With Applications in r<span></span>.”</span> <a href="https://doi.org/10.1201/9780429459016">https://doi.org/10.1201/9780429459016</a>.
</div>
<div id="ref-smoothr-2" class="csl-entry">
Strimas-Mackey, Matthew. 2023. <span>“Smoothr: Smooth and Tidy Spatial Features.”</span> <a href="https://CRAN.R-project.org/package=smoothr">https://CRAN.R-project.org/package=smoothr</a>.
</div>
<div id="ref-rmapshaper" class="csl-entry">
Teucher, Andy, and Kenton Russell. 2023. <span>“Rmapshaper: Client for ’Mapshaper’ for ’Geospatial’ Operations.”</span> <a href="https://CRAN.R-project.org/package=rmapshaper">https://CRAN.R-project.org/package=rmapshaper</a>.
</div>
</div></section></div> ]]></description>
  <category>Geocomputation with R</category>
  <category>Textbook Solutions</category>
  <guid>https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter5.html</guid>
  <pubDate>Sun, 15 Dec 2024 18:30:00 GMT</pubDate>
</item>
<item>
  <title>Chapter 4: Spatial data operations</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4.html</link>
  <description><![CDATA[ 




<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sf)        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simple Features in R</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(terra)     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handling rasters in R</span></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyterra) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># For plotting rasters in ggplot2</span></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magrittr)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Using pipes with raster objects</span></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All things tidy; Data Wrangling</span></span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(spData)    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Spatial Datasets</span></span>
<span id="cb1-7"></span>
<span id="cb1-8"></span>
<span id="cb1-9">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Extra Condensed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>)</span>
<span id="cb1-10">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>)</span>
<span id="cb1-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb1-12">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>))</span>
<span id="cb1-13">showtext<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span></code></pre></div>
</div>
<section id="introduction-to-spatial-operations" class="level2">
<h2 class="anchored" data-anchor-id="introduction-to-spatial-operations">4.1 Introduction to Spatial Operations</h2>
<ul>
<li><strong>Spatial Operations</strong>: Include spatial joins for vectors and local/focal operations for rasters, allowing modification based on location and shape.
<ul>
<li>Relation to Non-Spatial Operations: Many spatial operations (e.g., subsetting, joining) have non-spatial counterparts.</li>
</ul></li>
<li><strong>Spatial Joins</strong>: Can be done in multiple ways (e.g., <strong>intersect</strong>, <strong>within distance</strong>), unlike non-spatial joins <em>(refer to <a href="https://cran.r-project.org/web/packages/fuzzyjoin/index.html">fuzzyjoin</a> package <span class="citation" data-cites="fuzzyjoin">(Robinson 2020)</span> for alternatives).</em>
<ul>
<li>Types of Spatial Relationships: Includes operations like intersects and disjoint. Distance calculations explore spatial relationships.</li>
</ul></li>
<li><strong>Raster Operations</strong>:
<ol type="1">
<li>Subsetting (Section 4.3.1)</li>
<li>Map Algebra: Modifies raster cell values through local, focal, zonal, and global operations (Sections 4.3.3 to 4.3.6).</li>
<li>Merging Rasters: Demonstrated with reproducible examples (Section 4.3.8).</li>
</ol></li>
<li><strong>Coordinate Reference System (CRS)</strong>: Consistency in CRS is essential for spatial operations..</li>
</ul>
</section>
<section id="spatial-operations-on-vector-data" class="level2">
<h2 class="anchored" data-anchor-id="spatial-operations-on-vector-data">4.2 Spatial operations on vector data</h2>
<section id="spatial-subsetting-use-st_filter" class="level3">
<h3 class="anchored" data-anchor-id="spatial-subsetting-use-st_filter">4.2.1 Spatial Subsetting: use <code>st_filter()</code></h3>
<ul>
<li>Spatial subsetting extracts features from a spatial object (<code>x</code>) that relate spatially to another object (<code>y</code>).</li>
<li>Syntax: Use the <code>[ ]</code> operator: <code>x[y, , op = st_intersects]</code>.
<ul>
<li><p><code>x</code>: Target <code>sf</code> object.</p></li>
<li><p><code>y</code>: Subsetting <code>sf</code> object.</p></li>
<li><p><code>op</code>: Topological relation (default is <code>st_intersects</code>).</p>
<p><a href="https://r-spatial.github.io/sf/">sf package documentation</a></p></li>
</ul></li>
<li>Default Operator: <code>st_intersects()</code> selects features intersecting with the subsetting object. Alternative operators like <code>st_disjoint()</code> can be used for different relations.
<ul>
<li>Example: <code>nz_height[canterbury, ]</code> returns high points within Canterbury from the <code>nz_height</code> dataset in the spData package (<a href="https://nowosad.github.io/spData/">spData documentation</a>).</li>
</ul></li>
<li>Topological Relations: Include <code>touches</code>, <code>crosses</code>, and <code>within</code>. These determine spatial relationships between features in <code>x</code> and <code>y</code>.</li>
<li>Sparse Geometry Binary Predicate (sgbp):
<ul>
<li>Using <code>st_intersects()</code>, an <code>sgbp</code> list object is created.</li>
<li>Convert <code>sgbp</code> to logical vector for subsetting using <code>lengths({sgbp_object_name} &gt; 0)</code></li>
<li>Using <code>sparse = FALSE</code> argument in <code>st_intersects()</code> returns a dense matrix.</li>
</ul></li>
<li>Tidyverse Alternative: <a href="https://r-spatial.github.io/sf/reference/st_filter.html"><code>st_filter()</code></a> from the sf package simplifies spatial subsetting, increasing compatibility with <code>dplyr</code>.</li>
<li>Output Consistency: Subsets created using <code>[ ]</code>, logical vectors, or <code>st_filter()</code> are equivalent in spatial operations.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nz"</span>)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nz_height"</span>)</span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>(nz)</span>
<span id="cb2-5"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] "sf"         "data.frame"</span></span>
<span id="cb2-6"></span>
<span id="cb2-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A plot for all regions and all peaks</span></span>
<span id="cb2-8">nz <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-11">  ggrepel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text_repel</span>(</span>
<span id="cb2-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb2-13">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> Name,</span>
<span id="cb2-14">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> geom</span>
<span id="cb2-15">    ),</span>
<span id="cb2-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb2-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb2-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf_coordinates"</span></span>
<span id="cb2-19">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb2-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> nz_height,</span>
<span id="cb2-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb2-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>,</span>
<span id="cb2-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb2-25">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(</span>
<span id="cb2-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pink"</span>)</span>
<span id="cb2-28">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb2-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"All peaks in New Zealand, and all regions."</span></span>
<span id="cb2-31">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb2-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(</span>
<span id="cb2-35">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightblue"</span>,</span>
<span id="cb2-36">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb2-37">    ),</span>
<span id="cb2-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span></span>
<span id="cb2-39">  )</span>
<span id="cb2-40"></span>
<span id="cb2-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Total peaks in New Zealand</span></span>
<span id="cb2-42">nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>()</span>
<span id="cb2-43"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] 101   3</span></span>
<span id="cb2-44"></span>
<span id="cb2-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Peaks within Canterbury in New Zealand</span></span>
<span id="cb2-46"></span>
<span id="cb2-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Base R Version</span></span>
<span id="cb2-48">canterbury <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nz <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canterbury"</span>)</span>
<span id="cb2-49">nz_height[canterbury,] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>()</span>
<span id="cb2-50"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] 70  3</span></span>
<span id="cb2-51"></span>
<span id="cb2-52"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tidyverse Version</span></span>
<span id="cb2-53">nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb2-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_filter</span>(</span>
<span id="cb2-55">    nz <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canterbury"</span>),</span>
<span id="cb2-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.predicate =</span> st_intersects</span>
<span id="cb2-57">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-58">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>()</span>
<span id="cb2-59"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] 70  3</span></span>
<span id="cb2-60"></span>
<span id="cb2-61"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Getting the peaks which are inside Canterbury</span></span>
<span id="cb2-62">canterbury_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb2-63">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_filter</span>(</span>
<span id="cb2-64">    nz <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canterbury"</span>),</span>
<span id="cb2-65">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.predicate =</span> st_intersects</span>
<span id="cb2-66">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-67">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(t50_fid)</span>
<span id="cb2-68"></span>
<span id="cb2-69">nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-70">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">in_canterbury =</span> t50_fid <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> canterbury_ids) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-71">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-72">  </span>
<span id="cb2-73">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Base NZ Map and Label for Canterbury</span></span>
<span id="cb2-74">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb2-75">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> nz,</span>
<span id="cb2-76">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb2-77">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canterbury"</span></span>
<span id="cb2-78">    )</span>
<span id="cb2-79">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-80">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf_text</span>(</span>
<span id="cb2-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(nz, Name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canterbury"</span>),</span>
<span id="cb2-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb2-83">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> Name,</span>
<span id="cb2-84">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> geom</span>
<span id="cb2-85">    ),</span>
<span id="cb2-86">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb2-87">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb2-88">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-89">  </span>
<span id="cb2-90">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plotting the peaks, and colouring by presence in Canterbury</span></span>
<span id="cb2-91">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb2-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb2-93">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> in_canterbury,</span>
<span id="cb2-94">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> in_canterbury</span>
<span id="cb2-95">    ),</span>
<span id="cb2-96">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb2-97">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-98">  </span>
<span id="cb2-99">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(</span>
<span id="cb2-100">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightpink"</span>)</span>
<span id="cb2-101">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-102">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_manual</span>(</span>
<span id="cb2-103">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span>
<span id="cb2-104">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-105">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(</span>
<span id="cb2-106">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span></span>
<span id="cb2-107">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-108">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb2-109">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Peaks within Canterbury Region?"</span>,</span>
<span id="cb2-110">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Peaks within Canterbury Region?"</span>,</span>
<span id="cb2-111">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Highlighting Peaks within Canterbury region"</span></span>
<span id="cb2-112">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-113">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-114">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb2-115">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(</span>
<span id="cb2-116">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightblue"</span></span>
<span id="cb2-117">    ),</span>
<span id="cb2-118">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span></span>
<span id="cb2-119">  )</span></code></pre></div>
</details>
<div id="fig-4-2-1" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-4-2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="fig-4-2-1-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-4-2-1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-4-2-1-1.png" class="lightbox" data-gallery="fig-4-2-1" title="Figure&nbsp;1&nbsp;(a): New Zealand Map with all the peaks"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-4-2-1-1.png" class="img-fluid figure-img" data-ref-parent="fig-4-2-1" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-4-2-1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) New Zealand Map with all the peaks
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-4-2-1-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-4-2-1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-4-2-1-2.png" class="lightbox" data-gallery="fig-4-2-1" title="Figure&nbsp;1&nbsp;(b): New Zealand Map focussing on peaks that intersect with Canterbury"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-4-2-1-2.png" class="img-fluid figure-img" data-ref-parent="fig-4-2-1" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-4-2-1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) New Zealand Map focussing on peaks that intersect with Canterbury
</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-4-2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Spatial Subsetting and plotting with tidyverse and ggplot2 methods
</figcaption>
</figure>
</div>
</div>
<p>Example code for <code>st_intersects()</code> and <code>st_disjoint()</code> : these functions produce a sparse predicate list only. Hence, correct way to use them would be <code>st_filter()</code> with <code>.predicate = &lt;function&gt;</code> argument.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersects</span>(</span>
<span id="cb3-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(nz, Name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canterbury"</span>)</span>
<span id="cb3-4">  )</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sparse geometry binary predicate list of length 101, where the
predicate was `intersects'
first 10 elements:
 1: (empty)
 2: (empty)
 3: (empty)
 4: (empty)
 5: 1
 6: 1
 7: 1
 8: 1
 9: 1
 10: 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The 70 peaks within Canterbury region</span></span>
<span id="cb5-2">nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_filter</span>(</span>
<span id="cb5-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(nz, Name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canterbury"</span>),</span>
<span id="cb5-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.predicate =</span> st_intersects</span>
<span id="cb5-6">  )</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 70 features and 2 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 1365809 ymin: 5158491 xmax: 1654899 ymax: 5350463
Projected CRS: NZGD2000 / New Zealand Transverse Mercator 2000
First 10 features:
   t50_fid elevation                geometry
1  2362630      2749 POINT (1378170 5158491)
2  2362814      2822 POINT (1389460 5168749)
3  2362817      2778 POINT (1390166 5169466)
4  2363991      3004 POINT (1372357 5172729)
5  2363993      3114 POINT (1372062 5173236)
6  2363994      2882 POINT (1372810 5173419)
7  2363995      2796 POINT (1372579 5173989)
8  2363997      3070 POINT (1373796 5174144)
9  2363998      3061 POINT (1373955 5174231)
10 2363999      3077 POINT (1373984 5175228)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The 31 peaks outside Canterbury Region</span></span>
<span id="cb7-2">nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_filter</span>(</span>
<span id="cb7-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(nz, Name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canterbury"</span>),</span>
<span id="cb7-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.predicate =</span> st_disjoint</span>
<span id="cb7-6">  )</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 31 features and 2 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 1204143 ymin: 5048309 xmax: 1822492 ymax: 5650492
Projected CRS: NZGD2000 / New Zealand Transverse Mercator 2000
First 10 features:
   t50_fid elevation                geometry
1  2353944      2723 POINT (1204143 5049971)
2  2354404      2820 POINT (1234725 5048309)
3  2354405      2830 POINT (1235915 5048745)
4  2369113      3033 POINT (1259702 5076570)
5  2363996      2759 POINT (1373264 5175442)
6  2364028      2756 POINT (1374183 5177165)
7  2364029      2800 POINT (1374469 5176966)
8  2364031      2788 POINT (1375422 5177253)
9  2364166      2782 POINT (1383006 5181085)
10 2364167      2905 POINT (1383486 5181270)</code></pre>
</div>
</div>
</section>
<section id="topological-relations" class="level3">
<h3 class="anchored" data-anchor-id="topological-relations">4.2.2 Topological Relations</h3>
<ul>
<li><strong>Topological relations</strong> describe spatial relationships between objects using logical TRUE or FALSE statements <em>(Egenhofer and Herring, 1990)</em>.</li>
<li><strong>Symmetrical vs.&nbsp;non-symmetrical relations</strong>:
<ul>
<li>Symmetrical relations (e.g., <code>equals</code>, <code>intersects</code>, <code>crosses</code>) yield the same result when order of input is swapped.</li>
<li>Non-symmetrical relations (e.g., <code>contains</code>, <code>within</code>) depend on the order of input geometries.</li>
</ul></li>
<li><strong>Binary predicates</strong> in <strong><code>sf</code></strong> package test spatial relationships between vector geometries. See <a href="https://r-spatial.github.io/sf/articles/sf3.html">vignette(“sf3”)</a>. The following binary predicates exist in <code>sf</code> : —</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
<th>Symmetrical?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>st_intersects</code></td>
<td>Checks if geometries intersect.</td>
<td>Yes</td>
</tr>
<tr class="even">
<td><code>st_disjoint</code></td>
<td>Checks if geometries do not intersect (are disjoint).</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td><code>st_touches</code></td>
<td>Checks if geometries have at least one boundary point in common.</td>
<td>Yes</td>
</tr>
<tr class="even">
<td><code>st_crosses</code></td>
<td>Checks if a geometry crosses another (e.g., a line crosses a polygon).</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td><code>st_overlaps</code></td>
<td>Checks if geometries have some but not all interior points in common.</td>
<td>Yes</td>
</tr>
<tr class="even">
<td><code>st_equals</code></td>
<td>Checks if geometries are topologically equal.</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td><code>st_within</code></td>
<td>Checks if a geometry is completely contained within another.</td>
<td><strong>No</strong></td>
</tr>
<tr class="even">
<td><code>st_contains</code></td>
<td>Checks if a geometry contains another completely.</td>
<td><strong>No</strong></td>
</tr>
<tr class="odd">
<td><code>st_contains_properly</code></td>
<td>Checks if a geometry contains another but not vice versa.</td>
<td><strong>No</strong></td>
</tr>
<tr class="even">
<td><code>st_covers</code></td>
<td>Checks if a geometry covers another (includes boundary).</td>
<td><strong>No</strong></td>
</tr>
<tr class="odd">
<td><code>st_covered_by</code></td>
<td>Checks if a geometry is covered by another (includes boundary).</td>
<td><strong>No</strong></td>
</tr>
<tr class="even">
<td><code>st_equals_exact</code></td>
<td>Checks if geometries are exactly equal within a given tolerance.</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td><code>st_is_within_distance</code></td>
<td>Checks if geometries are within a specified distance from each other.</td>
<td>Yes</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>Sparse matrix output</strong>: Functions like <code>st_intersects()</code> use sparse matrices to save memory by only registering positive results; setting <code>sparse = FALSE</code> returns a dense matrix.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create two polygons</span></span>
<span id="cb9-2"> polygon1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_polygon</span>(</span>
<span id="cb9-3">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb9-4">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb9-5">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">byrow =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb9-6">   ))</span>
<span id="cb9-7"> )</span>
<span id="cb9-8"></span>
<span id="cb9-9"> polygon2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_polygon</span>(</span>
<span id="cb9-10">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>),</span>
<span id="cb9-11">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb9-12">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">byrow =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb9-13">   ))</span>
<span id="cb9-14"> )</span>
<span id="cb9-15"></span>
<span id="cb9-16"> polygon3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_polygon</span>(</span>
<span id="cb9-17">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>,</span>
<span id="cb9-18">                 <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>, </span>
<span id="cb9-19">                 <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, </span>
<span id="cb9-20">                 <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, </span>
<span id="cb9-21">                 <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>),</span>
<span id="cb9-22">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb9-23">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">byrow =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb9-24">   ))</span>
<span id="cb9-25"> )</span>
<span id="cb9-26"></span>
<span id="cb9-27"> polygon4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_polygon</span>(</span>
<span id="cb9-28">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, </span>
<span id="cb9-29">                 <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, </span>
<span id="cb9-30">                 <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, </span>
<span id="cb9-31">                 <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, </span>
<span id="cb9-32">                 <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>),</span>
<span id="cb9-33">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb9-34">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">byrow =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb9-35">   ))</span>
<span id="cb9-36"> )</span>
<span id="cb9-37"> </span>
<span id="cb9-38"> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert to sf objects</span></span>
<span id="cb9-39"> sf_poly1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sfc</span>(polygon1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span>)</span>
<span id="cb9-40"> sf_poly2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sfc</span>(polygon2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span>)</span>
<span id="cb9-41"> sf_poly3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sfc</span>(polygon3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span>)</span>
<span id="cb9-42"> sf_poly4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sfc</span>(polygon4, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span>)</span>
<span id="cb9-43"> </span>
<span id="cb9-44"> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a collection of points</span></span>
<span id="cb9-45"> points <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sfc</span>(</span>
<span id="cb9-46">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>)),</span>
<span id="cb9-47">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>)),</span>
<span id="cb9-48">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.25</span>)),</span>
<span id="cb9-49">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span></span>
<span id="cb9-50"> )</span>
<span id="cb9-51"></span>
<span id="cb9-52"> sf_points <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb9-53">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"p1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"p2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"p3"</span>),</span>
<span id="cb9-54">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> points</span>
<span id="cb9-55"> ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb9-56">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb9-57">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_set_crs</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span>)</span>
<span id="cb9-58"></span>
<span id="cb9-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Keeping environment clean</span></span>
<span id="cb9-60"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(polygon1, polygon2, </span>
<span id="cb9-61">   polygon3, polygon4,</span>
<span id="cb9-62">   points)</span>
<span id="cb9-63"></span>
<span id="cb9-64"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Visualize the objects</span></span>
<span id="cb9-65"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-66">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> sf_poly1, </span>
<span id="cb9-67">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf_poly1"</span>),</span>
<span id="cb9-68">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-69">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> sf_poly2, </span>
<span id="cb9-70">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf_poly2"</span>),</span>
<span id="cb9-71">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-72">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> sf_poly3, </span>
<span id="cb9-73">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf_poly3"</span>),</span>
<span id="cb9-74">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-75">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> sf_poly4, </span>
<span id="cb9-76">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf_poly4"</span>),</span>
<span id="cb9-77">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-78">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> sf_points,</span>
<span id="cb9-79">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> point),</span>
<span id="cb9-80">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>,</span>
<span id="cb9-81">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-82">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-83">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-create-objects" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-create-objects-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-create-objects-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;2: Some example objects to demonstrate the topological relations"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-create-objects-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-create-objects-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Some example objects to demonstrate the topological relations
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#################### Symmetrical Relations ######################</span></span>
<span id="cb10-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The order in which sf objects are placed does not matter</span></span>
<span id="cb10-3"></span>
<span id="cb10-4"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## st_intersects()----------------------------------------</span></span>
<span id="cb10-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersects</span>(sf_poly1, sf_poly2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F) </span>
<span id="cb10-6"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##      [,1]</span></span>
<span id="cb10-7"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] TRUE</span></span>
<span id="cb10-8"></span>
<span id="cb10-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersects</span>(sf_poly1, sf_points, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F) </span>
<span id="cb10-10"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##      [,1] [,2]  [,3]</span></span>
<span id="cb10-11"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] TRUE TRUE FALSE</span></span>
<span id="cb10-12"></span>
<span id="cb10-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersects</span>(sf_poly1, sf_poly3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-14"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]</span></span>
<span id="cb10-15"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE</span></span>
<span id="cb10-16"></span>
<span id="cb10-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersects</span>(sf_poly2 ,sf_poly3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F) </span>
<span id="cb10-18"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##      [,1]</span></span>
<span id="cb10-19"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] TRUE</span></span>
<span id="cb10-20"></span>
<span id="cb10-21"></span>
<span id="cb10-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># st_disjoint()------------------------------------------</span></span>
<span id="cb10-23"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_disjoint</span>(sf_poly1, sf_poly4, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-24"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##      [,1]</span></span>
<span id="cb10-25"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] TRUE</span></span>
<span id="cb10-26"></span>
<span id="cb10-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_disjoint</span>(sf_poly2, sf_poly3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F) </span>
<span id="cb10-28"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]</span></span>
<span id="cb10-29"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE</span></span>
<span id="cb10-30"></span>
<span id="cb10-31"></span>
<span id="cb10-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># st_touches()-------------------------------------------</span></span>
<span id="cb10-33"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_touches</span>(sf_poly1, sf_poly2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F) </span>
<span id="cb10-34"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]</span></span>
<span id="cb10-35"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE</span></span>
<span id="cb10-36"></span>
<span id="cb10-37"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_touches</span>(sf_poly2, sf_poly3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-38"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##      [,1]</span></span>
<span id="cb10-39"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] TRUE</span></span>
<span id="cb10-40"></span>
<span id="cb10-41"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_touches</span>(sf_poly1, sf_points, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-42"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]  [,2]  [,3]</span></span>
<span id="cb10-43"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE FALSE FALSE</span></span>
<span id="cb10-44"></span>
<span id="cb10-45"></span>
<span id="cb10-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># st_crosses()-------------------------------------------</span></span>
<span id="cb10-47"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crosses</span>(sf_poly1, sf_poly2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-48"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]</span></span>
<span id="cb10-49"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE</span></span>
<span id="cb10-50"></span>
<span id="cb10-51"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crosses</span>(sf_poly1, sf_points, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-52"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]  [,2]  [,3]</span></span>
<span id="cb10-53"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE FALSE FALSE</span></span>
<span id="cb10-54"></span>
<span id="cb10-55"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># st_overlaps()</span></span>
<span id="cb10-56"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_overlaps</span>(sf_poly1, sf_poly2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-57"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##      [,1]</span></span>
<span id="cb10-58"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] TRUE</span></span>
<span id="cb10-59"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_overlaps</span>(sf_poly1, sf_points, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-60"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]  [,2]  [,3]</span></span>
<span id="cb10-61"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE FALSE FALSE</span></span>
<span id="cb10-62"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_overlaps</span>(sf_poly3, sf_poly3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-63"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]</span></span>
<span id="cb10-64"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE</span></span>
<span id="cb10-65"></span>
<span id="cb10-66"></span>
<span id="cb10-67"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># st_equals()-------------------------------------------</span></span>
<span id="cb10-68"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_equals</span>(sf_poly1, sf_poly1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-69"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##      [,1]</span></span>
<span id="cb10-70"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] TRUE</span></span>
<span id="cb10-71"></span>
<span id="cb10-72"></span>
<span id="cb10-73"></span>
<span id="cb10-74"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># st_equals_exact()-------------------------------------</span></span>
<span id="cb10-75"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_equals_exact</span>(sf_poly1, sf_poly2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">par =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-76"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]</span></span>
<span id="cb10-77"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE</span></span>
<span id="cb10-78"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_equals_exact</span>(sf_poly1, sf_poly2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">par =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-79"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##      [,1]</span></span>
<span id="cb10-80"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] TRUE</span></span>
<span id="cb10-81"></span>
<span id="cb10-82"></span>
<span id="cb10-83"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># st_is_within_distance()-------------------------------</span></span>
<span id="cb10-84"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_is_within_distance</span>(sf_poly1, sf_poly2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-85"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##      [,1]</span></span>
<span id="cb10-86"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] TRUE</span></span>
<span id="cb10-87"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_is_within_distance</span>(sf_poly2, sf_poly3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-88"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##      [,1]</span></span>
<span id="cb10-89"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] TRUE</span></span>
<span id="cb10-90"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_is_within_distance</span>(sf_poly3, sf_poly4, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-91"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]</span></span>
<span id="cb10-92"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE</span></span>
<span id="cb10-93"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_is_within_distance</span>(sf_poly3, sf_poly4, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-94"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]</span></span>
<span id="cb10-95"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE</span></span>
<span id="cb10-96"></span>
<span id="cb10-97"></span>
<span id="cb10-98"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#################### Non-Symmetrical Relations ####################</span></span>
<span id="cb10-99"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The order in which sf objects are placed changes the outcome</span></span>
<span id="cb10-100"></span>
<span id="cb10-101"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># st_within()-------------------------------------------</span></span>
<span id="cb10-102">sf_points <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb10-103">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_within</span>(sf_poly1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-104"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]</span></span>
<span id="cb10-105"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,]  TRUE</span></span>
<span id="cb10-106"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [2,]  TRUE</span></span>
<span id="cb10-107"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [3,] FALSE</span></span>
<span id="cb10-108"></span>
<span id="cb10-109">sf_poly1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb10-110">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_within</span>(sf_points, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-111"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]  [,2]  [,3]</span></span>
<span id="cb10-112"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE FALSE FALSE</span></span>
<span id="cb10-113"></span>
<span id="cb10-114">sf_poly1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb10-115">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_within</span>(sf_poly2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-116"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]</span></span>
<span id="cb10-117"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE</span></span>
<span id="cb10-118"></span>
<span id="cb10-119"></span>
<span id="cb10-120"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># st_contains()-----------------------------------------</span></span>
<span id="cb10-121">sf_poly1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb10-122">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_contains</span>(sf_points, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-123"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##      [,1] [,2]  [,3]</span></span>
<span id="cb10-124"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] TRUE TRUE FALSE</span></span>
<span id="cb10-125"></span>
<span id="cb10-126">sf_points <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb10-127">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_contains</span>(sf_poly1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-128"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]</span></span>
<span id="cb10-129"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE</span></span>
<span id="cb10-130"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [2,] FALSE</span></span>
<span id="cb10-131"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [3,] FALSE</span></span>
<span id="cb10-132"></span>
<span id="cb10-133"></span>
<span id="cb10-134"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># st_covers()-------------------------------------------</span></span>
<span id="cb10-135">sf_poly1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb10-136">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_covers</span>(sf_points, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-137"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##      [,1] [,2]  [,3]</span></span>
<span id="cb10-138"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] TRUE TRUE FALSE</span></span>
<span id="cb10-139"></span>
<span id="cb10-140">sf_poly2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb10-141">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_covers</span>(sf_poly1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-142"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]</span></span>
<span id="cb10-143"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE</span></span>
<span id="cb10-144"></span>
<span id="cb10-145"></span>
<span id="cb10-146"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># st_covered_by()---------------------------------------</span></span>
<span id="cb10-147">sf_points <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb10-148">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_covered_by</span>(sf_poly1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-149"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]</span></span>
<span id="cb10-150"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,]  TRUE</span></span>
<span id="cb10-151"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [2,]  TRUE</span></span>
<span id="cb10-152"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [3,] FALSE</span></span></code></pre></div>
</div>
</section>
<section id="distance-relations" class="level3">
<h3 class="anchored" data-anchor-id="distance-relations">4.2.3 Distance Relations</h3>
<ul>
<li><strong>Distance relations</strong> are continuous, unlike binary topological relations which return TRUE/FALSE values.</li>
<li>The <a href="https://r-spatial.github.io/sf/reference/st_distance.html"><strong><code>st_distance()</code></strong></a> function calculates distances between two <strong>sf</strong> objects, returning a matrix with units of measurement (e.g., meters).</li>
<li><a href="https://r-spatial.github.io/sf/reference/st_centroid.html"><strong><code>st_centroid()</code></strong></a>: Computes the geometric centroid of a spatial feature, useful for representing a region’s central point in distance calculations.</li>
<li><strong>Matrix output</strong>:
<ul>
<li>Results are returned as a matrix, even for single value calculations.</li>
<li>Computes a distance matrix between all combinations of features in objects (e.g., distances between multiple points and polygons).</li>
</ul></li>
<li><strong>Point-to-polygon distance</strong>: Represents the shortest distance from a point to any part of the polygon.</li>
<li><strong>Usage in distance-based joins</strong>: <a href="https://r-spatial.github.io/sf/reference/st_distance.html"><code>st_distance()</code></a> is also used for performing joins based on distance criteria.</li>
<li>An example code to find distance between central points of Auckland and Canterbury Regions, vs.&nbsp;Top three peaks in New Zealand, returned as a matrix,a nd shown below as a beautiful table using {gt}.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Central points of Auckland and Canterbury Regions</span></span>
<span id="cb11-2">df1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nz <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_detect</span>(Name, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Auck|Canter"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_centroid</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(Name, geom)</span>
<span id="cb11-6"></span>
<span id="cb11-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Top 3 highest peaks in New Zealand</span></span>
<span id="cb11-8">df2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_max</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order_by =</span> elevation, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb11-10"></span>
<span id="cb11-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Finding the distance matrix</span></span>
<span id="cb11-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_distance</span>(df1, df2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">state =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Auckland"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canterbury"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">relocate</span>(state) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb11-17">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(</span>
<span id="cb11-18">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>state,</span>
<span id="cb11-19">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.fns =</span> as.numeric</span>
<span id="cb11-20">    )</span>
<span id="cb11-21">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-22">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-23">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>(</span>
<span id="cb11-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decimals =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb11-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale_by =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-3</span></span>
<span id="cb11-26">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-27">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">V1 =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Highest Peak"</span>, </span>
<span id="cb11-28">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">V2 =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Second"</span>,</span>
<span id="cb11-29">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">V3 =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Third"</span>,</span>
<span id="cb11-30">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">state =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Centroid of the State"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-31">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(</span>
<span id="cb11-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance in kilometers"</span></span>
<span id="cb11-33">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-34">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_538</span>()</span></code></pre></div>
<div id="tbl-distance" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-distance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Code output for use of st_centroid() and st_distance()
</figcaption>
<div aria-describedby="tbl-distance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="mhlgwgvzlj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#mhlgwgvzlj table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mhlgwgvzlj thead, #mhlgwgvzlj tbody, #mhlgwgvzlj tfoot, #mhlgwgvzlj tr, #mhlgwgvzlj td, #mhlgwgvzlj th {
  border-style: none;
}

#mhlgwgvzlj p {
  margin: 0;
  padding: 0;
}

#mhlgwgvzlj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mhlgwgvzlj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mhlgwgvzlj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mhlgwgvzlj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mhlgwgvzlj .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mhlgwgvzlj .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mhlgwgvzlj .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mhlgwgvzlj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mhlgwgvzlj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mhlgwgvzlj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mhlgwgvzlj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mhlgwgvzlj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mhlgwgvzlj .gt_spanner_row {
  border-bottom-style: hidden;
}

#mhlgwgvzlj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mhlgwgvzlj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#mhlgwgvzlj .gt_from_md > :first-child {
  margin-top: 0;
}

#mhlgwgvzlj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mhlgwgvzlj .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mhlgwgvzlj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#mhlgwgvzlj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mhlgwgvzlj .gt_row_group_first td {
  border-top-width: 2px;
}

#mhlgwgvzlj .gt_row_group_first th {
  border-top-width: 2px;
}

#mhlgwgvzlj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mhlgwgvzlj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mhlgwgvzlj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mhlgwgvzlj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mhlgwgvzlj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mhlgwgvzlj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mhlgwgvzlj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mhlgwgvzlj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mhlgwgvzlj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mhlgwgvzlj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mhlgwgvzlj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mhlgwgvzlj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mhlgwgvzlj .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mhlgwgvzlj .gt_left {
  text-align: left;
}

#mhlgwgvzlj .gt_center {
  text-align: center;
}

#mhlgwgvzlj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mhlgwgvzlj .gt_font_normal {
  font-weight: normal;
}

#mhlgwgvzlj .gt_font_bold {
  font-weight: bold;
}

#mhlgwgvzlj .gt_font_italic {
  font-style: italic;
}

#mhlgwgvzlj .gt_super {
  font-size: 65%;
}

#mhlgwgvzlj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mhlgwgvzlj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mhlgwgvzlj .gt_indent_1 {
  text-indent: 5px;
}

#mhlgwgvzlj .gt_indent_2 {
  text-indent: 10px;
}

#mhlgwgvzlj .gt_indent_3 {
  text-indent: 15px;
}

#mhlgwgvzlj .gt_indent_4 {
  text-indent: 20px;
}

#mhlgwgvzlj .gt_indent_5 {
  text-indent: 25px;
}

#mhlgwgvzlj .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mhlgwgvzlj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="4" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="font-family: Chivo; font-weight: 700">Distance in kilometers</th>
</tr>
<tr class="odd gt_col_headings">
<th id="Centroid of the State" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Centroid of the State</th>
<th id="Highest Peak" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Highest Peak</th>
<th id="Second" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Second</th>
<th id="Third" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Third</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="state">Auckland</td>
<td class="gt_row gt_right" headers="V1">856.6</td>
<td class="gt_row gt_right" headers="V2">857.3</td>
<td class="gt_row gt_right" headers="V3">856.9</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Canterbury</td>
<td class="gt_row gt_right" headers="V1">115.5</td>
<td class="gt_row gt_right" headers="V2">115.4</td>
<td class="gt_row gt_right" headers="V3">115.5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="de-9im-strings" class="level3">
<h3 class="anchored" data-anchor-id="de-9im-strings">4.2.4 DE-9IM Strings</h3>
<ul>
<li>The <strong>Dimensionally Extended 9-Intersection Model (DE-9IM)</strong> underlies binary spatial predicates. This model forms the basis for many spatial operations and helps create custom spatial predicates.</li>
<li><strong>Origins</strong>:
<ul>
<li>Initially named “DE + 9IM,” it refers to the <strong>dimensions of intersections</strong> between the boundaries, interiors, and exteriors of two geometries (Clementini and Di Felice 1995).</li>
<li>It applies to two-dimensional geometries (points, lines, polygons) in Euclidean space, requiring data in a projected coordinate reference system (CRS).</li>
</ul></li>
<li><strong>How DE-9IM Works</strong>:
<ul>
<li>The model visualizes intersections between components of two geometries (interior, boundary, exterior) in a 3x3 matrix form, indicating the dimension of the intersection (0 for points, 1 for lines, 2 for polygons, and F for false).</li>
<li>Flattening this matrix row-wise results in the DE-9IM string: <strong>“212111212”</strong>.</li>
</ul></li>
<li><strong>Using <code>st_relate()</code></strong>: The <a href="https://r-spatial.github.io/sf/reference/st_relate.html"><code>st_relate()</code></a> function returns DE-9IM strings to describe spatial relations.</li>
<li><strong>Developing Custom Predicates</strong>:
<ul>
<li>By interpreting DE-9IM strings, custom binary spatial predicates like <strong>queen</strong> and <strong>rook</strong> relations can be created:
<ul>
<li><p><strong>Queen relations</strong> (shared border or point): Pattern <code>F***T****</code>.</p></li>
<li><p><strong>Rook relations</strong> (shared linear intersection): Pattern <code>F***1****</code>.</p></li>
</ul></li>
<li>Custom functions using <a href="https://r-spatial.github.io/sf/reference/st_relate.html"><code>st_relate()</code></a>:</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">st_queen <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x, y) </span>
<span id="cb12-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_relate</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"F***T****"</span>)</span>
<span id="cb12-3"></span>
<span id="cb12-4">st_rook <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x, y) </span>
<span id="cb12-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_relate</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"F***1****"</span>)</span></code></pre></div>
<ul>
<li>This identifies which geometries in a grid have queen or rook relations to the central geometry.</li>
</ul>
</section>
<section id="spatial-joining-with-st_join" class="level3">
<h3 class="anchored" data-anchor-id="spatial-joining-with-st_join">4.2.5 Spatial Joining with <code>st_join()</code></h3>
<ul>
<li><p>Spatial joins combine datasets based on spatial relationships instead of shared key variables (as in non-spatial joins). It adds columns from a source object (<code>y</code>) to a target object (<code>x</code>).</p></li>
<li><p><strong>Join Details</strong>:</p>
<ul>
<li><p>Default behavior: A left join, which retains all rows from <code>x</code> and includes rows with no match from <code>y</code>.</p></li>
<li><p>Operators: Uses <code>st_intersects()</code> by default but can be modified via the <code>join</code> argument.</p></li>
<li><p>Handles all geometry types: Works for points, lines, and polygons, though joins involving polygons may create duplicate rows for multiple matches in <code>y</code>.</p></li>
</ul></li>
<li><p><strong>Flexibility</strong>:</p>
<ul>
<li><strong>Inner joins</strong>: Set <code>left = FALSE</code> to include only matched rows.</li>
</ul></li>
<li><p>The <code>st_join()</code> function: The <code>join</code> argument defines the topological operator to determine these relationships, with the default being <code>st_intersects()</code>.</p>
<ul>
<li><p>We can customize this behavior by choosing alternative functions such as <code>st_contains</code>, <code>st_within</code>, <code>st_overlaps</code>, <code>st_touches</code>, or <code>st_disjoint</code>, among others, each defining a different geometric predicate.</p></li>
<li><p>For example, <code>st_contains</code> selects features where geometries of <code>x</code> fully encompass those of <code>y</code>, while <code>st_within</code> does the reverse.</p></li>
<li><p>Additionally, advanced options like <code>st_is_within_distance</code> allow proximity-based joins, and <code>st_relate</code> supports customized spatial relationships using a pattern.</p></li>
</ul></li>
<li><p>Example: Getting 25 random points in the world, and seeing in which countries they fall in Figure&nbsp;3.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Getting 25 random points on the world,a dn then seeing in which countries they fall</span></span>
<span id="cb13-2">random_points <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb13-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(</span>
<span id="cb13-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(</span>
<span id="cb13-5">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, </span>
<span id="cb13-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_bbox</span>(world)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>xmin, </span>
<span id="cb13-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_bbox</span>(world)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>xmax</span>
<span id="cb13-8">    ),</span>
<span id="cb13-9">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb13-10">  ),</span>
<span id="cb13-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(</span>
<span id="cb13-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(</span>
<span id="cb13-13">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, </span>
<span id="cb13-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_bbox</span>(world)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ymin, </span>
<span id="cb13-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_bbox</span>(world)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ymax</span>
<span id="cb13-16">    ),</span>
<span id="cb13-17">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb13-18">  ),</span>
<span id="cb13-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> LETTERS[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>]</span>
<span id="cb13-20">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb13-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coords =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb13-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_set_crs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crs</span>(world))</span>
<span id="cb13-23"></span>
<span id="cb13-24"></span>
<span id="cb13-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Easiest (but not tidyverse) way to subset</span></span>
<span id="cb13-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># world[random_points, ]</span></span>
<span id="cb13-27"></span>
<span id="cb13-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tidyverse way to filter: Names of Countries in which they fall</span></span>
<span id="cb13-29">intersecting_countries <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> world <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb13-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_filter</span>(random_points) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb13-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(name_long)</span>
<span id="cb13-32"></span>
<span id="cb13-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The power of spatial joins: A tibble of countries where each random</span></span>
<span id="cb13-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># point falls. st_join() by default performs a left_join()</span></span>
<span id="cb13-35"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_join</span>(</span>
<span id="cb13-36">  random_points, </span>
<span id="cb13-37">  world <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(name_long)</span>
<span id="cb13-38">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb13-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">drop_na</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb13-40">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb13-41">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_nytimes</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="ztnogmfhwf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#ztnogmfhwf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ztnogmfhwf thead, #ztnogmfhwf tbody, #ztnogmfhwf tfoot, #ztnogmfhwf tr, #ztnogmfhwf td, #ztnogmfhwf th {
  border-style: none;
}

#ztnogmfhwf p {
  margin: 0;
  padding: 0;
}

#ztnogmfhwf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ztnogmfhwf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ztnogmfhwf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ztnogmfhwf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ztnogmfhwf .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ztnogmfhwf .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ztnogmfhwf .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ztnogmfhwf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ztnogmfhwf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ztnogmfhwf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ztnogmfhwf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ztnogmfhwf .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ztnogmfhwf .gt_spanner_row {
  border-bottom-style: hidden;
}

#ztnogmfhwf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ztnogmfhwf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ztnogmfhwf .gt_from_md > :first-child {
  margin-top: 0;
}

#ztnogmfhwf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ztnogmfhwf .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ztnogmfhwf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ztnogmfhwf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ztnogmfhwf .gt_row_group_first td {
  border-top-width: 2px;
}

#ztnogmfhwf .gt_row_group_first th {
  border-top-width: 2px;
}

#ztnogmfhwf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ztnogmfhwf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ztnogmfhwf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ztnogmfhwf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ztnogmfhwf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ztnogmfhwf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ztnogmfhwf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ztnogmfhwf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ztnogmfhwf .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#ztnogmfhwf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ztnogmfhwf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ztnogmfhwf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ztnogmfhwf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ztnogmfhwf .gt_left {
  text-align: left;
}

#ztnogmfhwf .gt_center {
  text-align: center;
}

#ztnogmfhwf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ztnogmfhwf .gt_font_normal {
  font-weight: normal;
}

#ztnogmfhwf .gt_font_bold {
  font-weight: bold;
}

#ztnogmfhwf .gt_font_italic {
  font-style: italic;
}

#ztnogmfhwf .gt_super {
  font-size: 65%;
}

#ztnogmfhwf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ztnogmfhwf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ztnogmfhwf .gt_indent_1 {
  text-indent: 5px;
}

#ztnogmfhwf .gt_indent_2 {
  text-indent: 10px;
}

#ztnogmfhwf .gt_indent_3 {
  text-indent: 15px;
}

#ztnogmfhwf .gt_indent_4 {
  text-indent: 20px;
}

#ztnogmfhwf .gt_indent_5 {
  text-indent: 25px;
}

#ztnogmfhwf .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ztnogmfhwf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="id" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase" scope="col">id</th>
<th id="geometry" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase" scope="col">geometry</th>
<th id="name_long" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase" scope="col">name_long</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="id" style="font-family: 'Source Sans Pro'; font-weight: 400">I</td>
<td class="gt_row gt_center" headers="geometry" style="font-family: 'Source Sans Pro'; font-weight: 400">c(43.05, 61.96)</td>
<td class="gt_row gt_left" headers="name_long" style="font-family: 'Source Sans Pro'; font-weight: 400">Russian Federation</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="id" style="font-family: 'Source Sans Pro'; font-weight: 400">N</td>
<td class="gt_row gt_center" headers="geometry" style="font-family: 'Source Sans Pro'; font-weight: 400">c(112.59, 71.68)</td>
<td class="gt_row gt_left" headers="name_long" style="font-family: 'Source Sans Pro'; font-weight: 400">Russian Federation</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="id" style="font-family: 'Source Sans Pro'; font-weight: 400">O</td>
<td class="gt_row gt_center" headers="geometry" style="font-family: 'Source Sans Pro'; font-weight: 400">c(59.22, 33.55)</td>
<td class="gt_row gt_left" headers="name_long" style="font-family: 'Source Sans Pro'; font-weight: 400">Iran</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="id" style="font-family: 'Source Sans Pro'; font-weight: 400">P</td>
<td class="gt_row gt_center" headers="geometry" style="font-family: 'Source Sans Pro'; font-weight: 400">c(93.88, 52.24)</td>
<td class="gt_row gt_left" headers="name_long" style="font-family: 'Source Sans Pro'; font-weight: 400">Russian Federation</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="id" style="font-family: 'Source Sans Pro'; font-weight: 400">R</td>
<td class="gt_row gt_center" headers="geometry" style="font-family: 'Source Sans Pro'; font-weight: 400">c(62.63, 51.25)</td>
<td class="gt_row gt_left" headers="name_long" style="font-family: 'Source Sans Pro'; font-weight: 400">Kazakhstan</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="id" style="font-family: 'Source Sans Pro'; font-weight: 400">S</td>
<td class="gt_row gt_center" headers="geometry" style="font-family: 'Source Sans Pro'; font-weight: 400">c(-17.61, -88.84)</td>
<td class="gt_row gt_left" headers="name_long" style="font-family: 'Source Sans Pro'; font-weight: 400">Antarctica</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb14-2"></span>
<span id="cb14-3">world <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb14-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">highlight =</span> name_long <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> intersecting_countries) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb14-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb14-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb14-8">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> highlight</span>
<span id="cb14-9">    ),</span>
<span id="cb14-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb14-11">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(</span>
<span id="cb14-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span>
<span id="cb14-14">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb14-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> random_points,</span>
<span id="cb14-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,</span>
<span id="cb14-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb14-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,</span>
<span id="cb14-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb14-21">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-22">  ggrepel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text_repel</span>(</span>
<span id="cb14-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> random_points,</span>
<span id="cb14-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> geometry),</span>
<span id="cb14-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb14-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,</span>
<span id="cb14-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb14-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_y =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb14-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf_coordinates"</span></span>
<span id="cb14-30">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb14-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"25 random points on world map, and Countries in which they fall"</span>,</span>
<span id="cb14-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb14-34">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb14-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span></span>
<span id="cb14-37">  )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-st-join" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-st-join-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-st-join-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;3: Using st_join() to spatially join two data sets, based on the st_intersect() relation"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-st-join-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-st-join-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Using st_join() to spatially join two data sets, based on the st_intersect() relation
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="distance-based-joins" class="level3">
<h3 class="anchored" data-anchor-id="distance-based-joins">4.2.6 Distance-based Joins</h3>
<ul>
<li><p>Distance-based joins are used when geographic datasets are spatially proximate but do not intersect. The <strong>sf</strong> package enables such joins using spatial relationships like proximity.</p></li>
<li><p><strong>Example Dataset used</strong>:</p>
<ul>
<li><code>cycle_hire</code>: Official cycle hire points.</li>
<li><code>cycle_hire_osm</code>: Cycle hire points from OpenStreetMap.</li>
<li>Relationship: These datasets are geographically close but do not overlap, as verified using <a href="https://r-spatial.github.io/sf/reference/st_intersects.html"><code>st_intersects()</code></a>, which returns <code>FALSE</code> for all points.</li>
</ul></li>
<li><p><strong>Implementation</strong>:</p>
<ol type="1">
<li><strong>Check Proximity</strong>:
<ul>
<li>Use <a href="https://r-spatial.github.io/sf/reference/st_is_within_distance.html"><code>st_is_within_distance()</code></a> to determine points within a threshold distance (e.g., 20 meters).</li>
</ul></li>
<li><strong>Perform Distance-based Join</strong>:
<ul>
<li>Apply <a href="https://r-spatial.github.io/sf/reference/st_join.html"><code>st_join()</code></a> with the <code>st_is_within_distance</code> predicate and a <code>dist</code> argument.</li>
<li>The resulting dataset may contain duplicate rows if points in the target object (<code>cycle_hire</code>) match multiple points in the source (<code>cycle_hire_osm</code>).</li>
</ul></li>
</ol></li>
<li><p><strong>Key Observations</strong>:</p>
<ul>
<li>Joins retain the geometry of features in the target dataset (<code>cycle_hire</code>).</li>
<li>Distance-based joins are effective for linking datasets that are close geographically but do not overlap.</li>
</ul></li>
</ul>
<p>Figure&nbsp;4 visualizes the spatial relationship between two datasets, <code>cycle_hire</code> and <code>cycle_hire_osm</code>, using a proximity filter. The <code>st_filter()</code> function from the <strong>sf</strong> package identifies points in the <code>cycle_hire</code> dataset that are within 10 meters of points in <code>cycle_hire_osm</code>, leveraging the <code>st_is_within_distance</code> predicate. The result is a subset of <code>cycle_hire</code> points, which are plotted using <strong>ggplot2</strong>. The plot includes:</p>
<ul>
<li><p>Filtered <code>cycle_hire</code> points (dark blue, fully opaque).</p></li>
<li><p>All <code>cycle_hire</code> points (dark blue, semi-transparent) for context.</p></li>
<li><p>All <code>cycle_hire_osm</code> points (red, semi-transparent) to show the proximity relationship.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cycle_hire"</span>)</span>
<span id="cb15-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cycle_hire_osm"</span>)</span>
<span id="cb15-3"></span>
<span id="cb15-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb15-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cycle_hire,</span>
<span id="cb15-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>,</span>
<span id="cb15-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb15-9">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb15-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cycle_hire_osm,</span>
<span id="cb15-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>,</span>
<span id="cb15-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb15-14">  )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter4_files/figure-html/unnamed-chunk-9-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Official Cycle hire points with added info from OSM points within 10 metres</span></span>
<span id="cb16-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb16-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cycle_hire |&gt; </span></span>
<span id="cb16-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   st_join(</span></span>
<span id="cb16-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     cycle_hire_osm, </span></span>
<span id="cb16-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     join = st_is_within_distance,</span></span>
<span id="cb16-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     dist = units::set_units(10, "m")</span></span>
<span id="cb16-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   )</span></span></code></pre></div>
</details>
</div>
<p>Just checking, whether any of the two points in these two data sets exactly match. Well, they don’t!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersects</span>(cycle_hire, cycle_hire_osm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">any</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p>Now, in Figure&nbsp;4, we highlight only those points of bike hire in the official data, which are within 10 metres of the OSM data. The important function here is <code>st_filter()</code> along with the argument <code>.predicate = st_is_within_distance()</code> and the argument <code>dist = ...</code> .</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot only points which have a OSM point within 10 metres</span></span>
<span id="cb19-2">cycle_hire <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_filter</span>(</span>
<span id="cb19-4">    cycle_hire_osm,</span>
<span id="cb19-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.predicate =</span> st_is_within_distance,</span>
<span id="cb19-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> units<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_units</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"m"</span>)</span>
<span id="cb19-7">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkblue"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb19-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cycle_hire, </span>
<span id="cb19-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, </span>
<span id="cb19-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>,</span>
<span id="cb19-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb19-15">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb19-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cycle_hire_osm, </span>
<span id="cb19-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, </span>
<span id="cb19-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>,</span>
<span id="cb19-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb19-21">  )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-st_join2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-st_join2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-st_join2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;4: Official Cycle Hire Points Within 10 Meters of OpenStreetMap Locations"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-st_join2-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-st_join2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Official Cycle Hire Points Within 10 Meters of OpenStreetMap Locations
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="spatial-aggregation" class="level3">
<h3 class="anchored" data-anchor-id="spatial-aggregation">4.2.7 Spatial Aggregation</h3>
<ul>
<li>Spatial data aggregation condenses data into fewer rows by summarizing multiple values of a variable into a single value per grouping variable, similar to attribute data aggregation. Following two approaches exist: —
<ul>
<li><strong>Base R’s <code>aggregate()</code></strong>: Groups values based on spatial relationships and summarizes them with a specified function (e.g., <code>mean</code>).</li>
<li><strong>Tidyverse Approach (<code>group_by()</code> and <code>summarize()</code>)</strong>: Combines <code>st_join()</code> with grouping and summarizing to perform spatial aggregation while allowing flexibility in function application and column naming. <strong>(This approach is better, as shown in Figure&nbsp;5)</strong></li>
</ul></li>
<li><strong>Output Differences</strong>:
<ul>
<li><code>aggregate()</code> may result in <code>NA</code> for unmatched regions.</li>
<li>Tidyverse methods preserve unmatched region names and allow for more flexible aggregation functions and output formatting.</li>
</ul></li>
<li>Functions like <code>median()</code>, <code>sd()</code>, or other statistical summarizers can replace <code>mean()</code> for different aggregation purposes.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nz_height"</span>)</span>
<span id="cb20-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nz"</span>)</span>
<span id="cb20-3"></span>
<span id="cb20-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_join</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> nz, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> nz_height) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb20-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Name) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb20-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">elevation =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(elevation, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> T)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb20-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb20-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> elevation)</span>
<span id="cb20-9">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-11">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb20-12">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grDevices::Terrain 2"</span>,</span>
<span id="cb20-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb20-14">  )</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-st-join-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-st-join-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-st-join-3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;5: Spatial data aggregation with st_join() from {sf} and summarise() from {tidyverse}"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-st-join-3-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-st-join-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Spatial data aggregation with st_join() from {sf} and summarise() from {tidyverse}
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="joining-in-congruent-layers" class="level3">
<h3 class="anchored" data-anchor-id="joining-in-congruent-layers">4.2.8 Joining In-congruent Layers</h3>
<ul>
<li><p>Spatial congruence occurs when two layers (aggregating object <code>y</code> and target object <code>x</code>) share borders, enabling accurate spatial aggregation. Incongruence arises when no shared borders exist, complicating spatial operations.</p></li>
<li><p>Example of Congruence:</p>
<ul>
<li>Administrative boundaries, such as districts made of smaller units, typically exhibit spatial congruence.</li>
</ul></li>
<li><p>Issue with Incongruence:</p>
<ul>
<li>In-congruent layers, like sub-zones with differing borders from aggregating zones, result in inaccurate aggregations (e.g., centroids of sub-zones).</li>
</ul></li>
<li><p><strong>Solution: Areal Interpolation</strong>: Transfers values between areal units using:</p>
<ul>
<li><strong>Simple area-weighted methods</strong>: Proportionally assigns values based on area overlap. This is implemented using <strong><code>st_interpolate_aw()</code></strong>.</li>
<li><strong>Advanced methods</strong>: Include algorithms like ‘pycnophylactic’ interpolation.</li>
</ul></li>
<li><p><strong>Example Dataset</strong>:</p>
<ul>
<li>The <strong>spData package</strong> includes <code>incongruent</code> (sub-zones) and <code>aggregating_zones</code> (larger zones). The <code>value</code> column in <code>incongruent</code> represents total regional income in million Euros, which must be aggregated into <code>aggregating_zones</code>.</li>
</ul></li>
<li><p><strong>Implementation: <code>st_interpolate_aw()</code></strong>:</p>
<ul>
<li>The <code>st_interpolate_aw()</code> function in the <strong>sf</strong> package performs areal-weighted interpolation of polygon data, allowing attributes from one spatial object (<code>x</code>) to be transferred to another (<code>to</code>) based on area overlap. The <code>extensive</code> argument determines whether attributes are <strong>spatially extensive</strong> (e.g., population, summed across areas) or <strong>spatially intensive</strong> (e.g., density, averaged). Additional options include <code>keep_NA</code> (to retain or exclude <code>NA</code> features) and <code>na.rm</code> (to remove features with <code>NA</code> attributes from <code>x</code>).</li>
<li>Aggregated results depend on the variable type:
<ul>
<li><strong>Extensive variables</strong>: Values increase with area (e.g., total income).</li>
<li><strong>Intensive variables</strong>: Values remain constant irrespective of area (e.g., averages).</li>
</ul></li>
<li><strong><code>st_interpolate_aw()</code></strong> handles <strong>spatially extensive variables</strong> (e.g., total income) by summing values across areas.</li>
<li>In <strong><code>st_interpolate_aw()</code></strong>, for <strong>spatially intensive variables</strong> (e.g., averages, percentages), set <code>extensive = FALSE</code> to use averages instead of sums.</li>
<li>Note: Warning messages indicate the assumption of uniform attribute distribution across areas.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aggregating_zones"</span>)</span>
<span id="cb21-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"incongruent"</span>)</span>
<span id="cb21-3"></span>
<span id="cb21-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The two overall main zones for which the total income needs to be computed</span></span>
<span id="cb21-5">aggregating_zones</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 2 features and 3 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 417686.2 ymin: 443703.6 xmax: 422959.3 ymax: 447036.8
Projected CRS: OSGB 1936 / British National Grid
      geo_code geo_label geo_labelw                       geometry
5164 E02002332 Leeds 003       &lt;NA&gt; MULTIPOLYGON (((418731.9 44...
6631 E02002333 Leeds 004       &lt;NA&gt; MULTIPOLYGON (((419196.4 44...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The 9 smaller counties or districts or sub-units which are not</span></span>
<span id="cb23-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># congruent with the main zones</span></span>
<span id="cb23-3">incongruent</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 9 features and 2 fields
Attribute-geometry relationships: aggregate (1), NA's (1)
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 417686.8 ymin: 443703 xmax: 422963 ymax: 446978
Projected CRS: OSGB 1936 / British National Grid
        level    value                       geometry
1 Incongruent 4.037919 MULTIPOLYGON (((420799.6 44...
2 Incongruent 5.014419 MULTIPOLYGON (((418664 4464...
3 Incongruent 4.933000 MULTIPOLYGON (((419964 4462...
4 Incongruent 5.120139 MULTIPOLYGON (((420368 4441...
5 Incongruent 6.548912 MULTIPOLYGON (((420419.8 44...
6 Incongruent 3.749791 MULTIPOLYGON (((421779 4451...
7 Incongruent 5.432837 MULTIPOLYGON (((419577 4464...
8 Incongruent 4.618049 MULTIPOLYGON (((417687.6 44...
9 Incongruent 5.956771 MULTIPOLYGON (((418859.3 44...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># We are using extensive = TRUE, because our variable is </span></span>
<span id="cb25-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># total income, not average income</span></span>
<span id="cb25-3">incongruent <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb25-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># We need to keep only the numeric variable (and of course,</span></span>
<span id="cb25-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># the sticky geometry. Otherwise, R will not understand what</span></span>
<span id="cb25-6">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># to do with non-numeric columns)</span></span>
<span id="cb25-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(value) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb25-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_interpolate_aw</span>(aggregating_zones, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">extensive =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in st_interpolate_aw.sf(select(incongruent, value), aggregating_zones,
: st_interpolate_aw assumes attributes are constant or uniform over areas of x</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 2 features and 1 field
Attribute-geometry relationship: aggregate (1)
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 417686.2 ymin: 443703.6 xmax: 422959.3 ymax: 447036.8
Projected CRS: OSGB 1936 / British National Grid
     value                       geometry
1 19.61613 MULTIPOLYGON (((418731.9 44...
2 25.66872 MULTIPOLYGON (((419196.4 44...</code></pre>
</div>
</div>
</section>
</section>
<section id="spatial-operations-on-raster-data" class="level2">
<h2 class="anchored" data-anchor-id="spatial-operations-on-raster-data">4.3 Spatial operations on raster data</h2>
<ul>
<li>Demonstrates <strong>advanced spatial raster operations</strong>.</li>
<li>Provides an alternative to manually creating datasets by accessing them from the <strong><code>spData</code></strong> package:
<ul>
<li><code>elev</code>: Represents elevation data.</li>
<li><code>grain</code>: Represents grain-related data.</li>
</ul></li>
</ul>
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1">elev <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/elev.tif"</span>, </span>
<span id="cb28-2">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spData"</span>))</span>
<span id="cb28-3"></span>
<span id="cb28-4">grain <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/grain.tif"</span>, </span>
<span id="cb28-5">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spData"</span>))</span>
<span id="cb28-6"></span>
<span id="cb28-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot(elev)</span></span>
<span id="cb28-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot(grain)</span></span>
<span id="cb28-9"></span>
<span id="cb28-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"elev SpatRaster"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data: {spData}"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_grass_c</span>()</span>
<span id="cb28-14">  </span>
<span id="cb28-15"></span>
<span id="cb28-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> grain) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_grass_d</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grain SpatRaster"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data: {spData}"</span>)</span></code></pre></div>
<div id="fig-4-3" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-4-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-4-3" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-4-3-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-4-3-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-4-3-1.png" class="lightbox" data-gallery="fig-4-3" title="Figure&nbsp;6&nbsp;(a): elev"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-4-3-1.png" class="img-fluid figure-img" data-ref-parent="fig-4-3" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-4-3-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) elev
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-4-3" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-4-3-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-4-3-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-4-3-2.png" class="lightbox" data-gallery="fig-4-3" title="Figure&nbsp;6&nbsp;(b): grain"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-4-3-2.png" class="img-fluid figure-img" data-ref-parent="fig-4-3" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-4-3-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) grain
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-4-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Section 4.3: Raster Datasets used: plotted using ggplot2 and {tidyterra}
</figcaption>
</figure>
</div>
<section id="spatial-subsetting" class="level3">
<h3 class="anchored" data-anchor-id="spatial-subsetting">4.3.1 Spatial subsetting</h3>
<ul>
<li>Spatial subsetting allows extraction of raster data by <strong>location (coordinates)</strong> or <strong>spatial objects</strong>:
<ul>
<li><strong><code>terra::extract()</code></strong>: Extracts raster values directly using coordinates. <em>(Note: A function with the same name exists in the <strong>tidyverse</strong>, so be careful to add package name at start)</em>.</li>
</ul></li>
<li><strong>Subsetting with another raster object</strong>:
<ul>
<li>Use a secondary raster as a spatial mask to subset the primary raster, using <code>terra::crop()</code> .</li>
<li>Example shown below: Subsetting <code>elev</code> using a smaller raster <code>clip_raster</code> (defining a specific extent).</li>
<li>Two kinds of Spatial outputs from subsetting:
<ul>
<li>Use the <strong><code>drop</code> argument</strong> with the <code>[ ]</code> operator to return subsetting results as raster objects.</li>
<li>Example: Subsets the first two cells of <code>elev</code> with <code>elev[1:2, drop = FALSE]</code>, whereas <code>elev[1:2]</code> returns the cell values of first two cells only.</li>
</ul></li>
</ul></li>
<li><strong>Masking raster data with logical values</strong>:
<ul>
<li>Creates a raster mask (<code>rmask</code>) with <strong>NA</strong> and <strong>TRUE</strong> values.</li>
<li>Masks the primary raster (<code>elev</code>) to retain only values corresponding to <code>TRUE</code> in the mask using:
<ul>
<li><code>[ ]</code> operator - use <code>TRUE</code> and <code>FALSE</code>.</li>
<li><code>mask()</code> function - use <code>TRUE</code> and <code>NA</code>.</li>
</ul></li>
</ul></li>
<li><strong>The <code>terra::crop()</code> function</strong> extracts a subset of a raster or vector object based on a specified extent, defined using another spatial object or <code>terra::ext()</code>. It retains the input’s resolution and CRS, focusing analysis on a specific region. Commonly used for preprocessing large datasets, it pairs well with <code>terra::mask()</code> for refined cropping.</li>
<li><strong>The <code>mask()</code> function in the <code>terra</code> package</strong> applies a mask to a SpatRaster or SpatVector. It replaces values in a raster (<code>x</code>) with <code>NA</code> (or another value) where another raster or vector (<code>mask</code>) has <code>NA</code> or specified mask values. It’s useful for filtering, clipping, or focusing on specific areas.</li>
<li><strong>The <code>extract()</code> function in the terra package</strong> retrieves values from a <code>SpatRaster</code> based on specified locations or geometries. Locations can be points (as a <code>SpatVector</code>, matrix, or data frame), cell numbers, or spatial objects like polygons. It supports methods for exact or weighted extraction, interpolation, and summary statistics for extracted data. Key arguments include:
<ul>
<li><p><strong><code>x</code></strong>: The <code>SpatRaster</code> to extract values from</p></li>
<li><p><strong><code>y</code></strong>: Locations (e.g., points, polygons, or cell numbers) to extract values for.</p></li>
<li><p><strong><code>fun</code></strong>: Summarizes extracted data for polygons (e.g., mean, sum).</p></li>
<li><p><strong><code>cells</code>/<code>xy</code></strong>: Optionally return cell numbers or coordinates.</p></li>
<li><p><strong><code>weights</code>/<code>exact</code></strong>: Extract weighted or exact fractions for polygons.</p></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Let us extract some values from "elev" using coordinates</span></span>
<span id="cb29-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># I want to extract coordiantes of </span></span>
<span id="cb29-3">coords_extract <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(</span>
<span id="cb29-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>,</span>
<span id="cb29-5">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>),</span>
<span id="cb29-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb29-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">byrow =</span> T</span>
<span id="cb29-8">)</span>
<span id="cb29-9"></span>
<span id="cb29-10">coords_extract</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,] -1.2 -1.2
[2,]  1.2  1.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1">elev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb31-2">  terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">extract</span>(</span>
<span id="cb31-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> coords_extract</span>
<span id="cb31-4">  )</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  elev
1   31
2    6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Let us create a new raster to clip the central four blocks of the elev raster</span></span>
<span id="cb33-2">clip_raster <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(</span>
<span id="cb33-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, </span>
<span id="cb33-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb33-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resolution =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, </span>
<span id="cb33-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vals =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb33-7">  )</span>
<span id="cb33-8"></span>
<span id="cb33-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extracting only the values</span></span>
<span id="cb33-10">elev[clip_raster]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  elev
1   15
2   16
3   21
4   22</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Explaining the meaning of argument drop = FALSE in the </span></span>
<span id="cb35-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># base R subsetting operator "[]"</span></span>
<span id="cb35-3">elev[clip_raster]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  elev
1   15
2   16
3   21
4   22</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1">elev[clip_raster, drop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>]    </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatRaster 
dimensions  : 2, 2, 1  (nrow, ncol, nlyr)
resolution  : 0.5, 0.5  (x, y)
extent      : -0.5, 0.5, -0.5, 0.5  (xmin, xmax, ymin, ymax)
coord. ref. : lon/lat WGS 84 (EPSG:4326) 
source(s)   : memory
varname     : elev 
name        : elev 
min value   :   15 
max value   :   22 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Using the {terra} approach: with the function terra::crop()</span></span>
<span id="cb39-2">elev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb39-3">  terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crop</span>(clip_raster)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatRaster 
dimensions  : 2, 2, 1  (nrow, ncol, nlyr)
resolution  : 0.5, 0.5  (x, y)
extent      : -0.5, 0.5, -0.5, 0.5  (xmin, xmax, ymin, ymax)
coord. ref. : lon/lat WGS 84 (EPSG:4326) 
source(s)   : memory
varname     : elev 
name        : elev 
min value   :   15 
max value   :   22 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Creating a temporary_mask object</span></span>
<span id="cb41-2">temporary_mask <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> elev</span>
<span id="cb41-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(temporary_mask) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>,</span>
<span id="cb41-4">                                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> T)</span>
<span id="cb41-5"></span>
<span id="cb41-6">elev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb41-7">  terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mask</span>(temporary_mask)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatRaster 
dimensions  : 6, 6, 1  (nrow, ncol, nlyr)
resolution  : 0.5, 0.5  (x, y)
extent      : -1.5, 1.5, -1.5, 1.5  (xmin, xmax, ymin, ymax)
coord. ref. : lon/lat WGS 84 (EPSG:4326) 
source(s)   : memory
varname     : elev 
name        : elev 
min value   :    1 
max value   :   36 </code></pre>
</div>
</div>
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb43-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> clip_raster) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb43-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb43-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb43-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_grass_c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>))</span>
<span id="cb43-6"></span>
<span id="cb43-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb43-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> temporary_mask) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb43-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_discrete</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb43-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb43-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>))</span>
<span id="cb43-12"></span>
<span id="cb43-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb43-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mask</span>(temporary_mask)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb43-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb43-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb43-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_grass_c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>))</span></code></pre></div>
<div id="fig-4-3-masking" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-4-3-masking-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-4-3-masking" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-4-3-masking-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-4-3-masking-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-4-3-masking-1.png" class="lightbox" data-gallery="fig-4-3-masking" title="Figure&nbsp;7&nbsp;(a): Plotting clip_raster: a smaller raster"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-4-3-masking-1.png" class="img-fluid figure-img" data-ref-parent="fig-4-3-masking" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-4-3-masking-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Plotting clip_raster: a smaller raster
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-4-3-masking" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-4-3-masking-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-4-3-masking-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-4-3-masking-2.png" class="lightbox" data-gallery="fig-4-3-masking" title="Figure&nbsp;7&nbsp;(b): The temporary_mask raster"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-4-3-masking-2.png" class="img-fluid figure-img" data-ref-parent="fig-4-3-masking" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-4-3-masking-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) The <code>temporary_mask</code> raster
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-4-3-masking" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-4-3-masking-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-4-3-masking-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-4-3-masking-3.png" class="lightbox" data-gallery="fig-4-3-masking" title="Figure&nbsp;7&nbsp;(c): plotting the masked elev, based on a randomly generated temporary_mask"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-4-3-masking-3.png" class="img-fluid figure-img" data-ref-parent="fig-4-3-masking" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-4-3-masking-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) plotting the masked elev, based on a randomly generated <code>temporary_mask</code>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-4-3-masking-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Showing plots from the code of above
</figcaption>
</figure>
</div>
</section>
<section id="local-operations" class="level3">
<h3 class="anchored" data-anchor-id="local-operations">4.3.3 Local operations</h3>
<ul>
<li>Local operations are <strong>cell-by-cell operations</strong> performed on one or more raster layers. Includes operations like addition, subtraction, squaring, logical comparisons, and logarithmic transformations. Examples are shown in Figure&nbsp;8</li>
<li><strong>Reclassification</strong>:
<ul>
<li>Numeric values can be grouped into intervals (e.g., low, middle, high elevations).</li>
<li>Use the <strong><code>classify()</code> function</strong> with a reclassification matrix to assign new values to defined ranges.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"`elev` - the original raster"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-4">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grDevices::terrain.colors"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>)</span>
<span id="cb44-6"></span>
<span id="cb44-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"elev^2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-10">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grDevices::terrain.colors"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb44-12">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt"</span>))</span>
<span id="cb44-13"></span>
<span id="cb44-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log2</span>(elev)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log2(elev)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-17">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grDevices::terrain.colors"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb44-19">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt"</span>))</span>
<span id="cb44-20"></span>
<span id="cb44-21"></span>
<span id="cb44-22"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"elev &gt; 10"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-25"> paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_d</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggsci::alternating_igv"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb44-27">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt"</span>))</span></code></pre></div>
<div id="fig-local-op-rasters" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-local-op-rasters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="fig-local-op-rasters-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-local-op-rasters-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-local-op-rasters-1.png" class="lightbox" data-gallery="fig-local-op-rasters" title="Figure&nbsp;8&nbsp;(a): elev"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-local-op-rasters-1.png" class="img-fluid figure-img" data-ref-parent="fig-local-op-rasters" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-local-op-rasters-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) elev
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-local-op-rasters-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-local-op-rasters-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-local-op-rasters-2.png" class="lightbox" data-gallery="fig-local-op-rasters" title="Figure&nbsp;8&nbsp;(b): elev^2"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-local-op-rasters-2.png" class="img-fluid figure-img" data-ref-parent="fig-local-op-rasters" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-local-op-rasters-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) elev^2
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-local-op-rasters-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-local-op-rasters-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-local-op-rasters-3.png" class="lightbox" data-gallery="fig-local-op-rasters" title="Figure&nbsp;8&nbsp;(c): log2(elev)"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-local-op-rasters-3.png" class="img-fluid figure-img" data-ref-parent="fig-local-op-rasters" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-local-op-rasters-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) log2(elev)
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-local-op-rasters-4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-local-op-rasters-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-local-op-rasters-4.png" class="lightbox" data-gallery="fig-local-op-rasters" title="Figure&nbsp;8&nbsp;(d): elev > 10"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-local-op-rasters-4.png" class="img-fluid figure-img" data-ref-parent="fig-local-op-rasters" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-local-op-rasters-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d) elev &gt; 10
</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-local-op-rasters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8
</figcaption>
</figure>
</div>
</div>
<ul>
<li><strong>Efficient alternatives for operations</strong>:
<ul>
<li><strong><code>app()</code></strong>: The <code>app()</code> function in the <code>{terra}</code> package applies a user-defined or pre-existing function to each cell’s values of a <code>SpatRaster</code>, treating layers as columns in a matrix. Functions should return outputs divisible by the total cell count.</li>
<li><strong><code>tapp()</code></strong>: The <code>tapp()</code> function in the <code>{terra}</code> package applies a function to subsets of layers in a <code>SpatRaster</code> grouped by an index. It allows for aggregation or summarization of layers based on grouping criteria such as indices, time periods (e.g., “years”, “months”), or custom functions.</li>
<li><strong><code>lapp()</code></strong>: The <code>lapp()</code> function in the <code>{terra}</code> package applies a user-defined function to the layers of a <code>SpatRaster</code> or <code>SpatRasterDataset</code>, treating each layer as an argument to the function. The function must accept a vector of layer values and return a vector or matrix of the same or compatible size. This is useful for combining or transforming layers, such as performing arithmetic operations between them. An example of <code>lapp()</code> is the NDVI Calculation:
<ul>
<li>NDVI (Normalized Difference Vegetation Index) is a local operation to assess vegetation:
<ul>
<li>Formula: <strong>(NIR - Red) / (NIR + Red)</strong>.</li>
</ul></li>
<li>Calculated from satellite data (e.g., Landsat 8) with red and NIR bands.
<ul>
<li>Positive NDVI values (&gt; 0.2) indicate vegetation.</li>
<li>Largest values correspond to dense forests, while lowest values are related to lakes and snowy areas.</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1">multi_rast <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/landsat.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>)</span>
<span id="cb45-2">multi_rast <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(multi_rast)</span>
<span id="cb45-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Rescale values to actual values (stored integers to save disk space)</span></span>
<span id="cb45-4">multi_rast <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> (multi_rast <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0000275</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span></span>
<span id="cb45-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove negative values due to clouds etc.</span></span>
<span id="cb45-6">multi_rast[multi_rast <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb45-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">object.size</span>(multi_rast)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1304 bytes</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1">ndvi_fun <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(nir, red){</span>
<span id="cb47-2">  (nir <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> red) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (nir <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> red)</span>
<span id="cb47-3">}</span>
<span id="cb47-4"></span>
<span id="cb47-5">ndvi_rast <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapp</span>(multi_rast[[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> ndvi_fun)</span>
<span id="cb47-6"></span>
<span id="cb47-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb47-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb47-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> ndvi_rast,</span>
<span id="cb47-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> lyr1)</span>
<span id="cb47-11">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb47-12">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb47-13">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grDevices::Terrain 2"</span>,</span>
<span id="cb47-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb47-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb47-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">oob =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>squish</span>
<span id="cb47-17">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb47-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb47-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Zion National Park - Satellite Photo Raster"</span>,</span>
<span id="cb47-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Using custom nvdi_fun() to find NVDI</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">and plot vegetation areas in {ggplot2}"</span>,</span>
<span id="cb47-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb47-22">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb47-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb47-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb47-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt"</span>)</span>
<span id="cb47-26">  )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter4_files/figure-html/unnamed-chunk-18-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="focal-operations" class="level3">
<h3 class="anchored" data-anchor-id="focal-operations">4.3.4 Focal operations</h3>
<ul>
<li>Focal operations consider a central cell and its neighbours within a defined neighbourhood (kernel, filter, or moving window).
<ul>
<li>Common neighbourhood size: <strong>3x3 cells</strong> (central cell + 8 neighbours), but customizable sizes and shapes are supported.</li>
<li>The operation aggregates values within the neighbourhood and assigns the result to the central cell, iterating across all cells.</li>
</ul></li>
<li><strong>Implementation in R</strong>:
<ul>
<li>Use the <strong><code>focal()</code> function</strong> to perform spatial filtering Figure&nbsp;9. Parameters:
<ul>
<li><strong><code>w</code></strong>: Defines the weights of the moving window using a matrix, example in Figure&nbsp;9 (c).</li>
<li><strong><code>fun</code></strong>: Specifies the aggregation function (e.g., <code>min</code>, <code>sum</code>, <code>mean</code>, <code>var</code>), as in Figure&nbsp;9 (b)</li>
</ul></li>
</ul></li>
<li><strong>Applications</strong>:
<ul>
<li>Spatial filtering or convolution for raster operations.</li>
<li>Low-pass filters:
<ul>
<li>Use the mean function to smooth and reduce extreme values.</li>
<li>For categorical data, replace the mean with the mode (most common value).</li>
</ul></li>
<li>High-pass filters:
<ul>
<li>Enhance features using methods like Laplace or Sobel filters (e.g., line detection).</li>
</ul></li>
<li>Terrain processing:
<ul>
<li>Compute topographic characteristics like slope, aspect, and flow directions using focal functions.</li>
</ul></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb48-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb48-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"elev SpatRaster"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data: {spData}"</span>)</span>
<span id="cb48-4"></span>
<span id="cb48-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb48-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb48-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb48-8">        terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">focal</span>(</span>
<span id="cb48-9">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">w =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>),</span>
<span id="cb48-10">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> min</span>
<span id="cb48-11">      )</span>
<span id="cb48-12">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb48-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Focal operation min on a 3X3 matric"</span>,</span>
<span id="cb48-14">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Simple min() function with na.rm = FALSE"</span>)</span>
<span id="cb48-15"></span>
<span id="cb48-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb48-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb48-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb48-19">        terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">focal</span>(</span>
<span id="cb48-20">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sobel filters (for edge detection):</span></span>
<span id="cb48-21">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">w =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>),</span>
<span id="cb48-22">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> mean,</span>
<span id="cb48-23">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb48-24">      )</span>
<span id="cb48-25">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb48-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb48-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Focal operation min on a 3X3 matric"</span>,</span>
<span id="cb48-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sobel filter matrix for edge detection, with mean() function"</span></span>
<span id="cb48-29">  )</span></code></pre></div>
<div id="fig-focal-op" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-focal-op-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="fig-focal-op-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-focal-op-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-focal-op-1.png" class="lightbox" data-gallery="fig-focal-op" title="Figure&nbsp;9&nbsp;(a): Original elev raster"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-focal-op-1.png" class="img-fluid figure-img" data-ref-parent="fig-focal-op" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-focal-op-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Original elev raster
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-focal-op-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-focal-op-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-focal-op-2.png" class="lightbox" data-gallery="fig-focal-op" title="Figure&nbsp;9&nbsp;(b): Focal operation with min() and a simple matrix of equal weights"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-focal-op-2.png" class="img-fluid figure-img" data-ref-parent="fig-focal-op" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-focal-op-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Focal operation with min() and a simple matrix of equal weights
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-focal-op-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-focal-op-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-focal-op-3.png" class="lightbox" data-gallery="fig-focal-op" title="Figure&nbsp;9&nbsp;(c): Focal operation with mean() and a sobel filter matrix for edge detection"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-focal-op-3.png" class="img-fluid figure-img" data-ref-parent="fig-focal-op" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-focal-op-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Focal operation with mean() and a sobel filter matrix for edge detection
</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-focal-op-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Focal operations on Rasters using terra::focal()
</figcaption>
</figure>
</div>
</div>
</section>
<section id="zonal-operations" class="level3">
<h3 class="anchored" data-anchor-id="zonal-operations">4.3.5 Zonal operations</h3>
<ul>
<li>Zonal operations aggregate raster cell values based on zones defined by a second raster with categorical values. Unlike focal operations, zones in zonal operations do not require neighboring cells to be adjacent.</li>
<li><strong>Key Characteristics</strong>:
<ul>
<li>The <code>zonal()</code> function in the <strong>terra</strong> package computes zonal statistics by summarizing the values of a <code>SpatRaster</code> for each “zone” defined by another <code>SpatRaster</code>. It applies a specified function (<code>fun</code>, e.g., mean, sum) to aggregate the data for each zone.</li>
<li>The result is typically a <strong>summary table</strong>, grouped by zones. Zones are defined by a secondary raster.</li>
<li><strong>Optional Output</strong>: A raster with calculated statistics for each zone can be generated by setting <code>as.raster = TRUE</code>.</li>
</ul></li>
<li><strong>Usage</strong>:
<ul>
<li>Ideal for summarizing raster values based on irregularly spread categorical zones.</li>
<li>Commonly used in <strong>land classification</strong>, <strong>soil analysis</strong>, and other spatial analyses where zones are pre-defined.</li>
</ul></li>
</ul>
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb49-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb49-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"elev SpatRaster"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data: {spData}"</span>)</span>
<span id="cb49-4">  </span>
<span id="cb49-5"></span>
<span id="cb49-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb49-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> grain) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb49-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grain SpatRaster"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data: {spData}"</span>)</span></code></pre></div>
<div id="fig-zonal-op" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-zonal-op-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-zonal-op" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-zonal-op-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-zonal-op-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-zonal-op-1.png" class="lightbox" data-gallery="fig-zonal-op" title="Figure&nbsp;10&nbsp;(a): elev"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-zonal-op-1.png" class="img-fluid figure-img" data-ref-parent="fig-zonal-op" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-zonal-op-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) elev
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-zonal-op" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-zonal-op-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-zonal-op-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-zonal-op-2.png" class="lightbox" data-gallery="fig-zonal-op" title="Figure&nbsp;10&nbsp;(b): grain"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-zonal-op-2.png" class="img-fluid figure-img" data-ref-parent="fig-zonal-op" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-zonal-op-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) grain
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-zonal-op-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: The elev and grain rasters
</figcaption>
</figure>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1">elev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb50-2">  terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">zonal</span>(</span>
<span id="cb50-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> grain,</span>
<span id="cb50-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> mean</span>
<span id="cb50-5">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb50-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  grain  elev
  &lt;chr&gt; &lt;dbl&gt;
1 clay   14.8
2 silt   21.2
3 sand   18.7</code></pre>
</div>
</div>
</section>
<section id="global-operations-and-distances" class="level3">
<h3 class="anchored" data-anchor-id="global-operations-and-distances">4.3.6 Global operations and distances</h3>
<ul>
<li>Global operations consider the entire raster dataset as a <strong>single zone</strong>.</li>
<li>Common operations include:
<ul>
<li><strong>Descriptive statistics</strong>: Minimum, maximum, etc.</li>
<li><strong>Distance calculations</strong>: Compute distance from each cell to a target cell using <strong><code>terra::distance()</code></strong>. The <code>terra::distance()</code> function calculates the shortest distance from each cell in a raster to a set of target cells, which are identified based on a condition (e.g., where raster values are non-NA, equal to a specific value, or greater than a threshold). This is useful for spatial analysis, such as finding proximity to certain features or zones in a raster.</li>
<li><strong>Weighted distances</strong>: Factor in additional variables, such as elevation, to modify distance calculations.</li>
<li><strong>Visibility and viewshed analysis</strong>: Assess visible areas from a specific point.</li>
</ul></li>
<li><strong>Applications</strong>:
<ul>
<li>Distance to coastlines or other target areas.</li>
<li>Topography-aware distance calculations.</li>
<li>Advanced spatial modeling like visibility analysis.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a sample SpatRaster</span></span>
<span id="cb52-2">r <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncols =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrows =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, </span>
<span id="cb52-3">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, </span>
<span id="cb52-4">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb52-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(r) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb52-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(r)[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Assign specific cells as targets</span></span>
<span id="cb52-7"></span>
<span id="cb52-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute the distance to the non-NA cells</span></span>
<span id="cb52-9">dist_raster <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">distance</span>(r)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
|---------|---------|---------|---------|
=========================================
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1">dist_raster <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dist_raster <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-5</span></span></code></pre></div>
</div>
<div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># View the raster</span></span>
<span id="cb55-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb55-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> r) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb55-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Original Raster (Targets in Blue)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb55-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb55-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span></span>
<span id="cb55-7">  )</span>
<span id="cb55-8"></span>
<span id="cb55-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># View the distance raster</span></span>
<span id="cb55-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb55-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dist_raster) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb55-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance to Targets (in units)"</span>,</span>
<span id="cb55-13">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance in Degrees"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb55-14">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggthemes::Red-Gold"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb55-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>)</span></code></pre></div>
<div id="fig-terra-distance" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-terra-distance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-terra-distance" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-terra-distance-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-terra-distance-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-terra-distance-1.png" class="lightbox" data-gallery="fig-terra-distance" title="Figure&nbsp;11&nbsp;(a): Original raster"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-terra-distance-1.png" class="img-fluid figure-img" data-ref-parent="fig-terra-distance" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-terra-distance-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Original raster
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-terra-distance" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-terra-distance-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-terra-distance-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-terra-distance-2.png" class="lightbox" data-gallery="fig-terra-distance" title="Figure&nbsp;11&nbsp;(b): Distance raster"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-terra-distance-2.png" class="img-fluid figure-img" data-ref-parent="fig-terra-distance" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-terra-distance-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Distance raster
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-terra-distance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Using the terra::distance()
</figcaption>
</figure>
</div>
</section>
<section id="map-algebra-counterparts-in-vector-processing" class="level3">
<h3 class="anchored" data-anchor-id="map-algebra-counterparts-in-vector-processing">4.3.7 Map algebra counterparts in vector processing</h3>
<ul>
<li>Equivalence between raster and vector operations:
<ul>
<li>Distance raster (global operation) ≈ Buffer operation (vector) (Section 5.2.5).</li>
<li>Raster reclassification ≈ Dissolving vector boundaries (Section 4.2.5).</li>
<li>Raster overlay with masks ≈ Vector clipping (Section 5.2.5).</li>
<li>Zonal operations ≈ Aggregating vector geometries by zone<strong>s</strong>.</li>
</ul></li>
</ul>
</section>
<section id="merging-rasters" class="level3">
<h3 class="anchored" data-anchor-id="merging-rasters">4.3.8 Merging rasters</h3>
<ul>
<li><p>Combines multiple raster datasets into a single raster. Often required for datasets spanning multiple spatial scenes (e.g., satellite imagery, elevation data).</p></li>
<li><p><strong><code>merge()</code></strong>:</p>
<ul>
<li>Places rasters side by side.</li>
<li>For overlapping areas, prioritizes values from the first raster.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb56" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1">aut <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> geodata<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">elevation_30s</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AUT"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tempdir</span>())</span>
<span id="cb56-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb56-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> aut) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb56-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb56-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Austria"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter4_files/figure-html/unnamed-chunk-24-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb57" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1">cze <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> geodata<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">elevation_30s</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CZE"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tempdir</span>())</span>
<span id="cb57-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb57-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cze) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb57-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb57-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Czechia"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter4_files/figure-html/unnamed-chunk-24-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb58" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1">svk <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> geodata<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">elevation_30s</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SVK"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tempdir</span>())</span>
<span id="cb58-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb58-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> svk) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb58-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb58-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Slovakia"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter4_files/figure-html/unnamed-chunk-24-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/unnamed-chunk-24-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb59" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1">aut_cze_svk <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> aut <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb59-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">merge</span>(svk) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb59-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">merge</span>(cze)</span>
<span id="cb59-4"></span>
<span id="cb59-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb59-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> aut_cze_svk) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb59-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb59-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Austria, Czechia and Slovakia"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter4_files/figure-html/unnamed-chunk-24-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-28"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/unnamed-chunk-24-4.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><strong><code>mosaic()</code></strong>:</p>
<ul>
<li>Handles overlaps by applying a function (e.g., mean) to the overlapping area.</li>
<li>Helps smooth visible borders but may not eliminate them entirely.</li>
</ul></li>
</ul>
</section>
</section>
<section id="exercises" class="level2">
<h2 class="anchored" data-anchor-id="exercises">4.4 Exercises</h2>
<section id="e1." class="level3">
<h3 class="anchored" data-anchor-id="e1.">E1.</h3>
<p><strong>It was established in Section <a href="https://r.geocompx.org/spatial-operations#spatial-vec">4.2</a> that Canterbury was the region of New Zealand containing most of the 101 highest points in the country. How many of these high points does the Canterbury region contain?</strong></p>
<p>Canterbury contains 70 of these high points.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nz"</span>)</span>
<span id="cb60-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nz_height"</span>)</span>
<span id="cb60-3"></span>
<span id="cb60-4">nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb60-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersection</span>(</span>
<span id="cb60-6">    nz <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canterbury"</span>)</span>
<span id="cb60-7">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb60-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 70</code></pre>
</div>
</div>
<p><strong>Bonus: plot the result using the <a href="https://rspatial.github.io/terra/reference/plot.html"><code>plot()</code></a> function to show all of New Zealand, <code>canterbury</code> region highlighted in yellow, high points in Canterbury represented by red crosses (hint: <code>pch = 7</code>) and high points in other parts of New Zealand represented by blue circles. See the help page <a href="https://rspatial.github.io/terra/reference/lines.html"><code>?points</code></a> for details with an illustration of different <code>pch</code> values.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1">nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb62-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb62-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">in_canterbury =</span> nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb62-4">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersects</span>(</span>
<span id="cb62-5">        nz <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canterbury"</span>),</span>
<span id="cb62-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb62-7">      )</span>
<span id="cb62-8">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb62-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb62-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb62-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> nz <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill_var =</span> Name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canterbury"</span>),</span>
<span id="cb62-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> fill_var)</span>
<span id="cb62-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb62-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb62-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> in_canterbury, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> in_canterbury)</span>
<span id="cb62-16">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb62-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_shape_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb62-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb62-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"yellow"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb62-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb62-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Is the region Canterbury?"</span>,</span>
<span id="cb62-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Peaks are in Canterbury?"</span>,</span>
<span id="cb62-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Peaks are in Canterbury?"</span></span>
<span id="cb62-24">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb62-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter4_files/figure-html/unnamed-chunk-26-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-29"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="e2." class="level3">
<h3 class="anchored" data-anchor-id="e2.">E2.</h3>
<p><strong>Which region has the second highest number of <code>nz_height</code> points, and how many does it have?</strong></p>
<p>The region with second highest number of <code>nz_height</code> points is <strong>West Coast</strong>. It has 22 such points.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1">nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb63-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_join</span>(nz) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb63-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb63-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Name) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb63-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 2
# Groups:   Name [7]
  Name                  n
  &lt;chr&gt;             &lt;int&gt;
1 Canterbury           70
2 Manawatu-Wanganui     2
3 Marlborough           1
4 Otago                 2
5 Southland             1
6 Waikato               3
7 West Coast           22</code></pre>
</div>
</div>
<hr>
</section>
<section id="e3." class="level3">
<h3 class="anchored" data-anchor-id="e3.">E3.</h3>
<p><strong>Generalizing the question to all regions: how many of New Zealand’s 16 regions contain points which belong to the top 101 highest points in the country? Which regions?</strong></p>
<ul>
<li><strong>Bonus: create a table listing these regions in order of the number of points and their name.</strong></li>
</ul>
<p>Seven (7) regions of New Zealand contain points which belong to top 101 highest points in the country. The table is shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1">nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb65-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_join</span>(nz) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb65-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb65-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Name) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb65-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of points"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sort =</span> T) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb65-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb65-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">S.No.</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb65-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">relocate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">S.No.</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb65-9">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb65-10">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_538</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb65-11">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(</span>
<span id="cb65-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of highest points in each region of New Zealand"</span></span>
<span id="cb65-13">  )</span></code></pre></div>
<div id="tbl-e3" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-e3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Table listing the regions
</figcaption>
<div aria-describedby="tbl-e3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="ddvrmedbxr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#ddvrmedbxr table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ddvrmedbxr thead, #ddvrmedbxr tbody, #ddvrmedbxr tfoot, #ddvrmedbxr tr, #ddvrmedbxr td, #ddvrmedbxr th {
  border-style: none;
}

#ddvrmedbxr p {
  margin: 0;
  padding: 0;
}

#ddvrmedbxr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ddvrmedbxr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ddvrmedbxr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ddvrmedbxr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ddvrmedbxr .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ddvrmedbxr .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ddvrmedbxr .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ddvrmedbxr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ddvrmedbxr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ddvrmedbxr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ddvrmedbxr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ddvrmedbxr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ddvrmedbxr .gt_spanner_row {
  border-bottom-style: hidden;
}

#ddvrmedbxr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ddvrmedbxr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#ddvrmedbxr .gt_from_md > :first-child {
  margin-top: 0;
}

#ddvrmedbxr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ddvrmedbxr .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ddvrmedbxr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#ddvrmedbxr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ddvrmedbxr .gt_row_group_first td {
  border-top-width: 2px;
}

#ddvrmedbxr .gt_row_group_first th {
  border-top-width: 2px;
}

#ddvrmedbxr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ddvrmedbxr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ddvrmedbxr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ddvrmedbxr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ddvrmedbxr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ddvrmedbxr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ddvrmedbxr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ddvrmedbxr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ddvrmedbxr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ddvrmedbxr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ddvrmedbxr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ddvrmedbxr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ddvrmedbxr .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ddvrmedbxr .gt_left {
  text-align: left;
}

#ddvrmedbxr .gt_center {
  text-align: center;
}

#ddvrmedbxr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ddvrmedbxr .gt_font_normal {
  font-weight: normal;
}

#ddvrmedbxr .gt_font_bold {
  font-weight: bold;
}

#ddvrmedbxr .gt_font_italic {
  font-style: italic;
}

#ddvrmedbxr .gt_super {
  font-size: 65%;
}

#ddvrmedbxr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ddvrmedbxr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ddvrmedbxr .gt_indent_1 {
  text-indent: 5px;
}

#ddvrmedbxr .gt_indent_2 {
  text-indent: 10px;
}

#ddvrmedbxr .gt_indent_3 {
  text-indent: 15px;
}

#ddvrmedbxr .gt_indent_4 {
  text-indent: 20px;
}

#ddvrmedbxr .gt_indent_5 {
  text-indent: 25px;
}

#ddvrmedbxr .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ddvrmedbxr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="3" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="font-family: Chivo; font-weight: 700">Number of highest points in each region of New Zealand</th>
</tr>
<tr class="odd gt_col_headings">
<th id="S.No." class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">S.No.</th>
<th id="Name" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Name</th>
<th id="Number of points" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Number of points</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="S.No.">1</td>
<td class="gt_row gt_left" headers="Name">Canterbury</td>
<td class="gt_row gt_right" headers="Number of points">70</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="S.No.">2</td>
<td class="gt_row gt_left" headers="Name">West Coast</td>
<td class="gt_row gt_right" headers="Number of points">22</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="S.No.">3</td>
<td class="gt_row gt_left" headers="Name">Waikato</td>
<td class="gt_row gt_right" headers="Number of points">3</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="S.No.">4</td>
<td class="gt_row gt_left" headers="Name">Manawatu-Wanganui</td>
<td class="gt_row gt_right" headers="Number of points">2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="S.No.">5</td>
<td class="gt_row gt_left" headers="Name">Otago</td>
<td class="gt_row gt_right" headers="Number of points">2</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="S.No.">6</td>
<td class="gt_row gt_left" headers="Name">Marlborough</td>
<td class="gt_row gt_right" headers="Number of points">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="S.No.">7</td>
<td class="gt_row gt_left" headers="Name">Southland</td>
<td class="gt_row gt_right" headers="Number of points">1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<hr>
<p><strong>Test your knowledge of spatial predicates by finding out and plotting how US states relate to each other and other spatial objects.</strong></p>
</section>
<section id="e4." class="level3">
<h3 class="anchored" data-anchor-id="e4.">E4.</h3>
<p><strong>The starting point of this exercise is to create an object representing Colorado state in the USA. Do this with the command <code>colorado = us_states[us_states$NAME == "Colorado",]</code> (base R) or with the <a href="https://dplyr.tidyverse.org/reference/filter.html"><code>filter()</code></a> function (tidyverse) and plot the resulting object in the context of US states.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"us_states"</span>)</span>
<span id="cb66-2"></span>
<span id="cb66-3">colorado <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb66-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(NAME <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Colorado"</span>)</span>
<span id="cb66-5"></span>
<span id="cb66-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb66-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> colorado) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb66-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Map of Colorado State"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb66-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb66-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:5070"</span></span>
<span id="cb66-11">  )</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-col-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-col-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-col-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-30" title="Figure&nbsp;12: Map of Colorado State"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-col-1-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-col-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: Map of Colorado State
</figcaption>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>Create a new object representing all the states that geographically intersect with Colorado and plot the result (hint: the most concise way to do this is with the subsetting method <code>[</code>)</strong>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb67" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb67-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb67-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> us_states,</span>
<span id="cb67-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb67-5">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb67-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb67-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> colorado,</span>
<span id="cb67-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"yellow"</span></span>
<span id="cb67-9">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb67-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf_text</span>(</span>
<span id="cb67-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> colorado,</span>
<span id="cb67-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb67-13">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> NAME</span>
<span id="cb67-14">    ),</span>
<span id="cb67-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb67-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb67-17">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb67-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb67-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:5070"</span></span>
<span id="cb67-20">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb67-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb67-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb67-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Map of USA states, with Colorado highlighted"</span></span>
<span id="cb67-24">  )</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-col-usa" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-col-usa-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-col-usa-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-31" title="Figure&nbsp;13: Colorado, within USA’s states; with projection changed to Albers Equal Area Projection"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-col-usa-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-col-usa-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13: Colorado, within USA’s states; with projection changed to Albers Equal Area Projection
</figcaption>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>Create another object representing all the objects that touch (have a shared boundary with) Colorado and plot the result (hint: remember you can use the argument <code>op = st_intersects</code> and other spatial relations during spatial subsetting operations in base R).</strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb68" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1">bordering <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb68-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb68-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">border_colorado =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_vector</span>(</span>
<span id="cb68-4">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_vector</span>(</span>
<span id="cb68-5">        us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb68-6">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersects</span>(colorado, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb68-7">      )</span>
<span id="cb68-8">    )</span>
<span id="cb68-9">  )</span>
<span id="cb68-10"></span>
<span id="cb68-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb68-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> bordering,</span>
<span id="cb68-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb68-15">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> border_colorado</span>
<span id="cb68-16">    )</span>
<span id="cb68-17">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(</span>
<span id="cb68-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"orange"</span>)</span>
<span id="cb68-20">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf_text</span>(</span>
<span id="cb68-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(bordering, border_colorado),</span>
<span id="cb68-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb68-24">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> NAME</span>
<span id="cb68-25">    ),</span>
<span id="cb68-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb68-27">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb68-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> colorado,</span>
<span id="cb68-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span></span>
<span id="cb68-31">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf_text</span>(</span>
<span id="cb68-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> colorado,</span>
<span id="cb68-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb68-35">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> NAME</span>
<span id="cb68-36">    ),</span>
<span id="cb68-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb68-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb68-39">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb68-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:5070"</span></span>
<span id="cb68-42">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb68-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb68-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Map of USA states, with states bordering Colorado highlighted in orange"</span></span>
<span id="cb68-46">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb68-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span></span>
<span id="cb68-49">  )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter4_files/figure-html/unnamed-chunk-31-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-32"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>Bonus: create a straight line from the centroid of the District of Columbia near the East coast to the centroid of California near the West coast of the USA (hint: functions <a href="https://r-spatial.github.io/sf/reference/geos_unary.html"><code>st_centroid()</code></a>, <a href="https://r-spatial.github.io/sf/reference/geos_combine.html"><code>st_union()</code></a> and <a href="https://r-spatial.github.io/sf/reference/st_cast.html"><code>st_cast()</code></a> described in Chapter 5 may help) and identify which states this long East-West line crosses</strong>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb69" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1">wdc_centre <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_centroid</span>(</span>
<span id="cb69-2">  us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(NAME <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"District of Columbia"</span>)</span>
<span id="cb69-3">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb69-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(geometry)</span>
<span id="cb69-5"></span>
<span id="cb69-6">cal_centre <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_centroid</span>(</span>
<span id="cb69-7">  us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(NAME <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"California"</span>)</span>
<span id="cb69-8">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb69-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(geometry)</span>
<span id="cb69-10"></span>
<span id="cb69-11">straight_line <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_union</span>(</span>
<span id="cb69-12">  wdc_centre,</span>
<span id="cb69-13">  cal_centre</span>
<span id="cb69-14">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb69-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_cast</span>(</span>
<span id="cb69-16">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LINESTRING"</span></span>
<span id="cb69-17">  )</span>
<span id="cb69-18"></span>
<span id="cb69-19">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb69-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb69-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">on_the_way =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_vector</span>(</span>
<span id="cb69-22">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersects</span>(</span>
<span id="cb69-23">        us_states, </span>
<span id="cb69-24">        straight_line, </span>
<span id="cb69-25">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb69-26">      )</span>
<span id="cb69-27">    )</span>
<span id="cb69-28">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb69-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb69-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb69-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb69-32">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> on_the_way</span>
<span id="cb69-33">    )</span>
<span id="cb69-34">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb69-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(</span>
<span id="cb69-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"orange"</span>)</span>
<span id="cb69-37">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb69-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb69-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> straight_line,</span>
<span id="cb69-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb69-41">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb69-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb69-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cal_centre,</span>
<span id="cb69-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb69-45">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb69-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb69-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> wdc_centre,</span>
<span id="cb69-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb69-49">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb69-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb69-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:5070"</span></span>
<span id="cb69-52">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb69-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb69-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Line from Centroids of District of Columbia and California;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">and highlighting the states that it crosses through"</span></span>
<span id="cb69-55">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb69-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb69-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span></span>
<span id="cb69-58">  )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter4_files/figure-html/unnamed-chunk-32-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-33"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="e5." class="level3">
<h3 class="anchored" data-anchor-id="e5.">E5.</h3>
<p><strong>Use <code>dem = rast(system.file("raster/dem.tif", package = "spDataLarge"))</code>, and reclassify the elevation in three classes: low (&lt;300), medium and high (&gt;500). Secondly, read the NDVI raster (<code>ndvi = rast(system.file("raster/ndvi.tif", package = "spDataLarge"))</code>) and compute the mean NDVI and the mean elevation for each altitudinal class.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1">dem <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/dem.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>))</span>
<span id="cb70-2"></span>
<span id="cb70-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb70-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dem) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb70-5">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grDevices::Terrain 2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb70-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Base raster `dem`"</span>)</span>
<span id="cb70-7"></span>
<span id="cb70-8">dem1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dem</span>
<span id="cb70-9"></span>
<span id="cb70-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(dem1) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(dem) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb70-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb70-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb70-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dem_class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb70-14">      dem <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Low"</span>,</span>
<span id="cb70-15">      dem <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"High"</span>,</span>
<span id="cb70-16">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.default =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Medium"</span></span>
<span id="cb70-17">    )</span>
<span id="cb70-18">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb70-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(dem_class)</span>
<span id="cb70-20"></span>
<span id="cb70-21"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb70-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dem1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb70-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#F1E4E3FF"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#00A600FF"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#EAB550FF"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb70-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The raster `dem` with elevation classified into 3 levels"</span>)</span></code></pre></div>
<div id="fig-e5-1" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-e5-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="fig-e5-1-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e5-1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-e5-1-1.png" class="lightbox" data-gallery="fig-e5-1" title="Figure&nbsp;14&nbsp;(a): Base raster"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-e5-1-1.png" class="img-fluid figure-img" data-ref-parent="fig-e5-1" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e5-1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Base raster
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-e5-1-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e5-1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-e5-1-2.png" class="lightbox" data-gallery="fig-e5-1" title="Figure&nbsp;14&nbsp;(b): Reclassified raster"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-e5-1-2.png" class="img-fluid figure-img" data-ref-parent="fig-e5-1" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e5-1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Reclassified raster
</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-e5-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14: Classifying elevation into high, middle and low
</figcaption>
</figure>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1">ndvi <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/ndvi.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>))</span>
<span id="cb71-2"></span>
<span id="cb71-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb71-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">elevation_class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(dem1),</span>
<span id="cb71-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">elevation =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(dem),</span>
<span id="cb71-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ndvi =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(ndvi)</span>
<span id="cb71-7">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb71-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(elevation_class) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb71-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb71-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_elevation =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(elevation),</span>
<span id="cb71-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_ndvi =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(ndvi)</span>
<span id="cb71-12">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb71-13">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb71-14">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>(</span>
<span id="cb71-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(mean_elevation, mean_ndvi)</span>
<span id="cb71-16">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb71-17">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label_with</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> snakecase<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>to_title_case) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb71-18">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(</span>
<span id="cb71-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mean elevation and NDVI for each altitude class"</span></span>
<span id="cb71-20">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb71-21">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_538</span>()</span></code></pre></div>
<div id="tbl-e5-2" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-e5-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Mean elevation and NDVI for each altitude class
</figcaption>
<div aria-describedby="tbl-e5-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="cxwquzrffb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#cxwquzrffb table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#cxwquzrffb thead, #cxwquzrffb tbody, #cxwquzrffb tfoot, #cxwquzrffb tr, #cxwquzrffb td, #cxwquzrffb th {
  border-style: none;
}

#cxwquzrffb p {
  margin: 0;
  padding: 0;
}

#cxwquzrffb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#cxwquzrffb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#cxwquzrffb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#cxwquzrffb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#cxwquzrffb .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cxwquzrffb .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cxwquzrffb .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cxwquzrffb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#cxwquzrffb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#cxwquzrffb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#cxwquzrffb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#cxwquzrffb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#cxwquzrffb .gt_spanner_row {
  border-bottom-style: hidden;
}

#cxwquzrffb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#cxwquzrffb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#cxwquzrffb .gt_from_md > :first-child {
  margin-top: 0;
}

#cxwquzrffb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#cxwquzrffb .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#cxwquzrffb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#cxwquzrffb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#cxwquzrffb .gt_row_group_first td {
  border-top-width: 2px;
}

#cxwquzrffb .gt_row_group_first th {
  border-top-width: 2px;
}

#cxwquzrffb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cxwquzrffb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#cxwquzrffb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#cxwquzrffb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cxwquzrffb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cxwquzrffb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#cxwquzrffb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#cxwquzrffb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#cxwquzrffb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cxwquzrffb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cxwquzrffb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cxwquzrffb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cxwquzrffb .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cxwquzrffb .gt_left {
  text-align: left;
}

#cxwquzrffb .gt_center {
  text-align: center;
}

#cxwquzrffb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#cxwquzrffb .gt_font_normal {
  font-weight: normal;
}

#cxwquzrffb .gt_font_bold {
  font-weight: bold;
}

#cxwquzrffb .gt_font_italic {
  font-style: italic;
}

#cxwquzrffb .gt_super {
  font-size: 65%;
}

#cxwquzrffb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#cxwquzrffb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#cxwquzrffb .gt_indent_1 {
  text-indent: 5px;
}

#cxwquzrffb .gt_indent_2 {
  text-indent: 10px;
}

#cxwquzrffb .gt_indent_3 {
  text-indent: 15px;
}

#cxwquzrffb .gt_indent_4 {
  text-indent: 20px;
}

#cxwquzrffb .gt_indent_5 {
  text-indent: 25px;
}

#cxwquzrffb .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#cxwquzrffb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="3" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="font-family: Chivo; font-weight: 700">Mean elevation and NDVI for each altitude class</th>
</tr>
<tr class="odd gt_col_headings">
<th id="Elevation Class" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Elevation Class</th>
<th id="Mean Elevation" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Mean Elevation</th>
<th id="Mean Ndvi" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Mean Ndvi</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="elevation_class">1</td>
<td class="gt_row gt_right" headers="mean_elevation">765.22</td>
<td class="gt_row gt_right" headers="mean_ndvi">−0.21</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="elevation_class">2</td>
<td class="gt_row gt_right" headers="mean_elevation">273.79</td>
<td class="gt_row gt_right" headers="mean_ndvi">−0.36</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="elevation_class">3</td>
<td class="gt_row gt_right" headers="mean_elevation">391.61</td>
<td class="gt_row gt_right" headers="mean_ndvi">−0.29</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<hr>
</section>
<section id="e6." class="level3">
<h3 class="anchored" data-anchor-id="e6.">E6.</h3>
<p><strong>Apply a line detection filter to <code>rast(system.file("ex/logo.tif", package = "terra"))</code>. Plot the result. Hint: Read <code>?terra::focal()</code>.</strong></p>
<p>The code below demonstrates edge detection on a raster image using Sobel filters with the <strong>{terra}</strong> package in R. The Sobel filters, represented as matrices <code>fx</code> and <code>fy</code>, are defined for detecting edges in horizontal and vertical directions, respectively. The <code>focal()</code> function applies these filters to the raster image, performing convolution to emphasize areas of rapid intensity change (edges). The processed images are then plotted, one showing <strong>horizontal edges (filtered with <code>fx</code>)</strong> in black and white, and the other showing <strong>vertical edges (filtered with <code>fy</code>)</strong> in white and black. This illustrates how Sobel filters can be used for edge detection in spatial raster data.</p>
<div class="sourceCode cell-code" id="cb72" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1">logo <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ex/logo.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"terra"</span>))</span>
<span id="cb72-2"></span>
<span id="cb72-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(logo)</span>
<span id="cb72-4"></span>
<span id="cb72-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sobel filters (for edge detection):</span></span>
<span id="cb72-6">fx <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb72-7">fy <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb72-8"></span>
<span id="cb72-9">logo <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb72-10">  terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">focal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">w =</span> fx) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb72-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>))</span>
<span id="cb72-12"></span>
<span id="cb72-13">logo <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb72-14">  terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">focal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">w =</span> fy) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb72-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>))</span></code></pre></div>
<div id="fig-e6" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-e6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-e6" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-e6-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e6-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-e6-1.png" class="lightbox" data-gallery="fig-e6" title="Figure&nbsp;15&nbsp;(a): Base raster Logo"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-e6-1.png" class="img-fluid figure-img" data-ref-parent="fig-e6" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e6-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Base raster Logo
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-e6" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-e6-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e6-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-e6-2.png" class="lightbox" data-gallery="fig-e6" title="Figure&nbsp;15&nbsp;(b): Horizontal edges detected with fx"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-e6-2.png" class="img-fluid figure-img" data-ref-parent="fig-e6" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e6-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Horizontal edges detected with fx
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-e6" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-e6-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e6-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-e6-3.png" class="lightbox" data-gallery="fig-e6" title="Figure&nbsp;15&nbsp;(c): Vertical edges detected with fy"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-e6-3.png" class="img-fluid figure-img" data-ref-parent="fig-e6" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e6-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Vertical edges detected with fy
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-e6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15: Edge detection with terra::focal()
</figcaption>
</figure>
</div>
<hr>
</section>
<section id="e7." class="level3">
<h3 class="anchored" data-anchor-id="e7.">E7.</h3>
<p><strong>Calculate the Normalized Difference Water Index (NDWI; <code>(green - nir)/(green + nir)</code>) of a Landsat image. Use the Landsat image provided by the spDataLarge package (<code>system.file("raster/landsat.tif", package = "spDataLarge")</code>). Also, calculate a correlation between NDVI and NDWI for this area (hint: you can use the <a href="https://rspatial.github.io/terra/reference/layerCor.html"><code>layerCor()</code></a> function).</strong></p>
<p>This code processes and visualizes raster data for Zion National Park, performing computations to derive vegetation and water indices and then plotting the results. The raster, containing layers for Red, Green, Blue, and Near Infrared (NIR) bands, is rescaled to real-world values, with negative values replaced by zeros.</p>
<p>Using custom functions, the NDVI (Normalized Difference Vegetation Index) and NDWI (Normalized Difference Water Index) are calculated from the NIR, Red, and Green bands. The resulting indices are converted into a tidy SpatRaster format for plotting.</p>
<p>The code below also calculates the correlation between the NDVI and NDWI layers as <strong>-0.96, thus telling us the NDVI and NDWI are negatively correlated (inversely correlated)</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#################### LONG, BASE R METHOD ########################</span></span>
<span id="cb73-2"></span>
<span id="cb73-3"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#################### I Don't Use This ###########################</span></span>
<span id="cb73-4"></span>
<span id="cb73-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Download the Zion National Park Raster File with layers of </span></span>
<span id="cb73-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Red, Green, Blue and NIR (Near Infra Red)</span></span>
<span id="cb73-7">landsat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(</span>
<span id="cb73-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/landsat.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>)</span>
<span id="cb73-9">)</span>
<span id="cb73-10"></span>
<span id="cb73-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Applying a scale factor to return values to actual ones.</span></span>
<span id="cb73-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The data-set was scaled to save disk space</span></span>
<span id="cb73-13">landsat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> (landsat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0000275</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span></span>
<span id="cb73-14"></span>
<span id="cb73-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove and replace negative values, since these were due to clouds</span></span>
<span id="cb73-16">landsat[landsat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb73-17"></span>
<span id="cb73-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Write a custom function for computing values of </span></span>
<span id="cb73-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># NDVI (normalized difference vegetation index) in R</span></span>
<span id="cb73-20">ndvi_fun <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(nir, red){</span>
<span id="cb73-21">  (nir <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> red) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (nir <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> red)</span>
<span id="cb73-22">}</span>
<span id="cb73-23"></span>
<span id="cb73-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a new raster with NDVI values using terra::lapp()</span></span>
<span id="cb73-25">landsat_ndvi <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapp</span>(landsat[[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> ndvi_fun)</span>
<span id="cb73-26"></span>
<span id="cb73-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Write a custom function for computing values of </span></span>
<span id="cb73-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># NDWI (normalized difference water index) in R</span></span>
<span id="cb73-29">ndwi_fun <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(nir, green){</span>
<span id="cb73-30">  (green <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> nir) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (nir <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> green)</span>
<span id="cb73-31">}</span>
<span id="cb73-32"></span>
<span id="cb73-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a new raster with NDVI values using terra::lapp()</span></span>
<span id="cb73-34">landsat_ndwi <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapp</span>(landsat[[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> ndwi_fun)</span>
<span id="cb73-35"></span>
<span id="cb73-36"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cor</span>(</span>
<span id="cb73-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(landsat_ndvi),</span>
<span id="cb73-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(landsat_ndwi),</span>
<span id="cb73-39">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"complete.obs"</span></span>
<span id="cb73-40">)</span>
<span id="cb73-41"></span>
<span id="cb73-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The correlation is -0.96. NDVI and NDWI are negatively correlated.</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">###################### THE TIDY APPROACH #######################</span></span>
<span id="cb74-2"></span>
<span id="cb74-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Download the Zion National Park Raster File with layers of </span></span>
<span id="cb74-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Red, Green, Blue and NIR (Near Infra Red)</span></span>
<span id="cb74-5">landsat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/landsat.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb74-6">  </span>
<span id="cb74-7">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Applying a scale factor to return values to actual ones,</span></span>
<span id="cb74-8">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The data-set was scaled to save disk space.</span></span>
<span id="cb74-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">multiply_by</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0000275</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb74-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">subtract</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb74-11">  </span>
<span id="cb74-12">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove and replace negative values, since these were due to clouds</span></span>
<span id="cb74-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">everything</span>(), <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(. <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, .)))</span>
<span id="cb74-14"></span>
<span id="cb74-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Write a custom function for computing values of </span></span>
<span id="cb74-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># NDVI (normalized difference vegetation index) in R</span></span>
<span id="cb74-17">ndvi_fun <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(nir, red) {</span>
<span id="cb74-18">  (nir <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> red) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (nir <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> red)</span>
<span id="cb74-19">}</span>
<span id="cb74-20"></span>
<span id="cb74-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Write a custom function for computing values of </span></span>
<span id="cb74-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># NDWI (normalized difference water index) in R</span></span>
<span id="cb74-23">ndwi_fun <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(nir, green) {</span>
<span id="cb74-24">  (green <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> nir) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (green <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> nir)</span>
<span id="cb74-25">}</span>
<span id="cb74-26"></span>
<span id="cb74-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Doing the tidy data wrangling magic with tidyverse and tidyterra</span></span>
<span id="cb74-28">landsat1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> landsat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb74-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xy =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb74-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb74-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ndvi =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ndvi_fun</span>(landsat_4, landsat_3),</span>
<span id="cb74-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ndwi =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ndwi_fun</span>(landsat_4, landsat_2)</span>
<span id="cb74-33">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb74-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"landsat"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb74-35">  tidyterra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_spatraster</span>(</span>
<span id="cb74-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(landsat)</span>
<span id="cb74-37">  )</span>
<span id="cb74-38"></span>
<span id="cb74-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Labeller for the facets</span></span>
<span id="cb74-40">lyr_labels <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb74-41">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"normalized difference vegetation index"</span>,</span>
<span id="cb74-42">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"normalized difference water index"</span></span>
<span id="cb74-43">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb74-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_to_title</span>()</span>
<span id="cb74-45"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(lyr_labels) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ndvi"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ndwi"</span>)</span>
<span id="cb74-46"></span>
<span id="cb74-47"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">layerCor</span>(landsat1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> cor, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"complete.obs"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb74-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]  [,2]
[1,]  1.00 -0.96
[2,] -0.96  1.00</code></pre>
</div>
</div>
<p>The <code>ggplot2</code> visualization in Figure&nbsp;16 uses facets to compare NDVI and NDWI values across the area, with clear labelling and a perceptually uniform colour scale.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The actual final plot</span></span>
<span id="cb76-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb76-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> landsat1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb76-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_grass_c</span>(</span>
<span id="cb76-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb76-6">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb76-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>lyr, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labeller =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labeller</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lyr =</span> lyr_labels)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb76-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb76-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb76-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Comparing NDVI and NDWI values"</span>,</span>
<span id="cb76-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Zion National Park area SpatRaster"</span>,</span>
<span id="cb76-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Value"</span></span>
<span id="cb76-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb76-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb76-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb76-16">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb76-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb76-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb76-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb76-20">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb76-21">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb76-22">    )</span>
<span id="cb76-23">  )</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-e7" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-e7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-e7-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-39" title="Figure&nbsp;16: Comparing NDVI and NDWI values"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-e7-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-e7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16: Comparing NDVI and NDWI values
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="e8." class="level3">
<h3 class="anchored" data-anchor-id="e8.">E8.</h3>
<p><strong>A StackOverflow <a href="https://stackoverflow.com/questions/35555709/global-raster-of-geographic-distances">post (stackoverflow.com/questions/35555709)</a> shows how to compute distances to the nearest coastline using <a href="https://rspatial.github.io/terra/reference/distance.html"><code>raster::distance()</code></a>. Try to do something similar but with <a href="https://rspatial.github.io/terra/reference/distance.html"><code>terra::distance()</code></a>: retrieve a digital elevation model of Spain, and compute a raster which represents distances to the coast across the country (hint: use <a href="https://rdrr.io/pkg/geodata/man/elevation.html"><code>geodata::elevation_30s()</code></a>). Convert the resulting distances from meters to kilometers. Note: it may be wise to increase the cell size of the input raster to reduce compute time during this operation (<a href="https://rspatial.github.io/terra/reference/aggregate.html"><code>aggregate()</code></a>).</strong></p>
<p>This code demonstrates the steps to compute and visualize the distance to the nearest coastline for Spain. First, it loads elevation data for Spain and nearby areas ( Figure&nbsp;17 (a) ), as well as for Spain’s political boundaries ( Figure&nbsp;17 (b) ), ensuring the inclusion of surrounding countries and water bodies. The raster is then aggregated for efficiency.</p>
<p>Initial visualizations are created: one showing elevation for Spain and neighbouring areas, and another isolating only Spain.</p>
<p>A binary raster is created where water is marked as <code>TRUE</code> (1) and land as <code>NA</code>. The <code>distance()</code> function calculates the distance of each land cell to the nearest water cell, with values converted to kilometres. ( Figure&nbsp;17 (c) )</p>
<p>Finally, the raw distance raster is masked to display only distances within Spain, producing a final visualization of Spain with distances to its nearest coastline ( Figure&nbsp;17 (d) ). The Figure&nbsp;17 includes multiple stages of the process, from raw data to the final processed map.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Full Spain and nearby Land Data</span></span>
<span id="cb77-2">spain_land <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> geodata<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">elevation_30s</span>(</span>
<span id="cb77-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Spain"</span>, </span>
<span id="cb77-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tempdir</span>(),</span>
<span id="cb77-5">  </span>
<span id="cb77-6">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use mask = FALSE to ensure that other countries are not shown as NA</span></span>
<span id="cb77-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mask =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb77-8"></span>
<span id="cb77-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data for only Sapin Political Boundaries Land</span></span>
<span id="cb77-10">spain_only <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> geodata<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">elevation_30s</span>(</span>
<span id="cb77-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Spain"</span>, </span>
<span id="cb77-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tempdir</span>()</span>
<span id="cb77-13">  )</span>
<span id="cb77-14"></span>
<span id="cb77-15">spain_working_land <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> spain_land <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb77-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aggregate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fact =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb77-17"></span>
<span id="cb77-18">spain_working_only <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> spain_only <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb77-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aggregate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fact =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb77-20"></span>
<span id="cb77-21"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb77-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> spain_working_land) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb77-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_terrain_c</span>(</span>
<span id="cb77-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb77-25">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb77-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb77-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Land map of Spain and nearby areas"</span>,</span>
<span id="cb77-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Water / Sea is shown as transparent values (NA)"</span>,</span>
<span id="cb77-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Elevation (m)"</span></span>
<span id="cb77-30">  ) </span>
<span id="cb77-31"></span>
<span id="cb77-32"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb77-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> spain_working_only) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb77-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_terrain_c</span>(</span>
<span id="cb77-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb77-36">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb77-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb77-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Land map of only Spain"</span>,</span>
<span id="cb77-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Water + nearby countries are shown as transparent values (NA)"</span>,</span>
<span id="cb77-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill  =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Elevation (m)"</span></span>
<span id="cb77-41">  ) </span>
<span id="cb77-42"></span>
<span id="cb77-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Start with a simple raster where only water is TRUE (1) </span></span>
<span id="cb77-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># and land is FALSE (0)</span></span>
<span id="cb77-45">temp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(spain_working_land)</span>
<span id="cb77-46"></span>
<span id="cb77-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert land (i.e. FALSE) into NA</span></span>
<span id="cb77-48">temp[temp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb77-49"></span>
<span id="cb77-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute distance of from nearest non-NA (i.e. Water / Sea)</span></span>
<span id="cb77-51">temp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">distance</span>(temp)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
|---------|---------|---------|---------|
=========================================
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb79" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Divide by 1000 to convert into KM</span></span>
<span id="cb79-2">temp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> temp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb79-3"></span>
<span id="cb79-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb79-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> temp) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb79-6">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb79-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grDevices::heat.colors"</span>,</span>
<span id="cb79-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb79-9">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb79-10">  </span>
<span id="cb79-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb79-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance from</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">water (km)"</span>,</span>
<span id="cb79-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Raw Spatraster of distance from Sea / Ocean"</span></span>
<span id="cb79-14">  )</span>
<span id="cb79-15"></span>
<span id="cb79-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert this raw distance vector to mask and only show Spain</span></span>
<span id="cb79-17">temp_spain <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> temp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb79-18">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Mask it with only the map of Spain Raster</span></span>
<span id="cb79-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mask</span>(spain_working_only) </span>
<span id="cb79-20"></span>
<span id="cb79-21"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb79-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> temp_spain) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb79-23">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb79-24">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grDevices::heat.colors"</span>,</span>
<span id="cb79-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb79-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb79-27">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb79-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb79-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(km)"</span>,</span>
<span id="cb79-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Spain: distances to nearest Coastline"</span></span>
<span id="cb79-31">  )</span></code></pre></div>
<div id="fig-e8" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-e8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="fig-e8-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e8-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-e8-1.png" class="lightbox" data-gallery="fig-e8" title="Figure&nbsp;17&nbsp;(a): Land map of Spain and nearby areas"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-e8-1.png" class="img-fluid figure-img" data-ref-parent="fig-e8" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e8-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Land map of Spain and nearby areas
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-e8-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e8-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-e8-2.png" class="lightbox" data-gallery="fig-e8" title="Figure&nbsp;17&nbsp;(b): Land map of only Spain"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-e8-2.png" class="img-fluid figure-img" data-ref-parent="fig-e8" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e8-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Land map of only Spain
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-e8-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e8-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-e8-3.png" class="lightbox" data-gallery="fig-e8" title="Figure&nbsp;17&nbsp;(c): Raw Spatraster of distance from coastline for entire landmass"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-e8-3.png" class="img-fluid figure-img" data-ref-parent="fig-e8" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e8-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Raw Spatraster of distance from coastline for entire landmass
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-e8-4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e8-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-e8-4.png" class="lightbox" data-gallery="fig-e8" title="Figure&nbsp;17&nbsp;(d): Final product: Spain with distances to nearest Coastline"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-e8-4.png" class="img-fluid figure-img" data-ref-parent="fig-e8" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e8-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d) Final product: Spain with distances to nearest Coastline
</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-e8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17: Steps in Computing the distance to nearest Coastline for Spain
</figcaption>
</figure>
</div>
</div>
<hr>
</section>
<section id="e9." class="level3">
<h3 class="anchored" data-anchor-id="e9.">E9.</h3>
<p><strong>Try to modify the approach used in the above exercise by weighting the distance raster with the elevation raster; every 100 altitudinal meters should increase the distance to the coast by 10 km. Next, compute and visualize the difference between the raster created using the Euclidean distance (E7) and the raster weighted by elevation.</strong></p>
<p>The code below performs a spatial analysis and visualization of the relationship between elevation and distance to the coastline for Spain. It begins by visualizing Spain’s elevation using a raster dataset (<code>spain_working_only</code>). It then calculates and visualizes the Euclidean distance from each point to the nearest coastline (<code>temp_spain</code>), as already done in Exercise <strong>E7</strong>.</p>
<p>A new raster (<code>spain_weighted</code>) is computed by weighting the Euclidean distance with elevation, where every 100 meters of elevation increases the effective distance to the coastline by 10 km.</p>
<p>The difference between the Euclidean distance raster and the elevation-weighted distance raster is then calculated and visualized (<code>spain_difference</code>).</p>
<p>The code uses the <code>ggplot2</code> package to display these rasters as separate maps, with clear titles and color scales to interpret the elevation, distances, and differences.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb80-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> spain_working_only) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb80-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb80-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb80-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Altitude (m)"</span>,</span>
<span id="cb80-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1. Elevation map of Spain"</span></span>
<span id="cb80-7">  )</span>
<span id="cb80-8"></span>
<span id="cb80-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb80-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> temp_spain) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb80-11">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb80-12">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grDevices::heat.colors"</span>,</span>
<span id="cb80-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb80-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb80-15">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb80-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb80-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(km)"</span>,</span>
<span id="cb80-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2. Spain: euclidean distances to nearest Coastline"</span></span>
<span id="cb80-19">  )</span>
<span id="cb80-20"></span>
<span id="cb80-21">spain_weighted <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> temp_spain <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> ((spain_working_only<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb80-22"></span>
<span id="cb80-23"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb80-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> spain_weighted) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb80-25">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb80-26">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grDevices::heat.colors"</span>,</span>
<span id="cb80-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb80-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb80-29">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb80-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb80-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(km)"</span>,</span>
<span id="cb80-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"3. Spain: distance to coastline weighted by elevation"</span></span>
<span id="cb80-33">  )</span>
<span id="cb80-34"></span>
<span id="cb80-35">spain_difference <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> spain_weighted <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> temp_spain</span>
<span id="cb80-36"></span>
<span id="cb80-37"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb80-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> spain_difference) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb80-39">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb80-40">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grDevices::heat.colors"</span>,</span>
<span id="cb80-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb80-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb80-43">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb80-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb80-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Difference</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">in Distance</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(km)"</span>,</span>
<span id="cb80-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"4. Difference between 2nd and 3rd maps"</span></span>
<span id="cb80-47">  )</span></code></pre></div>
<div id="fig-e9" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-e9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="fig-e9-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e9-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-e9-1.png" class="lightbox" data-gallery="fig-e9" title="Figure&nbsp;18&nbsp;(a): Elevation map of Spain"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-e9-1.png" class="img-fluid figure-img" data-ref-parent="fig-e9" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e9-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Elevation map of Spain
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-e9-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e9-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-e9-2.png" class="lightbox" data-gallery="fig-e9" title="Figure&nbsp;18&nbsp;(b): Spain: euclidean distances to nearest Coastline"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-e9-2.png" class="img-fluid figure-img" data-ref-parent="fig-e9" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e9-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Spain: euclidean distances to nearest Coastline
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-e9-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e9-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-e9-3.png" class="lightbox" data-gallery="fig-e9" title="Figure&nbsp;18&nbsp;(c): Spain: distance to coastline weighted by elevation"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-e9-3.png" class="img-fluid figure-img" data-ref-parent="fig-e9" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e9-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Spain: distance to coastline weighted by elevation
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-e9-4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e9-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-e9-4.png" class="lightbox" data-gallery="fig-e9" title="Figure&nbsp;18&nbsp;(d): Difference between 2nd and 3rd maps"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-e9-4.png" class="img-fluid figure-img" data-ref-parent="fig-e9" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e9-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d) Difference between 2nd and 3rd maps
</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-e9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18: Algebra on Rasters
</figcaption>
</figure>
</div>
</div>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-fuzzyjoin" class="csl-entry">
Robinson, David. 2020. <span>“Fuzzyjoin: Join Tables Together on Inexact Matching.”</span> <a href="https://CRAN.R-project.org/package=fuzzyjoin">https://CRAN.R-project.org/package=fuzzyjoin</a>.
</div>
</div></section></div> ]]></description>
  <category>Geocomputation with R</category>
  <category>Textbook Solutions</category>
  <guid>https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4.html</guid>
  <pubDate>Fri, 15 Nov 2024 18:30:00 GMT</pubDate>
</item>
<item>
  <title>Chapter 3: Attribute data operations</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter3.html</link>
  <description><![CDATA[ 




<section id="prerequisites" class="level3">
<h3 class="anchored" data-anchor-id="prerequisites">Prerequisites</h3>
<ul>
<li><code>sf</code> for vector data manipulation (<a href="https://r-spatial.github.io/sf/">link</a>)</li>
<li><code>terra</code> for raster data manipulation (<a href="https://rspatial.org/terra/">link</a>)</li>
<li><code>dplyr</code> for data frame operations (<a href="https://dplyr.tidyverse.org/">link</a>)</li>
<li><code>spData</code> for example datasets (<a href="https://cran.r-project.org/web/packages/spData/index.html">link</a>)</li>
</ul>
</section>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">3.1 Introduction</h2>
<ul>
<li><strong>Attribute Data</strong>: Non-spatial info tied to geographic data (e.g., bus stop name or elevation).
<ul>
<li><strong>Vector Example</strong>: A bus stop’s location as POINT (-0.098 51.495) with attributes like its name.</li>
<li><strong>Raster Example</strong>: Pixel values represent attributes (e.g., elevation); location defined by matrix indices and resolution.</li>
</ul></li>
<li><strong>Chapter Focus</strong>:
<ul>
<li>Manipulating geographic objects using attributes (e.g., names, elevations).</li>
<li>Techniques: subsetting, aggregation, joining data, creating new variables.</li>
<li>Vector and raster data operations are similar and interchangeable (e.g., subsetting, spatial joins).</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sf)        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handling Simple Features in R</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(terra)     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handling Rasters in R</span></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data Wrangling</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(spData)    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Spatial Data-sets</span></span></code></pre></div>
</details>
</div>
</section>
<section id="vector-attribute-manipulation" class="level2">
<h2 class="anchored" data-anchor-id="vector-attribute-manipulation">3.2 Vector Attribute Manipulation</h2>
<ul>
<li><p><strong><code>sf</code> Package</strong>:</p>
<ul>
<li>Extends base R’s <code>data.frame</code> with a geometry column (<code>sfc</code> class) for spatial features (points, lines, polygons).</li>
<li>Geometry column often named <code>geometry</code> or <code>geom</code>, but <strong>customizable</strong>.</li>
</ul></li>
<li><p><strong>Manipulation Methods</strong>:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">methods</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">class =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb2-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">methods =</span> x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">methods =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace_all</span>(methods, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">",sf"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  "</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">methods =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace_all</span>(methods, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".sf"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  "</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-6">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-7">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(</span>
<span id="cb2-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methods available"</span></span>
<span id="cb2-9">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-10">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>()</span></code></pre></div>
</details>
<div id="tbl-methods-sf" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-methods-sf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Methods available for the class ‘sf’ in R using {sf} package
</figcaption>
<div aria-describedby="tbl-methods-sf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="ykhsfgbdti" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ykhsfgbdti table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ykhsfgbdti thead, #ykhsfgbdti tbody, #ykhsfgbdti tfoot, #ykhsfgbdti tr, #ykhsfgbdti td, #ykhsfgbdti th {
  border-style: none;
}

#ykhsfgbdti p {
  margin: 0;
  padding: 0;
}

#ykhsfgbdti .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ykhsfgbdti .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ykhsfgbdti .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ykhsfgbdti .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ykhsfgbdti .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ykhsfgbdti .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ykhsfgbdti .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ykhsfgbdti .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ykhsfgbdti .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ykhsfgbdti .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ykhsfgbdti .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ykhsfgbdti .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ykhsfgbdti .gt_spanner_row {
  border-bottom-style: hidden;
}

#ykhsfgbdti .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ykhsfgbdti .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ykhsfgbdti .gt_from_md > :first-child {
  margin-top: 0;
}

#ykhsfgbdti .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ykhsfgbdti .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ykhsfgbdti .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ykhsfgbdti .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ykhsfgbdti .gt_row_group_first td {
  border-top-width: 2px;
}

#ykhsfgbdti .gt_row_group_first th {
  border-top-width: 2px;
}

#ykhsfgbdti .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ykhsfgbdti .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ykhsfgbdti .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ykhsfgbdti .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ykhsfgbdti .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ykhsfgbdti .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ykhsfgbdti .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ykhsfgbdti .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ykhsfgbdti .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ykhsfgbdti .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ykhsfgbdti .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ykhsfgbdti .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ykhsfgbdti .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ykhsfgbdti .gt_left {
  text-align: left;
}

#ykhsfgbdti .gt_center {
  text-align: center;
}

#ykhsfgbdti .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ykhsfgbdti .gt_font_normal {
  font-weight: normal;
}

#ykhsfgbdti .gt_font_bold {
  font-weight: bold;
}

#ykhsfgbdti .gt_font_italic {
  font-style: italic;
}

#ykhsfgbdti .gt_super {
  font-size: 65%;
}

#ykhsfgbdti .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ykhsfgbdti .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ykhsfgbdti .gt_indent_1 {
  text-indent: 5px;
}

#ykhsfgbdti .gt_indent_2 {
  text-indent: 10px;
}

#ykhsfgbdti .gt_indent_3 {
  text-indent: 15px;
}

#ykhsfgbdti .gt_indent_4 {
  text-indent: 20px;
}

#ykhsfgbdti .gt_indent_5 {
  text-indent: 25px;
}

#ykhsfgbdti .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ykhsfgbdti div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div style="font-family:system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;border-top-style:solid;border-top-width:2px;border-top-color:#D3D3D3;">
<div class="gt_heading gt_title gt_font_normal" style="text-size:bigger;">Methods available</div>
<div class="gt_heading gt_subtitle "></div>
</div>
<div id="ykhsfgbdti" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="ykhsfgbdti">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"methods":["$<-  ","[  ","[[<-  ","[<-  ","aggregate  ","anti_join  ","arrange  ","as.data.frame  ","cbind  ","coerce,oldClass,S3-method","coerce  ,Spatial-method","coerce  ,SpatRaster-method","coerce  ,SpatVector-method","coerce,Spatial  -method","crs  -method","dbDataType,DBIObject  -method","dbDataType,PostgreSQLConnection  -method","dbWriteTable,DBIObject,character  -method","dbWriteTable,PostgreSQLConnection,character  -method","distance,SpatRaster  -method","distinct  ","dplyr_reconstruct  ","drop_na  ","duplicated  ","ext  -method","extract,SpatRaster  -method","filter  ","full_join  ","gather  ","group_by  ","group_split  ","identify  ","initialize,oldClass-method","inner_join  ","left_join  ","lines  -method","mask,SpatRaster  -method","merge  ","mutate  ","nest  ","pivot_longer  ","pivot_wider  ","plot  ","points  -method","points  ","polys  -method","print  ","rasterize  ,SpatRaster-method","rbind  ","rename  ","rename_with  ","right_join  ","rowwise  ","sample_frac  ","sample_n  ","select  ","semi_join  ","separate  ","separate_rows  ","show,oldClass-method","slice  ","slotsFromS3,oldClass-method","spread  ","st_agr  ","st_agr<-  ","st_area  ","st_as_s2  ","st_as    ","st_as  c  ","st_bbox  ","st_boundary  ","st_break_antimeridian  ","st_buffer  ","st_cast  ","st_centroid  ","st_collection_extract  ","st_concave_hull  ","st_convex_hull  ","st_coordinates  ","st_crop  ","st_crs  ","st_crs<-  ","st_difference  ","st_drop_geometry  ","st_exterior_ring  ","st_filter  ","st_geometry  ","st_geometry<-  ","st_inscribed_circle  ","st_interpolate_aw  ","st_intersection  ","st_intersects  ","st_is  ","st_is_valid  ","st_join  ","st_line_merge  ","st_m_range  ","st_make_valid  ","st_minimum_rotated_rectangle  ","st_nearest_points  ","st_node  ","st_normalize  ","st_point_on_surface  ","st_polygonize  ","st_precision  ","st_reverse  ","st_sample  ","st_segmentize  ","st_set_precision  ","st_shift_longitude  ","st_simplify  ","st_snap  ","st_sym_difference  ","st_tra  orm  ","st_triangulate  ","st_triangulate_constrained  ","st_union  ","st_voronoi  ","st_wrap_dateline  ","st_write  ","st_z_range  ","st_zm  ","summarise  ","svc  -method","text  ","tra  orm  ","transmute  ","ungroup  ","unite  ","unnest  ","vect  -method"]},"columns":[{"id":"methods","name":"methods","type":"character","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left","headerStyle":{"font-weight":"normal"}}],"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"rgba(128,128,128,0.05)","style":{"fontFamily":"system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"}},"elementId":"ykhsfgbdti","dataKey":"cca70f43f6631eb080efbbc9d14d448b"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>
<ul>
<li><p>Methods like <code>aggregate()</code>, <code>cbind()</code>, <code>merge()</code>, and <code>rbind()</code> work seamlessly with <code>sf</code> objects.</p></li>
<li><p>Compatible with tidyverse functions (<code>dplyr</code>, <code>tidyr</code>) and can be used with <code>data.table</code> (partial compatibility noted in issue <a href="https://github.com/Rdatatable/data.table/issues/2273">#2273</a>).</p></li>
<li><p>Dropping geometry (<code>st_drop_geometry()</code>) can speed up attribute data operations when spatial data is not required.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Original 'world' dataset</span></span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(world)</span>
<span id="cb3-3"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] 177  11</span></span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>(world)</span>
<span id="cb3-5"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] "sf"         "tbl_df"     "tbl"        "data.frame"</span></span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Dropping the geometry column: Effects</span></span>
<span id="cb3-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>(world) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>()</span>
<span id="cb3-10"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] 177  10</span></span>
<span id="cb3-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>(world) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>()</span>
<span id="cb3-13"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] "tbl_df"     "tbl"        "data.frame"</span></span></code></pre></div>
</div></li>
<li><p><strong>Advantages</strong>:</p>
<ul>
<li><code>sf</code>’s integration with the tidyverse allows robust, efficient data manipulation.</li>
<li>Compatible with tidyverse functions (e.g., <code>dplyr</code>), making it versatile for data analysis.</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-keylearning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Relevant Topic
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Major Pitfalls of Using Spatial Data with the Tidyverse</strong></p>
<ol type="1">
<li><strong>Name Clashes</strong>
<ul>
<li>Functions like <code>select()</code> from <a href="https://dplyr.tidyverse.org/reference/select.html"><code>dplyr</code></a> can mask similar functions from the <a href="https://rspatial.github.io/raster/reference/select.html"><code>raster</code></a> package.</li>
<li>Use fully qualified names (e.g., <a href="https://dplyr.tidyverse.org/reference/select.html"><code>dplyr::select()</code></a>) to avoid conflicts.</li>
</ul></li>
<li><strong>Compatibility Issues with <code>sp</code> Package</strong>
<ul>
<li>The older <a href="https://cran.r-project.org/web/packages/sp/index.html"><code>sp</code></a> package does not integrate well with tidyverse functions.</li>
<li>Requires conversion between <code>sp</code> to <a href="https://r-spatial.github.io/sf/articles/sf1.html"><code>sf</code></a> object types using functions like <a href="https://r-spatial.github.io/sf/reference/st_as_sf.html"><code>st_as_sf()</code></a>.</li>
</ul></li>
<li><strong>Handling Multipolygon Objects</strong>
<ul>
<li>Multiple geometries in objects can cause unexpected plotting results.</li>
<li>Resolve issues by casting to simpler geometry types using <code>st_cast(to = "POLYGON")</code>.</li>
</ul></li>
<li><strong>Spatial Subsetting Challenges</strong>
<ul>
<li><p>Verbose syntax when using tidyverse functions like <a href="https://dplyr.tidyverse.org/reference/filter.html"><code>filter()</code></a> with spatial predicates like <a href="https://r-spatial.github.io/sf/reference/st_intersects.html"><code>st_intersects()</code></a>.</p></li>
<li><p>May result in altered row names, complicating joins and comparisons.</p></li>
<li><p>Other option is spatial subsetting using base <code>R</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">lnd_buff <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> lnd[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">27700</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># uk CRS</span></span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_buffer</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span>)</span>
<span id="cb4-5">near_lnd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> world[lnd_buff, ]</span>
<span id="cb4-6">world_poly <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> world <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_cast</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"POLYGON"</span>)</span>
<span id="cb4-8">near_lnd_new <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> world_poly[lnd_buff, ]</span>
<span id="cb4-9">near_lnd_tidy <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> world <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersects</span>(., lnd_buff, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>))</span></code></pre></div>
</div></li>
</ul></li>
<li><strong>Row Name Alterations</strong>
<ul>
<li>Tidyverse operations may drop or alter row names, affecting joins and comparisons. See related discussion in <a href="https://github.com/tidyverse/dplyr/issues/366">tidyverse/dplyr#366</a>.</li>
</ul></li>
<li><strong>Attribute Alteration Pitfall</strong>
<ul>
<li>Results from tidyverse functions may differ from base R operations due to row name discrepancies.</li>
<li>Example functions: <a href="https://dplyr.tidyverse.org/reference/filter.html"><code>filter()</code></a> vs base R subsetting (<code>[]</code>).</li>
</ul></li>
<li><strong>Issues with <code>bind_rows()</code></strong>
<ul>
<li><a href="https://dplyr.tidyverse.org/reference/bind.html"><code>bind_rows()</code></a> fails on spatial objects; use alternatives like setting geometries to NULL with <a href="https://r-spatial.github.io/sf/reference/st_set_geometry.html"><code>st_set_geometry()</code></a> before combining.</li>
</ul></li>
<li><strong>Limited Raster Data Support</strong>
<ul>
<li>Tidyverse integration with <a href="https://rspatial.github.io/raster/"><code>raster</code></a> data is minimal.</li>
<li>Initial efforts like <a href="https://cran.r-project.org/web/packages/tabularaster/index.html"><code>tabularaster</code></a>, <a href="https://cran.r-project.org/web/packages/sfraster/index.html"><code>sfraster</code></a>, and <a href="https://r-spatial.github.io/stars/"><code>stars</code></a> aim to enhance support.</li>
</ul></li>
</ol>
</div>
</div>
<section id="vector-attribute-sub-setting" class="level3">
<h3 class="anchored" data-anchor-id="vector-attribute-sub-setting">3.2.1 Vector Attribute Sub-setting</h3>
<ul>
<li><strong>Base R Sub-setting</strong>:
<ul>
<li><p>Uses <code>[</code> operator and <code>subset()</code> function for rows and columns selection.</p></li>
<li><p>Syntax: <code>object[i, j]</code> returns rows indexed by <code>i</code> and columns by <code>j</code>.</p></li>
</ul></li>
<li><strong><code>dplyr</code> Sub-setting Functions</strong>:
<ul>
<li><p><code>filter()</code> and <code>slice()</code> for rows, <code>select()</code> for columns.</p></li>
<li><p><strong><code>select()</code></strong>: Subsets columns by name or position.</p></li>
<li><p>Helper functions in <code>select()</code> like <code>contains()</code>, <code>starts_with()</code>, <code>num_range()</code>.</p></li>
</ul></li>
<li><strong>Extracting a Single Column</strong>:
<ul>
<li>Use <code>pull()</code> (<code>dplyr</code>), <code>$</code>, or <code>[[</code> (base <code>R</code>).</li>
</ul></li>
<li><strong>Row Selection</strong>:
<ul>
<li><p><strong><code>slice()</code></strong>: Selects rows by index.</p></li>
<li><p><strong><code>filter()</code></strong>: Filters rows based on conditions.</p></li>
</ul></li>
<li><strong>Comparison Operators</strong>:
<ul>
<li>Standard operators can be used in <code>filter()</code>: <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>==</code>, <code>!=</code>.</li>
</ul></li>
</ul>
<p>The <code>dplyr</code> functions (<code>filter()</code>, <code>select()</code>, <code>pull()</code>) are intuitive and integrate well with the tidyverse workflows.</p>
</section>
<section id="chaining-commands-with-pipes" class="level3">
<h3 class="anchored" data-anchor-id="chaining-commands-with-pipes">3.2.2 Chaining Commands with Pipes</h3>
<ul>
<li><strong>Pipe Operator</strong>:
<ul>
<li><strong><code>%&gt;%</code></strong> (from the <strong><code>magrittr</code></strong> package) and native <strong><code>|&gt;</code></strong> (from R 4.1.0 onwards) enable chaining commands, improving readability and flow of code.</li>
<li>The output of one function becomes the input of the next.</li>
<li>Alternative: Nested Function Calls: The same operation without pipes uses nested functions, which is harder to read.</li>
</ul></li>
<li><strong>Splitting into Multiple Lines</strong>:
<ul>
<li>Useful for debugging and inspecting intermediate results but can clutter the environment.</li>
</ul></li>
<li><strong>Key Packages</strong>:
<ul>
<li><a href="https://dplyr.tidyverse.org/"><strong><code>dplyr</code></strong></a>: Provides verbs like <code>filter()</code>, <code>select()</code>, <code>slice()</code>, and supports pipe workflows.</li>
<li><a href="https://magrittr.tidyverse.org/"><strong><code>magrittr</code></strong></a>: Provides <code>%&gt;%</code> operator for chaining functions.</li>
</ul></li>
</ul>
</section>
<section id="vector-attribute-aggregation" class="level3">
<h3 class="anchored" data-anchor-id="vector-attribute-aggregation">3.2.3 Vector Attribute Aggregation</h3>
<ul>
<li>Aggregation is summarizing data using one or more grouping variables, often leading to a smaller dataset. It is useful for data reduction, especially when working with large datasets.</li>
<li><strong>Base R Approach</strong>
<ul>
<li><strong>Using <code>aggregate()</code></strong>:
<ul>
<li><a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/aggregate"><strong><code>aggregate()</code></strong></a> groups data and applies a function (e.g., <code>sum</code>). Result: A non-spatial data frame with two columns (<code>continent</code>, <code>pop</code>).</li>
</ul></li>
<li><strong>Using <code>aggregate.sf()</code></strong>:
<ul>
<li>For spatial objects (<code>sf</code>), use <code>aggregate()</code> with <code>by</code> argument. This results in an <strong><code>sf</code></strong> object with eight features representing continents.</li>
</ul></li>
</ul></li>
<li><strong><code>dplyr</code> Approach</strong>
<ul>
<li><strong>Using <code>group_by()</code> and <code>summarize()</code></strong>:
<ul>
<li><p>Equivalent to <code>aggregate()</code>, but offers flexibility and control:</p>
<ul>
<li><a href="https://dplyr.tidyverse.org/reference/group_by.html"><strong><code>group_by()</code></strong></a> defines grouping variables.</li>
<li><a href="https://dplyr.tidyverse.org/reference/summarise.html"><strong><code>summarize()</code></strong></a> applies aggregation functions.</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb5-2">world <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(continent) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pop =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(pop, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 8 features and 2 fields
Geometry type: GEOMETRY
Dimension:     XY
Bounding box:  xmin: -180 ymin: -89.9 xmax: 180 ymax: 83.64513
Geodetic CRS:  WGS 84
# A tibble: 8 × 3
  continent                      pop                                        geom
  &lt;chr&gt;                        &lt;dbl&gt;                              &lt;GEOMETRY [°]&gt;
1 Africa                  1154946633 MULTIPOLYGON (((36.86623 22, 36.69069 22.2…
2 Antarctica                       0 MULTIPOLYGON (((-180 -89.9, 180 -89.9, 180…
3 Asia                    4311408059 MULTIPOLYGON (((36.14976 35.82153, 35.9050…
4 Europe                   669036256 MULTIPOLYGON (((26.29 35.29999, 25.74502 3…
5 North America            565028684 MULTIPOLYGON (((-82.26815 23.18861, -82.51…
6 Oceania                   37757833 MULTIPOLYGON (((166.7932 -15.66881, 167.00…
7 Seven seas (open ocean)          0 POLYGON ((68.935 -48.625, 68.8675 -48.83, …
8 South America            412060811 MULTIPOLYGON (((-66.95992 -54.89681, -66.4…</code></pre>
</div>
</div>
<ul>
<li>More details on grouped data and <a href="https://dplyr.tidyverse.org/reference/summarise.html"><code>summarize()</code></a> from the <strong>dplyr</strong> package vignettes.</li>
</ul>
<div class="callout callout-style-default callout-keylearning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Relevant Topic
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong><code>dplyr</code></strong> functions are highly effective when applied to grouped data frames (<code>grouped_df</code> objects). Here are the main points covered:</p>
<ul>
<li><p><strong>Grouping Data</strong>: Use <a href="https://dplyr.tidyverse.org/reference/group_by.html"><strong><code>group_by()</code></strong></a> to create groups within a data frame based on one or more variables.</p>
<ul>
<li>To count rows in each group, use <a href="https://dplyr.tidyverse.org/reference/tally.html"><strong><code>tally()</code></strong></a>.</li>
</ul></li>
<li><p><strong>Accessing Group Metadata</strong>:</p>
<ul>
<li><strong><code>group_keys()</code></strong>: Shows underlying group data. <a href="https://dplyr.tidyverse.org/reference/group_keys.html">Details here</a>.</li>
<li><strong><code>group_vars()</code></strong>: Retrieves names of the grouping variables. <a href="https://dplyr.tidyverse.org/reference/group_vars.html">Details here</a>.</li>
</ul></li>
<li><p><strong>Modifying Groups</strong>:</p>
<ul>
<li>To overwrite or add grouping variables, use <code>.add = TRUE</code> with <strong><code>group_by()</code></strong>. <a href="https://dplyr.tidyverse.org/reference/group_by.html">Read more</a>.</li>
<li>To remove groups, use <a href="https://dplyr.tidyverse.org/reference/ungroup.html"><strong><code>ungroup()</code></strong></a>.</li>
</ul></li>
<li><p><strong>Verbs and Grouping</strong>:</p>
<ul>
<li><strong><code>summarise()</code></strong>: Computes summary statistics per group. The <code>.groups</code> argument controls grouping structure. <a href="https://dplyr.tidyverse.org/reference/summarise.html">More on <code>summarise()</code></a>.</li>
</ul></li>
<li><p><strong>Column Manipulation</strong>:</p>
<ul>
<li><strong><code>select()</code></strong> retains grouping variables by default. <a href="https://dplyr.tidyverse.org/reference/select.html">More on <code>select()</code></a>.</li>
<li><strong><code>rename()</code></strong> and <strong><code>relocate()</code></strong> function the same way for grouped and ungrouped data. <a href="https://dplyr.tidyverse.org/reference/relocate.html">Details here</a>.</li>
</ul></li>
<li><p><strong>Sorting Groups</strong>:</p>
<ul>
<li><strong><code>arrange()</code></strong>: Sorts data, with <code>.by_group = TRUE</code> option to sort within groups. <a href="https://dplyr.tidyverse.org/reference/arrange.html">More on <code>arrange()</code></a>.</li>
</ul></li>
</ul>
</div>
</div>
<ul>
<li>Check out <a href="https://r4ds.had.co.nz/transform.html">Chapter 5</a> of <a href="https://r4ds.had.co.nz/"><em>R for Data Science</em></a>.</li>
</ul>
</section>
<section id="vector-attribute-joining" class="level3">
<h3 class="anchored" data-anchor-id="vector-attribute-joining">3.2.4 Vector Attribute Joining</h3>
<ul>
<li><p>Joining involves combining tables based on a shared key variable. In R, <code>dplyr</code> functions like <code>left_join()</code> and <code>inner_join()</code> are commonly used for this purpose.</p>
<ul>
<li>The join functions in <code>dplyr</code> (<code>left_join</code>, <code>inner_join</code>, etc.) follow conventions from SQL, allowing easy and consistent data merging.</li>
<li>These functions work similarly for both non-spatial (<code>data.frame</code>) and spatial (<code>sf</code>) objects. The geometry list column in <code>sf</code> objects is the key difference.</li>
</ul></li>
<li><p><strong>When merging an <code>sf</code> object with a data.frame</strong></p>
<ul>
<li>The resulting object remains an <code>sf</code> object, keeping its spatial features intact while adding new columns for coffee production.</li>
</ul></li>
<li><p><strong>Handling Key Variables</strong>:</p>
<ul>
<li>If datasets have key variables with matching names (e.g., <code>name_long</code>), joining works automatically.</li>
<li>If the key variables differ, either:
<ul>
<li>Rename the variable to match, or</li>
<li>Use the <code>by</code> argument to specify the joining variables explicitly.</li>
</ul></li>
</ul></li>
<li><p><strong>Inner Joins</strong>:</p>
<ul>
<li>An <strong>inner join</strong> keeps only the rows with matching key variables in both datasets. This reduces the number of rows, depending on the overlap in key variables.</li>
</ul></li>
<li><p><strong>Troubleshooting Joins</strong>:</p>
<ul>
<li>If some rows are missing in the result (e.g., due to differing key names like “Congo, Dem. Rep.&nbsp;of”), identify mismatches using <code>setdiff()</code>.</li>
<li>Use regex matching from the <code>stringr</code> package to identify correct key names for adjustments.</li>
</ul></li>
<li><p><strong>Reversing Joins</strong>:</p>
<ul>
<li>You can also join starting with a non-spatial dataset and adding spatial variables from an <code>sf</code> object.</li>
<li><strong>The result will be a non-spatial <code>data.frame</code> (tibble), unless explicitly converted to an <code>sf</code> object using <code>st_as_sf()</code>.</strong></li>
</ul></li>
<li><p><strong>Further Resources</strong>:</p>
<ul>
<li><p><a href="https://r4ds.had.co.nz/relational-data.html?q=join#relational-data">Chapter 13</a> on Relational Data in <a href="https://r4ds.had.co.nz/relational-data.html?q=join#relational-data">R for Data Science</a> by Grolemund and Wickham (2016)</p></li>
<li><p>The <a href="https://asardaes.github.io/table.express/articles/joins.html">documentation</a>&nbsp;describing joins with&nbsp;<strong><code>data.table</code></strong> package.</p></li>
<li><p>The join <a href="https://geocompx.github.io/geocompkg/articles/join.html">vignette</a> in the <code>geocompkg</code> package, which is summarized below: —</p></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-keylearning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Relevant Topic
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Spatial Joins Extended</strong></p>
<ul>
<li>Spatial Joins: Combines attributes from different datasets based on a common key, useful for integrating non-spatial (attribute) data with spatial data.</li>
</ul>
<section id="left-join" class="level4">
<h4 class="anchored" data-anchor-id="left-join">Left Join</h4>
<ul>
<li>Adds attributes to all observations from the left dataset with matched values from the right.</li>
</ul>
</section>
<section id="joining-by-different-column-names" class="level4">
<h4 class="anchored" data-anchor-id="joining-by-different-column-names">Joining by Different Column Names</h4>
<ul>
<li><p>Case: If key columns have different names, use a named vector to specify the keys</p></li>
<li><p>Issue: Duplicate columns (e.g., <code>tbl_1_var.x</code> and <code>tbl_2_var.y</code>). Resolved by specifying all keys.</p></li>
</ul>
</section>
<section id="joining-with-a-non-spatial-first-argument" class="level4">
<h4 class="anchored" data-anchor-id="joining-with-a-non-spatial-first-argument">Joining with a Non-Spatial First Argument</h4>
<ul>
<li>Dropping Geometry: <code>st_drop_geometry()</code> removes spatial attributes, allowing joins with standard data frames.</li>
</ul>
</section>
<section id="inner-join" class="level4">
<h4 class="anchored" data-anchor-id="inner-join">Inner Join</h4>
<ul>
<li>Keeps only rows with matching keys in both datasets.</li>
</ul>
</section>
</div>
</div>
</section>
<section id="creating-attributes-and-removing-spatial-information" class="level3">
<h3 class="anchored" data-anchor-id="creating-attributes-and-removing-spatial-information">3.2.5 Creating attributes and removing spatial information</h3>
<ul>
<li><strong>Creating new attributes</strong>:
<ul>
<li>Calculate a new attribute using <code>mutate()</code> from <code>dplyr</code>. Example: <code>population / area</code>.</li>
<li>Use <code>mutate()</code> to add the new column without overwriting the geometry column.</li>
</ul></li>
<li><strong>Combining columns</strong>:
<ul>
<li>Use <a href="https://tidyr.tidyverse.org/reference/unite.html"><code>unite()</code></a> from <code>tidyr</code> to merge two or more columns into one (e.g., <code>continent</code> and <code>region_un</code>).</li>
<li><code>unite()</code> allows setting a separator (e.g., <code>:</code>) and can optionally remove the original columns.</li>
</ul></li>
<li><strong>Splitting columns</strong>:
<ul>
<li>Use <a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html"><code>separate_wider_position()</code></a> and <a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html"><code>separate_wider_delim()</code></a>from <code>tidyr</code> to split a combined column back into its original components.</li>
</ul></li>
<li><strong>Renaming columns</strong>:
<ul>
<li>Use <a href="https://dplyr.tidyverse.org/reference/rename.html"><code>rename()</code></a> from <code>dplyr</code> for renaming specific columns.</li>
<li>For renaming all columns, use <a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/setNames"><code>setNames()</code></a> with a character vector for new names.</li>
</ul></li>
<li><strong>Removing geometry</strong>:
<ul>
<li>Use <a href="https://r-spatial.github.io/sf/reference/st_geometry.html"><code>st_drop_geometry()</code></a> to drop the spatial information while retaining the attributes in a non-spatial <code>data.frame</code>. This method is preferred over manually selecting non-geometry columns as it avoids unintended issues.</li>
</ul></li>
</ul>
</section>
</section>
<section id="manipulating-raster-objects" class="level2">
<h2 class="anchored" data-anchor-id="manipulating-raster-objects">3.3 Manipulating Raster Objects</h2>
<ul>
<li><strong>Raster Data Model</strong>:
<ul>
<li>Represents continuous surfaces, unlike vector data which use discrete entities (points, lines, polygons).</li>
<li>Useful for representing spatial phenomena like elevation, temperature, and land cover.</li>
</ul></li>
<li><strong>Creating a Raster Object</strong>:
<ul>
<li>Use <code>rast()</code> function to create raster objects.</li>
<li>The <code>vals</code> argument assigns numeric values to each cell.</li>
</ul></li>
<li><strong>Categorical Raster Values</strong>:
<ul>
<li>Can hold logical or factor (categorical) values.</li>
<li>Example: Creating a raster for soil types (<code>clay</code>, <code>silt</code>, <code>sand</code>).</li>
</ul></li>
<li><strong>Raster Attribute Table (RAT)</strong>:
<ul>
<li>Stores additional information about raster values, accessible with <code>cats()</code>.</li>
<li>Each layer’s attribute data can be modified with <code>levels()</code>.</li>
</ul></li>
<li><strong>Color Table</strong>:
<ul>
<li>Categorical rasters can store color information using a color table with RGB (Red, Green, Blue) or RGBA (Red, Green, Blue, Alpha) columns.</li>
<li>Use <code>coltab()</code> to view or set color tables.</li>
<li>Saving the raster (e.g., as GeoTIFF) includes the color table information.</li>
</ul></li>
</ul>
<section id="raster-subsetting" class="level3">
<h3 class="anchored" data-anchor-id="raster-subsetting">3.3.1 Raster subsetting</h3>
<ul>
<li><p><strong>Raster Subsetting</strong>:</p>
<ul>
<li>Involves selecting specific parts of a raster dataset using the base R subsetting operator <code>[ , ]</code>.</li>
<li><strong>Subsetting Methods</strong>:
<ol type="1">
<li><strong>Row-Column Indexing</strong>: Accesses cells using specific row and column coordinates.</li>
<li><strong>Cell IDs</strong>: Accesses cells using unique numeric identifiers for each raster cell.</li>
<li><strong>Coordinates and Spatial Objects</strong>: These methods are used for spatial subsetting, using another spatial object to subset a raster.</li>
</ol></li>
</ul></li>
<li><p><strong>Examples</strong>:</p>
<ul>
<li>Accessing the top-left pixel value using row-column indexing:</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A simple raster</span></span>
<span id="cb7-2">  elev <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(</span>
<span id="cb7-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrows =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncols =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb7-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>,</span>
<span id="cb7-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vals =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb7-6">    ) </span>
<span id="cb7-7"></span>
<span id="cb7-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A raster with categorical levels</span></span>
<span id="cb7-9">grain <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(</span>
<span id="cb7-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrows =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncols =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb7-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>,</span>
<span id="cb7-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vals =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(</span>
<span id="cb7-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Wheat"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rice"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Maize"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Others"</span>),</span>
<span id="cb7-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,</span>
<span id="cb7-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb7-16">  )</span>
<span id="cb7-17">)</span>
<span id="cb7-18"></span>
<span id="cb7-19">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print the "elev" object to visualize the design</span></span>
<span id="cb7-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(elev)</span>
<span id="cb7-21"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## class       : SpatRaster </span></span>
<span id="cb7-22"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## dimensions  : 10, 10, 1  (nrow, ncol, nlyr)</span></span>
<span id="cb7-23"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## resolution  : 0.3, 0.3  (x, y)</span></span>
<span id="cb7-24"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## extent      : -1.5, 1.5, -1.5, 1.5  (xmin, xmax, ymin, ymax)</span></span>
<span id="cb7-25"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## coord. ref. : lon/lat WGS 84 (CRS84) (OGC:CRS84) </span></span>
<span id="cb7-26"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## source(s)   : memory</span></span>
<span id="cb7-27"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## name        : lyr.1 </span></span>
<span id="cb7-28"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## min value   :     1 </span></span>
<span id="cb7-29"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## max value   :   100</span></span>
<span id="cb7-30"></span>
<span id="cb7-31">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the raster object to visualize the matrix as an image</span></span>
<span id="cb7-32">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(</span>
<span id="cb7-33">      elev, </span>
<span id="cb7-34">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Raster Object with a Sequential Pattern"</span></span>
<span id="cb7-35">    )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter3_files/figure-html/raster-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter3_files/figure-html/raster-1-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"></span>
<span id="cb8-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Accessing using row number and column number</span></span>
<span id="cb8-3">    elev[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb8-4"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##   lyr.1</span></span>
<span id="cb8-5"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1     1</span></span>
<span id="cb8-6"></span>
<span id="cb8-7">    elev[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]</span>
<span id="cb8-8"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##   lyr.1</span></span>
<span id="cb8-9"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1    95</span></span>
<span id="cb8-10"></span>
<span id="cb8-11">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(</span>
<span id="cb8-12">      grain,</span>
<span id="cb8-13">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Raster Object with 4 categorical levels"</span></span>
<span id="cb8-14">    )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter3_files/figure-html/raster-1-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter3_files/figure-html/raster-1-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"></span>
<span id="cb9-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Accessing using row number and column number</span></span>
<span id="cb9-3"></span>
<span id="cb9-4">    grain[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb9-5"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##   lyr.1</span></span>
<span id="cb9-6"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1  Rice</span></span>
<span id="cb9-7"></span>
<span id="cb9-8">    grain[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]</span>
<span id="cb9-9"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##    lyr.1</span></span>
<span id="cb9-10"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1 Others</span></span>
<span id="cb9-11"></span>
<span id="cb9-12">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A multilayered raster - combining both</span></span>
<span id="cb9-13">    two_layers <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(elev, grain)</span>
<span id="cb9-14"></span>
<span id="cb9-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(two_layers)</span>
<span id="cb9-16"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## class       : SpatRaster </span></span>
<span id="cb9-17"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## dimensions  : 10, 10, 2  (nrow, ncol, nlyr)</span></span>
<span id="cb9-18"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## resolution  : 0.3, 0.3  (x, y)</span></span>
<span id="cb9-19"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## extent      : -1.5, 1.5, -1.5, 1.5  (xmin, xmax, ymin, ymax)</span></span>
<span id="cb9-20"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## coord. ref. : lon/lat WGS 84 (CRS84) (OGC:CRS84) </span></span>
<span id="cb9-21"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## source(s)   : memory</span></span>
<span id="cb9-22"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## names       : lyr.1, lyr.1 </span></span>
<span id="cb9-23"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## min values  :     1, Maize </span></span>
<span id="cb9-24"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## max values  :   100, Wheat</span></span>
<span id="cb9-25">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(two_layers) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Continuous variable"</span>, </span>
<span id="cb9-26">                           <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Categorical variable"</span>)</span>
<span id="cb9-27">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(</span>
<span id="cb9-28">      two_layers</span>
<span id="cb9-29">    )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter3_files/figure-html/raster-1-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter3_files/figure-html/raster-1-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Accessing the first cell using its Cell ID:</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Accessing raster values using cell ID</span></span>
<span id="cb10-2">elev[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb10-3"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##   lyr.1</span></span>
<span id="cb10-4"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1     1</span></span>
<span id="cb10-5">elev[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">95</span>]</span>
<span id="cb10-6"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##   lyr.1</span></span>
<span id="cb10-7"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1    95</span></span></code></pre></div>
</details>
</div>
<ul>
<li><p><strong>Subsetting Multi-layered Rasters</strong>:</p>
<ul>
<li>For multi-layer raster objects (e.g., <code>two_layers = c(grain, elev)</code>), subsetting returns values from each layer:</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">two_layers[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Continuous variable Categorical variable
1                   1                 Rice</code></pre>
</div>
</div>
<ul>
<li>To extract all cell values from a raster:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extracting all values - single layer raster</span></span>
<span id="cb13-2">elev[][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]  </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># It is Equivalent to using the values() function</span></span>
<span id="cb15-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(elev)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extracting all values - multi-layer raster</span></span>
<span id="cb17-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># It returns a data.frame</span></span>
<span id="cb17-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(two_layers) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 2
   `Continuous variable` `Categorical variable`
                   &lt;int&gt;                  &lt;int&gt;
 1                     1                      3
 2                     2                      3
 3                     3                      3
 4                     4                      2
 5                     5                      1
 6                     6                      1
 7                     7                      3
 8                     8                      3
 9                     9                      1
10                    10                      2
# ℹ 90 more rows</code></pre>
</div>
</div>
<ul>
<li><p><strong>Modifying Raster Values</strong>:</p>
<ul>
<li>Change specific cell values by combining subsetting with assignment:</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">elev[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sets the value of the 1 central cells to 0</span></span>
<span id="cb19-2"></span>
<span id="cb19-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(elev)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter3_files/figure-html/unnamed-chunk-10-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter3_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Modify multiple cells simultaneously:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1">elev[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sets the value of the central 2 cells to 0</span></span>
<span id="cb20-2"></span>
<span id="cb20-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(elev)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter3_files/figure-html/unnamed-chunk-11-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter3_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><strong>Replacing Values in Multi-layered Rasters</strong>:</p>
<ul>
<li>Modify cell values in a multi-layer raster using a matrix with corresponding layers and cell indices:</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Assigns new values for Cell ID 1 in both layers</span></span>
<span id="cb21-2">two_layers[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))  </span>
<span id="cb21-3"></span>
<span id="cb21-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(two_layers)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter3_files/figure-html/unnamed-chunk-12-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter3_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>This subsetting approach allows efficient extraction and manipulation of raster cell values, enabling the customization of raster datasets for specific analytical needs.</p>
</section>
<section id="summarizing-raster-objects" class="level3">
<h3 class="anchored" data-anchor-id="summarizing-raster-objects">3.3.2 Summarizing Raster Objects</h3>
<ul>
<li><strong>Descriptive Statistics</strong>:
<ul>
<li>The <strong>terra</strong> package provides functions for summarizing raster objects.</li>
<li>Printing a raster object directly shows the <strong>minimum</strong> and <strong>maximum</strong> values.</li>
<li>The <a href="https://rspatial.github.io/terra/reference/summary.html"><code>summary()</code></a> function provides detailed statistics:
<ul>
<li>For <strong>continuous rasters</strong>: Minimum, maximum, quartiles, and count of NAs.</li>
<li>For <strong>categorical rasters</strong>: Counts of each unique class.</li>
</ul></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(two_layers)</span>
<span id="cb22-2"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##  Continuous.variable Categorical.variable</span></span>
<span id="cb22-3"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##  Min.   :  1.00      Maize :18           </span></span>
<span id="cb22-4"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##  1st Qu.: 24.75      Others:26           </span></span>
<span id="cb22-5"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##  Median : 50.50      Rice  :31           </span></span>
<span id="cb22-6"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##  Mean   : 50.06      Wheat :25           </span></span>
<span id="cb22-7"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##  3rd Qu.: 75.25                          </span></span>
<span id="cb22-8"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##  Max.   :100.00</span></span></code></pre></div>
</div>
<ul>
<li><strong>Custom Summary Statistics</strong>:
<ul>
<li>The <a href="https://rspatial.github.io/terra/reference/global.html"><code>global()</code></a> function calculates additional statistics like <strong>standard deviation</strong> and can be used to apply custom summary statistics.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">global</span>(two_layers, sum)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      sum
Continuous variable  5006
Categorical variable  263</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">global</span>(two_layers, mean)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      mean
Continuous variable  50.06
Categorical variable  2.63</code></pre>
</div>
</div>
<ul>
<li><strong>Frequency Table</strong>:
<ul>
<li>The <a href="https://rspatial.github.io/terra/reference/freq.html"><code>freq()</code></a> function generates a frequency table for categorical raster values, showing counts of each category.</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">freq</span>(two_layers<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Categorical variable</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb27-2">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb27-3">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_538</span>()</span></code></pre></div>
</details>
<div id="tbl-freq-raster" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-freq-raster-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Frequency table using freq() on raster objects
</figcaption>
<div aria-describedby="tbl-freq-raster-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="rzlnkjibln" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#rzlnkjibln table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rzlnkjibln thead, #rzlnkjibln tbody, #rzlnkjibln tfoot, #rzlnkjibln tr, #rzlnkjibln td, #rzlnkjibln th {
  border-style: none;
}

#rzlnkjibln p {
  margin: 0;
  padding: 0;
}

#rzlnkjibln .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rzlnkjibln .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rzlnkjibln .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rzlnkjibln .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rzlnkjibln .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rzlnkjibln .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rzlnkjibln .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rzlnkjibln .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rzlnkjibln .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rzlnkjibln .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rzlnkjibln .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rzlnkjibln .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rzlnkjibln .gt_spanner_row {
  border-bottom-style: hidden;
}

#rzlnkjibln .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rzlnkjibln .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#rzlnkjibln .gt_from_md > :first-child {
  margin-top: 0;
}

#rzlnkjibln .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rzlnkjibln .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rzlnkjibln .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#rzlnkjibln .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rzlnkjibln .gt_row_group_first td {
  border-top-width: 2px;
}

#rzlnkjibln .gt_row_group_first th {
  border-top-width: 2px;
}

#rzlnkjibln .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rzlnkjibln .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rzlnkjibln .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rzlnkjibln .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rzlnkjibln .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rzlnkjibln .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rzlnkjibln .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rzlnkjibln .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rzlnkjibln .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rzlnkjibln .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rzlnkjibln .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rzlnkjibln .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rzlnkjibln .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rzlnkjibln .gt_left {
  text-align: left;
}

#rzlnkjibln .gt_center {
  text-align: center;
}

#rzlnkjibln .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rzlnkjibln .gt_font_normal {
  font-weight: normal;
}

#rzlnkjibln .gt_font_bold {
  font-weight: bold;
}

#rzlnkjibln .gt_font_italic {
  font-style: italic;
}

#rzlnkjibln .gt_super {
  font-size: 65%;
}

#rzlnkjibln .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rzlnkjibln .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rzlnkjibln .gt_indent_1 {
  text-indent: 5px;
}

#rzlnkjibln .gt_indent_2 {
  text-indent: 10px;
}

#rzlnkjibln .gt_indent_3 {
  text-indent: 15px;
}

#rzlnkjibln .gt_indent_4 {
  text-indent: 20px;
}

#rzlnkjibln .gt_indent_5 {
  text-indent: 25px;
}

#rzlnkjibln .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#rzlnkjibln div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="layer" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">layer</th>
<th id="value" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">value</th>
<th id="count" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">count</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="layer">1</td>
<td class="gt_row gt_left" headers="value">Maize</td>
<td class="gt_row gt_right" headers="count">18</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="layer">1</td>
<td class="gt_row gt_left" headers="value">Others</td>
<td class="gt_row gt_right" headers="count">26</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="layer">1</td>
<td class="gt_row gt_left" headers="value">Rice</td>
<td class="gt_row gt_right" headers="count">31</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="layer">1</td>
<td class="gt_row gt_left" headers="value">Wheat</td>
<td class="gt_row gt_right" headers="count">25</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<ul>
<li><strong>Visualization of Raster Statistics</strong>:
<ul>
<li>Several functions like <a href="https://rspatial.github.io/terra/reference/hist.html"><code>hist()</code></a>, <a href="https://rspatial.github.io/terra/reference/boxplot.html"><code>boxplot()</code></a>, and <a href="https://rspatial.github.io/terra/reference/density.html"><code>density()</code></a> work directly with raster objects to visualize statistics.</li>
<li>If visualization functions do not support raster objects, values can be extracted using <a href="https://rspatial.github.io/terra/reference/values.html"><code>values()</code></a> for further plotting.</li>
</ul></li>
<li><strong>Handling Function Name Clashes</strong>:
<ul>
<li>Some functions (e.g., <code>extract()</code>) exist in multiple packages like <strong>terra</strong> and <strong>tidyr</strong>, leading to conflicts.</li>
<li>To avoid issues, call functions with full namespaces (e.g., <code>tidyr::extract()</code>).
<ul>
<li>Use <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/detach.html"><code>detach()</code></a> to unload conflicting packages, but be cautious as it may impact dependent packages.</li>
</ul></li>
</ul></li>
</ul>
</section>
</section>
<section id="exercises" class="level2">
<h2 class="anchored" data-anchor-id="exercises">3.4 Exercises</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sf)</span>
<span id="cb28-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb28-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(terra)</span>
<span id="cb28-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(spData)</span>
<span id="cb28-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(us_states)</span>
<span id="cb28-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(us_states_df)</span></code></pre></div>
</div>
<section id="e1" class="level3">
<h3 class="anchored" data-anchor-id="e1">E1</h3>
<p><strong>Create a new object called <code>us_states_name</code> that contains only the <code>NAME</code> column from the <code>us_states</code> object using either base R (<code>[</code>) or tidyverse (<a href="https://dplyr.tidyverse.org/reference/select.html"><code>select()</code></a>) syntax. What is the class of the new object and what makes it geographic?</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1">us_states_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb29-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(NAME)</span>
<span id="cb29-3"></span>
<span id="cb29-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>(us_states_name)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sf"         "data.frame"</code></pre>
</div>
</div>
<p>The new object of the class <code>sf</code>, and the stickiness of the <code>geometry</code> column makes it a geographical dataset.</p>
<hr>
</section>
<section id="e2" class="level3">
<h3 class="anchored" data-anchor-id="e2">E2</h3>
<p><strong>Select columns from the <code>us_states</code> object which contain population data. Obtain the same result using a different command (bonus: try to find three ways of obtaining the same result). Hint: try to use helper functions, such as <code>contains</code> or <code>matches</code> from dplyr (see <a href="https://tidyselect.r-lib.org/reference/starts_with.html"><code>?contains</code></a>).</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb31-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">contains</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pop"</span>))</span>
<span id="cb31-3"></span>
<span id="cb31-4">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb31-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">where</span>(is.double)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb31-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>AREA)</span>
<span id="cb31-7"></span>
<span id="cb31-8">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb31-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)</span></code></pre></div>
</div>
<p>The above three methods all select the columns <code>total_pop_10</code> and <code>total_pop_15</code> . Notice that the column <code>geometry</code> is sticky, and can be removed using <code>st_drop_geometry()</code>.</p>
<hr>
</section>
<section id="e3" class="level3">
<h3 class="anchored" data-anchor-id="e3">E3</h3>
<p><strong>Find all states with the following characteristics (bonus: find <em>and</em> plot them):</strong></p>
<ul>
<li><p><strong>Belong to the Midwest region.</strong></p>
<p>The code shown below gives out the names of all such states.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb32-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(REGION <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Midwest"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb32-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(NAME) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb32-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", "</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Indiana, Kansas, Minnesota, Missouri, North Dakota, South Dakota, Illinois, Iowa, Michigan, Nebraska, Ohio, Wisconsin"</code></pre>
</div>
</div>
<ul>
<li><p><strong>Belong to the West region, have an area below 250,000 km<sup>2</sup><em>and</em> in 2015 a population greater than 5,000,000 residents (hint: you may need to use the function <a href="https://r-quantities.github.io/units/reference/units.html"><code>units::set_units()</code></a> or <a href="https://rdrr.io/r/base/numeric.html"><code>as.numeric()</code></a>).</strong></p>
<p>Only Washington State qualifies all three conditions. Code is shown below.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb34-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(REGION <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"West"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb34-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(total_pop_15 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5e6</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb34-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(AREA) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250000</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 1 feature and 6 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -124.7042 ymin: 45.54774 xmax: -116.916 ymax: 49.00236
Geodetic CRS:  NAD83
  GEOID       NAME REGION          AREA total_pop_10 total_pop_15
1    53 Washington   West 175436 [km^2]      6561297      6985464
                        geometry
1 MULTIPOLYGON (((-122.7699 4...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb36-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(REGION <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"West"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb36-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(total_pop_15 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5e6</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb36-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(AREA <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> units<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_units</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250000</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"km2"</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 1 feature and 6 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -124.7042 ymin: 45.54774 xmax: -116.916 ymax: 49.00236
Geodetic CRS:  NAD83
  GEOID       NAME REGION          AREA total_pop_10 total_pop_15
1    53 Washington   West 175436 [km^2]      6561297      6985464
                        geometry
1 MULTIPOLYGON (((-122.7699 4...</code></pre>
</div>
</div>
<ul>
<li><p><strong>Belong to the South region, had an area larger than 150,000 km<sup>2</sup> and a total population in 2015 larger than 7,000,000 residents.</strong></p>
<p>The states that fulfil these conditions are Florida, Georgia and Texas.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb38-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(REGION <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"South"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb38-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(AREA <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> units<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_units</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">150000</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"km2"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb38-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(total_pop_15 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7e6</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb38-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(NAME)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Florida" "Georgia" "Texas"  </code></pre>
</div>
</div>
<hr>
</section>
<section id="e4" class="level3">
<h3 class="anchored" data-anchor-id="e4">E4</h3>
<p><strong>What was the total population in 2015 in the <code>us_states</code> dataset? What was the minimum and maximum total population in 2015?</strong></p>
<p>The total population in the <code>us_states</code> dataset in the year 2015 was 314,375,347. The minimum total population in 2015 was 579,679 (Wyoming), and the maximum total population was 38,421,464 (California).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb40-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb40-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb40-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb40-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">total_pop_15 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(total_pop_15)</span>
<span id="cb40-6">  )</span>
<span id="cb40-7"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## # A tibble: 1 × 1</span></span>
<span id="cb40-8"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##   total_pop_15</span></span>
<span id="cb40-9"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##          &lt;dbl&gt;</span></span>
<span id="cb40-10"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1    314375347</span></span>
<span id="cb40-11"></span>
<span id="cb40-12">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb40-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb40-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_min</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order_by =</span> total_pop_15, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb40-15"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##   GEOID    NAME REGION            AREA total_pop_10 total_pop_15</span></span>
<span id="cb40-16"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1    56 Wyoming   West 253309.6 [km^2]       545579       579679</span></span>
<span id="cb40-17"></span>
<span id="cb40-18">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb40-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb40-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_max</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order_by =</span> total_pop_15, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb40-21"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##   GEOID       NAME REGION            AREA total_pop_10 total_pop_15</span></span>
<span id="cb40-22"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1    06 California   West 409747.1 [km^2]     36637290     38421464</span></span></code></pre></div>
</div>
<hr>
</section>
<section id="e5" class="level3">
<h3 class="anchored" data-anchor-id="e5">E5</h3>
<p><strong>How many states are there in each region?</strong></p>
<p>The number of states in each region are shown in Table&nbsp;3 below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb41-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb41-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(REGION, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of States"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb41-4">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb41-5">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_538</span>()</span></code></pre></div>
</details>
<div id="tbl-st-region" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-st-region-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Table showing number of states in each region.
</figcaption>
<div aria-describedby="tbl-st-region-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="clpnyxitaf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#clpnyxitaf table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#clpnyxitaf thead, #clpnyxitaf tbody, #clpnyxitaf tfoot, #clpnyxitaf tr, #clpnyxitaf td, #clpnyxitaf th {
  border-style: none;
}

#clpnyxitaf p {
  margin: 0;
  padding: 0;
}

#clpnyxitaf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#clpnyxitaf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#clpnyxitaf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#clpnyxitaf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#clpnyxitaf .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#clpnyxitaf .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#clpnyxitaf .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#clpnyxitaf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#clpnyxitaf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#clpnyxitaf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#clpnyxitaf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#clpnyxitaf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#clpnyxitaf .gt_spanner_row {
  border-bottom-style: hidden;
}

#clpnyxitaf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#clpnyxitaf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#clpnyxitaf .gt_from_md > :first-child {
  margin-top: 0;
}

#clpnyxitaf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#clpnyxitaf .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#clpnyxitaf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#clpnyxitaf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#clpnyxitaf .gt_row_group_first td {
  border-top-width: 2px;
}

#clpnyxitaf .gt_row_group_first th {
  border-top-width: 2px;
}

#clpnyxitaf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#clpnyxitaf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#clpnyxitaf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#clpnyxitaf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#clpnyxitaf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#clpnyxitaf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#clpnyxitaf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#clpnyxitaf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#clpnyxitaf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#clpnyxitaf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#clpnyxitaf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#clpnyxitaf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#clpnyxitaf .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#clpnyxitaf .gt_left {
  text-align: left;
}

#clpnyxitaf .gt_center {
  text-align: center;
}

#clpnyxitaf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#clpnyxitaf .gt_font_normal {
  font-weight: normal;
}

#clpnyxitaf .gt_font_bold {
  font-weight: bold;
}

#clpnyxitaf .gt_font_italic {
  font-style: italic;
}

#clpnyxitaf .gt_super {
  font-size: 65%;
}

#clpnyxitaf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#clpnyxitaf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#clpnyxitaf .gt_indent_1 {
  text-indent: 5px;
}

#clpnyxitaf .gt_indent_2 {
  text-indent: 10px;
}

#clpnyxitaf .gt_indent_3 {
  text-indent: 15px;
}

#clpnyxitaf .gt_indent_4 {
  text-indent: 20px;
}

#clpnyxitaf .gt_indent_5 {
  text-indent: 25px;
}

#clpnyxitaf .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#clpnyxitaf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="REGION" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">REGION</th>
<th id="Number of States" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Number of States</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="REGION">Norteast</td>
<td class="gt_row gt_right" headers="Number of States">9</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="REGION">Midwest</td>
<td class="gt_row gt_right" headers="Number of States">12</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="REGION">South</td>
<td class="gt_row gt_right" headers="Number of States">17</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="REGION">West</td>
<td class="gt_row gt_right" headers="Number of States">11</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<hr>
</section>
<section id="e6" class="level3">
<h3 class="anchored" data-anchor-id="e6">E6</h3>
<p><strong>What was the minimum and maximum total population in 2015 in each region? What was the total population in 2015 in each region?</strong></p>
<p>The minimum and maximum total population in 2015 in each region is shown in Table&nbsp;4 (a). The total population in each region in 2015 is shown in Table&nbsp;4 (b).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(REGION) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_min</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order_by =</span> total_pop_15, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(REGION, NAME, total_pop_15) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-7">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-8">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>(</span>
<span id="cb42-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> total_pop_15,</span>
<span id="cb42-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decimals =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb42-11">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-12">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label_with</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> snakecase<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>to_title_case) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-13">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_538</span>()</span>
<span id="cb42-14">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(REGION) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb42-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">total_population_2015 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(total_pop_15)</span>
<span id="cb42-19">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(REGION, total_population_2015) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-22">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-23">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>(</span>
<span id="cb42-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> total_population_2015,</span>
<span id="cb42-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decimals =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb42-26">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-27">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label_with</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> snakecase<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>to_title_case) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-28">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_538</span>()</span></code></pre></div>
</details>
<div id="tbl-e6" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-e6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Region-wise total and minimum-maximum populations
</figcaption>
<div aria-describedby="tbl-e6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="umqaednlmw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#umqaednlmw table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#umqaednlmw thead, #umqaednlmw tbody, #umqaednlmw tfoot, #umqaednlmw tr, #umqaednlmw td, #umqaednlmw th {
  border-style: none;
}

#umqaednlmw p {
  margin: 0;
  padding: 0;
}

#umqaednlmw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#umqaednlmw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#umqaednlmw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#umqaednlmw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#umqaednlmw .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#umqaednlmw .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#umqaednlmw .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#umqaednlmw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#umqaednlmw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#umqaednlmw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#umqaednlmw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#umqaednlmw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#umqaednlmw .gt_spanner_row {
  border-bottom-style: hidden;
}

#umqaednlmw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#umqaednlmw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#umqaednlmw .gt_from_md > :first-child {
  margin-top: 0;
}

#umqaednlmw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#umqaednlmw .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#umqaednlmw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#umqaednlmw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#umqaednlmw .gt_row_group_first td {
  border-top-width: 2px;
}

#umqaednlmw .gt_row_group_first th {
  border-top-width: 2px;
}

#umqaednlmw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#umqaednlmw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#umqaednlmw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#umqaednlmw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#umqaednlmw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#umqaednlmw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#umqaednlmw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#umqaednlmw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#umqaednlmw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#umqaednlmw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#umqaednlmw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#umqaednlmw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#umqaednlmw .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#umqaednlmw .gt_left {
  text-align: left;
}

#umqaednlmw .gt_center {
  text-align: center;
}

#umqaednlmw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#umqaednlmw .gt_font_normal {
  font-weight: normal;
}

#umqaednlmw .gt_font_bold {
  font-weight: bold;
}

#umqaednlmw .gt_font_italic {
  font-style: italic;
}

#umqaednlmw .gt_super {
  font-size: 65%;
}

#umqaednlmw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#umqaednlmw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#umqaednlmw .gt_indent_1 {
  text-indent: 5px;
}

#umqaednlmw .gt_indent_2 {
  text-indent: 10px;
}

#umqaednlmw .gt_indent_3 {
  text-indent: 15px;
}

#umqaednlmw .gt_indent_4 {
  text-indent: 20px;
}

#umqaednlmw .gt_indent_5 {
  text-indent: 25px;
}

#umqaednlmw .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#umqaednlmw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>

<div id="tbl-e6-1" class="gt_table do-not-create-environment quarto-float quarto-figure quarto-figure-center anchored" data-quarto-disable-processing="false" data-quarto-postprocess="true" data-quarto-bootstrap="false">
<figure class="quarto-float quarto-subfloat-tbl figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-e6-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Minimum and maximum populations, region-wise, in 2015
</figcaption>
<div aria-describedby="tbl-e6-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-e6-1" class="gt_table do-not-create-environment caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="Region" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Region</th>
<th id="Name" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Name</th>
<th id="Total Pop 15" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Total Pop 15</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="REGION">Norteast</td>
<td class="gt_row gt_left" headers="NAME">Vermont</td>
<td class="gt_row gt_right" headers="total_pop_15">626,604</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="REGION">Midwest</td>
<td class="gt_row gt_left" headers="NAME">North Dakota</td>
<td class="gt_row gt_right" headers="total_pop_15">721,640</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="REGION">South</td>
<td class="gt_row gt_left" headers="NAME">District of Columbia</td>
<td class="gt_row gt_right" headers="total_pop_15">647,484</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="REGION">West</td>
<td class="gt_row gt_left" headers="NAME">Wyoming</td>
<td class="gt_row gt_right" headers="total_pop_15">579,679</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>

</div>
</div>
<div class="cell-output-display">
<div id="ghhngiuwgq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#ghhngiuwgq table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ghhngiuwgq thead, #ghhngiuwgq tbody, #ghhngiuwgq tfoot, #ghhngiuwgq tr, #ghhngiuwgq td, #ghhngiuwgq th {
  border-style: none;
}

#ghhngiuwgq p {
  margin: 0;
  padding: 0;
}

#ghhngiuwgq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ghhngiuwgq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ghhngiuwgq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ghhngiuwgq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ghhngiuwgq .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ghhngiuwgq .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ghhngiuwgq .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ghhngiuwgq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ghhngiuwgq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ghhngiuwgq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ghhngiuwgq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ghhngiuwgq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ghhngiuwgq .gt_spanner_row {
  border-bottom-style: hidden;
}

#ghhngiuwgq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ghhngiuwgq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#ghhngiuwgq .gt_from_md > :first-child {
  margin-top: 0;
}

#ghhngiuwgq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ghhngiuwgq .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ghhngiuwgq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#ghhngiuwgq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ghhngiuwgq .gt_row_group_first td {
  border-top-width: 2px;
}

#ghhngiuwgq .gt_row_group_first th {
  border-top-width: 2px;
}

#ghhngiuwgq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ghhngiuwgq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ghhngiuwgq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ghhngiuwgq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ghhngiuwgq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ghhngiuwgq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ghhngiuwgq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ghhngiuwgq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ghhngiuwgq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ghhngiuwgq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ghhngiuwgq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ghhngiuwgq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ghhngiuwgq .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ghhngiuwgq .gt_left {
  text-align: left;
}

#ghhngiuwgq .gt_center {
  text-align: center;
}

#ghhngiuwgq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ghhngiuwgq .gt_font_normal {
  font-weight: normal;
}

#ghhngiuwgq .gt_font_bold {
  font-weight: bold;
}

#ghhngiuwgq .gt_font_italic {
  font-style: italic;
}

#ghhngiuwgq .gt_super {
  font-size: 65%;
}

#ghhngiuwgq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ghhngiuwgq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ghhngiuwgq .gt_indent_1 {
  text-indent: 5px;
}

#ghhngiuwgq .gt_indent_2 {
  text-indent: 10px;
}

#ghhngiuwgq .gt_indent_3 {
  text-indent: 15px;
}

#ghhngiuwgq .gt_indent_4 {
  text-indent: 20px;
}

#ghhngiuwgq .gt_indent_5 {
  text-indent: 25px;
}

#ghhngiuwgq .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ghhngiuwgq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>

<div id="tbl-e6-2" class="gt_table do-not-create-environment quarto-float quarto-figure quarto-figure-center anchored" data-quarto-disable-processing="false" data-quarto-postprocess="true" data-quarto-bootstrap="false">
<figure class="quarto-float quarto-subfloat-tbl figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-e6-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Total population, region-wise, in 2015
</figcaption>
<div aria-describedby="tbl-e6-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-e6-2" class="gt_table do-not-create-environment caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="Region" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Region</th>
<th id="Total Population 2015" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Total Population 2015</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="REGION">Norteast</td>
<td class="gt_row gt_right" headers="total_population_2015">55,989,520</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="REGION">Midwest</td>
<td class="gt_row gt_right" headers="total_population_2015">67,546,398</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="REGION">South</td>
<td class="gt_row gt_right" headers="total_population_2015">118,575,377</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="REGION">West</td>
<td class="gt_row gt_right" headers="total_population_2015">72,264,052</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>

</div>
</div>
</div>
</figure>
</div>
</div>
<hr>
</section>
<section id="e7" class="level3">
<h3 class="anchored" data-anchor-id="e7">E7</h3>
<p><strong>Add variables from <code>us_states_df</code> to <code>us_states</code>, and create a new object called <code>us_states_stats</code>. What function did you use and why? Which variable is the key in both datasets? What is the class of the new object?</strong></p>
<p>The function we use to accomplish this task is <code>left_join()</code> and the key in both datasets are the state names, called <code>NAME</code> in <code>us_states</code> dataset, and <code>state</code> in <code>us_states_df</code> dataset.</p>
<p>The class of the new object depends on which object is used first on the <code>left_join()</code> function, if <code>us_states</code> (an sf object) is used first, the class of new object is <code>sf</code> . However, if the <code>us_states_df</code> (a data frame) is used first, the resulting object is a <code>data.frame</code> or <code>tibble</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb43-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(us_states_df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">join_by</span>(NAME <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> state)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb43-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>()</span>
<span id="cb43-4"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] "sf"         "data.frame"</span></span>
<span id="cb43-5"></span>
<span id="cb43-6">us_states_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb43-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(us_states, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">join_by</span>(state <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> NAME)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb43-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>()</span>
<span id="cb43-9"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] "tbl_df"     "tbl"        "data.frame"</span></span></code></pre></div>
</div>
<hr>
</section>
<section id="e8" class="level3">
<h3 class="anchored" data-anchor-id="e8">E8</h3>
<p><strong><code>us_states_df</code> has two more rows than <code>us_states</code>. How can you find them? (Hint: try to use the <a href="https://dplyr.tidyverse.org/reference/filter-joins.html"><code>dplyr::anti_join()</code></a> function.)</strong></p>
<p>The two rows that more more in <code>us_states_df</code> are shown below: —</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1">us_states_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb44-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anti_join</span>(us_states, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">join_by</span>(state <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> NAME)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb44-3">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb44-4">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_538</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb44-5">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label_with</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> snakecase<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>to_title_case)</span></code></pre></div>
<div id="tbl-e8" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-e8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: The two extra rows in <code>us_states_df</code>
</figcaption>
<div aria-describedby="tbl-e8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="rziicvdicq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#rziicvdicq table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rziicvdicq thead, #rziicvdicq tbody, #rziicvdicq tfoot, #rziicvdicq tr, #rziicvdicq td, #rziicvdicq th {
  border-style: none;
}

#rziicvdicq p {
  margin: 0;
  padding: 0;
}

#rziicvdicq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rziicvdicq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rziicvdicq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rziicvdicq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rziicvdicq .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rziicvdicq .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rziicvdicq .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rziicvdicq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rziicvdicq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rziicvdicq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rziicvdicq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rziicvdicq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rziicvdicq .gt_spanner_row {
  border-bottom-style: hidden;
}

#rziicvdicq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rziicvdicq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#rziicvdicq .gt_from_md > :first-child {
  margin-top: 0;
}

#rziicvdicq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rziicvdicq .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rziicvdicq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#rziicvdicq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rziicvdicq .gt_row_group_first td {
  border-top-width: 2px;
}

#rziicvdicq .gt_row_group_first th {
  border-top-width: 2px;
}

#rziicvdicq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rziicvdicq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rziicvdicq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rziicvdicq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rziicvdicq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rziicvdicq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rziicvdicq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rziicvdicq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rziicvdicq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rziicvdicq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rziicvdicq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rziicvdicq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rziicvdicq .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rziicvdicq .gt_left {
  text-align: left;
}

#rziicvdicq .gt_center {
  text-align: center;
}

#rziicvdicq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rziicvdicq .gt_font_normal {
  font-weight: normal;
}

#rziicvdicq .gt_font_bold {
  font-weight: bold;
}

#rziicvdicq .gt_font_italic {
  font-style: italic;
}

#rziicvdicq .gt_super {
  font-size: 65%;
}

#rziicvdicq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rziicvdicq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rziicvdicq .gt_indent_1 {
  text-indent: 5px;
}

#rziicvdicq .gt_indent_2 {
  text-indent: 10px;
}

#rziicvdicq .gt_indent_3 {
  text-indent: 15px;
}

#rziicvdicq .gt_indent_4 {
  text-indent: 20px;
}

#rziicvdicq .gt_indent_5 {
  text-indent: 25px;
}

#rziicvdicq .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#rziicvdicq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="State" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">State</th>
<th id="Median Income 10" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Median Income 10</th>
<th id="Median Income 15" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Median Income 15</th>
<th id="Poverty Level 10" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Poverty Level 10</th>
<th id="Poverty Level 15" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Poverty Level 15</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="state">Alaska</td>
<td class="gt_row gt_right" headers="median_income_10">29509</td>
<td class="gt_row gt_right" headers="median_income_15">31455</td>
<td class="gt_row gt_right" headers="poverty_level_10">64245</td>
<td class="gt_row gt_right" headers="poverty_level_15">72957</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Hawaii</td>
<td class="gt_row gt_right" headers="median_income_10">29945</td>
<td class="gt_row gt_right" headers="median_income_15">31051</td>
<td class="gt_row gt_right" headers="poverty_level_10">124627</td>
<td class="gt_row gt_right" headers="poverty_level_15">153944</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<hr>
</section>
<section id="e9" class="level3">
<h3 class="anchored" data-anchor-id="e9">E9</h3>
<p><strong>What was the population density in 2015 in each state? What was the population density in 2010 in each state?</strong></p>
<p>The Table&nbsp;6 shows the population density.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb45-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb45-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb45-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb45-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">population_density_2010 =</span> total_pop_10 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(AREA),</span>
<span id="cb45-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">population_density_2015 =</span> total_pop_15 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(AREA),</span>
<span id="cb45-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.keep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"unused"</span></span>
<span id="cb45-8">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb45-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>GEOID) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb45-10">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb45-11">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb45-12">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_espn</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb45-13">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>(</span>
<span id="cb45-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decimals =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb45-15">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb45-16">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label_with</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> snakecase<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>to_title_case)</span></code></pre></div>
</details>
<div id="tbl-e9" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-e9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6: A table showing population density in 2010 and 2015 in each state
</figcaption>
<div aria-describedby="tbl-e9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="jxauekonpt" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#jxauekonpt table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jxauekonpt thead, #jxauekonpt tbody, #jxauekonpt tfoot, #jxauekonpt tr, #jxauekonpt td, #jxauekonpt th {
  border-style: none;
}

#jxauekonpt p {
  margin: 0;
  padding: 0;
}

#jxauekonpt .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jxauekonpt .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jxauekonpt .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jxauekonpt .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jxauekonpt .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jxauekonpt .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jxauekonpt .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jxauekonpt .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jxauekonpt .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jxauekonpt .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jxauekonpt .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jxauekonpt .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jxauekonpt .gt_spanner_row {
  border-bottom-style: hidden;
}

#jxauekonpt .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jxauekonpt .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jxauekonpt .gt_from_md > :first-child {
  margin-top: 0;
}

#jxauekonpt .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jxauekonpt .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jxauekonpt .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jxauekonpt .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jxauekonpt .gt_row_group_first td {
  border-top-width: 2px;
}

#jxauekonpt .gt_row_group_first th {
  border-top-width: 2px;
}

#jxauekonpt .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jxauekonpt .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jxauekonpt .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jxauekonpt .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jxauekonpt .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jxauekonpt .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jxauekonpt .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jxauekonpt .gt_striped {
  background-color: #FAFAFA;
}

#jxauekonpt .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jxauekonpt .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jxauekonpt .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jxauekonpt .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jxauekonpt .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jxauekonpt .gt_left {
  text-align: left;
}

#jxauekonpt .gt_center {
  text-align: center;
}

#jxauekonpt .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jxauekonpt .gt_font_normal {
  font-weight: normal;
}

#jxauekonpt .gt_font_bold {
  font-weight: bold;
}

#jxauekonpt .gt_font_italic {
  font-style: italic;
}

#jxauekonpt .gt_super {
  font-size: 65%;
}

#jxauekonpt .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jxauekonpt .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jxauekonpt .gt_indent_1 {
  text-indent: 5px;
}

#jxauekonpt .gt_indent_2 {
  text-indent: 10px;
}

#jxauekonpt .gt_indent_3 {
  text-indent: 15px;
}

#jxauekonpt .gt_indent_4 {
  text-indent: 20px;
}

#jxauekonpt .gt_indent_5 {
  text-indent: 25px;
}

#jxauekonpt .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#jxauekonpt div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="jxauekonpt" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="jxauekonpt">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"NAME":["Alabama","Arizona","Colorado","Connecticut","Florida","Georgia","Idaho","Indiana","Kansas","Louisiana","Massachusetts","Minnesota","Missouri","Montana","Nevada","New Jersey","New York","North Dakota","Oklahoma","Pennsylvania","South Carolina","South Dakota","Texas","Vermont","West Virginia","Arkansas","California","Delaware","District of Columbia","Illinois","Iowa","Kentucky","Maine","Maryland","Michigan","Mississippi","Nebraska","New Hampshire","New Mexico","North Carolina","Ohio","Oregon","Rhode Island","Tennessee","Utah","Virginia","Washington","Wisconsin","Wyoming"],"REGION":["South","West","West","Norteast","South","South","West","Midwest","Midwest","South","Norteast","Midwest","Midwest","West","West","Norteast","Norteast","Midwest","South","Norteast","South","Midwest","South","Norteast","South","South","West","South","South","Midwest","Midwest","South","Norteast","South","Midwest","South","Midwest","Norteast","West","South","Midwest","West","Norteast","South","West","South","West","Midwest","West"],"population_density_2010":[35.2455062155994,21.1554776934259,18.1288925599977,273.248787851967,122.551302651402,61.9990293874535,7.05176782570392,68.5265134388798,13.1870421652331,36.2083647394599,309.749575062158,23.9831548616216,32.771334634104,2.55689180372898,9.19575649028921,430.19229100202,151.174915659046,3.60228091420056,20.3089496545739,107.57796435811,55.7630195534436,4.00197562829728,35.3517320608069,25.1047229234309,29.3059258992919,20.8634375390697,89.4144027631312,170.070352571492,3279.27688882004,87.3011013739212,20.6956966291401,41.0292695677935,15.5246585554078,212.167384177209,65.8599260353045,23.7746744195534,8.98339244237298,54.6871218916389,6.39317524771536,71.740160082088,107.541193575778,14.9671027216726,385.113820057529,57.141830766349,12.0860477325452,74.3966527211482,37.3999362639842,38.8946381994903,2.15380344081465],"population_density_2015":[36.1277860879574,22.4935646648374,19.5824688311292,276.900363999535,130.059657133867,65.5208971110139,7.46629324221766,70.1415651433386,13.579734360935,37.8047665738771,320.676490520251,24.7941529209767,33.4527009917196,2.66444658820484,9.77301188531067,439.210687298658,154.660882792235,3.93955972182453,21.2726046986554,109.001117731237,59.0527132220802,4.22087082315856,38.5895926973833,25.1990680178924,29.4749665246273,21.4845725584771,93.768732808708,178.788484929011,3633.26371848178,88.1806086532857,21.225798515303,42.0969254066532,15.5414383040846,220.887166248633,65.515058774307,24.147134683367,9.33411486863702,55.1142339910987,6.61863772674621,76.1829581398894,108.134796498303,15.6725359903779,384.119309038276,59.5672504456195,13.2055930220986,78.332683575258,39.8177232907391,39.6132782401365,2.28842133727287]},"columns":[{"id":"NAME","name":"Name","type":"character","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left","headerStyle":{"font-weight":"normal"}},{"id":"REGION","name":"Region","type":"factor","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"center","headerStyle":{"font-weight":"normal"}},{"id":"population_density_2010","name":"Population Density 2010","type":"numeric","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["35.2","21.2","18.1","273.2","122.6","62.0","7.1","68.5","13.2","36.2","309.7","24.0","32.8","2.6","9.2","430.2","151.2","3.6","20.3","107.6","55.8","4.0","35.4","25.1","29.3","20.9","89.4","170.1","3,279.3","87.3","20.7","41.0","15.5","212.2","65.9","23.8","9.0","54.7","6.4","71.7","107.5","15.0","385.1","57.1","12.1","74.4","37.4","38.9","2.2"],"html":true,"align":"right","headerStyle":{"font-weight":"normal"}},{"id":"population_density_2015","name":"Population Density 2015","type":"numeric","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["36.1","22.5","19.6","276.9","130.1","65.5","7.5","70.1","13.6","37.8","320.7","24.8","33.5","2.7","9.8","439.2","154.7","3.9","21.3","109.0","59.1","4.2","38.6","25.2","29.5","21.5","93.8","178.8","3,633.3","88.2","21.2","42.1","15.5","220.9","65.5","24.1","9.3","55.1","6.6","76.2","108.1","15.7","384.1","59.6","13.2","78.3","39.8","39.6","2.3"],"html":true,"align":"right","headerStyle":{"font-weight":"normal"}}],"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"striped":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"#fafafa","style":{"fontFamily":"Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"}},"elementId":"jxauekonpt","dataKey":"9efb56d490c8761af53ee104b65af28d"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>
<hr>
</section>
<section id="e10" class="level3">
<h3 class="anchored" data-anchor-id="e10">E10</h3>
<p><strong>How much has population density changed between 2010 and 2015 in each state? Calculate the change in percentages and map them.</strong></p>
<p>The Table&nbsp;7 shows how much the population density has changed between 2010 and 2015 in each state. The Figure&nbsp;1 shows the percentage change in a map of the US.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb46-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb46-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb46-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb46-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">population_density_2010 =</span> total_pop_10 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(AREA),</span>
<span id="cb46-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">population_density_2015 =</span> total_pop_15 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(AREA),</span>
<span id="cb46-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">change_in_density =</span> (population_density_2015 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> population_density_2010)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>population_density_2010,</span>
<span id="cb46-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.keep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"unused"</span></span>
<span id="cb46-9">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb46-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>GEOID) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb46-11">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb46-12">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb46-13">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_espn</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb46-14">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>(</span>
<span id="cb46-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decimals =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb46-16">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb46-17">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_percent</span>(</span>
<span id="cb46-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> change_in_density</span>
<span id="cb46-19">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb46-20">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label_with</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> snakecase<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>to_title_case)</span></code></pre></div>
</details>
<div id="tbl-e10" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-e10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7: Table showing change in population density between 2010 and 2015
</figcaption>
<div aria-describedby="tbl-e10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="alpbljfmss" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#alpbljfmss table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#alpbljfmss thead, #alpbljfmss tbody, #alpbljfmss tfoot, #alpbljfmss tr, #alpbljfmss td, #alpbljfmss th {
  border-style: none;
}

#alpbljfmss p {
  margin: 0;
  padding: 0;
}

#alpbljfmss .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#alpbljfmss .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#alpbljfmss .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#alpbljfmss .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#alpbljfmss .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#alpbljfmss .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#alpbljfmss .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#alpbljfmss .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#alpbljfmss .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#alpbljfmss .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#alpbljfmss .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#alpbljfmss .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#alpbljfmss .gt_spanner_row {
  border-bottom-style: hidden;
}

#alpbljfmss .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#alpbljfmss .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#alpbljfmss .gt_from_md > :first-child {
  margin-top: 0;
}

#alpbljfmss .gt_from_md > :last-child {
  margin-bottom: 0;
}

#alpbljfmss .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#alpbljfmss .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#alpbljfmss .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#alpbljfmss .gt_row_group_first td {
  border-top-width: 2px;
}

#alpbljfmss .gt_row_group_first th {
  border-top-width: 2px;
}

#alpbljfmss .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#alpbljfmss .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#alpbljfmss .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#alpbljfmss .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#alpbljfmss .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#alpbljfmss .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#alpbljfmss .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#alpbljfmss .gt_striped {
  background-color: #FAFAFA;
}

#alpbljfmss .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#alpbljfmss .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#alpbljfmss .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#alpbljfmss .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#alpbljfmss .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#alpbljfmss .gt_left {
  text-align: left;
}

#alpbljfmss .gt_center {
  text-align: center;
}

#alpbljfmss .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#alpbljfmss .gt_font_normal {
  font-weight: normal;
}

#alpbljfmss .gt_font_bold {
  font-weight: bold;
}

#alpbljfmss .gt_font_italic {
  font-style: italic;
}

#alpbljfmss .gt_super {
  font-size: 65%;
}

#alpbljfmss .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#alpbljfmss .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#alpbljfmss .gt_indent_1 {
  text-indent: 5px;
}

#alpbljfmss .gt_indent_2 {
  text-indent: 10px;
}

#alpbljfmss .gt_indent_3 {
  text-indent: 15px;
}

#alpbljfmss .gt_indent_4 {
  text-indent: 20px;
}

#alpbljfmss .gt_indent_5 {
  text-indent: 25px;
}

#alpbljfmss .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#alpbljfmss div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="alpbljfmss" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="alpbljfmss">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"NAME":["Alabama","Arizona","Colorado","Connecticut","Florida","Georgia","Idaho","Indiana","Kansas","Louisiana","Massachusetts","Minnesota","Missouri","Montana","Nevada","New Jersey","New York","North Dakota","Oklahoma","Pennsylvania","South Carolina","South Dakota","Texas","Vermont","West Virginia","Arkansas","California","Delaware","District of Columbia","Illinois","Iowa","Kentucky","Maine","Maryland","Michigan","Mississippi","Nebraska","New Hampshire","New Mexico","North Carolina","Ohio","Oregon","Rhode Island","Tennessee","Utah","Virginia","Washington","Wisconsin","Wyoming"],"REGION":["South","West","West","Norteast","South","South","West","Midwest","Midwest","South","Norteast","Midwest","Midwest","West","West","Norteast","Norteast","Midwest","South","Norteast","South","Midwest","South","Norteast","South","South","West","South","South","Midwest","Midwest","South","Norteast","South","Midwest","South","Midwest","Norteast","West","South","Midwest","West","Norteast","South","West","South","West","Midwest","West"],"population_density_2010":[35.2455062155994,21.1554776934259,18.1288925599977,273.248787851967,122.551302651402,61.9990293874535,7.05176782570392,68.5265134388798,13.1870421652331,36.2083647394599,309.749575062158,23.9831548616216,32.771334634104,2.55689180372898,9.19575649028921,430.19229100202,151.174915659046,3.60228091420056,20.3089496545739,107.57796435811,55.7630195534436,4.00197562829728,35.3517320608069,25.1047229234309,29.3059258992919,20.8634375390697,89.4144027631312,170.070352571492,3279.27688882004,87.3011013739212,20.6956966291401,41.0292695677935,15.5246585554078,212.167384177209,65.8599260353045,23.7746744195534,8.98339244237298,54.6871218916389,6.39317524771536,71.740160082088,107.541193575778,14.9671027216726,385.113820057529,57.141830766349,12.0860477325452,74.3966527211482,37.3999362639842,38.8946381994903,2.15380344081465],"population_density_2015":[36.1277860879574,22.4935646648374,19.5824688311292,276.900363999535,130.059657133867,65.5208971110139,7.46629324221766,70.1415651433386,13.579734360935,37.8047665738771,320.676490520251,24.7941529209767,33.4527009917196,2.66444658820484,9.77301188531067,439.210687298658,154.660882792235,3.93955972182453,21.2726046986554,109.001117731237,59.0527132220802,4.22087082315856,38.5895926973833,25.1990680178924,29.4749665246273,21.4845725584771,93.768732808708,178.788484929011,3633.26371848178,88.1806086532857,21.225798515303,42.0969254066532,15.5414383040846,220.887166248633,65.515058774307,24.147134683367,9.33411486863702,55.1142339910987,6.61863772674621,76.1829581398894,108.134796498303,15.6725359903779,384.119309038276,59.5672504456195,13.2055930220986,78.332683575258,39.8177232907391,39.6132782401365,2.28842133727287],"change_in_density":[0.0250324074496498,0.0632501421524182,0.0801800918793524,0.0133635584489642,0.0612670311944605,0.0568052074097973,0.0587831912166451,0.0235682748677891,0.0297786410918764,0.0440893104647016,0.035276611617305,0.0338153201292504,0.020791535200599,0.042064660037238,0.0627741062555374,0.0209636399472251,0.0230591637375251,0.0936292353809456,0.0474497726604267,0.0132290416686983,0.0589941809998963,0.0546967835869622,0.0915898726265267,0.00375806157069671,0.00576813801810305,0.0297714611144142,0.0486983071073215,0.0512619173518457,0.107946611909651,0.0100744121840742,0.0256141117480648,0.0260218095546532,0.00108084494205992,0.0410985981904784,-0.00523637486037683,0.0156662613855718,0.0390412005836171,0.00781010381760501,0.0352661189932851,0.0619290234746868,0.00551977249635632,0.0471322527695263,-0.00258238205812448,0.0424456067777733,0.0926312152928832,0.0529060207703532,0.064646822114591,0.018476583763558,0.0625024057010992]},"columns":[{"id":"NAME","name":"Name","type":"character","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left","headerStyle":{"font-weight":"normal"}},{"id":"REGION","name":"Region","type":"factor","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"center","headerStyle":{"font-weight":"normal"}},{"id":"population_density_2010","name":"Population Density 2010","type":"numeric","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["35.2","21.2","18.1","273.2","122.6","62.0","7.1","68.5","13.2","36.2","309.7","24.0","32.8","2.6","9.2","430.2","151.2","3.6","20.3","107.6","55.8","4.0","35.4","25.1","29.3","20.9","89.4","170.1","3,279.3","87.3","20.7","41.0","15.5","212.2","65.9","23.8","9.0","54.7","6.4","71.7","107.5","15.0","385.1","57.1","12.1","74.4","37.4","38.9","2.2"],"html":true,"align":"right","headerStyle":{"font-weight":"normal"}},{"id":"population_density_2015","name":"Population Density 2015","type":"numeric","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["36.1","22.5","19.6","276.9","130.1","65.5","7.5","70.1","13.6","37.8","320.7","24.8","33.5","2.7","9.8","439.2","154.7","3.9","21.3","109.0","59.1","4.2","38.6","25.2","29.5","21.5","93.8","178.8","3,633.3","88.2","21.2","42.1","15.5","220.9","65.5","24.1","9.3","55.1","6.6","76.2","108.1","15.7","384.1","59.6","13.2","78.3","39.8","39.6","2.3"],"html":true,"align":"right","headerStyle":{"font-weight":"normal"}},{"id":"change_in_density","name":"Change in Density","type":"numeric","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["2.50%","6.33%","8.02%","1.34%","6.13%","5.68%","5.88%","2.36%","2.98%","4.41%","3.53%","3.38%","2.08%","4.21%","6.28%","2.10%","2.31%","9.36%","4.74%","1.32%","5.90%","5.47%","9.16%","0.38%","0.58%","2.98%","4.87%","5.13%","10.79%","1.01%","2.56%","2.60%","0.11%","4.11%","−0.52%","1.57%","3.90%","0.78%","3.53%","6.19%","0.55%","4.71%","−0.26%","4.24%","9.26%","5.29%","6.46%","1.85%","6.25%"],"html":true,"align":"right","headerStyle":{"font-weight":"normal"}}],"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"striped":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"#fafafa","style":{"fontFamily":"Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"}},"elementId":"alpbljfmss","dataKey":"abee78ac07c3f015164b21eb3963c378"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style","tag.attribs.columns.4.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb47-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb47-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">population_density_2010 =</span> total_pop_10 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(AREA),</span>
<span id="cb47-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">population_density_2015 =</span> total_pop_15 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(AREA),</span>
<span id="cb47-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">change_in_density =</span> (population_density_2015 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> population_density_2010)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>population_density_2010,</span>
<span id="cb47-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.keep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"unused"</span></span>
<span id="cb47-7">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb47-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb47-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb47-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb47-11">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> change_in_density</span>
<span id="cb47-12">    )</span>
<span id="cb47-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb47-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf_text</span>(</span>
<span id="cb47-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb47-16">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb47-17">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(</span>
<span id="cb47-18">          change_in_density <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,</span>
<span id="cb47-19">          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb47-20">        ),</span>
<span id="cb47-21">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%"</span></span>
<span id="cb47-22">      )</span>
<span id="cb47-23">    ),</span>
<span id="cb47-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb47-25">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb47-26">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb47-27">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggthemes::Red-Green Diverging"</span>,</span>
<span id="cb47-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_percent</span>(),</span>
<span id="cb47-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Change in population density between 2010 and 2015"</span>,</span>
<span id="cb47-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span>
<span id="cb47-31">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb47-32">  ggthemes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_map</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb47-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb47-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb47-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span></span>
<span id="cb47-36">  )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-e10" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-e10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter3_files/figure-html/fig-e10-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;1: Map of the change in population density"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter3_files/figure-html/fig-e10-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-e10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Map of the change in population density
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="e11" class="level3">
<h3 class="anchored" data-anchor-id="e11">E11</h3>
<p><strong>Change the columns’ names in <code>us_states</code> to lowercase. (Hint: helper functions - <a href="https://rdrr.io/r/base/chartr.html"><code>tolower()</code></a> and <a href="https://rdrr.io/r/base/colnames.html"><code>colnames()</code></a> may help.)</strong></p>
<p>A very easy method is using the <code>janitor</code> package and the function <code>clean_names()</code></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb48-2">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb48-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb48-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 49 × 7
  geoid name   region   area total_pop_10 total_pop_15                  geometry
  &lt;chr&gt; &lt;chr&gt;  &lt;fct&gt;  [km^2]        &lt;dbl&gt;        &lt;dbl&gt;        &lt;MULTIPOLYGON [°]&gt;
1 01    Alaba… South  1.34e5      4712651      4830620 (((-88.20006 34.99563, -…
2 04    Arizo… West   2.95e5      6246816      6641928 (((-114.7196 32.71876, -…
3 08    Color… West   2.70e5      4887061      5278906 (((-109.0501 41.00066, -…
4 09    Conne… Norte… 1.30e4      3545837      3593222 (((-73.48731 42.04964, -…
5 12    Flori… South  1.51e5     18511620     19645772 (((-81.81169 24.56874, -…
# ℹ 44 more rows</code></pre>
</div>
</div>
<hr>
</section>
<section id="e12" class="level3">
<h3 class="anchored" data-anchor-id="e12">E12</h3>
<p><strong>Using <code>us_states</code> and <code>us_states_df</code> create a new object called <code>us_states_sel</code>. The new object should have only two variables: <code>median_income_15</code> and <code>geometry</code>. Change the name of the <code>median_income_15</code> column to <code>Income</code>.</strong></p>
<p>The new object <code>us_states_sel</code> is created as shown below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1">us_states_sel <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb50-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(us_states_df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">join_by</span>(NAME <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> state)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb50-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Income =</span> median_income_15, geometry)</span>
<span id="cb50-4"></span>
<span id="cb50-5">us_states_sel</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 49 features and 1 field
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -124.7042 ymin: 24.55868 xmax: -66.9824 ymax: 49.38436
Geodetic CRS:  NAD83
First 10 features:
   Income                       geometry
1   22890 MULTIPOLYGON (((-88.20006 3...
2   26156 MULTIPOLYGON (((-114.7196 3...
3   30752 MULTIPOLYGON (((-109.0501 4...
4   33226 MULTIPOLYGON (((-73.48731 4...
5   24654 MULTIPOLYGON (((-81.81169 2...
6   25588 MULTIPOLYGON (((-85.60516 3...
7   23558 MULTIPOLYGON (((-116.916 45...
8   25834 MULTIPOLYGON (((-87.52404 4...
9   27315 MULTIPOLYGON (((-102.0517 4...
10  24014 MULTIPOLYGON (((-92.01783 2...</code></pre>
</div>
</div>
<hr>
</section>
<section id="e13" class="level3">
<h3 class="anchored" data-anchor-id="e13">E13</h3>
<p><strong>Calculate the change in the number of residents living below the poverty level between 2010 and 2015 for each state. (Hint: See <code>?us_states_df</code> for documentation on the poverty level columns.) Bonus: Calculate the change in the <em>percentage</em> of residents living below the poverty level in each state.</strong></p>
<p>The Table&nbsp;8 shows the change in the number of residents living below the poverty level between 2010 and 2015 for each state.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1">us_states_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb52-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb52-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">change_in_poverty =</span> poverty_level_15 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> poverty_level_10</span>
<span id="cb52-4">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb52-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(state, change_in_poverty) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb52-6">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb52-7">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decimals =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb52-8">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label_with</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> snakecase<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>to_title_case) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb52-9">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>() </span></code></pre></div>
</details>
<div id="tbl-e13-a" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-e13-a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8: The change in the number of residents living below the poverty level between 2010 and 2015 for each state
</figcaption>
<div aria-describedby="tbl-e13-a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="ucvfgzyblo" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ucvfgzyblo table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ucvfgzyblo thead, #ucvfgzyblo tbody, #ucvfgzyblo tfoot, #ucvfgzyblo tr, #ucvfgzyblo td, #ucvfgzyblo th {
  border-style: none;
}

#ucvfgzyblo p {
  margin: 0;
  padding: 0;
}

#ucvfgzyblo .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ucvfgzyblo .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ucvfgzyblo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ucvfgzyblo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ucvfgzyblo .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ucvfgzyblo .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ucvfgzyblo .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ucvfgzyblo .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ucvfgzyblo .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ucvfgzyblo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ucvfgzyblo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ucvfgzyblo .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ucvfgzyblo .gt_spanner_row {
  border-bottom-style: hidden;
}

#ucvfgzyblo .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ucvfgzyblo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ucvfgzyblo .gt_from_md > :first-child {
  margin-top: 0;
}

#ucvfgzyblo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ucvfgzyblo .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ucvfgzyblo .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ucvfgzyblo .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ucvfgzyblo .gt_row_group_first td {
  border-top-width: 2px;
}

#ucvfgzyblo .gt_row_group_first th {
  border-top-width: 2px;
}

#ucvfgzyblo .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ucvfgzyblo .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ucvfgzyblo .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ucvfgzyblo .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ucvfgzyblo .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ucvfgzyblo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ucvfgzyblo .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ucvfgzyblo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ucvfgzyblo .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ucvfgzyblo .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ucvfgzyblo .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ucvfgzyblo .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ucvfgzyblo .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ucvfgzyblo .gt_left {
  text-align: left;
}

#ucvfgzyblo .gt_center {
  text-align: center;
}

#ucvfgzyblo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ucvfgzyblo .gt_font_normal {
  font-weight: normal;
}

#ucvfgzyblo .gt_font_bold {
  font-weight: bold;
}

#ucvfgzyblo .gt_font_italic {
  font-style: italic;
}

#ucvfgzyblo .gt_super {
  font-size: 65%;
}

#ucvfgzyblo .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ucvfgzyblo .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ucvfgzyblo .gt_indent_1 {
  text-indent: 5px;
}

#ucvfgzyblo .gt_indent_2 {
  text-indent: 10px;
}

#ucvfgzyblo .gt_indent_3 {
  text-indent: 15px;
}

#ucvfgzyblo .gt_indent_4 {
  text-indent: 20px;
}

#ucvfgzyblo .gt_indent_5 {
  text-indent: 25px;
}

#ucvfgzyblo .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ucvfgzyblo div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="ucvfgzyblo" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="ucvfgzyblo">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"state":["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","District of Columbia","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"],"change_in_poverty":[100716,8712,247577,50960,1215197,69785,52045,14458,8598,677744,343195,29317,42000,229070,135503,35620,42561,70059,107921,17920,100073,90514,172866,54529,47273,113376,12477,24888,117911,14313,166879,67590,355777,267520,1353,189544,46796,120676,156711,20827,114364,9088,115127,500397,68065,2507,140306,128503,12889,86735,12698]},"columns":[{"id":"state","name":"State","type":"character","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left","headerStyle":{"font-weight":"normal"}},{"id":"change_in_poverty","name":"Change in Poverty","type":"numeric","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["100,716","8,712","247,577","50,960","1,215,197","69,785","52,045","14,458","8,598","677,744","343,195","29,317","42,000","229,070","135,503","35,620","42,561","70,059","107,921","17,920","100,073","90,514","172,866","54,529","47,273","113,376","12,477","24,888","117,911","14,313","166,879","67,590","355,777","267,520","1,353","189,544","46,796","120,676","156,711","20,827","114,364","9,088","115,127","500,397","68,065","2,507","140,306","128,503","12,889","86,735","12,698"],"html":true,"align":"right","headerStyle":{"font-weight":"normal"}}],"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"rgba(128,128,128,0.05)","style":{"fontFamily":"system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"}},"elementId":"ucvfgzyblo","dataKey":"c7487f3a976b6a26dfa0d25133c1c26e"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>The Table&nbsp;9 shows the change in the <em>percentage</em> of residents living below the poverty level in each state.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb53-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb53-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(us_states_df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">join_by</span>(NAME <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> state)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb53-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb53-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb53-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">state =</span> NAME,</span>
<span id="cb53-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">poverty_2010 =</span> poverty_level_10 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> total_pop_10,</span>
<span id="cb53-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">poverty_2015 =</span> poverty_level_15 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> total_pop_15,</span>
<span id="cb53-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">change_in_poverty =</span> poverty_2015 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> poverty_2010,</span>
<span id="cb53-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.keep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span></span>
<span id="cb53-11">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb53-12">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb53-13">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_percent</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb53-14">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label_with</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> snakecase<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>to_title_case) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb53-15">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>()</span></code></pre></div>
</details>
<div id="tbl-e13-b" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-e13-b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9: Table showing the change in the percentage of residents living below the poverty level in each state.
</figcaption>
<div aria-describedby="tbl-e13-b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="pphqdixxxt" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#pphqdixxxt table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pphqdixxxt thead, #pphqdixxxt tbody, #pphqdixxxt tfoot, #pphqdixxxt tr, #pphqdixxxt td, #pphqdixxxt th {
  border-style: none;
}

#pphqdixxxt p {
  margin: 0;
  padding: 0;
}

#pphqdixxxt .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pphqdixxxt .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pphqdixxxt .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pphqdixxxt .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pphqdixxxt .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pphqdixxxt .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pphqdixxxt .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pphqdixxxt .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pphqdixxxt .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pphqdixxxt .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pphqdixxxt .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pphqdixxxt .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pphqdixxxt .gt_spanner_row {
  border-bottom-style: hidden;
}

#pphqdixxxt .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pphqdixxxt .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pphqdixxxt .gt_from_md > :first-child {
  margin-top: 0;
}

#pphqdixxxt .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pphqdixxxt .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pphqdixxxt .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#pphqdixxxt .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pphqdixxxt .gt_row_group_first td {
  border-top-width: 2px;
}

#pphqdixxxt .gt_row_group_first th {
  border-top-width: 2px;
}

#pphqdixxxt .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pphqdixxxt .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pphqdixxxt .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pphqdixxxt .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pphqdixxxt .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pphqdixxxt .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pphqdixxxt .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pphqdixxxt .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pphqdixxxt .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pphqdixxxt .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pphqdixxxt .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pphqdixxxt .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pphqdixxxt .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pphqdixxxt .gt_left {
  text-align: left;
}

#pphqdixxxt .gt_center {
  text-align: center;
}

#pphqdixxxt .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pphqdixxxt .gt_font_normal {
  font-weight: normal;
}

#pphqdixxxt .gt_font_bold {
  font-weight: bold;
}

#pphqdixxxt .gt_font_italic {
  font-style: italic;
}

#pphqdixxxt .gt_super {
  font-size: 65%;
}

#pphqdixxxt .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pphqdixxxt .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pphqdixxxt .gt_indent_1 {
  text-indent: 5px;
}

#pphqdixxxt .gt_indent_2 {
  text-indent: 10px;
}

#pphqdixxxt .gt_indent_3 {
  text-indent: 15px;
}

#pphqdixxxt .gt_indent_4 {
  text-indent: 20px;
}

#pphqdixxxt .gt_indent_5 {
  text-indent: 25px;
}

#pphqdixxxt .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#pphqdixxxt div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="pphqdixxxt" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="pphqdixxxt">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"state":["Alabama","Arizona","Colorado","Connecticut","Florida","Georgia","Idaho","Indiana","Kansas","Louisiana","Massachusetts","Minnesota","Missouri","Montana","Nevada","New Jersey","New York","North Dakota","Oklahoma","Pennsylvania","South Carolina","South Dakota","Texas","Vermont","West Virginia","Arkansas","California","Delaware","District of Columbia","Illinois","Iowa","Kentucky","Maine","Maryland","Michigan","Mississippi","Nebraska","New Hampshire","New Mexico","North Carolina","Ohio","Oregon","Rhode Island","Tennessee","Utah","Virginia","Washington","Wisconsin","Wyoming"],"poverty_2010":[0.16690054069355,0.149374177180823,0.119536875025706,0.0886408484089934,0.135178066533345,0.152685631728997,0.133074010493864,0.131289971418322,0.120595345009431,0.176155658993124,0.101649103240094,0.103422719258652,0.135520676546363,0.141833694655344,0.117123901249026,0.0892003819951369,0.137815921911005,0.118821019067739,0.157059525665524,0.119709293129428,0.158827094214958,0.132362763958762,0.163379064178924,0.106888498024855,0.168673762849019,0.174987572597613,0.134287907211478,0.106501013301138,0.174139288158795,0.123342779124543,0.112146239043162,0.171677911479415,0.122288378468966,0.0836897119473045,0.145086849410616,0.205395597743161,0.114626276662266,0.0757470476178879,0.179706446007743,0.150999689575586,0.137789490334405,0.137235856642543,0.116809243564634,0.160781418605517,0.106703356419979,0.0996608666887536,0.118880306744231,0.113093117051295,0.0958559621979585],"poverty_2015":[0.183674145347802,0.177763143472799,0.123883433423516,0.101956127397639,0.161872437489349,0.178775045861805,0.151667102781422,0.148895700711486,0.131819811150206,0.192050034884578,0.111683751427541,0.110102080189018,0.151514329459124,0.148404600773234,0.152337424373874,0.106109970415793,0.152794002635264,0.11052325259132,0.162100332672422,0.130408960121394,0.173916856581664,0.136276521305993,0.168526170959795,0.110489240413403,0.174668092599194,0.187155196659599,0.159680068411761,0.116913521880201,0.170452088391373,0.139906123781543,0.120859821446466,0.183255926917853,0.13563915431495,0.0972601473930358,0.163310782782124,0.218047971256469,0.123632891382903,0.0859688219537668,0.206015785102276,0.169366033632382,0.153407008324222,0.161693151941,0.136877990169514,0.171947723057443,0.121100621035008,0.111646276991945,0.130057502264703,0.1261465065933,0.112122398775874],"change_in_poverty":[0.016773604654252,0.0283889662919759,0.00434655839781052,0.0133152789886458,0.0266943709560039,0.026089414132808,0.0185930922875584,0.0176057292931637,0.0112244661407746,0.0158943758914541,0.0100346481874471,0.00667936093036536,0.0159936529127602,0.00657090611789024,0.0352135231248471,0.0169095884206558,0.0149780807242582,-0.00829776647641904,0.00504080700689805,0.010699666991966,0.0150897623667059,0.00391375734723046,0.00514710678087085,0.00360074238854793,0.00599432975017505,0.0121676240619868,0.025392161200283,0.0104125085790636,-0.00368719976742196,0.0165633446570004,0.0087135824033043,0.0115780154384372,0.0133507758459838,0.0135704354457314,0.0182239333715079,0.0126523735133076,0.00900661472063637,0.010221774335879,0.0263093390945327,0.0183663440567962,0.0156175179898172,0.0244572952984563,0.0200687466048799,0.0111663044519261,0.0143972646150286,0.0119854103031911,0.0111771955204722,0.0130533895420045,0.0162664365779157]},"columns":[{"id":"state","name":"State","type":"character","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left","headerStyle":{"font-weight":"normal"}},{"id":"poverty_2010","name":"Poverty 2010","type":"numeric","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["16.69%","14.94%","11.95%","8.86%","13.52%","15.27%","13.31%","13.13%","12.06%","17.62%","10.16%","10.34%","13.55%","14.18%","11.71%","8.92%","13.78%","11.88%","15.71%","11.97%","15.88%","13.24%","16.34%","10.69%","16.87%","17.50%","13.43%","10.65%","17.41%","12.33%","11.21%","17.17%","12.23%","8.37%","14.51%","20.54%","11.46%","7.57%","17.97%","15.10%","13.78%","13.72%","11.68%","16.08%","10.67%","9.97%","11.89%","11.31%","9.59%"],"html":true,"align":"right","headerStyle":{"font-weight":"normal"}},{"id":"poverty_2015","name":"Poverty 2015","type":"numeric","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["18.37%","17.78%","12.39%","10.20%","16.19%","17.88%","15.17%","14.89%","13.18%","19.21%","11.17%","11.01%","15.15%","14.84%","15.23%","10.61%","15.28%","11.05%","16.21%","13.04%","17.39%","13.63%","16.85%","11.05%","17.47%","18.72%","15.97%","11.69%","17.05%","13.99%","12.09%","18.33%","13.56%","9.73%","16.33%","21.80%","12.36%","8.60%","20.60%","16.94%","15.34%","16.17%","13.69%","17.19%","12.11%","11.16%","13.01%","12.61%","11.21%"],"html":true,"align":"right","headerStyle":{"font-weight":"normal"}},{"id":"change_in_poverty","name":"Change in Poverty","type":"numeric","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1.68%","2.84%","0.43%","1.33%","2.67%","2.61%","1.86%","1.76%","1.12%","1.59%","1.00%","0.67%","1.60%","0.66%","3.52%","1.69%","1.50%","−0.83%","0.50%","1.07%","1.51%","0.39%","0.51%","0.36%","0.60%","1.22%","2.54%","1.04%","−0.37%","1.66%","0.87%","1.16%","1.34%","1.36%","1.82%","1.27%","0.90%","1.02%","2.63%","1.84%","1.56%","2.45%","2.01%","1.12%","1.44%","1.20%","1.12%","1.31%","1.63%"],"html":true,"align":"right","headerStyle":{"font-weight":"normal"}}],"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"rgba(128,128,128,0.05)","style":{"fontFamily":"system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"}},"elementId":"pphqdixxxt","dataKey":"3c82ceb62f643ab88b7629dbb60a572c"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>
<hr>
</section>
<section id="e14" class="level3">
<h3 class="anchored" data-anchor-id="e14">E14</h3>
<p><strong>What was the minimum, average and maximum state’s number of people living below the poverty line in 2015 for each region? Bonus: What is the region with the largest increase in people living below the poverty line?</strong></p>
<p>The the minimum, average and maximum state’s number of people living below the poverty line in 2015 for each region are shown in Table&nbsp;10 below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb54-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb54-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">state =</span> NAME, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">region =</span> REGION) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb54-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(us_states_df) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb54-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb54-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(region) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb54-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb54-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">minimum_poverty_2015 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(poverty_level_15),</span>
<span id="cb54-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">maximum_poverty_2015 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(poverty_level_15),</span>
<span id="cb54-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">average_poverty_2015 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(poverty_level_15)</span>
<span id="cb54-11">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb54-12">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb54-13">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label_with</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> snakecase<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>to_title_case) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb54-14">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decimals =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span></code></pre></div>
</details>
<div id="tbl-e14-a" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-e14-a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;10: A table showing the minimum, average and maximum state’s number of people living below the poverty line in 2015 for each region
</figcaption>
<div aria-describedby="tbl-e14-a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="vgjmqijyhf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vgjmqijyhf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vgjmqijyhf thead, #vgjmqijyhf tbody, #vgjmqijyhf tfoot, #vgjmqijyhf tr, #vgjmqijyhf td, #vgjmqijyhf th {
  border-style: none;
}

#vgjmqijyhf p {
  margin: 0;
  padding: 0;
}

#vgjmqijyhf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vgjmqijyhf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vgjmqijyhf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vgjmqijyhf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vgjmqijyhf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vgjmqijyhf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vgjmqijyhf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vgjmqijyhf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vgjmqijyhf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vgjmqijyhf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vgjmqijyhf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vgjmqijyhf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vgjmqijyhf .gt_spanner_row {
  border-bottom-style: hidden;
}

#vgjmqijyhf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vgjmqijyhf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vgjmqijyhf .gt_from_md > :first-child {
  margin-top: 0;
}

#vgjmqijyhf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vgjmqijyhf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vgjmqijyhf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vgjmqijyhf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vgjmqijyhf .gt_row_group_first td {
  border-top-width: 2px;
}

#vgjmqijyhf .gt_row_group_first th {
  border-top-width: 2px;
}

#vgjmqijyhf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vgjmqijyhf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vgjmqijyhf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vgjmqijyhf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vgjmqijyhf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vgjmqijyhf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vgjmqijyhf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vgjmqijyhf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vgjmqijyhf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vgjmqijyhf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vgjmqijyhf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vgjmqijyhf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vgjmqijyhf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vgjmqijyhf .gt_left {
  text-align: left;
}

#vgjmqijyhf .gt_center {
  text-align: center;
}

#vgjmqijyhf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vgjmqijyhf .gt_font_normal {
  font-weight: normal;
}

#vgjmqijyhf .gt_font_bold {
  font-weight: bold;
}

#vgjmqijyhf .gt_font_italic {
  font-style: italic;
}

#vgjmqijyhf .gt_super {
  font-size: 65%;
}

#vgjmqijyhf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vgjmqijyhf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vgjmqijyhf .gt_indent_1 {
  text-indent: 5px;
}

#vgjmqijyhf .gt_indent_2 {
  text-indent: 10px;
}

#vgjmqijyhf .gt_indent_3 {
  text-indent: 15px;
}

#vgjmqijyhf .gt_indent_4 {
  text-indent: 20px;
}

#vgjmqijyhf .gt_indent_5 {
  text-indent: 25px;
}

#vgjmqijyhf .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#vgjmqijyhf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="Region" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Region</th>
<th id="Minimum Poverty 2015" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Minimum Poverty 2015</th>
<th id="Maximum Poverty 2015" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Maximum Poverty 2015</th>
<th id="Average Poverty 2015" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Average Poverty 2015</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="region">Norteast</td>
<td class="gt_row gt_right" headers="minimum_poverty_2015">69,233</td>
<td class="gt_row gt_right" headers="maximum_poverty_2015">3,005,943</td>
<td class="gt_row gt_right" headers="average_poverty_2015">804,465</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="region">Midwest</td>
<td class="gt_row gt_right" headers="minimum_poverty_2015">79,758</td>
<td class="gt_row gt_right" headers="maximum_poverty_2015">1,801,118</td>
<td class="gt_row gt_right" headers="average_poverty_2015">799,155</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="region">South</td>
<td class="gt_row gt_right" headers="minimum_poverty_2015">108,315</td>
<td class="gt_row gt_right" headers="maximum_poverty_2015">4,472,451</td>
<td class="gt_row gt_right" headers="average_poverty_2015">1,147,575</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="region">West</td>
<td class="gt_row gt_right" headers="minimum_poverty_2015">64,995</td>
<td class="gt_row gt_right" headers="maximum_poverty_2015">6,135,142</td>
<td class="gt_row gt_right" headers="average_poverty_2015">1,016,665</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<p>As evident in Table&nbsp;11, the region with the largest increase in people living below the poverty line is <strong>the South Region</strong>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb55-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb55-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">state =</span> NAME, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">region =</span> REGION) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb55-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb55-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(us_states_df) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb55-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(region) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb55-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb55-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">change_total_poverty =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(poverty_level_15) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(poverty_level_10)</span>
<span id="cb55-9">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb55-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(change_total_poverty)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb55-11">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb55-12">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label_with</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> snakecase<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>to_title_case) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb55-13">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decimals =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span></code></pre></div>
</details>
<div id="tbl-e14-b" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-e14-b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11: Table showing the region with the largest increase in people living below the poverty line
</figcaption>
<div aria-describedby="tbl-e14-b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="sqrdcibqsm" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#sqrdcibqsm table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#sqrdcibqsm thead, #sqrdcibqsm tbody, #sqrdcibqsm tfoot, #sqrdcibqsm tr, #sqrdcibqsm td, #sqrdcibqsm th {
  border-style: none;
}

#sqrdcibqsm p {
  margin: 0;
  padding: 0;
}

#sqrdcibqsm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#sqrdcibqsm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#sqrdcibqsm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#sqrdcibqsm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#sqrdcibqsm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sqrdcibqsm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sqrdcibqsm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sqrdcibqsm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#sqrdcibqsm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#sqrdcibqsm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#sqrdcibqsm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#sqrdcibqsm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#sqrdcibqsm .gt_spanner_row {
  border-bottom-style: hidden;
}

#sqrdcibqsm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#sqrdcibqsm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#sqrdcibqsm .gt_from_md > :first-child {
  margin-top: 0;
}

#sqrdcibqsm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#sqrdcibqsm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#sqrdcibqsm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#sqrdcibqsm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#sqrdcibqsm .gt_row_group_first td {
  border-top-width: 2px;
}

#sqrdcibqsm .gt_row_group_first th {
  border-top-width: 2px;
}

#sqrdcibqsm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sqrdcibqsm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#sqrdcibqsm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#sqrdcibqsm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sqrdcibqsm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sqrdcibqsm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#sqrdcibqsm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#sqrdcibqsm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#sqrdcibqsm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sqrdcibqsm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sqrdcibqsm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sqrdcibqsm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sqrdcibqsm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sqrdcibqsm .gt_left {
  text-align: left;
}

#sqrdcibqsm .gt_center {
  text-align: center;
}

#sqrdcibqsm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#sqrdcibqsm .gt_font_normal {
  font-weight: normal;
}

#sqrdcibqsm .gt_font_bold {
  font-weight: bold;
}

#sqrdcibqsm .gt_font_italic {
  font-style: italic;
}

#sqrdcibqsm .gt_super {
  font-size: 65%;
}

#sqrdcibqsm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#sqrdcibqsm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#sqrdcibqsm .gt_indent_1 {
  text-indent: 5px;
}

#sqrdcibqsm .gt_indent_2 {
  text-indent: 10px;
}

#sqrdcibqsm .gt_indent_3 {
  text-indent: 15px;
}

#sqrdcibqsm .gt_indent_4 {
  text-indent: 20px;
}

#sqrdcibqsm .gt_indent_5 {
  text-indent: 25px;
}

#sqrdcibqsm .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#sqrdcibqsm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="Region" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Region</th>
<th id="Change Total Poverty" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Change Total Poverty</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="region">South</td>
<td class="gt_row gt_right" headers="change_total_poverty">2,718,396</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="region">West</td>
<td class="gt_row gt_right" headers="change_total_poverty">2,102,479</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="region">Midwest</td>
<td class="gt_row gt_right" headers="change_total_poverty">1,095,133</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="region">Norteast</td>
<td class="gt_row gt_right" headers="change_total_poverty">877,493</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<hr>
</section>
<section id="e15" class="level3">
<h3 class="anchored" data-anchor-id="e15">E15</h3>
<p><strong>Create a raster from scratch, with nine rows and columns and a resolution of 0.5 decimal degrees (WGS84). Fill it with random numbers. Extract the values of the four corner cells.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load the terra package</span></span>
<span id="cb56-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(terra)</span>
<span id="cb56-3"></span>
<span id="cb56-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a raster with 9 rows and 9 columns, resolution of 0.5 degrees</span></span>
<span id="cb56-5">r <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrows =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncols =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, </span>
<span id="cb56-6">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resolution =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, </span>
<span id="cb56-7">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>)</span>
<span id="cb56-8"></span>
<span id="cb56-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fill the raster with random numbers</span></span>
<span id="cb56-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(r) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncell</span>(r))</span>
<span id="cb56-11"></span>
<span id="cb56-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print the raster</span></span>
<span id="cb56-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(r)</span>
<span id="cb56-14"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## class       : SpatRaster </span></span>
<span id="cb56-15"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## dimensions  : 360, 720, 1  (nrow, ncol, nlyr)</span></span>
<span id="cb56-16"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## resolution  : 0.5, 0.5  (x, y)</span></span>
<span id="cb56-17"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)</span></span>
<span id="cb56-18"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span id="cb56-19"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## source(s)   : memory</span></span>
<span id="cb56-20"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## name        :        lyr.1 </span></span>
<span id="cb56-21"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## min value   : 4.599569e-06 </span></span>
<span id="cb56-22"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## max value   : 9.999993e-01</span></span>
<span id="cb56-23"></span>
<span id="cb56-24"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(r)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter3_files/figure-html/unnamed-chunk-36-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter3_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb57" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract the values of the four corner cells</span></span>
<span id="cb57-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Top-left (1, 1), Top-right (1, 9), Bottom-left (9, 1), </span></span>
<span id="cb57-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # Bottom-right (9, 9)</span></span>
<span id="cb57-4"></span>
<span id="cb57-5">r[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb57-6"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       lyr.1</span></span>
<span id="cb57-7"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1 0.3572785</span></span>
<span id="cb57-8">r[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>]</span>
<span id="cb57-9"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       lyr.1</span></span>
<span id="cb57-10"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1 0.2861174</span></span>
<span id="cb57-11">r[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb57-12"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       lyr.1</span></span>
<span id="cb57-13"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1 0.2665531</span></span>
<span id="cb57-14">r[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>]</span>
<span id="cb57-15"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       lyr.1</span></span>
<span id="cb57-16"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1 0.5069412</span></span></code></pre></div>
</div>
<hr>
</section>
<section id="e16" class="level3">
<h3 class="anchored" data-anchor-id="e16">E16</h3>
<p><strong>What is the most common class of our example raster <code>grain</code>?</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1">grain_order <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"clay"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"silt"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sand"</span>)</span>
<span id="cb58-2">grain_char <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(grain_order, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb58-3">grain_fact <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(grain_char, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> grain_order)</span>
<span id="cb58-4">grain <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrows =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncols =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, </span>
<span id="cb58-5">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, </span>
<span id="cb58-6">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>,</span>
<span id="cb58-7">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vals =</span> grain_fact)</span>
<span id="cb58-8"></span>
<span id="cb58-9">answer <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">freq</span>(grain) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb58-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(count))</span>
<span id="cb58-11"></span>
<span id="cb58-12">gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(answer) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb58-13">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label_with</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> snakecase<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>to_title_case)</span></code></pre></div>
</details>
<div id="tbl-e16" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-e16-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;12: The count of different classes in the example raster <code>grain</code>.
</figcaption>
<div aria-describedby="tbl-e16-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="iruzhlnzvw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#iruzhlnzvw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#iruzhlnzvw thead, #iruzhlnzvw tbody, #iruzhlnzvw tfoot, #iruzhlnzvw tr, #iruzhlnzvw td, #iruzhlnzvw th {
  border-style: none;
}

#iruzhlnzvw p {
  margin: 0;
  padding: 0;
}

#iruzhlnzvw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#iruzhlnzvw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#iruzhlnzvw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#iruzhlnzvw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#iruzhlnzvw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iruzhlnzvw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iruzhlnzvw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iruzhlnzvw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#iruzhlnzvw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#iruzhlnzvw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#iruzhlnzvw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#iruzhlnzvw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#iruzhlnzvw .gt_spanner_row {
  border-bottom-style: hidden;
}

#iruzhlnzvw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#iruzhlnzvw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#iruzhlnzvw .gt_from_md > :first-child {
  margin-top: 0;
}

#iruzhlnzvw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#iruzhlnzvw .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#iruzhlnzvw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#iruzhlnzvw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#iruzhlnzvw .gt_row_group_first td {
  border-top-width: 2px;
}

#iruzhlnzvw .gt_row_group_first th {
  border-top-width: 2px;
}

#iruzhlnzvw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iruzhlnzvw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#iruzhlnzvw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#iruzhlnzvw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iruzhlnzvw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iruzhlnzvw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#iruzhlnzvw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#iruzhlnzvw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#iruzhlnzvw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iruzhlnzvw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iruzhlnzvw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#iruzhlnzvw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iruzhlnzvw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#iruzhlnzvw .gt_left {
  text-align: left;
}

#iruzhlnzvw .gt_center {
  text-align: center;
}

#iruzhlnzvw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#iruzhlnzvw .gt_font_normal {
  font-weight: normal;
}

#iruzhlnzvw .gt_font_bold {
  font-weight: bold;
}

#iruzhlnzvw .gt_font_italic {
  font-style: italic;
}

#iruzhlnzvw .gt_super {
  font-size: 65%;
}

#iruzhlnzvw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#iruzhlnzvw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#iruzhlnzvw .gt_indent_1 {
  text-indent: 5px;
}

#iruzhlnzvw .gt_indent_2 {
  text-indent: 10px;
}

#iruzhlnzvw .gt_indent_3 {
  text-indent: 15px;
}

#iruzhlnzvw .gt_indent_4 {
  text-indent: 20px;
}

#iruzhlnzvw .gt_indent_5 {
  text-indent: 25px;
}

#iruzhlnzvw .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#iruzhlnzvw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="Layer" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Layer</th>
<th id="Value" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Value</th>
<th id="Count" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Count</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="layer">1</td>
<td class="gt_row gt_left" headers="value">silt</td>
<td class="gt_row gt_right" headers="count">14</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="layer">1</td>
<td class="gt_row gt_left" headers="value">clay</td>
<td class="gt_row gt_right" headers="count">13</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="layer">1</td>
<td class="gt_row gt_left" headers="value">sand</td>
<td class="gt_row gt_right" headers="count">9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<p>The most common class is the silt .</p>
<hr>
</section>
<section id="e17" class="level3">
<h3 class="anchored" data-anchor-id="e17">E17</h3>
<p><strong>Plot the histogram and the boxplot of the <code>dem.tif</code> file from the spDataLarge package (<code>system.file("raster/dem.tif", package = "spDataLarge")</code>).</strong></p>
<p>The plots are shown in Figure&nbsp;2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1">temp_rast <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/dem.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>))</span>
<span id="cb59-2"></span>
<span id="cb59-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(temp_rast)</span>
<span id="cb59-4"></span>
<span id="cb59-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">boxplot</span>(temp_rast)</span>
<span id="cb59-6"></span>
<span id="cb59-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Using ggplot2 methods</span></span>
<span id="cb59-8"></span>
<span id="cb59-9">temp_rast <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb59-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb59-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb59-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(dem)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb59-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(</span>
<span id="cb59-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>,</span>
<span id="cb59-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey20"</span></span>
<span id="cb59-16">  )</span>
<span id="cb59-17"></span>
<span id="cb59-18">temp_rast <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb59-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb59-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb59-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(dem)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb59-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>(</span>
<span id="cb59-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>,</span>
<span id="cb59-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey20"</span>,</span>
<span id="cb59-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">staplewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb59-26">  )</span></code></pre></div>
<div id="fig-e17" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-e17-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="fig-e17-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e17-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter3_files/figure-html/fig-e17-1.png" class="lightbox" data-gallery="fig-e17" title="Figure&nbsp;2&nbsp;(a): Histogram of the raster dem.tif using base R hist()"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter3_files/figure-html/fig-e17-1.png" class="img-fluid figure-img" data-ref-parent="fig-e17" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e17-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Histogram of the raster dem.tif using base R hist()
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-e17-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e17-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter3_files/figure-html/fig-e17-2.png" class="lightbox" data-gallery="fig-e17" title="Figure&nbsp;2&nbsp;(b): Boxplot of the raster dem.tif using base R boxplot()"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter3_files/figure-html/fig-e17-2.png" class="img-fluid figure-img" data-ref-parent="fig-e17" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e17-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Boxplot of the raster dem.tif using base R boxplot()
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-e17-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e17-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter3_files/figure-html/fig-e17-3.png" class="lightbox" data-gallery="fig-e17" title="Figure&nbsp;2&nbsp;(c): Histogram of the values in raster dem.tif using ggplot2"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter3_files/figure-html/fig-e17-3.png" class="img-fluid figure-img" data-ref-parent="fig-e17" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e17-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Histogram of the values in raster dem.tif using ggplot2
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-e17-4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e17-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter3_files/figure-html/fig-e17-4.png" class="lightbox" data-gallery="fig-e17" title="Figure&nbsp;2&nbsp;(d): Boxplot of the values in raster dem.tif using ggplot2"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter3_files/figure-html/fig-e17-4.png" class="img-fluid figure-img" data-ref-parent="fig-e17" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e17-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d) Boxplot of the values in raster dem.tif using ggplot2
</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-e17-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Plots produced for question E17
</figcaption>
</figure>
</div>
</div>


</section>
</section>

 ]]></description>
  <category>Geocomputation with R</category>
  <category>Textbook Solutions</category>
  <guid>https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter3.html</guid>
  <pubDate>Thu, 07 Nov 2024 18:30:00 GMT</pubDate>
</item>
<item>
  <title>Chapter 2: Geographic data in R</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">2.1 Introduction</h2>
<ul>
<li><strong>Geographic Data Models</strong>: Vector and raster models are foundational.
<ul>
<li><strong>Vector Model</strong>: Represents geographic data as points, lines, and polygons with precise boundaries; commonly used in social sciences for features like human settlements.</li>
<li><strong>Raster Model</strong>: Divides surfaces into cells; useful in environmental sciences, often based on remote sensing and aerial data. Scalable and consistent over large areas.</li>
</ul></li>
<li><strong>Choosing a Model</strong>:
<ul>
<li>Vector is often used in social sciences.</li>
<li>Raster is prevalent in environmental studies.</li>
</ul></li>
<li><strong>R Implementation</strong>:
<ul>
<li>Use <a href="https://r-spatial.github.io/sf/"><strong><code>sf</code></strong></a> for vector data.</li>
<li>Use <a href="https://rspatial.org/terra/"><strong><code>terra</code></strong></a> for raster data.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sf)           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simple Features in R</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(terra)        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Raster Data in R</span></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(spData)       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Spatial Datasets</span></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(spDataLarge)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Large Spatial Datasets</span></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data Wrangling and Visualization</span></span></code></pre></div>
</div>
</section>
<section id="vector-data" class="level2">
<h2 class="anchored" data-anchor-id="vector-data">2.2 Vector Data</h2>
<ul>
<li><strong>Vector Data</strong>: Represents geographic features using points, lines, and polygons based on coordinate reference systems (CRS).
<ul>
<li>Example: London’s coordinates <code>c(-0.1, 51.5)</code> in geographic CRS or <code>c(530000, 180000)</code> in projected CRS (<a href="https://en.wikipedia.org/wiki/Ordnance_Survey_National_Grid#:~:text=The%20Ordnance%20Survey%20National%20Grid,to%20the%20west%20of%20the">British National Grid</a>).</li>
</ul></li>
<li><strong>CRS Overview</strong>:
<ul>
<li>Geographic CRS uses <code>lon/lat</code> (0° longitude and latitude origin).</li>
<li>Projected CRS, like the British National Grid, is based on <code>Easting/Northing</code> coordinates with positive values.</li>
</ul></li>
<li><strong>Key dependencies / libraries used by the <code>sf</code> Package</strong>:
<ul>
<li><a href="https://gdal.org/"><strong><code>GDAL</code></strong></a>: Handles geographic data formats</li>
<li><a href="https://proj.org/"><strong><code>PROJ</code></strong></a>: For CRS transformations</li>
<li><a href="https://cran.r-project.org/package=geos"><strong><code>GEOS</code></strong></a>: Supports planar geometry for projected data</li>
<li><a href="https://s2geometry.io/"><strong><code>S2</code></strong></a>: Manages spherical geometry for unprojected data (e.g., <code>lon/lat</code>), toggleable with <code>sf::sf_use_s2(FALSE)</code>.</li>
</ul></li>
<li><strong>Geometry Engines</strong>:
<ul>
<li><strong>Planar (GEOS)</strong>: For 2D projected data.</li>
<li><strong>Spherical (S2)</strong>: For 3D unprojected data.</li>
</ul></li>
</ul>
<section id="introduction-to-simple-features" class="level3">
<h3 class="anchored" data-anchor-id="introduction-to-simple-features">2.2.1 Introduction to Simple Features</h3>
<ul>
<li><strong>Simple Features (SF)</strong>: Hierarchical model by <a href="https://www.ogc.org/">OGC</a> (Open Geospatial Consortium); supports multiple geometry types.</li>
<li><strong>Core Types</strong>: <code>sf</code> package in R supports 7 core geometry types (points, lines, polygons, and their “multi” versions).</li>
<li><strong>Library Integration</strong>: <code>sf</code> replaces <code>sp</code>, <code>rgdal</code>, <code>rgeos</code>; unified interface for GEOS (geometry), GDAL (data I/O), PROJ (CRS).</li>
<li><strong>Non-Planar Support</strong>: Integrates <code>s2</code> for geographic (lon/lat) operations, used by default for accuracy on spherical geometries.</li>
<li><strong>Data Storage</strong>: SF objects are data frames with a spatial column (<code>geometry</code> or <code>geom</code>).</li>
<li><strong>Vignettes</strong>: Documentation accessible with <code>vignette(package = "sf")</code> for practical use and examples.</li>
<li><strong>Plotting</strong>: <code>plot(sf_object)</code> maps all variables, unlike single-map GIS tools.</li>
<li><strong>Summary</strong>: <code>summary()</code> gives spatial and attribute data insights.</li>
<li><strong>Subset</strong>: SF objects subsettable like data frames, retaining spatial metadata.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">world</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 177 features and 10 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -180 ymin: -89.9 xmax: 180 ymax: 83.64513
Geodetic CRS:  WGS 84
# A tibble: 177 × 11
   iso_a2 name_long continent region_un subregion type  area_km2     pop lifeExp
 * &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
 1 FJ     Fiji      Oceania   Oceania   Melanesia Sove…   1.93e4  8.86e5    70.0
 2 TZ     Tanzania  Africa    Africa    Eastern … Sove…   9.33e5  5.22e7    64.2
 3 EH     Western … Africa    Africa    Northern… Inde…   9.63e4 NA         NA  
 4 CA     Canada    North Am… Americas  Northern… Sove…   1.00e7  3.55e7    82.0
 5 US     United S… North Am… Americas  Northern… Coun…   9.51e6  3.19e8    78.8
 6 KZ     Kazakhst… Asia      Asia      Central … Sove…   2.73e6  1.73e7    71.6
 7 UZ     Uzbekist… Asia      Asia      Central … Sove…   4.61e5  3.08e7    71.0
 8 PG     Papua Ne… Oceania   Oceania   Melanesia Sove…   4.65e5  7.76e6    65.2
 9 ID     Indonesia Asia      Asia      South-Ea… Sove…   1.82e6  2.55e8    68.9
10 AR     Argentina South Am… Americas  South Am… Sove…   2.78e6  4.30e7    76.3
# ℹ 167 more rows
# ℹ 2 more variables: gdpPercap &lt;dbl&gt;, geom &lt;MULTIPOLYGON [°]&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(world)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "iso_a2"    "name_long" "continent" "region_un" "subregion" "type"     
 [7] "area_km2"  "pop"       "lifeExp"   "gdpPercap" "geom"     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>(world)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sf"         "tbl_df"     "tbl"        "data.frame"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">########### THE GEOMETRY COLUMN IS STICKY ################</span></span>
<span id="cb8-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(world[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lifeExp"</span>])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    lifeExp                 geom    
 Min.   :50.62   MULTIPOLYGON :177  
 1st Qu.:64.96   epsg:4326    :  0  
 Median :72.87   +proj=long...:  0  
 Mean   :70.85                      
 3rd Qu.:76.78                      
 Max.   :83.59                      
 NA's   :10                         </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(world)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-basic-plot-on-sf" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-basic-plot-on-sf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter2_files/figure-html/fig-basic-plot-on-sf-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: The basic plot() function on a sf object produced multiple plots, one for each of the non-geometry variables (columns) in the plotted dataset."><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/fig-basic-plot-on-sf-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-basic-plot-on-sf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: The basic plot() function on a sf object produced multiple plots, one for each of the non-geometry variables (columns) in the plotted dataset.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="why-simple-features" class="level3">
<h3 class="anchored" data-anchor-id="why-simple-features">2.2.2 Why Simple Features?</h3>
<ul>
<li><strong>Cross-Compatibility</strong>: SF model is compatible with many GIS tools (e.g., <a href="https://www.qgis.org/">QGIS</a>, <a href="https://postgis.net/">PostGIS</a>), enabling easy data transfer.</li>
<li><strong>Advantages of <code>sf</code> in <code>R</code></strong>:
<ul>
<li>Data Handling: Fast reading/writing of spatial data.</li>
<li>Plotting: Improved plotting speed and performance.</li>
<li>Data Frame-Like: <code>sf</code> objects behave like data frames.</li>
<li>Consistent Naming: <code>sf</code> functions are intuitive, starting with <code>st_</code>.</li>
<li>Tidyverse-Friendly: Works well with <code>|&gt;</code> and integrates with tidyverse packages.</li>
</ul></li>
<li><strong>Data Import Options</strong>:
<ul>
<li><code>read_sf()</code>: Imports data as a tidy tibble (quietly).</li>
<li><code>st_read()</code>: Imports data as a base R data frame (verbose).</li>
</ul></li>
<li><strong>Popularity</strong>: <code>sf</code> is the primary package for spatial vector data in R, preferred over alternatives like <code>spatstat</code> and <code>terra</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">world_dfr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_read</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"shapes/world.shp"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spData"</span>))</span>
<span id="cb11-2"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Reading layer `world' from data source </span></span>
<span id="cb11-3"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##   `C:\Users\dradi\AppData\Local\R\win-library\4.3\spData\shapes\world.shp' </span></span>
<span id="cb11-4"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##   using driver `ESRI Shapefile'</span></span>
<span id="cb11-5"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Simple feature collection with 177 features and 10 fields</span></span>
<span id="cb11-6"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Geometry type: MULTIPOLYGON</span></span>
<span id="cb11-7"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Dimension:     XY</span></span>
<span id="cb11-8"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Bounding box:  xmin: -180 ymin: -89.9 xmax: 180 ymax: 83.64513</span></span>
<span id="cb11-9"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Geodetic CRS:  WGS 84</span></span>
<span id="cb11-10">world_dfr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_sf</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"shapes/world.shp"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spData"</span>))</span>
<span id="cb11-11"></span>
<span id="cb11-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>(world_dfr)</span>
<span id="cb11-13"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] "sf"         "tbl_df"     "tbl"        "data.frame"</span></span></code></pre></div>
</div>
</section>
<section id="basic-maps" class="level3">
<h3 class="anchored" data-anchor-id="basic-maps">2.2.3 Basic Maps</h3>
<ul>
<li><strong>Plotting in <code>sf</code></strong>:
<ul>
<li><code>plot()</code> creates multi-panel plots for multiple variables or a single-panel plot for one variable.</li>
<li>Supports fixed color customization using <code>col</code> and <code>border</code> arguments.</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(world)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-base-plot-fn" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-base-plot-fn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter2_files/figure-html/fig-base-plot-fn-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: The base plot() function creates a faceted output with a map for each variable other than geometry"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/fig-base-plot-fn-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-base-plot-fn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: The base plot() function creates a faceted output with a map for each variable other than geometry
</figcaption>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>Layering Plots</strong>: Add layers to existing plots with <code>add = TRUE</code>. Use <code>reset = FALSE</code> for plots with a key.</li>
<li><strong>Overlaying Data</strong>: Circles representing population size can be plotted using <code>cex</code> and <code>st_centroid()</code>.</li>
<li><strong>Bounding Box Expansion</strong>: <code>expandBB</code> adjusts the plot boundaries (bottom, left, top, right).</li>
<li><strong>Limitations</strong>: Base <code>plot()</code> is simple but limited in functionality; use <code>tmap</code> for advanced maps.</li>
</ul>
</section>
<section id="geometry-types" class="level3">
<h3 class="anchored" data-anchor-id="geometry-types">2.2.4 Geometry Types</h3>
<ul>
<li><strong>Geometry Basics:</strong>
<ul>
<li>Core components of simple features; <code>sf</code> supports 18 types.</li>
<li>Focus on 7 common types: POINT, LINESTRING, POLYGON, MULTIPOINT, MULTILINESTRING, MULTIPOLYGON, GEOMETRYCOLLECTION.</li>
</ul></li>
<li><strong>Encoding Standards:</strong>
<ul>
<li>WKB (Well-known binary): Hexadecimal, computer-friendly format.</li>
<li>WKT (Well-known text): Human-readable format, often shown for explanation.</li>
</ul></li>
<li><strong>Common Geometries:</strong>
<ul>
<li>POINT: Single coordinate (e.g., <code>POINT (5 2)</code>).</li>
<li>LINESTRING: Connected sequence of points (e.g., <code>LINESTRING (1 5, 4 4, 4 1, 2 2, 3 2)</code>).</li>
<li>POLYGON: Closed ring of points (e.g., <code>POLYGON ((1 5, 2 2, 4 1, 4 4, 1 5))</code>).</li>
</ul></li>
<li><strong>Multi-Geometries:</strong>
<ul>
<li>MULTIPOINT: Multiple points (e.g., <code>MULTIPOINT (5 2, 1 3, 3 4, 3 2)</code>).</li>
<li>MULTILINESTRING: Multiple linestrings (e.g., <code>MULTILINESTRING ((1 5, 4 4, 4 1, 2 2, 3 2), (1 2, 2 4))</code>).</li>
<li>MULTIPOLYGON: Multiple polygons (e.g., <code>MULTIPOLYGON (((1 5, 2 2, 4 1, 4 4, 1 5), (0 2, 1 2, 1 3, 0 3, 0 2)))</code>).</li>
</ul></li>
<li><strong>Geometry Collection:</strong>
<ul>
<li>Mix of geometry types (e.g., <code>GEOMETRYCOLLECTION (MULTIPOINT (5 2, 1 3, 3 4, 3 2), LINESTRING (1 5, 4 4, 4 1, 2 2, 3 2))</code>).</li>
</ul></li>
</ul>
</section>
<section id="the-sf-class" class="level3">
<h3 class="anchored" data-anchor-id="the-sf-class">2.2.5 The sf Class</h3>
<ul>
<li><p><strong>Structure of sf Objects</strong>: Composed of geometries (<code>sfc</code> object) and non-geographic attributes (<code>data.frame</code> or <code>tibble</code>).</p></li>
<li><p><strong>Creation of sf Objects</strong>: Steps:</p>
<ol type="1">
<li><p>Create geometry (<code>sfg</code>) with functions like <code>st_point()</code></p></li>
<li><p>Convert to geometry column (<code>sfc</code>) with CRS using function <code>st_sfc(..., crs = "...")</code></p></li>
<li><p>Combine attributes (<code>data.frame</code>) with <code>sfc</code> using function <code>st_sf(..., geometry = ...)</code></p></li>
</ol></li>
</ul>
<!-- -->
<ul>
<li><p><strong>Characteristics</strong>:</p>
<ul>
<li><code>sf</code> objects have dual class: <code>sf</code> and <code>data.frame</code>.</li>
<li>Spatial attributes stored in a <code>geometry</code> column.</li>
<li><code>sf</code> behaves like a <code>data.frame</code> but with spatial extension.</li>
</ul></li>
</ul>
</section>
<section id="simple-feature-geometries-sfg" class="level3">
<h3 class="anchored" data-anchor-id="simple-feature-geometries-sfg">2.2.6 Simple Feature Geometries (<code>sfg</code>)</h3>
<p>An <em>sfg</em> object represents a single simple feature geometry. A simple feature geometry column (<em>sfc</em>) is a collection of <em>sfg</em> objects and can also include information about the coordinate reference system (CRS) being used.</p>
<p>Geometries can be created using <code>st_</code> functions or imported from existing spatial files.</p>
<ul>
<li><strong>sfg Creation Functions</strong>:
<ul>
<li><code>st_point()</code>: Create a single point.</li>
<li><code>st_linestring()</code>: Create a linestring.</li>
<li><code>st_polygon()</code>: Create a polygon.</li>
<li><code>st_multipoint()</code>: Create a multipoint.</li>
<li><code>st_multilinestring()</code>: Create a multilinestring.</li>
<li><code>st_multipolygon()</code>: Create a multipolygon.</li>
<li><code>st_geometrycollection()</code>: Create a geometry collection.</li>
</ul></li>
<li><strong>Input Data Types</strong>:
<ul>
<li><strong>Numeric Vector</strong>: Single points.</li>
<li><strong>Matrix</strong>: Sets of points for multipoint or linestring.</li>
<li><strong>List</strong>: Complex structures for multilinestrings, (multi)polygons, or geometry collections.</li>
</ul></li>
<li><strong>Examples</strong>:</li>
</ul>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"></span>
<span id="cb13-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a point</span></span>
<span id="cb13-3">point <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># POINT (8 3)</span></span>
<span id="cb13-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(point)</span>
<span id="cb13-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(point) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>()</span>
<span id="cb13-7"></span>
<span id="cb13-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a multipoint</span></span>
<span id="cb13-9">multipoint_matrix <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))</span>
<span id="cb13-10">multipoint <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_multipoint</span>(multipoint_matrix)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># MULTIPOINT ((8 3), (2 5), (5 7), (7 3))</span></span>
<span id="cb13-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(multipoint)</span>
<span id="cb13-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(multipoint) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>()</span>
<span id="cb13-14"></span>
<span id="cb13-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a linestring</span></span>
<span id="cb13-16">linestring_matrix <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb13-17">linestring <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_linestring</span>(linestring_matrix)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># LINESTRING (2 8, 6 6, 7 2, 5 3, 8 4)</span></span>
<span id="cb13-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(linestring)</span>
<span id="cb13-19"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(linestring) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>()</span>
<span id="cb13-21"></span>
<span id="cb13-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a polygon</span></span>
<span id="cb13-23">polygon_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)))</span>
<span id="cb13-24">polygon <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_polygon</span>(polygon_list)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># POLYGON ((2 8, 4 3, 7 2, 6 7, 2 8))</span></span>
<span id="cb13-25"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(polygon)</span>
<span id="cb13-26"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(polygon) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>()</span>
<span id="cb13-28"></span>
<span id="cb13-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Polygon with a hole</span></span>
<span id="cb13-30">polygon_border <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>))</span>
<span id="cb13-31">polygon_hole <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb13-32">polygon_with_hole_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(polygon_border, polygon_hole)</span>
<span id="cb13-33">polygon_with_hole <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_polygon</span>(polygon_with_hole_list)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># POLYGON with a hole</span></span>
<span id="cb13-34"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(polygon_with_hole)</span>
<span id="cb13-35"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(polygon_with_hole) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>()</span>
<span id="cb13-37"></span>
<span id="cb13-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a multilinestring</span></span>
<span id="cb13-39">multilinestring_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb13-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)),</span>
<span id="cb13-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>))</span>
<span id="cb13-42">)</span>
<span id="cb13-43">multilinestring <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_multilinestring</span>(multilinestring_list)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># MULTILINESTRING</span></span>
<span id="cb13-44"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(multilinestring)</span>
<span id="cb13-45"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(multilinestring) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>()</span>
<span id="cb13-47"></span>
<span id="cb13-48"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a multipolygon</span></span>
<span id="cb13-49">multipolygon_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb13-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>))),</span>
<span id="cb13-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)))</span>
<span id="cb13-52">)</span>
<span id="cb13-53">multipolygon <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_multipolygon</span>(multipolygon_list)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># MULTIPOLYGON</span></span>
<span id="cb13-54"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(multipolygon)</span>
<span id="cb13-55"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(multipolygon) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>()</span>
<span id="cb13-57"></span>
<span id="cb13-58"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a geometry collection</span></span>
<span id="cb13-59">geometrycollection_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_multipoint</span>(multipoint_matrix), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_linestring</span>(linestring_matrix))</span>
<span id="cb13-60">geometry_collection <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_geometrycollection</span>(geometrycollection_list)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># GEOMETRYCOLLECTION</span></span>
<span id="cb13-61"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(geometry_collection)</span>
<span id="cb13-62"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(geometry_collection) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-63">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>()</span></code></pre></div>
</details>
<div id="fig-geometries" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-geometries-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-geometries" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-geometries-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-geometries-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter2_files/figure-html/fig-geometries-1.png" class="lightbox" data-gallery="fig-geometries" title="Figure&nbsp;3&nbsp;(a): A point"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/fig-geometries-1.png" class="img-fluid figure-img" data-ref-parent="fig-geometries" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-geometries-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) A point
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-geometries" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-geometries-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-geometries-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter2_files/figure-html/fig-geometries-2.png" class="lightbox" data-gallery="fig-geometries" title="Figure&nbsp;3&nbsp;(b): A multipoint"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/fig-geometries-2.png" class="img-fluid figure-img" data-ref-parent="fig-geometries" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-geometries-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) A multipoint
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-geometries" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-geometries-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-geometries-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter2_files/figure-html/fig-geometries-3.png" class="lightbox" data-gallery="fig-geometries" title="Figure&nbsp;3&nbsp;(c): A linestring"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/fig-geometries-3.png" class="img-fluid figure-img" data-ref-parent="fig-geometries" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-geometries-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) A linestring
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-geometries" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-geometries-4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-geometries-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter2_files/figure-html/fig-geometries-4.png" class="lightbox" data-gallery="fig-geometries" title="Figure&nbsp;3&nbsp;(d): A polygon"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/fig-geometries-4.png" class="img-fluid figure-img" data-ref-parent="fig-geometries" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-geometries-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d) A polygon
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-geometries" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-geometries-5" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-geometries-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter2_files/figure-html/fig-geometries-5.png" class="lightbox" data-gallery="fig-geometries" title="Figure&nbsp;3&nbsp;(e): Polygon with a hole"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/fig-geometries-5.png" class="img-fluid figure-img" data-ref-parent="fig-geometries" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-geometries-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(e) Polygon with a hole
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-geometries" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-geometries-6" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-geometries-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter2_files/figure-html/fig-geometries-6.png" class="lightbox" data-gallery="fig-geometries" title="Figure&nbsp;3&nbsp;(f): Multilinestring"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/fig-geometries-6.png" class="img-fluid figure-img" data-ref-parent="fig-geometries" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-geometries-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(f) Multilinestring
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-geometries" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-geometries-7" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-geometries-7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter2_files/figure-html/fig-geometries-7.png" class="lightbox" data-gallery="fig-geometries" title="Figure&nbsp;3&nbsp;(g): Multipolygon"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/fig-geometries-7.png" class="img-fluid figure-img" data-ref-parent="fig-geometries" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-geometries-7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(g) Multipolygon
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-geometries" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-geometries-8" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-geometries-8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter2_files/figure-html/fig-geometries-8.png" class="lightbox" data-gallery="fig-geometries" title="Figure&nbsp;3&nbsp;(h): Geometry Collection"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/fig-geometries-8.png" class="img-fluid figure-img" data-ref-parent="fig-geometries" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-geometries-8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(h) Geometry Collection
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-geometries-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Creating different sample geometry objects in R with {sf}
</figcaption>
</figure>
</div>
</section>
<section id="the-sfheaders-package" class="level3">
<h3 class="anchored" data-anchor-id="the-sfheaders-package">2.2.8 The <code>sfheaders</code> Package</h3>
<ul>
<li><strong>Overview</strong>:
<ul>
<li><code>sfheaders</code> <span class="citation" data-cites="sfheaders">(Cooley 2024)</span> is an R package designed to efficiently create and manipulate <code>sf</code> objects from vectors, matrices, and data frames.</li>
<li>It does not rely on the <code>sf</code> library and instead uses underlying C++ code, enabling faster operations and the potential for further development with compiled code.</li>
</ul></li>
<li><strong>Compatibility</strong>:
<ul>
<li>Although separate from <code>sf</code>, it is fully compatible, producing valid <code>sf</code> objects like <code>sfg</code>, <code>sfc</code>, and <code>sf</code>.</li>
</ul></li>
<li><strong>Key Functionality</strong>:
<ul>
<li>Converts:
<ul>
<li><strong>Vector</strong> → <code>sfg_POINT</code></li>
<li><strong>Matrix</strong> → <code>sfg_LINESTRING</code></li>
<li><strong>Data Frame</strong> → <code>sfg_POLYGON</code></li>
</ul></li>
<li>Creates <code>sfc</code> and <code>sf</code> objects using similar syntax.</li>
</ul></li>
<li><strong>Advantages</strong>:
<ul>
<li><code>sfheaders</code> is optimized for high-speed ‘deconstruction’ and ‘reconstruction’ of <code>sf</code> objects and casting between geometry types, offering faster performance than <code>sf</code> in many cases.</li>
</ul></li>
</ul>
</section>
<section id="spherical-geometry-operations-with-s2" class="level3">
<h3 class="anchored" data-anchor-id="spherical-geometry-operations-with-s2">2.2.9 Spherical Geometry Operations with S2</h3>
<ul>
<li><strong>Concept</strong>:
<ul>
<li>Spherical geometry operations acknowledge Earth’s roundness, as opposed to planar operations that assume flat surfaces.</li>
<li>Since <code>sf</code> version 1.0.0, R integrates with Google’s S2 spherical geometry engine, enabling accurate global spatial operations.</li>
<li>S2 supports operations like distance, buffer, and area calculations, allowing accurate geocomputation on a spherical Earth model.</li>
<li>Known as a Discrete Global Grid System (DGGS), S2 is similar to other systems like H3, which is a global hexagonal index.</li>
</ul></li>
<li><strong>S2 Mode</strong>:
<ul>
<li><p>By default, S2 is enabled in <code>sf</code>. Verify with:</p>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sf_use_s2</span>()</span></code></pre></div></li>
<li><p><strong>Turning Off S2</strong>:</p>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sf_use_s2</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div></li>
</ul></li>
<li><strong>S2 Limitations and Edge Cases</strong>:
<ul>
<li>Some operations may fail due to S2’s stricter definitions, potentially affecting legacy code. Error messages such as <code>Error in s2_geography_from_wkb ...</code> might require turning off S2.</li>
</ul></li>
<li><strong>Recommendation</strong>:
<ul>
<li>Keep S2 enabled for accurate global calculations unless specific operations necessitate its deactivation.</li>
</ul></li>
</ul>
</section>
</section>
<section id="raster-data" class="level2">
<h2 class="anchored" data-anchor-id="raster-data">2.3 Raster Data</h2>
<ul>
<li>The raster data model represents the world as a continuous grid of cells (pixels). Focuses on <strong>regular grids</strong>, where each cell is of constant size, though other grid types (e.g., rotated, sheared) exist.</li>
<li><strong>Structure</strong>:
<ul>
<li>Comprises a raster header and a matrix of equally spaced cells.</li>
<li>The raster header includes:
<ul>
<li>CRS (Coordinate Reference System)</li>
<li>Extent (geographical area covered)</li>
<li>Origin (starting point, often the lower left corner; the <code>terra</code> package defaults to the upper left).</li>
</ul></li>
<li>Extent is defined by:
<ul>
<li>Number of columns (ncol)</li>
<li>Number of rows (nrow)</li>
<li>Cell size resolution</li>
</ul></li>
</ul></li>
<li><strong>Cell Access and Modification</strong>:
<ul>
<li>Cells can be accessed and modified by:
<ul>
<li>Cell ID</li>
<li>Explicitly specifying row and column indices.</li>
</ul></li>
<li>This matrix representation is efficient as it avoids storing corner coordinates (unlike vector polygons).</li>
</ul></li>
<li><strong>Data Characteristics</strong>:
<ul>
<li>Each cell can hold a single value, which can be either:
<ul>
<li>Continuous (e.g., elevation, temperature)</li>
<li>Categorical (e.g., land cover classes).</li>
</ul></li>
</ul></li>
<li><strong>Applications</strong>:
<ul>
<li>Raster maps are useful for continuous phenomena (e.g., temperature, population density) and can also represent discrete features (e.g., soil classes).</li>
</ul></li>
</ul>
<section id="r-packages-for-working-with-raster-data" class="level3">
<h3 class="anchored" data-anchor-id="r-packages-for-working-with-raster-data">2.3.1 <code>R</code> Packages for Working with Raster Data</h3>
<ul>
<li>Several R packages for reading and processing raster datasets have emerged over the last two decades. The <strong><code>raster</code></strong> package was the first significant advancement in R’s raster capabilities when launched in 2010. It was the premier package until the development of <strong><code>terra</code></strong> and <strong><code>stars</code></strong>, both offering powerful functions for raster data.</li>
<li>This book emphasizes <strong><code>terra</code></strong>, which replaces the older, slower raster package.</li>
<li><strong>Comparison of <code>terra</code> and <code>stars</code></strong>:</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 31%">
<col style="width: 43%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Feature</strong></th>
<th><strong><code>terra</code></strong></th>
<th><strong><code>stars</code></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Primary Focus</strong></td>
<td>Regular grids</td>
<td>Supports regular, rotated, sheared, rectilinear, and curvilinear grids</td>
</tr>
<tr class="even">
<td><strong>Data Structure</strong></td>
<td>One or multi-layered rasters</td>
<td>Raster data cubes with multiple layers, time steps, and attributes</td>
</tr>
<tr class="odd">
<td><strong>Memory Management</strong></td>
<td>Uses C++ code and pointers for data storage</td>
<td>Uses lists of arrays for smaller rasters; file paths for larger ones</td>
</tr>
<tr class="even">
<td><strong>Vector Data Integration</strong></td>
<td>Uses its own class <code>SpatVector</code> but supports <code>sf</code> objects</td>
<td>Closely related to vector objects/functions in <code>sf</code></td>
</tr>
<tr class="odd">
<td><strong>Functions &amp; Methods</strong></td>
<td>Large number of built-in, purpose-specific functions (e.g., re-sampling, cropping)</td>
<td>Mix of built-in functions (<code>st_</code> prefix), existing <code>dplyr</code> functions, and custom methods for <code>R</code> functions</td>
</tr>
<tr class="even">
<td><strong>Conversion Between Packages</strong></td>
<td>Conversion to <code>stars</code> with <code>st_as_stars()</code></td>
<td>Conversion to <code>terra</code> with <code>rast()</code></td>
</tr>
<tr class="odd">
<td><strong>Performance</strong></td>
<td>Generally optimized for speed and memory efficiency</td>
<td>Flexible, but performance varies based on data type and structure</td>
</tr>
<tr class="even">
<td><strong>Best Use Cases</strong></td>
<td>Single or multi-layer rasters; fast processing</td>
<td>Complex data cubes with layers over time and multiple attributes</td>
</tr>
<tr class="odd">
<td><strong>Programming Language Basis</strong></td>
<td>Primarily C++</td>
<td><code>R</code> with some C++ integration</td>
</tr>
</tbody>
</table>
</section>
<section id="introduction-to-terra" class="level3">
<h3 class="anchored" data-anchor-id="introduction-to-terra">2.3.2 Introduction to <strong><code>terra</code></strong></h3>
<ul>
<li>The <strong><code>terra</code></strong> package is designed for handling raster objects in R, supporting a range of functions to create, read, export, manipulate, and process raster datasets.
<ul>
<li>While its functionality is similar to the older <strong><code>raster</code></strong> package, <strong><code>terra</code></strong> offers improved computational efficiency.</li>
<li>Despite <strong><code>terra</code></strong>’s advantages, the <strong><code>raster</code></strong> class system remains popular due to its widespread use in other R packages.</li>
<li><strong><code>terra</code></strong> provides seamless translation between the two object types using functions like <strong><code>raster()</code></strong>, <strong><code>stack()</code></strong>, and <strong><code>brick()</code></strong> for backward compatibility.</li>
</ul></li>
<li><strong>Key Features</strong>:
<ul>
<li>Low-Level Functionality: Includes functions that help in building new tools for raster data processing.</li>
<li>Memory Management: Supports processing of large raster datasets by dividing them into smaller chunks for iterative processing, allowing operations beyond available RAM capacity.</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">raster_filepath <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/srtm.tif"</span>, </span>
<span id="cb16-2">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>)</span>
<span id="cb16-3">my_rast <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(raster_filepath)</span>
<span id="cb16-4"></span>
<span id="cb16-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>(my_rast)</span>
<span id="cb16-6"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] "SpatRaster"</span></span>
<span id="cb16-7"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## attr(,"package")</span></span>
<span id="cb16-8"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] "terra"</span></span>
<span id="cb16-9"></span>
<span id="cb16-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ext</span>(my_rast)</span>
<span id="cb16-11"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## SpatExtent : -113.239583212784, -112.85208321281, 37.1320834298579, 37.5129167631658 (xmin, xmax, ymin, ymax)</span></span>
<span id="cb16-12"></span>
<span id="cb16-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(my_rast)</span>
<span id="cb16-14"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## class       : SpatRaster </span></span>
<span id="cb16-15"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## dimensions  : 457, 465, 1  (nrow, ncol, nlyr)</span></span>
<span id="cb16-16"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## resolution  : 0.0008333333, 0.0008333333  (x, y)</span></span>
<span id="cb16-17"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## extent      : -113.2396, -112.8521, 37.13208, 37.51292  (xmin, xmax, ymin, ymax)</span></span>
<span id="cb16-18"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span id="cb16-19"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## source      : srtm.tif </span></span>
<span id="cb16-20"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## name        : srtm </span></span>
<span id="cb16-21"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## min value   : 1024 </span></span>
<span id="cb16-22"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## max value   : 2892</span></span></code></pre></div>
</details>
</div>
<ul>
<li><strong>Dedicated Reporting Functions</strong>:
<ul>
<li><strong><code>dim()</code></strong>: Number of rows, columns, and layers.</li>
<li><strong><code>ncell()</code></strong>: Total number of cells (pixels).</li>
<li><strong><code>res()</code></strong>: Spatial resolution.</li>
<li><strong><code>ext()</code></strong>: Spatial extent.</li>
<li><strong><code>crs()</code></strong>: Coordinate reference system (CRS).</li>
<li><strong><code>inMemory()</code></strong>: Checks if data is stored in memory or on disk.</li>
<li><strong><code>sources</code></strong>: Shows file location.</li>
</ul></li>
<li><strong>Accessing Full Function List</strong>:
<ul>
<li>Run <code>help("terra-package")</code> to see all available <strong><code>terra</code></strong> functions.</li>
</ul></li>
</ul>
</section>
<section id="basic-map-making" class="level3">
<h3 class="anchored" data-anchor-id="basic-map-making">2.3.3 Basic Map-Making</h3>
<ul>
<li><strong>Plotting with</strong> <code>terra</code>:
<ul>
<li>The <strong>terra</strong> package offers a simple way to create basic visualizations using the <strong>plot()</strong> function, specifically designed for <strong>SpatRaster</strong> objects.</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(my_rast)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-terra-examples2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-terra-examples2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter2_files/figure-html/fig-terra-examples2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Figure&nbsp;4: An example raster data displayed with {terra} using plot()"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/fig-terra-examples2-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-terra-examples2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: An example raster data displayed with {terra} using plot()
</figcaption>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>Advanced Plotting Options</strong>:
<ul>
<li><strong><code>plotRGB()</code></strong>: A specialized function in <strong>terra</strong> for creating color composite plots using three layers (e.g., red, green, blue bands) from a <strong>SpatRaster</strong> object.</li>
<li><strong><code>tmap</code> Package</strong> <span class="citation" data-cites="tmap">(Tennekes 2018)</span>: Useful for creating both static and interactive maps for raster and vector data.</li>
<li><strong><code>rasterVis</code> Package</strong> <span class="citation" data-cites="rasterVis">(2023)</span>: Includes functions such as <strong><code>levelplot()</code></strong> to create advanced visualizations, including faceted plots for displaying changes over time.</li>
</ul></li>
</ul>
</section>
<section id="raster-classes" class="level3">
<h3 class="anchored" data-anchor-id="raster-classes">2.3.4 Raster Classes</h3>
<ul>
<li>The SpatRaster class in <code>terra</code> represents raster objects. Rasters are commonly created by reading a file using <code>rast()</code>
<ul>
<li><code>terra</code> supports reading various formats via GDAL, only loading the header and a file pointer into RAM.</li>
</ul></li>
<li><strong>Creating Rasters from Scratch</strong>: Use <strong>rast()</strong> to make new raster objects:
<ul>
<li>Fills values row-wise from the top left corner.</li>
<li>Resolution depends on rows, columns, and extent; defaults to degrees (WGS84 CRS).</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a new SpatRaster object: a checkerboard design</span></span>
<span id="cb18-2">new_raster <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrows =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncols =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, </span>
<span id="cb18-3">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, </span>
<span id="cb18-4">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb18-5">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vals =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>), </span>
<span id="cb18-6">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)) </span>
<span id="cb18-7"></span>
<span id="cb18-8"></span>
<span id="cb18-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the new raster</span></span>
<span id="cb18-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(new_raster, </span>
<span id="cb18-11">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkblue"</span>, </span>
<span id="cb18-12">             <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>,</span>
<span id="cb18-13">             <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>,</span>
<span id="cb18-14">             <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightblue"</span>), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use blue and white for the design</span></span>
<span id="cb18-15">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb18-16">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-new-raster" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-new-raster-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter2_files/figure-html/fig-new-raster-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Figure&nbsp;5: Creating a new raster from scratch"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/fig-new-raster-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-new-raster-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Creating a new raster from scratch
</figcaption>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>Handling Multi-Layer Rasters</strong>:
<ul>
<li><p><strong>SpatRaster</strong> supports multi-layer rasters, such as satellite or time-series data:</p>
<ul>
<li><p>Use <strong><code>nlyr()</code></strong> to get the number of layers:</p></li>
<li><p>Access layers with <strong><code>[[</code></strong> or <strong><code>$</code></strong>.</p></li>
<li><p>Use <strong><code>subset()</code></strong> for layer extraction:</p></li>
</ul></li>
</ul></li>
<li><strong>Combining Raster Layers</strong>:
<ul>
<li>Merge <strong>SpatRaster</strong> layers using <strong>c()</strong>:</li>
</ul></li>
<li><strong>Saving SpatRaster Objects</strong>:
<ul>
<li>Since they often point to files, direct saving to <strong>.rds</strong> or <strong>.rda</strong> isn’t feasible.</li>
<li>Solutions:
<ol type="1">
<li><strong><code>wrap()</code></strong>: Creates a temporary object for saving or cluster use.</li>
<li><strong><code>writeRaster()</code></strong>: Saves as a regular raster file.</li>
</ol></li>
</ul></li>
</ul>
</section>
</section>
<section id="coordinate-reference-systems" class="level2">
<h2 class="anchored" data-anchor-id="coordinate-reference-systems">2.4 Coordinate Reference Systems</h2>
<ul>
<li>CRSs (Coordinate Reference Systems) are essential for spatial data, defining how spatial elements correspond to the Earth’s surface (or other celestial bodies).</li>
<li><strong>Types of CRSs</strong>:
<ul>
<li><strong>Geographic CRSs</strong>:
<ul>
<li>Represent data on a three-dimensional surface (e.g., latitude and longitude).</li>
<li>Coordinate units are typically degrees.</li>
</ul></li>
<li><strong>Projected CRSs</strong>:
<ul>
<li>Represent data on a two-dimensional, flat plane.</li>
<li>Transform spherical Earth data into a flat map.</li>
<li>Coordinate units can be in meters, feet, etc.</li>
</ul></li>
</ul></li>
</ul>
<section id="geographic-coordinate-reference-systems" class="level3">
<h3 class="anchored" data-anchor-id="geographic-coordinate-reference-systems">2.4.1 Geographic Coordinate Reference Systems</h3>
<ul>
<li>Geographic CRSs use longitude and latitude to identify locations on Earth.
<ul>
<li>Longitude: Measures East-West position relative to the Prime Meridian.</li>
<li>Latitude: Measures North-South position relative to the equatorial plane.</li>
<li>Distances are measured in <strong>angular units (degrees)</strong>, not meters, impacting spatial measurements (explored further in Section 7).</li>
</ul></li>
<li>The Earth can be modeled as spherical or ellipsoidal.
<ul>
<li><strong>Spherical models</strong>: Simplify calculations by assuming Earth is a perfect sphere.</li>
<li><strong>Ellipsoidal models</strong>: More accurately represent Earth with distinct equatorial and polar radii. The equatorial radius is about 11.5 km longer than the polar radius due to Earth’s compression.</li>
</ul></li>
<li><strong>Datum</strong> refers to the model describing the relationship between coordinate values and actual locations on Earth. A datum consists of:
<ol type="1">
<li><p><strong>Ellipsoid</strong>: An idealized mathematical model of the Earth’s shape, which helps to approximate the Earth’s surface.</p></li>
<li><p><strong>Origin Point</strong>: A fixed starting point for the coordinate system, where the ellipsoid is anchored to Earth.</p></li>
<li><p><strong>Offset and Orientation</strong>: How the ellipsoid is aligned with respect to the actual shape of the Earth.</p></li>
</ol></li>
</ul>
<!-- -->
<ul>
<li>The two types of Datums are: —
<ul>
<li><strong>Geocentric datum</strong> (e.g., WGS84): Centered at Earth’s center of gravity, providing global consistency but less local accuracy.</li>
<li><strong>Local datum</strong> (e.g., NAD83): Adjusted for specific regions to better align with the Earth’s surface, accounting for local geographic variations (e.g., mountain ranges).</li>
</ul></li>
</ul>
</section>
<section id="projected-coordinate-reference-systems" class="level3">
<h3 class="anchored" data-anchor-id="projected-coordinate-reference-systems">2.4.2 Projected Coordinate Reference Systems</h3>
<ul>
<li>Projected CRSs are based on geographic CRSs and use map projections to represent Earth’s three-dimensional surface in <strong>Easting</strong> and <strong>Northing</strong> (x and y) values. These CRSs rely on Cartesian coordinates on a flat surface, with an origin and linear units (<em>e.g.,</em> meters).</li>
<li><strong>Deformations</strong>:
<ul>
<li>The conversion from 3D to 2D inherently introduces distortions. Projected CRSs can only preserve one or two of the following properties:
<ul>
<li><strong>Area</strong>: Preserved in <strong>equal-area</strong> projections.</li>
<li><strong>Direction</strong>: Preserved in <strong>azimuthal</strong> projections.</li>
<li><strong>Distance</strong>: Preserved in <strong>equidistant</strong> projections.</li>
<li><strong>Shape</strong>: Preserved in <strong>conformal</strong> projections.</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="types-of-projections-and-their-characteristics" class="level3">
<h3 class="anchored" data-anchor-id="types-of-projections-and-their-characteristics">Types of Projections and Their Characteristics</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 30%">
<col style="width: 23%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Type of Projection</strong></th>
<th><strong>Description</strong></th>
<th><strong>Common Properties Preserved</strong></th>
<th><strong>Best Used For</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Conic</strong></td>
<td>Projects Earth’s surface onto a cone.</td>
<td>Area, shape</td>
<td>Maps of mid-latitude regions</td>
</tr>
<tr class="even">
<td><strong>Cylindrical</strong></td>
<td>Projects Earth’s surface onto a cylinder.</td>
<td>Direction, shape</td>
<td>World maps</td>
</tr>
<tr class="odd">
<td><strong>Planar (Azimuthal)</strong></td>
<td>Projects onto a flat surface at a point or line.</td>
<td>Distance, direction</td>
<td>Polar region maps</td>
</tr>
</tbody>
</table>
</section>
<section id="deformations-by-projection-type" class="level3">
<h3 class="anchored" data-anchor-id="deformations-by-projection-type">Deformations by Projection Type</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 47%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Property</strong></th>
<th><strong>Definition</strong></th>
<th><strong>Projection Type That Preserves It</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Area</strong></td>
<td>The relative size of regions is maintained.</td>
<td>Equal-area projections (e.g., Albers)</td>
</tr>
<tr class="even">
<td><strong>Direction</strong></td>
<td>Bearings from the center are accurate.</td>
<td>Azimuthal projections (e.g., Lambert)</td>
</tr>
<tr class="odd">
<td><strong>Distance</strong></td>
<td>Correct distances are preserved along specific lines or from specific points.</td>
<td>Equidistant projections (e.g., Equirectangular)</td>
</tr>
<tr class="even">
<td><strong>Shape</strong></td>
<td>Local angles and shapes are maintained, though areas are distorted.</td>
<td>Conformal projections (e.g., Mercator)</td>
</tr>
</tbody>
</table>
<ul>
<li>Use the <a href="https://www.geo-projections.com/">Map Projection Explorer</a> for details.</li>
<li>Use <code>st_crs()</code> for querying CRSs in <strong>sf objects</strong> and <code>crs()</code> for <strong>terra objects</strong>.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sf_proj_info</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"proj"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-3">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-4">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label_with</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> snakecase<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>to_title_case) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-5">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_espn</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-6">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>()</span></code></pre></div>
</details>
<div id="tbl-projection-types" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-projection-types-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: A list of the available projections supported by the PROJ library
</figcaption>
<div aria-describedby="tbl-projection-types-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="qrmhsgtppx" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#qrmhsgtppx table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qrmhsgtppx thead, #qrmhsgtppx tbody, #qrmhsgtppx tfoot, #qrmhsgtppx tr, #qrmhsgtppx td, #qrmhsgtppx th {
  border-style: none;
}

#qrmhsgtppx p {
  margin: 0;
  padding: 0;
}

#qrmhsgtppx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qrmhsgtppx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qrmhsgtppx .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qrmhsgtppx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qrmhsgtppx .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qrmhsgtppx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qrmhsgtppx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qrmhsgtppx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qrmhsgtppx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qrmhsgtppx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qrmhsgtppx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qrmhsgtppx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qrmhsgtppx .gt_spanner_row {
  border-bottom-style: hidden;
}

#qrmhsgtppx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qrmhsgtppx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qrmhsgtppx .gt_from_md > :first-child {
  margin-top: 0;
}

#qrmhsgtppx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qrmhsgtppx .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qrmhsgtppx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qrmhsgtppx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qrmhsgtppx .gt_row_group_first td {
  border-top-width: 2px;
}

#qrmhsgtppx .gt_row_group_first th {
  border-top-width: 2px;
}

#qrmhsgtppx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qrmhsgtppx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qrmhsgtppx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qrmhsgtppx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qrmhsgtppx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qrmhsgtppx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qrmhsgtppx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#qrmhsgtppx .gt_striped {
  background-color: #FAFAFA;
}

#qrmhsgtppx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qrmhsgtppx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qrmhsgtppx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qrmhsgtppx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qrmhsgtppx .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qrmhsgtppx .gt_left {
  text-align: left;
}

#qrmhsgtppx .gt_center {
  text-align: center;
}

#qrmhsgtppx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qrmhsgtppx .gt_font_normal {
  font-weight: normal;
}

#qrmhsgtppx .gt_font_bold {
  font-weight: bold;
}

#qrmhsgtppx .gt_font_italic {
  font-style: italic;
}

#qrmhsgtppx .gt_super {
  font-size: 65%;
}

#qrmhsgtppx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#qrmhsgtppx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qrmhsgtppx .gt_indent_1 {
  text-indent: 5px;
}

#qrmhsgtppx .gt_indent_2 {
  text-indent: 10px;
}

#qrmhsgtppx .gt_indent_3 {
  text-indent: 15px;
}

#qrmhsgtppx .gt_indent_4 {
  text-indent: 20px;
}

#qrmhsgtppx .gt_indent_5 {
  text-indent: 25px;
}

#qrmhsgtppx .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#qrmhsgtppx div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="qrmhsgtppx" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="qrmhsgtppx">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"name":["adams_hemi","adams_ws1","adams_ws2","aea","aeqd","affine","airy","aitoff","alsk","apian","august","axisswap","bacon","bertin1953","bipc","boggs","bonne","calcofi","cart","cass","cc","ccon","cea","chamb","collg","col_urban","comill","crast","defmodel","deformation","denoy","eck1","eck2","eck3","eck4","eck5","eck6","eqearth","eqc","eqdc","euler","etmerc","fahey","fouc","fouc_s","gall","geoc","geogoffset","geos","gins8","gn_sinu","gnom","goode","gridshift","gs48","gs50","guyou","hammer","hatano","healpix","rhealpix","helmert","hgridshift","horner","igh","igh_o","imoll","imoll_o","imw_p","isea","kav5","kav7","krovak","labrd","laea","lagrng","larr","lask","lonlat","latlon","lcc","lcca","leac","lee_os","loxim","lsat","mbt_s","mbt_fps","mbtfpp","mbtfpq","mbtfps","merc","mil_os","mill","misrsom","moll","molobadekas","molodensky","murd1","murd2","murd3","natearth","natearth2","nell","nell_h","nicol","nsper","nzmg","noop","ob_tran","ocea","oea","omerc","ortel","ortho","pconic","patterson","peirce_q","pipeline","poly","pop","push","putp1","putp2","putp3","putp3p","putp4p","putp5","putp5p","putp6","putp6p","qua_aut","qsc","robin","rouss","rpoly","s2","sch","set","sinu","som","somerc","stere","sterea","gstmerc","tcc","tcea","times","tinshift","tissot","tmerc","tobmerc","topocentric","tpeqd","tpers","unitconvert","ups","urm5","urmfps","utm","vandg","vandg2","vandg3","vandg4","vertoffset","vitk1","vgridshift","wag1","wag2","wag3","wag4","wag5","wag6","wag7","webmerc","weren","wink1","wink2","wintri","xyzgridshift"],"description":["Adams Hemisphere in a Square","Adams World in a Square I","Adams World in a Square II","Albers Equal Area","Azimuthal Equidistant","Affine transformation","Airy","Aitoff","Modified Stereographic of Alaska","Apian Globular I","August Epicycloidal","Axis ordering","Bacon Globular","Bertin 1953","Bipolar conic of western hemisphere","Boggs Eumorphic","Bonne (Werner lat_1=90)","Cal Coop Ocean Fish Invest Lines/Stations","Geodetic/cartesian conversions","Cassini","Central Cylindrical","Central Conic","Equal Area Cylindrical","Chamberlin Trimetric","Collignon","Colombia Urban","Compact Miller","Craster Parabolic (Putnins P4)","Deformation model","Kinematic grid shift","Denoyer Semi-Elliptical","Eckert I","Eckert II","Eckert III","Eckert IV","Eckert V","Eckert VI","Equal Earth","Equidistant Cylindrical (Plate Carree)","Equidistant Conic","Euler","Extended Transverse Mercator","Fahey","Foucaut","Foucaut Sinusoidal","Gall (Gall Stereographic)","Geocentric Latitude","Geographic Offset","Geostationary Satellite View","Ginsburg VIII (TsNIIGAiK)","General Sinusoidal Series","Gnomonic","Goode Homolosine","Generic grid shift","Modified Stereographic of 48 U.S.","Modified Stereographic of 50 U.S.","Guyou","Hammer & Eckert-Greifendorff","Hatano Asymmetrical Equal Area","HEALPix","rHEALPix","3(6)-, 4(8)- and 7(14)-parameter Helmert shift","Horizontal grid shift","Horner polynomial evaluation","Interrupted Goode Homolosine","Interrupted Goode Homolosine Oceanic View","Interrupted Mollweide","Interrupted Mollweide Oceanic View","International Map of the World Polyconic","Icosahedral Snyder Equal Area","Kavrayskiy V","Kavrayskiy VII","Krovak","Laborde","Lambert Azimuthal Equal Area","Lagrange","Larrivee","Laskowski","Lat/long (Geodetic)","Lat/long (Geodetic alias)","Lambert Conformal Conic","Lambert Conformal Conic Alternative","Lambert Equal Area Conic","Lee Oblated Stereographic","Loximuthal","Space oblique for LANDSAT","McBryde-Thomas Flat-Polar Sine (No. 1)","McBryde-Thomas Flat-Pole Sine (No. 2)","McBride-Thomas Flat-Polar Parabolic","McBryde-Thomas Flat-Polar Quartic","McBryde-Thomas Flat-Polar Sinusoidal","Mercator","Miller Oblated Stereographic","Miller Cylindrical","Space oblique for MISR","Mollweide","Molodensky-Badekas transformation","Molodensky transform","Murdoch I","Murdoch II","Murdoch III","Natural Earth","Natural Earth 2","Nell","Nell-Hammer","Nicolosi Globular","Near-sided perspective","New Zealand Map Grid","No operation","General Oblique Transformation","Oblique Cylindrical Equal Area","Oblated Equal Area","Oblique Mercator","Ortelius Oval","Orthographic","Perspective Conic","Patterson Cylindrical","Peirce Quincuncial","Transformation pipeline manager","Polyconic (American)","Retrieve coordinate value from pipeline stack","Save coordinate value on pipeline stack","Putnins P1","Putnins P2","Putnins P3","Putnins P3'","Putnins P4'","Putnins P5","Putnins P5'","Putnins P6","Putnins P6'","Quartic Authalic","Quadrilateralized Spherical Cube","Robinson","Roussilhe Stereographic","Rectangular Polyconic","S2","Spherical Cross-track Height","Set coordinate value","Sinusoidal (Sanson-Flamsteed)","Space Oblique Mercator","Swiss. Obl. Mercator","Stereographic","Oblique Stereographic Alternative","Gauss-Schreiber Transverse Mercator (aka Gauss-Laborde Reunion)","Transverse Central Cylindrical","Transverse Cylindrical Equal Area","Times","Triangulation based transformation","Tissot","Transverse Mercator","Tobler-Mercator","Geocentric/Topocentric conversion","Two Point Equidistant","Tilted perspective","Unit conversion","Universal Polar Stereographic","Urmaev V","Urmaev Flat-Polar Sinusoidal","Universal Transverse Mercator (UTM)","van der Grinten (I)","van der Grinten II","van der Grinten III","van der Grinten IV","Vertical Offset and Slope","Vitkovsky I","Vertical grid shift","Wagner I (Kavrayskiy VI)","Wagner II","Wagner III","Wagner IV","Wagner V","Wagner VI","Wagner VII","Web Mercator / Pseudo Mercator","Werenskiold I","Winkel I","Winkel II","Winkel Tripel","Geocentric grid shift"]},"columns":[{"id":"name","name":"Name","type":"character","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left","headerStyle":{"font-weight":"normal"}},{"id":"description","name":"Description","type":"character","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left","headerStyle":{"font-weight":"normal"}}],"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"striped":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"#fafafa","style":{"fontFamily":"Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"}},"elementId":"qrmhsgtppx","dataKey":"da11b8da9a0c61d44ce66a7aaa35fe9c"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>
</section>
</section>
<section id="units" class="level2">
<h2 class="anchored" data-anchor-id="units">2.5 Units</h2>
<ul>
<li><p>CRSs include spatial units information, which is crucial for accurately interpreting distance and area.</p></li>
<li><p>Cartographic best practices suggest adding scale indicators on maps to show the relationship between map and ground distances.</p></li>
<li><p><strong>Units in <code>sf</code> Objects</strong>:</p>
<ul>
<li><code>sf</code> objects natively support units for geometric data, ensuring outputs from functions like <code>st_area()</code> come with a <code>units</code> attribute.</li>
<li>This feature, supported by the <code>units</code> package, avoids confusion across different CRSs, which may use meters, feet, etc.</li>
<li>To convert units, use <code>units::set_units()</code></li>
</ul></li>
<li><p><strong>Units in Raster Data</strong>:</p>
<ul>
<li>Unlike <code>sf</code>, raster packages do not natively support units.</li>
<li>Users should be cautious when working with raster data to convert units properly.</li>
<li>An example to calculate the area of India in square meters and then, square kilometres</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load required libraries</span></span>
<span id="cb20-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sf)</span>
<span id="cb20-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(units)</span>
<span id="cb20-4"></span>
<span id="cb20-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate the area of India in square meters</span></span>
<span id="cb20-6">india_area <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rnaturalearth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ne_countries</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb20-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(admin <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"India"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb20-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_area</span>()</span>
<span id="cb20-9">india_area</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3.150428e+12 [m^2]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert area to square kilometers</span></span>
<span id="cb22-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Area of India in square kilometers:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_units</span>(india_area, km<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Area of India in square kilometers: 3150428 [km^2]"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert area to hectares</span></span>
<span id="cb24-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Area of India in hectares:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_units</span>(india_area, ha))))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Area of India in hectares: 315042827 [ha]"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert area to acres</span></span>
<span id="cb26-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Area of India in acres:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_units</span>(india_area, acre))))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Area of India in acres: 778484666 [acre]"</code></pre>
</div>
</div>
</section>
<section id="exercises" class="level2">
<h2 class="anchored" data-anchor-id="exercises"><strong>2.6 Exercises</strong></h2>
<hr>
<section id="e1" class="level3">
<h3 class="anchored" data-anchor-id="e1">E1</h3>
<p>Using <code>summary()</code> on the geometry column of the <code>world</code> data object in the <code>spData</code> package provides valuable information about the spatial characteristics of the dataset:</p>
<ol type="1">
<li><strong>Geometry Type</strong>:
<ul>
<li>The output will indicate the type of geometries present in the <code>world</code> data object. Here, it is <code>MULTIPOLYGON</code> suggesting that the dataset represents the outlines of countries or regions in <strong>MULTIPLOYGON</strong> formats.</li>
</ul></li>
<li><strong>Number of Countries</strong>:
<ul>
<li>The summary will show the number of geometries or features present, which corresponds to the number of countries or regions represented in the <code>world</code> dataset. Here, it is <strong>177 countries</strong>.</li>
</ul></li>
<li><strong>Coordinate Reference System (CRS)</strong>:
<ul>
<li>The output will include details about the CRS, and in the present case it is <strong>EPSG:4326</strong>.</li>
</ul></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>((spData<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>world<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>geom))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> MULTIPOLYGON     epsg:4326 +proj=long... 
          177             0             0 </code></pre>
</div>
</div>
<hr>
</section>
<section id="e2" class="level3">
<h3 class="anchored" data-anchor-id="e2">E2</h3>
<p>To generate the world map, you can run the following code (as shown in Section 2.2.3):</p>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(spData)</span>
<span id="cb30-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(world[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>])</span>
<span id="cb30-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(world[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pop"</span>])</span></code></pre></div>
</details>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-ex2-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ex2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter2_files/figure-html/fig-ex2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Figure&nbsp;6: Reproducing Figure 2.4 of the book"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/fig-ex2-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ex2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Reproducing Figure 2.4 of the book
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-ex2-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ex2-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter2_files/figure-html/fig-ex2-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Figure&nbsp;7: Reproducing Figure 2.4 of the book"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/fig-ex2-2.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ex2-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Reproducing Figure 2.4 of the book
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<ul>
<li><strong>Similarities</strong>:
<ol type="1">
<li>The map displays country boundaries and highlights the global population distribution as shown in the book.</li>
<li>The color scale representing population data is consistent with that described in the book, with larger populations shown with more intense colors.</li>
</ol></li>
<li><strong>Differences</strong>:
<ol type="1">
<li>The aspect ratio or positioning of the map might vary depending on your screen resolution and window size.</li>
<li>The color theme and legend display may differ if your R setup or graphic device uses default settings different from those in the book.</li>
</ol></li>
<li><strong><code>cex</code> Argument</strong>: This parameter controls the size of plotting symbols in R. It is a numeric value that acts as a multiplier for the default size of symbols.
<ul>
<li>Setting <code>cex</code> to values larger than 1 enlarges symbols, while values less than 1 shrink them.</li>
</ul></li>
<li><strong>Reason for <code>cex = sqrt(world$pop) / 10000</code></strong> : The code sets <code>cex</code> to <code>sqrt(world$pop) / 10000</code> to scale the size of the points on the map in proportion to the population of each country. This square root transformation is used to moderate the variation in symbol sizes because population values can vary significantly between countries. Dividing by 10,000 helps to reduce the symbol size to a reasonable range for plotting.</li>
</ul>
<p><strong>Other Ideas: —</strong></p>
<ul>
<li><strong>Bubble Plot</strong>: Overlay a bubble plot on the map with points sized by population.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(world[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pop"</span>])</span>
<span id="cb31-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">points</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_coordinates</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_centroid</span>(world<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>geom)), </span>
<span id="cb31-3">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cex =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(world<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>pop) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span>, </span>
<span id="cb31-4">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter2_files/figure-html/unnamed-chunk-14-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>Choropleth Map</strong>: Use color gradients to represent population density.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tmap)</span>
<span id="cb32-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tm_shape</span>(world) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb32-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tm_polygons</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pop"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"jenks"</span>, </span>
<span id="cb32-4">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Blues"</span>, </span>
<span id="cb32-5">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Population"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter2_files/figure-html/unnamed-chunk-15-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>Log Transformation</strong>: Visualize population using a log scale for better differentiation.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1">world<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>log_pop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log10</span>(world<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>pop <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb33-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(world[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log_pop"</span>])</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter2_files/figure-html/unnamed-chunk-16-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="e3" class="level3">
<h3 class="anchored" data-anchor-id="e3">E3</h3>
<p>To create a map of Nigeria in context and customize it using the <code>plot()</code> function, you can follow these steps:</p>
<p><strong>Step 1:</strong> Load Necessary Libraries and Data: Make sure you have the <code>spData</code> package loaded and access to the world spatial data.</p>
<p><strong>Step 2:</strong> Plotting Nigeria in Context: You can plot Nigeria by subsetting the <code>world</code> data and adjusting parameters such as <code>lwd</code> (line width), <code>col</code> (color), and <code>expandBB</code> (expanding the bounding box). Here’s an example code snippet:</p>
<p><strong>Step 3:</strong> Annotating the Map: To annotate the map with text labels, you can use the <code>text()</code> function. Here’s an example where we add the name of Nigeria and its capital, Abuja:</p>
<p><strong>Step 4:</strong> Exploring the <code>text()</code> Documentation</p>
<ul>
<li><strong><code>lwd</code></strong>: This argument controls the line width for the borders of the countries.</li>
<li><strong><code>col</code></strong>: This argument sets the fill color for the countries. You can customize it based on your preference.</li>
<li><strong><code>expandBB</code></strong>: This argument expands the bounding box of the plot, which can help visualize nearby areas more clearly.</li>
</ul>
<hr>
</section>
<section id="e4" class="level3">
<h3 class="anchored" data-anchor-id="e4">E4</h3>
<p>To create an empty <code>SpatRaster</code> object with 10 columns and 10 rows, assign random values between 0 and 10, and then plot it, you can use the <code>terra</code> package in R. Here’s how you can do it:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(terra)</span>
<span id="cb34-2"></span>
<span id="cb34-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create an empty SpatRaster object with 10 columns and 10 rows</span></span>
<span id="cb34-4">my_raster <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrows =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncols =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb34-5"></span>
<span id="cb34-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Assign random values between 0 and 10</span></span>
<span id="cb34-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(my_raster) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncell</span>(my_raster), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb34-8"></span>
<span id="cb34-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the raster</span></span>
<span id="cb34-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(my_raster, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Random Values Raster"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter2_files/figure-html/unnamed-chunk-17-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="e5" class="level3">
<h3 class="anchored" data-anchor-id="e5">E5</h3>
<p>To read in the <code>raster/nlcd.tif</code> file from the <code>spDataLarge</code> package and examine its properties, you can follow these steps in R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(spDataLarge)</span>
<span id="cb35-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(terra)</span>
<span id="cb35-3"></span>
<span id="cb35-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read the raster file</span></span>
<span id="cb35-5">nlcd_raster <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/nlcd.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>))</span></code></pre></div>
</div>
<p><strong>Information You Can Obtain: —</strong></p>
<ol type="1">
<li><p><strong>Basic Properties</strong>: The <code>print(nlcd_raster)</code> command will provide you with information about the raster, including its dimensions, number of layers, and type of data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check the basic properties of the raster</span></span>
<span id="cb36-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(nlcd_raster)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatRaster 
dimensions  : 1359, 1073, 1  (nrow, ncol, nlyr)
resolution  : 31.5303, 31.52466  (x, y)
extent      : 301903.3, 335735.4, 4111244, 4154086  (xmin, xmax, ymin, ymax)
coord. ref. : NAD83 / UTM zone 12N (EPSG:26912) 
source      : nlcd.tif 
color table : 1 
categories  : levels 
name        :   levels 
min value   :    Water 
max value   : Wetlands </code></pre>
</div>
</div></li>
<li><p><strong>Summary Statistics</strong>: The <code>summary(nlcd_raster)</code> function will give you basic statistics about the raster values, such as minimum, maximum, and mean values. In this case, it tells the number of cells with Forest, Shrubland, Barren, Developed, Cultivated, Wetlands and Other land-use types.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get summary statistics</span></span>
<span id="cb38-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(nlcd_raster)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        levels     
 Forest    :52620  
 Shrubland :37463  
 Barren    : 7290  
 Developed : 1203  
 Cultivated:  596  
 Wetlands  :  443  
 (Other)   :  421  </code></pre>
</div>
</div></li>
<li><p><strong>Extent</strong>: The <code>ext(nlcd_raster)</code> command will provide the geographical extent of the raster, showing the minimum and maximum x and y coordinates.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check the extent of the raster</span></span>
<span id="cb40-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ext</span>(nlcd_raster)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SpatExtent : 301903.344386758, 335735.354381954, 4111244.46098842, 4154086.47216415 (xmin, xmax, ymin, ymax)</code></pre>
</div>
</div></li>
<li><p><strong>Rows and Columns</strong>: You can find the number of rows and columns in the raster using <code>nrow(nlcd_raster)</code> and <code>ncol(nlcd_raster)</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the number of rows and columns</span></span>
<span id="cb42-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(nlcd_raster)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1359</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(nlcd_raster)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1073</code></pre>
</div>
</div></li>
<li><p><strong>Coordinate Reference System (CRS)</strong>: The <code>crs(nlcd_raster)</code> command will return the CRS of the raster, which is essential for spatial analyses.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the coordinate reference system (CRS)</span></span>
<span id="cb46-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crs</span>(nlcd_raster))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] │ PROJCRS["NAD83 / UTM zone 12N",
    │     BASEGEOGCRS["NAD83",
    │         DATUM["North American Datum 1983",
    │             ELLIPSOID["GRS 1980",6378137,298.257222101,
    │                 LENGTHUNIT["metre",1]]],
    │         PRIMEM["Greenwich",0,
    │             ANGLEUNIT["degree",0.0174532925199433]],
    │         ID["EPSG",4269]],
    │     CONVERSION["UTM zone 12N",
    │         METHOD["Transverse Mercator",
    │             ID["EPSG",9807]],
    │         PARAMETER["Latitude of natural origin",0,
    │             ANGLEUNIT["degree",0.0174532925199433],
    │             ID["EPSG",8801]],
    │         PARAMETER["Longitude of natural origin",-111,
    │             ANGLEUNIT["degree",0.0174532925199433],
    │             ID["EPSG",8802]],
    │         PARAMETER["Scale factor at natural origin",0.9996,
    │             SCALEUNIT["unity",1],
    │             ID["EPSG",8805]],
    │         PARAMETER["False easting",500000,
    │             LENGTHUNIT["metre",1],
    │             ID["EPSG",8806]],
    │         PARAMETER["False northing",0,
    │             LENGTHUNIT["metre",1],
    │             ID["EPSG",8807]]],
    │     CS[Cartesian,2],
    │         AXIS["(E)",east,
    │             ORDER[1],
    │             LENGTHUNIT["metre",1]],
    │         AXIS["(N)",north,
    │             ORDER[2],
    │             LENGTHUNIT["metre",1]],
    │     USAGE[
    │         SCOPE["Engineering survey, topographic mapping."],
    │         AREA["North America - between 114°W and 108°W - onshore and offshore. Canada - Alberta; Northwest Territories; Nunavut; Saskatchewan. United States (USA) - Arizona; Colorado; Idaho; Montana; New Mexico; Utah; Wyoming."],
    │         BBOX[31.33,-114,84,-108]],
    │     ID["EPSG",26912]]</code></pre>
</div>
</div></li>
<li><p><strong>Resolution</strong>: You can check the resolution of the raster with the <code>res(nlcd_raster)</code> function, which will indicate the size of each pixel.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check the resolution of the raster</span></span>
<span id="cb48-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">res</span>(nlcd_raster)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 31.53030 31.52466</code></pre>
</div>
</div></li>
<li><p><strong>Values</strong>: The <code>values(nlcd_raster)</code> command allows you to access the actual values contained in the raster. Here, I am printing only the first few values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the values of the raster</span></span>
<span id="cb50-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(nlcd_raster) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     levels
[1,]      4
[2,]      4
[3,]      5
[4,]      4
[5,]      4
[6,]      4</code></pre>
</div>
</div></li>
</ol>
<hr>
</section>
<section id="e6" class="level3">
<h3 class="anchored" data-anchor-id="e6">E6</h3>
<p>To check the Coordinate Reference System (CRS) of the <code>raster/nlcd.tif</code> file from the <code>spDataLarge</code> package, you can use the following steps in R. The CRS provides essential information about how the spatial data is projected on the Earth’s surface.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(spDataLarge)</span>
<span id="cb52-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(terra)</span>
<span id="cb52-3"></span>
<span id="cb52-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read the raster file</span></span>
<span id="cb52-5">nlcd_raster <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/nlcd.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>))</span>
<span id="cb52-6"></span>
<span id="cb52-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check the coordinate reference system (CRS)</span></span>
<span id="cb52-8">nlcd_crs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crs</span>(nlcd_raster)</span>
<span id="cb52-9">nlcd_crs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] │ PROJCRS["NAD83 / UTM zone 12N",
    │     BASEGEOGCRS["NAD83",
    │         DATUM["North American Datum 1983",
    │             ELLIPSOID["GRS 1980",6378137,298.257222101,
    │                 LENGTHUNIT["metre",1]]],
    │         PRIMEM["Greenwich",0,
    │             ANGLEUNIT["degree",0.0174532925199433]],
    │         ID["EPSG",4269]],
    │     CONVERSION["UTM zone 12N",
    │         METHOD["Transverse Mercator",
    │             ID["EPSG",9807]],
    │         PARAMETER["Latitude of natural origin",0,
    │             ANGLEUNIT["degree",0.0174532925199433],
    │             ID["EPSG",8801]],
    │         PARAMETER["Longitude of natural origin",-111,
    │             ANGLEUNIT["degree",0.0174532925199433],
    │             ID["EPSG",8802]],
    │         PARAMETER["Scale factor at natural origin",0.9996,
    │             SCALEUNIT["unity",1],
    │             ID["EPSG",8805]],
    │         PARAMETER["False easting",500000,
    │             LENGTHUNIT["metre",1],
    │             ID["EPSG",8806]],
    │         PARAMETER["False northing",0,
    │             LENGTHUNIT["metre",1],
    │             ID["EPSG",8807]]],
    │     CS[Cartesian,2],
    │         AXIS["(E)",east,
    │             ORDER[1],
    │             LENGTHUNIT["metre",1]],
    │         AXIS["(N)",north,
    │             ORDER[2],
    │             LENGTHUNIT["metre",1]],
    │     USAGE[
    │         SCOPE["Engineering survey, topographic mapping."],
    │         AREA["North America - between 114°W and 108°W - onshore and offshore. Canada - Alberta; Northwest Territories; Nunavut; Saskatchewan. United States (USA) - Arizona; Colorado; Idaho; Montana; New Mexico; Utah; Wyoming."],
    │         BBOX[31.33,-114,84,-108]],
    │     ID["EPSG",26912]]</code></pre>
</div>
</div>
<p><strong>Understanding the CRS Information: —</strong></p>
<p>The output from the <code>crs(nlcd_raster)</code> command will typically include details such as:</p>
<ol type="1">
<li><p><strong>Projection Type</strong>: Indicates whether the CRS is geographic (latitude and longitude) or projected (a flat representation). Here, it is North American <strong>NAD83 / UTM Zone 12 N</strong></p></li>
<li><p><strong>Datum</strong>: Information about the geodetic datum used, which is crucial for accurately locating points on the Earth’s surface. Here, it is North American Datum 1983.</p></li>
<li><p><strong>Coordinate Units</strong>: Specifies the units of measurement used for the coordinates, such as degrees (for geographic CRSs) or meters (for projected CRSs). Here, it is in metres, as shown in:</p>
<pre><code>LENGTHUNIT["metre",1]</code></pre></li>
<li><p><strong>EPSG Code</strong>: If applicable, the output might include an EPSG code, which is a standardized reference number for a specific CRS. This code can be used to look up more detailed information about the CRS. Here, it is: —</p>
<pre><code>ID["EPSG",26912]</code></pre></li>
<li><p><strong>Transformation Parameters</strong>: If it’s a projected CRS, the output may include parameters related to the projection method, such as central meridian, standard parallels, and false easting/northing. Here, they are: —</p>
<pre><code>|         PRIMEM["Greenwich",0,     
│             ANGLEUNIT["degree",0.0174532925199433]],     
│         ID["EPSG",4269]], 
|
|
│     CONVERSION["UTM zone 12N",     
│         METHOD["Transverse Mercator",     
│             ID["EPSG",9807]],     
│         PARAMETER["Latitude of natural origin",0,     
│             ANGLEUNIT["degree",0.0174532925199433],     
│             ID["EPSG",8801]],     
│         PARAMETER["Longitude of natural origin",-111,     
|             ANGLEUNIT["degree",0.0174532925199433],     
│             ID["EPSG",8802]],     
│         PARAMETER["Scale factor at natural origin",0.9996,
│             SCALEUNIT["unity",1],     
│             ID["EPSG",8805]],     
│         PARAMETER["False easting",500000,     
│             LENGTHUNIT["metre",1],     
│             ID["EPSG",8806]],     
│         PARAMETER["False northing",0,     
│             LENGTHUNIT["metre",1],     
│             ID["EPSG",8807]]],</code></pre></li>
</ol>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-sfheaders" class="csl-entry">
Cooley, David. 2024. <span>“Sfheaders: Converts Between r Objects and Simple Feature Objects.”</span> <a href="https://CRAN.R-project.org/package=sfheaders">https://CRAN.R-project.org/package=sfheaders</a>.
</div>
<div id="ref-rasterVis" class="csl-entry">
Oscar Perpiñán, and Robert Hijmans. 2023. <span>“<span></span>rasterVis<span></span>.”</span> <a href="https://oscarperpinan.github.io/rastervis/">https://oscarperpinan.github.io/rastervis/</a>.
</div>
<div id="ref-tmap" class="csl-entry">
Tennekes, Martijn. 2018. <span>“<span></span>Tmap<span></span>: Thematic Maps in <span></span>r<span></span>”</span> 84. <a href="https://doi.org/10.18637/jss.v084.i06">https://doi.org/10.18637/jss.v084.i06</a>.
</div>
</div></section></div> ]]></description>
  <category>Geocomputation with R</category>
  <category>Textbook Solutions</category>
  <guid>https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2.html</guid>
  <pubDate>Sat, 02 Nov 2024 18:30:00 GMT</pubDate>
</item>
</channel>
</rss>
