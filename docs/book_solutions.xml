<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>visage</title>
<link>https://aditya-dahiya.github.io/visage/index.html/book_solutions.html</link>
<atom:link href="https://aditya-dahiya.github.io/visage/index.html/book_solutions.xml" rel="self" type="application/rss+xml"/>
<description>Visualizing Information and Spatial Analysis with ggplot2 Extensions</description>
<generator>quarto-1.5.57</generator>
<lastBuildDate>Sun, 15 Dec 2024 18:30:00 GMT</lastBuildDate>
<item>
  <title>Chapter 5: Geometry operations</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter5.html</link>
  <description><![CDATA[ 




<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sf)        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simple Features in R</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(terra)     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handling rasters in R</span></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyterra) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># For plotting rasters in ggplot2</span></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magrittr)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Using pipes with raster objects</span></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All things tidy; Data Wrangling</span></span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(spData)    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Spatial Datasets</span></span></code></pre></div>
</div>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">5.1 Introduction</h2>
<ul>
<li>Previous chapters introduced geographic datasets’ structure (Chapter 2), attribute-based manipulation (Chapter 3), and spatial relations (Chapter 4).</li>
<li>Focus of this chapter: Manipulating geographic elements of spatial objects.
<ul>
<li>Examples: Creating buffers, simplifying/converting vector geometries, and raster aggregation/resampling.</li>
</ul></li>
<li>Section 5.2: Transforming vector geometries using:
<ul>
<li><strong>Unary operations:</strong> Simplifications, buffers, centroids, and affine transformations (Sections 5.2.1–5.2.4).</li>
<li><strong>Binary operations:</strong> Modifying geometries through clipping and unions (Sections 5.2.5–5.2.7).</li>
<li><strong>Type transformations:</strong> Converting geometry types, e.g., polygons to lines (Section 5.2.8).</li>
</ul></li>
<li>Section 5.3: Raster transformations:
<ul>
<li>Alter pixel size, resolution, extent, and origin.</li>
<li>Align raster datasets for map algebra.</li>
</ul></li>
</ul>
</section>
<section id="geometric-operations-on-vector-data" class="level2">
<h2 class="anchored" data-anchor-id="geometric-operations-on-vector-data">5.2 Geometric operations on vector data</h2>
<ul>
<li>Focus: Operations that modify the geometry of vector (<code>sf</code>) objects.</li>
<li>Key distinction: Works directly on geometry-level objects of class <code>sfc</code>, in addition to <code>sf</code> objects.</li>
<li>Examples: Drilling into geometry to transform, simplify, or reshape vector data.</li>
</ul>
<section id="simplification" class="level3">
<h3 class="anchored" data-anchor-id="simplification">5.2.1 Simplification</h3>
<ul>
<li>Generalizes vector geometries (lines/polygons) for smaller scale maps, reducing memory, disk space, and bandwidth usage. Useful for publishing interactive maps by simplifying complex geometries.</li>
<li><strong>Key Functions and Algorithms</strong>:
<ul>
<li><code>st_simplify()</code> from the <a href="https://r-spatial.github.io/sf/">sf package</a> <span class="citation" data-cites="sf-3">(Pebesma and Bivand 2023)</span>:
<ul>
<li><p>Implements the Douglas-Peucker algorithm (<a href="https://doi.org/10.3138/FM57-6770-U75U-7727">Douglas and Peucker 1973</a>).</p></li>
<li><p>Controlled by <code>dTolerance</code> (generalization level in metres, or map units).</p></li>
<li><p>Simplifies individual geometries but does <strong>not preserve topology</strong>, leading to overlaps or holes.</p></li>
</ul></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>topology (noun): the way in which parts of something are organized, arranged or connected</p>
</div>
</div>
<ul>
<li><code>ms_simplify()</code> from the <a href="https://github.com/ateucher/rmapshaper">rmapshaper package</a> <span class="citation" data-cites="rmapshaper">(Teucher and Russell 2023)</span>:
<ul>
<li>Uses the Visvalingam algorithm (<a href="https://doi.org/10.3138/FM57-6770-U75U-7727">Visvalingam and Whyatt 1993</a>).</li>
<li>Retains topology by default (<code>keep_shapes = TRUE</code>) and allows fine control over the vertex retention (<code>keep</code>: the % of vertices that are to be retained, given as a proportion).</li>
</ul></li>
<li><code>smooth()</code> from the <a href="https://cran.r-project.org/package=smoothr">smoothr package</a>:
<ul>
<li>Smooths edges using techniques like Gaussian kernel regression, Chaikin’s algorithm, or spline interpolation.</li>
<li>Does not reduce vertex count and does not preserve topology.</li>
<li>Key parameter: <code>smoothness</code> (controls Gaussian bandwidth).</li>
</ul></li>
<li>Examples of Simplification are shown in Figure&nbsp;1</li>
<li><strong>Applications of Smoothing</strong>:
<ul>
<li>Suitable for geometries derived from raster vectorization (e.g., Chapter 6).</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Download India's Official states' map from</span></span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://github.com/Aditya-Dahiya/projects_presentations/tree/main/data/india_map</span></span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#### Base Map</span></span>
<span id="cb2-5">india_states <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_sf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"India_State_Boundary.shp"</span>)</span>
<span id="cb2-6"></span>
<span id="cb2-7">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> india_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb2-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Base Map of India: in full detail"</span>,</span>
<span id="cb2-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Source: Census of India"</span></span>
<span id="cb2-14">  )</span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb2-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>,</span>
<span id="cb2-18">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ch5-2-1_1.png"</span>),</span>
<span id="cb2-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb2-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1600</span>,</span>
<span id="cb2-21">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1200</span>,</span>
<span id="cb2-22">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span></span>
<span id="cb2-23">)</span>
<span id="cb2-24"></span>
<span id="cb2-25"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#### st_simplify()</span></span>
<span id="cb2-26">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> india_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_simplify</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dTolerance =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span>    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 100 km tolerance</span></span>
<span id="cb2-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb2-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"India: st_simplify(dTolerance = 100000)"</span>,</span>
<span id="cb2-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Douglas-Peucker algorithm. Topology is lost."</span></span>
<span id="cb2-34">  )</span>
<span id="cb2-35"></span>
<span id="cb2-36"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb2-37">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>,</span>
<span id="cb2-38">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ch5-2-1_2.png"</span>),</span>
<span id="cb2-39">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb2-40">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1600</span>,</span>
<span id="cb2-41">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1200</span>,</span>
<span id="cb2-42">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span></span>
<span id="cb2-43">)</span>
<span id="cb2-44"></span>
<span id="cb2-45"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#### rmapshaper::ms_simplify()</span></span>
<span id="cb2-46">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> india_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-47">  rmapshaper<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ms_simplify</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">keep =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0001</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">keep_shapes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span>    </span>
<span id="cb2-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb2-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"India: rmapshaper::ms_simplify(keep_shapes = TRUE)"</span>,</span>
<span id="cb2-53">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Visvalingam algorithm. Topology is retained."</span></span>
<span id="cb2-54">  )</span>
<span id="cb2-55"></span>
<span id="cb2-56"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb2-57">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>,</span>
<span id="cb2-58">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ch5-2-1_3.png"</span>),</span>
<span id="cb2-59">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb2-60">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1600</span>,</span>
<span id="cb2-61">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1200</span>,</span>
<span id="cb2-62">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span></span>
<span id="cb2-63">)</span>
<span id="cb2-64"></span>
<span id="cb2-65"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#### smoothr::smooth() - 3 methods</span></span>
<span id="cb2-66">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> india_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-67">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_simplify</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dTolerance =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># To save computing time</span></span>
<span id="cb2-68">  smoothr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ksmooth"</span>,</span>
<span id="cb2-69">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">smoothness =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span>    </span>
<span id="cb2-70">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-71">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-72">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-73">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb2-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"smoothr::smooth(method = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">ksmooth</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">)"</span>,</span>
<span id="cb2-75">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gaussian kernel regression. Topology is lost."</span></span>
<span id="cb2-76">  )</span>
<span id="cb2-77"></span>
<span id="cb2-78"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb2-79">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>,</span>
<span id="cb2-80">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ch5-2-1_4.png"</span>),</span>
<span id="cb2-81">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb2-82">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1600</span>,</span>
<span id="cb2-83">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1200</span>,</span>
<span id="cb2-84">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span></span>
<span id="cb2-85">)</span>
<span id="cb2-86"></span>
<span id="cb2-87">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> india_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-88">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_simplify</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dTolerance =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># To save computing time</span></span>
<span id="cb2-89">  smoothr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chaikin"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span>    </span>
<span id="cb2-90">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-91">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-92">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-93">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb2-94">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"smoothr::smooth(method = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">chaikin</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">)"</span>,</span>
<span id="cb2-95">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Chaikin’s corner cutting algorithm. Topology is lost."</span></span>
<span id="cb2-96">  )</span>
<span id="cb2-97"></span>
<span id="cb2-98"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb2-99">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>,</span>
<span id="cb2-100">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ch5-2-1_5.png"</span>),</span>
<span id="cb2-101">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb2-102">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1600</span>,</span>
<span id="cb2-103">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1200</span>,</span>
<span id="cb2-104">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span></span>
<span id="cb2-105">)</span>
<span id="cb2-106"></span>
<span id="cb2-107">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> india_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-108">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_simplify</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dTolerance =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># To save computing time</span></span>
<span id="cb2-109">  smoothr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spline"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span>    </span>
<span id="cb2-110">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-111">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-112">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-113">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb2-114">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"smoothr::smooth(method = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">spline</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">)"</span>,</span>
<span id="cb2-115">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Spline interpolation. Topology is lost."</span></span>
<span id="cb2-116">  )</span>
<span id="cb2-117"></span>
<span id="cb2-118"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb2-119">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>,</span>
<span id="cb2-120">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ch5-2-1_6.png"</span>),</span>
<span id="cb2-121">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb2-122">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1600</span>,</span>
<span id="cb2-123">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1200</span>,</span>
<span id="cb2-124">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span></span>
<span id="cb2-125">)</span></code></pre></div>
</details>
</div>
<div id="fig-simplified" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-simplified-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/ch5-2-1_1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Official Map of India (full details)"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/ch5-2-1_1.png" class="img-fluid figure-img"></a></p>
<figcaption>Official Map of India (full details)</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/ch5-2-1_2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Using st_simplify(dTolerance = 100000), i.e.&nbsp;100 km resolution"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/ch5-2-1_2.png" class="img-fluid figure-img"></a></p>
<figcaption>Using st_simplify(dTolerance = 100000), i.e.&nbsp;100 km resolution</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/ch5-2-1_3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Using rmapshaper::ms_simplify(keep_shape = TRUE) to retain topology"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/ch5-2-1_3.png" class="img-fluid figure-img"></a></p>
<figcaption>Using rmapshaper::ms_simplify(keep_shape = TRUE) to retain topology</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/ch5-2-1_4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Using gaussian kernel regression with smoothr::smooth(method = “ksmooth”)"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/ch5-2-1_4.png" class="img-fluid figure-img"></a></p>
<figcaption>Using gaussian kernel regression with smoothr::smooth(method = “ksmooth”)</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/ch5-2-1_5.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Using Chalkin’s corner cutting algorithm with smoothr::smooth(method = “chalkin”)"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/ch5-2-1_5.png" class="img-fluid figure-img"></a></p>
<figcaption>Using Chalkin’s corner cutting algorithm with smoothr::smooth(method = “chalkin”)</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/ch5-2-1_6.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Using spline interpolation with smoothr::smooth(method = “spline”)"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/ch5-2-1_6.png" class="img-fluid figure-img"></a></p>
<figcaption>Using spline interpolation with smoothr::smooth(method = “spline”)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-simplified-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1
</figcaption>
</figure>
</div>
<section id="smoothr" class="level4">
<h4 class="anchored" data-anchor-id="smoothr"><code>smoothr</code></h4>
<p>A short note on the <strong>{smoothr}</strong> package <span class="citation" data-cites="smoothr-2">(Strimas-Mackey 2023)</span>, which uses three different types of algorithms:-.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sf)</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(smoothr)</span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Smooth polygons using different methods</span></span>
<span id="cb3-6">p_smooth_chaikin <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">smooth</span>(jagged_polygons, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chaikin"</span>)</span>
<span id="cb3-7">p_smooth_ksmooth <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">smooth</span>(jagged_polygons, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ksmooth"</span>)</span>
<span id="cb3-8">p_smooth_spline <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">smooth</span>(jagged_polygons, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spline"</span>)</span>
<span id="cb3-9"></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combine data for plotting</span></span>
<span id="cb3-11">plot_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_rows</span>(</span>
<span id="cb3-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>(p_smooth_chaikin), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chaikin"</span>),</span>
<span id="cb3-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>(p_smooth_ksmooth), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ksmooth"</span>),</span>
<span id="cb3-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>(p_smooth_spline), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spline"</span>),</span>
<span id="cb3-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>(jagged_polygons), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"original"</span>)</span>
<span id="cb3-16">)</span>
<span id="cb3-17"></span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Assign colors to methods</span></span>
<span id="cb3-19">method_colors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb3-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">chaikin =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E41A1C"</span>,</span>
<span id="cb3-21">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ksmooth =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#4DAF4A"</span>,</span>
<span id="cb3-22">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">spline =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#377EB8"</span></span>
<span id="cb3-23">)</span>
<span id="cb3-24"></span>
<span id="cb3-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert geometry for plotting</span></span>
<span id="cb3-26">plot_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plot_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sfc</span>(geometry)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>()</span>
<span id="cb3-29"></span>
<span id="cb3-30">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plot_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(method <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"original"</span>)</span>
<span id="cb3-32"></span>
<span id="cb3-33">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plot_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(method <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"original"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>method)</span>
<span id="cb3-36"></span>
<span id="cb3-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot with ggplot2</span></span>
<span id="cb3-38">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> p2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> geometry, </span>
<span id="cb3-40">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> method),</span>
<span id="cb3-41">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>,</span>
<span id="cb3-42">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb3-43">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb3-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> p1,</span>
<span id="cb3-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey50"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>),</span>
<span id="cb3-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb3-48">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> method_colors) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> method) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb3-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb3-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb3-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb3-57">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-58">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb3-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Simplification with {smoothr}"</span>,</span>
<span id="cb3-60">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Method"</span></span>
<span id="cb3-61">  )</span>
<span id="cb3-62"></span>
<span id="cb3-63"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb3-64">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>,</span>
<span id="cb3-65">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ch5-2-1_7.png"</span>),</span>
<span id="cb3-66">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb3-67">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>,</span>
<span id="cb3-68">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1200</span>,</span>
<span id="cb3-69">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span></span>
<span id="cb3-70">)</span></code></pre></div>
</details>
</div>
<p><a href="images/ch5-2-1_7.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/ch5-2-1_7.png" class="img-fluid"></a></p>
</div>
</div>
</section>
</section>
<section id="centroids" class="level3">
<h3 class="anchored" data-anchor-id="centroids">5.2.2 Centroids</h3>
<ul>
<li><p>Identify the center of geographic objects, creating single-point representations of complex geometries using <code>st_centroid()</code></p></li>
<li><p><strong>Types of Centroids</strong>: (shown in Figure&nbsp;2)</p>
<ol type="1">
<li><strong>Geographic Centroid</strong> (center of mass):
<ul>
<li>Balances a spatial object (like balancing a plate).</li>
<li>Useful for creating simple point representations or estimating distances between polygons.</li>
<li>Calculated with <code>st_centroid()</code> from the <a href="https://r-spatial.github.io/sf/">sf package</a>.</li>
<li>Limitation: Centroids may fall outside the object (e.g., doughnut-shaped polygons).</li>
</ul></li>
<li><strong>Point on Surface</strong>:
<ul>
<li>Ensures the point lies <strong>within</strong> the object boundaries.</li>
<li>Useful for labeling irregular polygons, such as islands or multipolygon geometries.</li>
<li>Calculated with <code>st_point_on_surface()</code>.</li>
</ul></li>
</ol></li>
<li><p><strong>Other Centroid Types</strong>: Chebyshev center and visual center</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Extra Condensed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>)</span>
<span id="cb4-2">showtext<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb4-3"></span>
<span id="cb4-4">ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(</span>
<span id="cb4-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb4-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>,</span>
<span id="cb4-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb4-8">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb4-10">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-11">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb4-12">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb4-13">      ),</span>
<span id="cb4-14">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span></span>
<span id="cb4-15">    )</span>
<span id="cb4-16">)</span>
<span id="cb4-17"></span>
<span id="cb4-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Focussing on the Island Chains of India</span></span>
<span id="cb4-19">andaman <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> india_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(</span>
<span id="cb4-21">    State_Name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Andaman &amp; Nicobar"</span></span>
<span id="cb4-22">  )</span>
<span id="cb4-23">  </span>
<span id="cb4-24">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(andaman) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb4-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Base Map"</span>,</span>
<span id="cb4-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Andaman &amp; Nicobar</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Islands (India)"</span></span>
<span id="cb4-29">  )</span>
<span id="cb4-30"></span>
<span id="cb4-31">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb4-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> andaman</span>
<span id="cb4-34">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb4-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_centroid</span>(andaman),</span>
<span id="cb4-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>,</span>
<span id="cb4-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, </span>
<span id="cb4-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stroke =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb4-41">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb4-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"st_centroid()"</span>,</span>
<span id="cb4-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Andaman &amp; Nicobar</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Islands (India)"</span></span>
<span id="cb4-45">  )</span>
<span id="cb4-46"></span>
<span id="cb4-47">g3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb4-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> andaman</span>
<span id="cb4-50">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb4-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_centroid</span>(andaman, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">of_largest_polygon =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb4-53">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>,</span>
<span id="cb4-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, </span>
<span id="cb4-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stroke =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb4-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb4-58">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb4-60">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"st_centroid</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(of_largest_polygon = TRUE)"</span>,</span>
<span id="cb4-61">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Andaman &amp; Nicobar</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Islands (India)"</span></span>
<span id="cb4-62">  )</span>
<span id="cb4-63"></span>
<span id="cb4-64">g4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-65">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb4-66">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> andaman</span>
<span id="cb4-67">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-68">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb4-69">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_point_on_surface</span>(andaman),</span>
<span id="cb4-70">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>,</span>
<span id="cb4-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, </span>
<span id="cb4-72">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stroke =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb4-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb4-75">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-76">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb4-77">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"st_point_on_surface()"</span>,</span>
<span id="cb4-78">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Andaman &amp; Nicobar</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Islands (India)"</span></span>
<span id="cb4-79">  )</span>
<span id="cb4-80"></span>
<span id="cb4-81"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb4-82">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb4-83">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb4-84">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter5-2-2_1.png"</span>),</span>
<span id="cb4-85">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> patchwork<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wrap_plots</span>(g1, g2, g3, g4, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb4-86">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1900</span>,</span>
<span id="cb4-87">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2400</span>,</span>
<span id="cb4-88">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span></span>
<span id="cb4-89">)</span></code></pre></div>
</details>
</div>
<div id="fig-5-2-2-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-5-2-2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter5-2-2_1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;2: Various centroids using st_centroid() and st_point_on_surface()"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter5-2-2_1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-5-2-2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Various centroids using st_centroid() and st_point_on_surface()
</figcaption>
</figure>
</div>
</section>
<section id="buffers" class="level3">
<h3 class="anchored" data-anchor-id="buffers">5.2.3 Buffers</h3>
<ul>
<li>Buffers are <strong>polygons</strong> representing areas within a specified distance from a geometric feature (point, line, or polygon).</li>
<li><strong>Purpose</strong>: Used for geographic <strong>data analysis</strong> (not just visualization). Examples:
<ul>
<li>How many points are within a given distance of a line?</li>
<li>Which demographic groups are within travel range of a new shop?</li>
</ul></li>
<li><strong><code>st_buffer()</code></strong> from the <a href="https://r-spatial.github.io/sf/">sf package</a>. Example Visualization is shown in Figure&nbsp;3
<ul>
<li><strong>Input</strong>: Geometry and <code>dist</code> (distance in CRS units, e.g., meters).</li>
<li><strong>Output</strong>: <strong>One buffer polygon per geometry feature.</strong></li>
</ul></li>
<li><strong>Other Key Arguments in <code>st_buffer()</code></strong>:
<ul>
<li><strong><code>nQuadSegs</code></strong> (GEOS engine):
<ul>
<li>Number of segments per quadrant (default: 30).</li>
<li>Adjust: Decrease for memory concerns, or increase for high resolution output.</li>
</ul></li>
<li><strong><code>max_cells</code></strong> (S2 engine):
<ul>
<li>Higher values create smoother buffers (slower computation).</li>
</ul></li>
<li><strong><code>endCapStyle</code> and <code>joinStyle</code></strong> (GEOS engine):
<ul>
<li>Control buffer edge appearance (useful for lines).</li>
</ul></li>
<li><strong><code>singleSide</code></strong> (GEOS engine):
<ul>
<li>Buffer on one or both sides of the geometry.</li>
</ul></li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">a1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> andaman <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_cast</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"POLYGON"</span>)</span>
<span id="cb5-3"></span>
<span id="cb5-4">a2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_buffer</span>(a1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_factor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>()))</span>
<span id="cb5-6"></span>
<span id="cb5-7">a3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_buffer</span>(a1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nQuadSegs =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_factor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>()))</span>
<span id="cb5-9"></span>
<span id="cb5-10">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> a1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb5-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Base Map with</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">st_cast(</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">POLYGON</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">)"</span>,</span>
<span id="cb5-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nicobar Islands"</span></span>
<span id="cb5-15">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb5-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9.5</span>),</span>
<span id="cb5-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span></span>
<span id="cb5-19">  )</span>
<span id="cb5-20"></span>
<span id="cb5-21">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb5-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> a2,</span>
<span id="cb5-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> id),</span>
<span id="cb5-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb5-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb5-27">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb5-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> a1</span>
<span id="cb5-30">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb5-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"With 20 km buffer</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> around each island"</span>,</span>
<span id="cb5-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nicobar Islands; each</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">buffer in separate colour"</span></span>
<span id="cb5-34">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb5-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9.5</span>),</span>
<span id="cb5-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span></span>
<span id="cb5-39">  )</span>
<span id="cb5-40"></span>
<span id="cb5-41"></span>
<span id="cb5-42">g3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb5-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> a3,</span>
<span id="cb5-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> id),</span>
<span id="cb5-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb5-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb5-48">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb5-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> a1</span>
<span id="cb5-51">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb5-53">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"With 20 km buffer</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> around each island"</span>,</span>
<span id="cb5-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nicobar Islands;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">arugment (nQuadSegs = 1)"</span></span>
<span id="cb5-55">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb5-58">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9.5</span>),</span>
<span id="cb5-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span></span>
<span id="cb5-60">  )</span>
<span id="cb5-61"></span>
<span id="cb5-62"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb5-63">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb5-64">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb5-65">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter5-2-3_1.png"</span>),</span>
<span id="cb5-66">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> patchwork<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wrap_plots</span>(g1, g2, g3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb5-67">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1200</span>,</span>
<span id="cb5-68">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>,</span>
<span id="cb5-69">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span></span>
<span id="cb5-70">)</span></code></pre></div>
</details>
</div>
<div id="fig-5-2-3-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-5-2-3-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/chapter5-2-3_1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Figure&nbsp;3: Use of st_buffer()"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter5-2-3_1.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-5-2-3-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Use of st_buffer()
</figcaption>
</figure>
</div>
</section>
<section id="affine-transformations" class="level3">
<h3 class="anchored" data-anchor-id="affine-transformations">5.2.4 Affine Transformations</h3>
<ul>
<li>Definition: Transformations that preserve <strong>lines and parallelism</strong> but not necessarily angles or lengths.</li>
<li><strong>Types of Affine Transformations</strong>:
<ol type="1">
<li><p><strong>Shifting (Translation)</strong>: Moves every point by a constant distance.</p>
<ul>
<li><p>Example: Adding a vector to shift all <strong>y-coordinates</strong> north by 400 km distance while keeping <strong>x-coordinates</strong> unchanged using:</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">n_shift <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> n1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400000</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_set_crs</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(n1))</span></code></pre></div></li>
<li><p><em>Note: This converts the CRS of the new sfc object to <code>NA</code> and thus needs <code>st_set_crs()</code> to return it back to the original CRS.</em></p></li>
</ul></li>
<li><p><strong>Scaling</strong>: Enlarges or shrinks geometries.</p>
<ul>
<li><strong>Global Scaling</strong>:
<ul>
<li>Multiplies all coordinates relative to the origin, preserving <strong>topological relations</strong>.</li>
</ul></li>
<li><strong>Local Scaling</strong>:
<ul>
<li><p>Scales geometries around specific points (e.g., centroids).</p></li>
<li><p>Steps:</p>
<ol type="1">
<li>Shift geometries so the centroid becomes (0,0).</li>
<li>Scale by a factor.</li>
<li>Shift back to original centroid coordinates.</li>
</ol></li>
<li><p>Example: Enlarge the geometries by a factor of 2.5.</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">n1_scale <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (n1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> n1_centroid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">multiply_by</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add</span>(n1_centroid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_set_crs</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(n1))</span></code></pre></div></li>
</ul></li>
</ul></li>
<li><p><strong>Rotation</strong>: Rotates coordinates using a <strong>rotation matrix</strong>.</p>
<ul>
<li>Rotation matrix: Define a function to create the rotation matrix and apply it to the geometry. R=[cosθ/sinθ​ − sinθ/cosθ​]</li>
</ul></li>
</ol></li>
<li><strong>Replacing Old Geometry</strong>: Use <code>st_set_geometry()</code> from the <a href="https://r-spatial.github.io/sf/">sf package</a> to finally Replace original geometry with scaled versions (shifted, rotated or scaled)</li>
<li><strong>Applications</strong>:
<ul>
<li>Shifting: For <strong>label placement</strong>.</li>
<li>Scaling: In non-contiguous cartograms (see <a href="https://r.geocompx.org/cartograms.html">Section 9.6</a>).</li>
<li>Rotation: Correcting distorted geometries during re-projection.</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Extra Condensed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>)</span>
<span id="cb8-2">showtext<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb8-3"></span>
<span id="cb8-4">ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(</span>
<span id="cb8-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb8-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>,</span>
<span id="cb8-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb8-8">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb8-10">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb8-11">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb8-12">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb8-13">      ),</span>
<span id="cb8-14">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb8-15">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb8-16">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb8-17">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb8-18">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span></span>
<span id="cb8-19">      )</span>
<span id="cb8-20">    )</span>
<span id="cb8-21">)</span>
<span id="cb8-22"></span>
<span id="cb8-23">df1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> andaman <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_cast</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"POLYGON"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb8-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb8-29">      id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nicobar Islands"</span>,</span>
<span id="cb8-30">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.default =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Andaman Islands"</span></span>
<span id="cb8-31">    )</span>
<span id="cb8-32">  )</span>
<span id="cb8-33"></span>
<span id="cb8-34"></span>
<span id="cb8-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pull out only sfc class (i.e. geometry for Andaman Islands)</span></span>
<span id="cb8-36">a1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Andaman Islands"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_geometry</span>()</span>
<span id="cb8-39"></span>
<span id="cb8-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pull out only sfc class (i.e. geometry for Nicobar Islands)</span></span>
<span id="cb8-41">n1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nicobar Islands"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_geometry</span>()</span>
<span id="cb8-44"></span>
<span id="cb8-45"></span>
<span id="cb8-46">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> name)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> id)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb8-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">13.5</span>),</span>
<span id="cb8-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span></span>
<span id="cb8-53">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb8-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Base Map"</span>,</span>
<span id="cb8-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10 Largest Islands amongst</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Andamand and Nicobar Island chain"</span>,</span>
<span id="cb8-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb8-58">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#89973DFF"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E8B92FFF"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-60">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb8-61">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left"</span></span>
<span id="cb8-62">  )</span>
<span id="cb8-63"></span>
<span id="cb8-64">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-65">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> a1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#89973DFF"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-66">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> n1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E8B92FFF"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-67">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb8-68">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">13.5</span>),</span>
<span id="cb8-69">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span></span>
<span id="cb8-70">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb8-71">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb8-72">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Plotting as separate</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">sfc objects"</span>,</span>
<span id="cb8-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10 Largest Islands"</span></span>
<span id="cb8-74">  )</span>
<span id="cb8-75"></span>
<span id="cb8-76"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#################### Shifting #########################</span></span>
<span id="cb8-77"></span>
<span id="cb8-78">n_shift <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> n1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-79">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400000</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-80">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_set_crs</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(n1))</span>
<span id="cb8-81"></span>
<span id="cb8-82">g3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-83">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> a1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#89973DFF"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-84">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb8-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> n_shift, </span>
<span id="cb8-86">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E8B92FFF"</span>, </span>
<span id="cb8-87">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb8-88">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-89">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb8-90">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">13.5</span>),</span>
<span id="cb8-91">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span></span>
<span id="cb8-92">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-93">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb8-94">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Shifting sfc objects"</span>,</span>
<span id="cb8-95">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bring Nicobar Islands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">closer to the Andamans"</span></span>
<span id="cb8-96">  )</span>
<span id="cb8-97"></span>
<span id="cb8-98"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#################### Scaling ##########################</span></span>
<span id="cb8-99"></span>
<span id="cb8-100">n1_centroid <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_centroid</span>(n1)</span>
<span id="cb8-101"></span>
<span id="cb8-102">n1_scale <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (n1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> n1_centroid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-103">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">multiply_by</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-104">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add</span>(n1_centroid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-105">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_set_crs</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(n1))</span>
<span id="cb8-106"></span>
<span id="cb8-107">g4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-108">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> a1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#89973DFF"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-109">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb8-110">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> n1_scale, </span>
<span id="cb8-111">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E8B92FFF"</span>, </span>
<span id="cb8-112">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb8-113">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-114">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb8-115">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">13.5</span>),</span>
<span id="cb8-116">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span></span>
<span id="cb8-117">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb8-118">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb8-119">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Scaling sfc objects"</span>,</span>
<span id="cb8-120">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Enlarging Nicobar Islands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">by 2.5 times."</span></span>
<span id="cb8-121">  )</span>
<span id="cb8-122"></span>
<span id="cb8-123"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##################### Rotation ########################</span></span>
<span id="cb8-124">rotation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(a){</span>
<span id="cb8-125">  r <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> a <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#degrees to radians</span></span>
<span id="cb8-126">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(r), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(r), <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(r), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(r)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb8-127">} </span>
<span id="cb8-128"></span>
<span id="cb8-129">n1_rotate <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (n1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> n1_centroid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-130">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">multiply_by</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rotation</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-131">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add</span>(n1_centroid) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-132">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_set_crs</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(n1))</span>
<span id="cb8-133"></span>
<span id="cb8-134"></span>
<span id="cb8-135">g5 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-136">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> a1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#89973DFF"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-137">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb8-138">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> n1_rotate, </span>
<span id="cb8-139">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E8B92FFF"</span>, </span>
<span id="cb8-140">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb8-141">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-142">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb8-143">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">13.5</span>),</span>
<span id="cb8-144">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span></span>
<span id="cb8-145">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb8-146">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb8-147">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rotating sfc objects"</span>,</span>
<span id="cb8-148">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rotating Nicobar Islands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">clockwise by 90 degrees"</span></span>
<span id="cb8-149">  )</span>
<span id="cb8-150"></span>
<span id="cb8-151">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> patchwork<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wrap_plots</span>(g1, g3, g4, g5) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-152">  patchwork<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">widths =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb8-153"></span>
<span id="cb8-154"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb8-155">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"book_solutions"</span>, </span>
<span id="cb8-156">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>, </span>
<span id="cb8-157">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chapter5-2-4_1.png"</span>),</span>
<span id="cb8-158">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb8-159">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1200</span>,</span>
<span id="cb8-160">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2500</span>,</span>
<span id="cb8-161">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span></span>
<span id="cb8-162">)</span></code></pre></div>
</details>
</div>
<p><a href="images/chapter5-2-4_1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/chapter5-2-4_1.png" class="img-fluid"></a></p>
</section>
<section id="data-viz-demonstration" class="level3">
<h3 class="anchored" data-anchor-id="data-viz-demonstration">Data Viz demonstration</h3>
<p>Here’s a more visually appealing version of the same graphic, produced using complete <a href="https://aditya-dahiya.github.io/projects_presentations/data_vizs/sf_affine_transformations.html#how-i-made-this-graphic">code</a> given on <a href="https://aditya-dahiya.github.io/projects_presentations/data_vizs/sf_affine_transformations.html">this page</a>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/sf_affine_transformations.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="This plot demonstrates the application of spatial transformations on the Andaman and Nicobar Islands using the `sf` package in R. It showcases four techniques: base mapping, northward shifting, scaling (enlargement), and rotation (90° clockwise), highlighting their effects on spatial geometries. The `facet_wrap` function neatly organizes the transformations for comparison, while `geom_sf` and custom labels enhance the visualization."><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/images/sf_affine_transformations.png" class="img-fluid figure-img" alt="This plot demonstrates the application of spatial transformations on the Andaman and Nicobar Islands using the `sf` package in R. It showcases four techniques: base mapping, northward shifting, scaling (enlargement), and rotation (90° clockwise), highlighting their effects on spatial geometries. The `facet_wrap` function neatly organizes the transformations for comparison, while `geom_sf` and custom labels enhance the visualization."></a></p>
<figcaption>This plot demonstrates the application of spatial transformations on the Andaman and Nicobar Islands using the `sf` package in R. It showcases four techniques: base mapping, northward shifting, scaling (enlargement), and rotation (90° clockwise), highlighting their effects on spatial geometries. The `facet_wrap` function neatly organizes the transformations for comparison, while `geom_sf` and custom labels enhance the visualization.</figcaption>
</figure>
</div>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-sf-3" class="csl-entry">
Pebesma, Edzer, and Roger Bivand. 2023. <span>“<span></span>Spatial Data Science: With Applications in r<span></span>.”</span> <a href="https://doi.org/10.1201/9780429459016">https://doi.org/10.1201/9780429459016</a>.
</div>
<div id="ref-smoothr-2" class="csl-entry">
Strimas-Mackey, Matthew. 2023. <span>“Smoothr: Smooth and Tidy Spatial Features.”</span> <a href="https://CRAN.R-project.org/package=smoothr">https://CRAN.R-project.org/package=smoothr</a>.
</div>
<div id="ref-rmapshaper" class="csl-entry">
Teucher, Andy, and Kenton Russell. 2023. <span>“Rmapshaper: Client for ’Mapshaper’ for ’Geospatial’ Operations.”</span> <a href="https://CRAN.R-project.org/package=rmapshaper">https://CRAN.R-project.org/package=rmapshaper</a>.
</div>
</div></section></div> ]]></description>
  <category>Geocomputation with R</category>
  <category>Textbook Solutions</category>
  <guid>https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter5.html</guid>
  <pubDate>Sun, 15 Dec 2024 18:30:00 GMT</pubDate>
</item>
<item>
  <title>Chapter 4: Spatial data operations</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4.html</link>
  <description><![CDATA[ 




<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sf)        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simple Features in R</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(terra)     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handling rasters in R</span></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyterra) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># For plotting rasters in ggplot2</span></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magrittr)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Using pipes with raster objects</span></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All things tidy; Data Wrangling</span></span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(spData)    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Spatial Datasets</span></span>
<span id="cb1-7"></span>
<span id="cb1-8"></span>
<span id="cb1-9">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Extra Condensed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>)</span>
<span id="cb1-10">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>)</span>
<span id="cb1-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb1-12">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>))</span>
<span id="cb1-13">showtext<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span></code></pre></div>
</div>
<section id="introduction-to-spatial-operations" class="level2">
<h2 class="anchored" data-anchor-id="introduction-to-spatial-operations">4.1 Introduction to Spatial Operations</h2>
<ul>
<li><strong>Spatial Operations</strong>: Include spatial joins for vectors and local/focal operations for rasters, allowing modification based on location and shape.
<ul>
<li>Relation to Non-Spatial Operations: Many spatial operations (e.g., subsetting, joining) have non-spatial counterparts.</li>
</ul></li>
<li><strong>Spatial Joins</strong>: Can be done in multiple ways (e.g., <strong>intersect</strong>, <strong>within distance</strong>), unlike non-spatial joins <em>(refer to <a href="https://cran.r-project.org/web/packages/fuzzyjoin/index.html">fuzzyjoin</a> package <span class="citation" data-cites="fuzzyjoin">(Robinson 2020)</span> for alternatives).</em>
<ul>
<li>Types of Spatial Relationships: Includes operations like intersects and disjoint. Distance calculations explore spatial relationships.</li>
</ul></li>
<li><strong>Raster Operations</strong>:
<ol type="1">
<li>Subsetting (Section 4.3.1)</li>
<li>Map Algebra: Modifies raster cell values through local, focal, zonal, and global operations (Sections 4.3.3 to 4.3.6).</li>
<li>Merging Rasters: Demonstrated with reproducible examples (Section 4.3.8).</li>
</ol></li>
<li><strong>Coordinate Reference System (CRS)</strong>: Consistency in CRS is essential for spatial operations..</li>
</ul>
</section>
<section id="spatial-operations-on-vector-data" class="level2">
<h2 class="anchored" data-anchor-id="spatial-operations-on-vector-data">4.2 Spatial operations on vector data</h2>
<section id="spatial-subsetting-use-st_filter" class="level3">
<h3 class="anchored" data-anchor-id="spatial-subsetting-use-st_filter">4.2.1 Spatial Subsetting: use <code>st_filter()</code></h3>
<ul>
<li>Spatial subsetting extracts features from a spatial object (<code>x</code>) that relate spatially to another object (<code>y</code>).</li>
<li>Syntax: Use the <code>[ ]</code> operator: <code>x[y, , op = st_intersects]</code>.
<ul>
<li><p><code>x</code>: Target <code>sf</code> object.</p></li>
<li><p><code>y</code>: Subsetting <code>sf</code> object.</p></li>
<li><p><code>op</code>: Topological relation (default is <code>st_intersects</code>).</p>
<p><a href="https://r-spatial.github.io/sf/">sf package documentation</a></p></li>
</ul></li>
<li>Default Operator: <code>st_intersects()</code> selects features intersecting with the subsetting object. Alternative operators like <code>st_disjoint()</code> can be used for different relations.
<ul>
<li>Example: <code>nz_height[canterbury, ]</code> returns high points within Canterbury from the <code>nz_height</code> dataset in the spData package (<a href="https://nowosad.github.io/spData/">spData documentation</a>).</li>
</ul></li>
<li>Topological Relations: Include <code>touches</code>, <code>crosses</code>, and <code>within</code>. These determine spatial relationships between features in <code>x</code> and <code>y</code>.</li>
<li>Sparse Geometry Binary Predicate (sgbp):
<ul>
<li>Using <code>st_intersects()</code>, an <code>sgbp</code> list object is created.</li>
<li>Convert <code>sgbp</code> to logical vector for subsetting using <code>lengths({sgbp_object_name} &gt; 0)</code></li>
<li>Using <code>sparse = FALSE</code> argument in <code>st_intersects()</code> returns a dense matrix.</li>
</ul></li>
<li>Tidyverse Alternative: <a href="https://r-spatial.github.io/sf/reference/st_filter.html"><code>st_filter()</code></a> from the sf package simplifies spatial subsetting, increasing compatibility with <code>dplyr</code>.</li>
<li>Output Consistency: Subsets created using <code>[ ]</code>, logical vectors, or <code>st_filter()</code> are equivalent in spatial operations.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nz"</span>)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nz_height"</span>)</span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>(nz)</span>
<span id="cb2-5"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] "sf"         "data.frame"</span></span>
<span id="cb2-6"></span>
<span id="cb2-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A plot for all regions and all peaks</span></span>
<span id="cb2-8">nz <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-11">  ggrepel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text_repel</span>(</span>
<span id="cb2-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb2-13">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> Name,</span>
<span id="cb2-14">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> geom</span>
<span id="cb2-15">    ),</span>
<span id="cb2-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb2-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb2-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf_coordinates"</span></span>
<span id="cb2-19">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb2-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> nz_height,</span>
<span id="cb2-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb2-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>,</span>
<span id="cb2-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb2-25">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(</span>
<span id="cb2-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pink"</span>)</span>
<span id="cb2-28">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb2-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"All peaks in New Zealand, and all regions."</span></span>
<span id="cb2-31">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb2-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(</span>
<span id="cb2-35">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightblue"</span>,</span>
<span id="cb2-36">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb2-37">    ),</span>
<span id="cb2-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span></span>
<span id="cb2-39">  )</span>
<span id="cb2-40"></span>
<span id="cb2-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Total peaks in New Zealand</span></span>
<span id="cb2-42">nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>()</span>
<span id="cb2-43"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] 101   3</span></span>
<span id="cb2-44"></span>
<span id="cb2-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Peaks within Canterbury in New Zealand</span></span>
<span id="cb2-46"></span>
<span id="cb2-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Base R Version</span></span>
<span id="cb2-48">canterbury <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nz <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canterbury"</span>)</span>
<span id="cb2-49">nz_height[canterbury,] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>()</span>
<span id="cb2-50"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] 70  3</span></span>
<span id="cb2-51"></span>
<span id="cb2-52"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tidyverse Version</span></span>
<span id="cb2-53">nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb2-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_filter</span>(</span>
<span id="cb2-55">    nz <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canterbury"</span>),</span>
<span id="cb2-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.predicate =</span> st_intersects</span>
<span id="cb2-57">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-58">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>()</span>
<span id="cb2-59"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] 70  3</span></span>
<span id="cb2-60"></span>
<span id="cb2-61"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Getting the peaks which are inside Canterbury</span></span>
<span id="cb2-62">canterbury_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb2-63">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_filter</span>(</span>
<span id="cb2-64">    nz <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canterbury"</span>),</span>
<span id="cb2-65">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.predicate =</span> st_intersects</span>
<span id="cb2-66">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-67">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(t50_fid)</span>
<span id="cb2-68"></span>
<span id="cb2-69">nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-70">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">in_canterbury =</span> t50_fid <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> canterbury_ids) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-71">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-72">  </span>
<span id="cb2-73">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Base NZ Map and Label for Canterbury</span></span>
<span id="cb2-74">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb2-75">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> nz,</span>
<span id="cb2-76">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb2-77">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canterbury"</span></span>
<span id="cb2-78">    )</span>
<span id="cb2-79">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-80">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf_text</span>(</span>
<span id="cb2-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(nz, Name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canterbury"</span>),</span>
<span id="cb2-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb2-83">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> Name,</span>
<span id="cb2-84">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> geom</span>
<span id="cb2-85">    ),</span>
<span id="cb2-86">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb2-87">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb2-88">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-89">  </span>
<span id="cb2-90">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plotting the peaks, and colouring by presence in Canterbury</span></span>
<span id="cb2-91">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb2-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb2-93">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> in_canterbury,</span>
<span id="cb2-94">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> in_canterbury</span>
<span id="cb2-95">    ),</span>
<span id="cb2-96">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb2-97">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-98">  </span>
<span id="cb2-99">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(</span>
<span id="cb2-100">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightpink"</span>)</span>
<span id="cb2-101">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-102">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_manual</span>(</span>
<span id="cb2-103">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span>
<span id="cb2-104">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-105">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(</span>
<span id="cb2-106">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span></span>
<span id="cb2-107">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-108">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb2-109">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Peaks within Canterbury Region?"</span>,</span>
<span id="cb2-110">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Peaks within Canterbury Region?"</span>,</span>
<span id="cb2-111">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Highlighting Peaks within Canterbury region"</span></span>
<span id="cb2-112">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-113">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-114">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb2-115">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(</span>
<span id="cb2-116">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightblue"</span></span>
<span id="cb2-117">    ),</span>
<span id="cb2-118">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span></span>
<span id="cb2-119">  )</span></code></pre></div>
</details>
<div id="fig-4-2-1" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-4-2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="fig-4-2-1-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-4-2-1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-4-2-1-1.png" class="lightbox" data-gallery="fig-4-2-1" title="Figure&nbsp;1&nbsp;(a): New Zealand Map with all the peaks"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-4-2-1-1.png" class="img-fluid figure-img" data-ref-parent="fig-4-2-1" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-4-2-1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) New Zealand Map with all the peaks
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-4-2-1-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-4-2-1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-4-2-1-2.png" class="lightbox" data-gallery="fig-4-2-1" title="Figure&nbsp;1&nbsp;(b): New Zealand Map focussing on peaks that intersect with Canterbury"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-4-2-1-2.png" class="img-fluid figure-img" data-ref-parent="fig-4-2-1" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-4-2-1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) New Zealand Map focussing on peaks that intersect with Canterbury
</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-4-2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Spatial Subsetting and plotting with tidyverse and ggplot2 methods
</figcaption>
</figure>
</div>
</div>
<p>Example code for <code>st_intersects()</code> and <code>st_disjoint()</code> : these functions produce a sparse predicate list only. Hence, correct way to use them would be <code>st_filter()</code> with <code>.predicate = &lt;function&gt;</code> argument.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersects</span>(</span>
<span id="cb3-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(nz, Name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canterbury"</span>)</span>
<span id="cb3-4">  )</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sparse geometry binary predicate list of length 101, where the
predicate was `intersects'
first 10 elements:
 1: (empty)
 2: (empty)
 3: (empty)
 4: (empty)
 5: 1
 6: 1
 7: 1
 8: 1
 9: 1
 10: 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The 70 peaks within Canterbury region</span></span>
<span id="cb5-2">nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_filter</span>(</span>
<span id="cb5-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(nz, Name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canterbury"</span>),</span>
<span id="cb5-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.predicate =</span> st_intersects</span>
<span id="cb5-6">  )</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 70 features and 2 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 1365809 ymin: 5158491 xmax: 1654899 ymax: 5350463
Projected CRS: NZGD2000 / New Zealand Transverse Mercator 2000
First 10 features:
   t50_fid elevation                geometry
1  2362630      2749 POINT (1378170 5158491)
2  2362814      2822 POINT (1389460 5168749)
3  2362817      2778 POINT (1390166 5169466)
4  2363991      3004 POINT (1372357 5172729)
5  2363993      3114 POINT (1372062 5173236)
6  2363994      2882 POINT (1372810 5173419)
7  2363995      2796 POINT (1372579 5173989)
8  2363997      3070 POINT (1373796 5174144)
9  2363998      3061 POINT (1373955 5174231)
10 2363999      3077 POINT (1373984 5175228)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The 31 peaks outside Canterbury Region</span></span>
<span id="cb7-2">nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_filter</span>(</span>
<span id="cb7-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(nz, Name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canterbury"</span>),</span>
<span id="cb7-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.predicate =</span> st_disjoint</span>
<span id="cb7-6">  )</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 31 features and 2 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 1204143 ymin: 5048309 xmax: 1822492 ymax: 5650492
Projected CRS: NZGD2000 / New Zealand Transverse Mercator 2000
First 10 features:
   t50_fid elevation                geometry
1  2353944      2723 POINT (1204143 5049971)
2  2354404      2820 POINT (1234725 5048309)
3  2354405      2830 POINT (1235915 5048745)
4  2369113      3033 POINT (1259702 5076570)
5  2363996      2759 POINT (1373264 5175442)
6  2364028      2756 POINT (1374183 5177165)
7  2364029      2800 POINT (1374469 5176966)
8  2364031      2788 POINT (1375422 5177253)
9  2364166      2782 POINT (1383006 5181085)
10 2364167      2905 POINT (1383486 5181270)</code></pre>
</div>
</div>
</section>
<section id="topological-relations" class="level3">
<h3 class="anchored" data-anchor-id="topological-relations">4.2.2 Topological Relations</h3>
<ul>
<li><strong>Topological relations</strong> describe spatial relationships between objects using logical TRUE or FALSE statements <em>(Egenhofer and Herring, 1990)</em>.</li>
<li><strong>Symmetrical vs.&nbsp;non-symmetrical relations</strong>:
<ul>
<li>Symmetrical relations (e.g., <code>equals</code>, <code>intersects</code>, <code>crosses</code>) yield the same result when order of input is swapped.</li>
<li>Non-symmetrical relations (e.g., <code>contains</code>, <code>within</code>) depend on the order of input geometries.</li>
</ul></li>
<li><strong>Binary predicates</strong> in <strong><code>sf</code></strong> package test spatial relationships between vector geometries. See <a href="https://r-spatial.github.io/sf/articles/sf3.html">vignette(“sf3”)</a>. The following binary predicates exist in <code>sf</code> : —</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
<th>Symmetrical?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>st_intersects</code></td>
<td>Checks if geometries intersect.</td>
<td>Yes</td>
</tr>
<tr class="even">
<td><code>st_disjoint</code></td>
<td>Checks if geometries do not intersect (are disjoint).</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td><code>st_touches</code></td>
<td>Checks if geometries have at least one boundary point in common.</td>
<td>Yes</td>
</tr>
<tr class="even">
<td><code>st_crosses</code></td>
<td>Checks if a geometry crosses another (e.g., a line crosses a polygon).</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td><code>st_overlaps</code></td>
<td>Checks if geometries have some but not all interior points in common.</td>
<td>Yes</td>
</tr>
<tr class="even">
<td><code>st_equals</code></td>
<td>Checks if geometries are topologically equal.</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td><code>st_within</code></td>
<td>Checks if a geometry is completely contained within another.</td>
<td><strong>No</strong></td>
</tr>
<tr class="even">
<td><code>st_contains</code></td>
<td>Checks if a geometry contains another completely.</td>
<td><strong>No</strong></td>
</tr>
<tr class="odd">
<td><code>st_contains_properly</code></td>
<td>Checks if a geometry contains another but not vice versa.</td>
<td><strong>No</strong></td>
</tr>
<tr class="even">
<td><code>st_covers</code></td>
<td>Checks if a geometry covers another (includes boundary).</td>
<td><strong>No</strong></td>
</tr>
<tr class="odd">
<td><code>st_covered_by</code></td>
<td>Checks if a geometry is covered by another (includes boundary).</td>
<td><strong>No</strong></td>
</tr>
<tr class="even">
<td><code>st_equals_exact</code></td>
<td>Checks if geometries are exactly equal within a given tolerance.</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td><code>st_is_within_distance</code></td>
<td>Checks if geometries are within a specified distance from each other.</td>
<td>Yes</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>Sparse matrix output</strong>: Functions like <code>st_intersects()</code> use sparse matrices to save memory by only registering positive results; setting <code>sparse = FALSE</code> returns a dense matrix.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create two polygons</span></span>
<span id="cb9-2"> polygon1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_polygon</span>(</span>
<span id="cb9-3">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb9-4">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb9-5">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">byrow =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb9-6">   ))</span>
<span id="cb9-7"> )</span>
<span id="cb9-8"></span>
<span id="cb9-9"> polygon2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_polygon</span>(</span>
<span id="cb9-10">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>),</span>
<span id="cb9-11">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb9-12">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">byrow =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb9-13">   ))</span>
<span id="cb9-14"> )</span>
<span id="cb9-15"></span>
<span id="cb9-16"> polygon3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_polygon</span>(</span>
<span id="cb9-17">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>,</span>
<span id="cb9-18">                 <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>, </span>
<span id="cb9-19">                 <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, </span>
<span id="cb9-20">                 <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, </span>
<span id="cb9-21">                 <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>),</span>
<span id="cb9-22">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb9-23">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">byrow =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb9-24">   ))</span>
<span id="cb9-25"> )</span>
<span id="cb9-26"></span>
<span id="cb9-27"> polygon4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_polygon</span>(</span>
<span id="cb9-28">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, </span>
<span id="cb9-29">                 <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, </span>
<span id="cb9-30">                 <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, </span>
<span id="cb9-31">                 <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, </span>
<span id="cb9-32">                 <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>),</span>
<span id="cb9-33">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb9-34">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">byrow =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb9-35">   ))</span>
<span id="cb9-36"> )</span>
<span id="cb9-37"> </span>
<span id="cb9-38"> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert to sf objects</span></span>
<span id="cb9-39"> sf_poly1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sfc</span>(polygon1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span>)</span>
<span id="cb9-40"> sf_poly2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sfc</span>(polygon2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span>)</span>
<span id="cb9-41"> sf_poly3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sfc</span>(polygon3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span>)</span>
<span id="cb9-42"> sf_poly4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sfc</span>(polygon4, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span>)</span>
<span id="cb9-43"> </span>
<span id="cb9-44"> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a collection of points</span></span>
<span id="cb9-45"> points <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sfc</span>(</span>
<span id="cb9-46">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>)),</span>
<span id="cb9-47">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>)),</span>
<span id="cb9-48">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.25</span>)),</span>
<span id="cb9-49">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span></span>
<span id="cb9-50"> )</span>
<span id="cb9-51"></span>
<span id="cb9-52"> sf_points <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb9-53">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"p1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"p2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"p3"</span>),</span>
<span id="cb9-54">   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> points</span>
<span id="cb9-55"> ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb9-56">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb9-57">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_set_crs</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span>)</span>
<span id="cb9-58"></span>
<span id="cb9-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Keeping environment clean</span></span>
<span id="cb9-60"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(polygon1, polygon2, </span>
<span id="cb9-61">   polygon3, polygon4,</span>
<span id="cb9-62">   points)</span>
<span id="cb9-63"></span>
<span id="cb9-64"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Visualize the objects</span></span>
<span id="cb9-65"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-66">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> sf_poly1, </span>
<span id="cb9-67">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf_poly1"</span>),</span>
<span id="cb9-68">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-69">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> sf_poly2, </span>
<span id="cb9-70">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf_poly2"</span>),</span>
<span id="cb9-71">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-72">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> sf_poly3, </span>
<span id="cb9-73">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf_poly3"</span>),</span>
<span id="cb9-74">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-75">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> sf_poly4, </span>
<span id="cb9-76">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf_poly4"</span>),</span>
<span id="cb9-77">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-78">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> sf_points,</span>
<span id="cb9-79">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> point),</span>
<span id="cb9-80">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>,</span>
<span id="cb9-81">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-82">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-83">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-create-objects" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-create-objects-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-create-objects-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;2: Some example objects to demonstrate the topological relations"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-create-objects-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-create-objects-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Some example objects to demonstrate the topological relations
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#################### Symmetrical Relations ######################</span></span>
<span id="cb10-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The order in which sf objects are placed does not matter</span></span>
<span id="cb10-3"></span>
<span id="cb10-4"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## st_intersects()----------------------------------------</span></span>
<span id="cb10-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersects</span>(sf_poly1, sf_poly2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F) </span>
<span id="cb10-6"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##      [,1]</span></span>
<span id="cb10-7"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] TRUE</span></span>
<span id="cb10-8"></span>
<span id="cb10-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersects</span>(sf_poly1, sf_points, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F) </span>
<span id="cb10-10"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##      [,1] [,2]  [,3]</span></span>
<span id="cb10-11"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] TRUE TRUE FALSE</span></span>
<span id="cb10-12"></span>
<span id="cb10-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersects</span>(sf_poly1, sf_poly3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-14"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]</span></span>
<span id="cb10-15"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE</span></span>
<span id="cb10-16"></span>
<span id="cb10-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersects</span>(sf_poly2 ,sf_poly3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F) </span>
<span id="cb10-18"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##      [,1]</span></span>
<span id="cb10-19"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] TRUE</span></span>
<span id="cb10-20"></span>
<span id="cb10-21"></span>
<span id="cb10-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># st_disjoint()------------------------------------------</span></span>
<span id="cb10-23"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_disjoint</span>(sf_poly1, sf_poly4, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-24"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##      [,1]</span></span>
<span id="cb10-25"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] TRUE</span></span>
<span id="cb10-26"></span>
<span id="cb10-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_disjoint</span>(sf_poly2, sf_poly3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F) </span>
<span id="cb10-28"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]</span></span>
<span id="cb10-29"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE</span></span>
<span id="cb10-30"></span>
<span id="cb10-31"></span>
<span id="cb10-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># st_touches()-------------------------------------------</span></span>
<span id="cb10-33"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_touches</span>(sf_poly1, sf_poly2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F) </span>
<span id="cb10-34"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]</span></span>
<span id="cb10-35"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE</span></span>
<span id="cb10-36"></span>
<span id="cb10-37"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_touches</span>(sf_poly2, sf_poly3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-38"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##      [,1]</span></span>
<span id="cb10-39"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] TRUE</span></span>
<span id="cb10-40"></span>
<span id="cb10-41"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_touches</span>(sf_poly1, sf_points, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-42"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]  [,2]  [,3]</span></span>
<span id="cb10-43"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE FALSE FALSE</span></span>
<span id="cb10-44"></span>
<span id="cb10-45"></span>
<span id="cb10-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># st_crosses()-------------------------------------------</span></span>
<span id="cb10-47"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crosses</span>(sf_poly1, sf_poly2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-48"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]</span></span>
<span id="cb10-49"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE</span></span>
<span id="cb10-50"></span>
<span id="cb10-51"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crosses</span>(sf_poly1, sf_points, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-52"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]  [,2]  [,3]</span></span>
<span id="cb10-53"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE FALSE FALSE</span></span>
<span id="cb10-54"></span>
<span id="cb10-55"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># st_overlaps()</span></span>
<span id="cb10-56"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_overlaps</span>(sf_poly1, sf_poly2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-57"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##      [,1]</span></span>
<span id="cb10-58"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] TRUE</span></span>
<span id="cb10-59"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_overlaps</span>(sf_poly1, sf_points, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-60"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]  [,2]  [,3]</span></span>
<span id="cb10-61"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE FALSE FALSE</span></span>
<span id="cb10-62"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_overlaps</span>(sf_poly3, sf_poly3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-63"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]</span></span>
<span id="cb10-64"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE</span></span>
<span id="cb10-65"></span>
<span id="cb10-66"></span>
<span id="cb10-67"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># st_equals()-------------------------------------------</span></span>
<span id="cb10-68"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_equals</span>(sf_poly1, sf_poly1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-69"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##      [,1]</span></span>
<span id="cb10-70"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] TRUE</span></span>
<span id="cb10-71"></span>
<span id="cb10-72"></span>
<span id="cb10-73"></span>
<span id="cb10-74"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># st_equals_exact()-------------------------------------</span></span>
<span id="cb10-75"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_equals_exact</span>(sf_poly1, sf_poly2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">par =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-76"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]</span></span>
<span id="cb10-77"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE</span></span>
<span id="cb10-78"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_equals_exact</span>(sf_poly1, sf_poly2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">par =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-79"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##      [,1]</span></span>
<span id="cb10-80"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] TRUE</span></span>
<span id="cb10-81"></span>
<span id="cb10-82"></span>
<span id="cb10-83"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># st_is_within_distance()-------------------------------</span></span>
<span id="cb10-84"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_is_within_distance</span>(sf_poly1, sf_poly2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-85"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##      [,1]</span></span>
<span id="cb10-86"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] TRUE</span></span>
<span id="cb10-87"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_is_within_distance</span>(sf_poly2, sf_poly3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-88"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##      [,1]</span></span>
<span id="cb10-89"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] TRUE</span></span>
<span id="cb10-90"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_is_within_distance</span>(sf_poly3, sf_poly4, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-91"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]</span></span>
<span id="cb10-92"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE</span></span>
<span id="cb10-93"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_is_within_distance</span>(sf_poly3, sf_poly4, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-94"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]</span></span>
<span id="cb10-95"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE</span></span>
<span id="cb10-96"></span>
<span id="cb10-97"></span>
<span id="cb10-98"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#################### Non-Symmetrical Relations ####################</span></span>
<span id="cb10-99"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The order in which sf objects are placed changes the outcome</span></span>
<span id="cb10-100"></span>
<span id="cb10-101"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># st_within()-------------------------------------------</span></span>
<span id="cb10-102">sf_points <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb10-103">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_within</span>(sf_poly1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-104"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]</span></span>
<span id="cb10-105"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,]  TRUE</span></span>
<span id="cb10-106"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [2,]  TRUE</span></span>
<span id="cb10-107"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [3,] FALSE</span></span>
<span id="cb10-108"></span>
<span id="cb10-109">sf_poly1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb10-110">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_within</span>(sf_points, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-111"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]  [,2]  [,3]</span></span>
<span id="cb10-112"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE FALSE FALSE</span></span>
<span id="cb10-113"></span>
<span id="cb10-114">sf_poly1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb10-115">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_within</span>(sf_poly2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-116"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]</span></span>
<span id="cb10-117"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE</span></span>
<span id="cb10-118"></span>
<span id="cb10-119"></span>
<span id="cb10-120"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># st_contains()-----------------------------------------</span></span>
<span id="cb10-121">sf_poly1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb10-122">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_contains</span>(sf_points, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-123"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##      [,1] [,2]  [,3]</span></span>
<span id="cb10-124"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] TRUE TRUE FALSE</span></span>
<span id="cb10-125"></span>
<span id="cb10-126">sf_points <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb10-127">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_contains</span>(sf_poly1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-128"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]</span></span>
<span id="cb10-129"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE</span></span>
<span id="cb10-130"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [2,] FALSE</span></span>
<span id="cb10-131"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [3,] FALSE</span></span>
<span id="cb10-132"></span>
<span id="cb10-133"></span>
<span id="cb10-134"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># st_covers()-------------------------------------------</span></span>
<span id="cb10-135">sf_poly1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb10-136">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_covers</span>(sf_points, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-137"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##      [,1] [,2]  [,3]</span></span>
<span id="cb10-138"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] TRUE TRUE FALSE</span></span>
<span id="cb10-139"></span>
<span id="cb10-140">sf_poly2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb10-141">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_covers</span>(sf_poly1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-142"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]</span></span>
<span id="cb10-143"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,] FALSE</span></span>
<span id="cb10-144"></span>
<span id="cb10-145"></span>
<span id="cb10-146"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># st_covered_by()---------------------------------------</span></span>
<span id="cb10-147">sf_points <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb10-148">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_covered_by</span>(sf_poly1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F)</span>
<span id="cb10-149"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       [,1]</span></span>
<span id="cb10-150"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1,]  TRUE</span></span>
<span id="cb10-151"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [2,]  TRUE</span></span>
<span id="cb10-152"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [3,] FALSE</span></span></code></pre></div>
</div>
</section>
<section id="distance-relations" class="level3">
<h3 class="anchored" data-anchor-id="distance-relations">4.2.3 Distance Relations</h3>
<ul>
<li><strong>Distance relations</strong> are continuous, unlike binary topological relations which return TRUE/FALSE values.</li>
<li>The <a href="https://r-spatial.github.io/sf/reference/st_distance.html"><strong><code>st_distance()</code></strong></a> function calculates distances between two <strong>sf</strong> objects, returning a matrix with units of measurement (e.g., meters).</li>
<li><a href="https://r-spatial.github.io/sf/reference/st_centroid.html"><strong><code>st_centroid()</code></strong></a>: Computes the geometric centroid of a spatial feature, useful for representing a region’s central point in distance calculations.</li>
<li><strong>Matrix output</strong>:
<ul>
<li>Results are returned as a matrix, even for single value calculations.</li>
<li>Computes a distance matrix between all combinations of features in objects (e.g., distances between multiple points and polygons).</li>
</ul></li>
<li><strong>Point-to-polygon distance</strong>: Represents the shortest distance from a point to any part of the polygon.</li>
<li><strong>Usage in distance-based joins</strong>: <a href="https://r-spatial.github.io/sf/reference/st_distance.html"><code>st_distance()</code></a> is also used for performing joins based on distance criteria.</li>
<li>An example code to find distance between central points of Auckland and Canterbury Regions, vs.&nbsp;Top three peaks in New Zealand, returned as a matrix,a nd shown below as a beautiful table using {gt}.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Central points of Auckland and Canterbury Regions</span></span>
<span id="cb11-2">df1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nz <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_detect</span>(Name, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Auck|Canter"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_centroid</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(Name, geom)</span>
<span id="cb11-6"></span>
<span id="cb11-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Top 3 highest peaks in New Zealand</span></span>
<span id="cb11-8">df2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_max</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order_by =</span> elevation, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb11-10"></span>
<span id="cb11-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Finding the distance matrix</span></span>
<span id="cb11-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_distance</span>(df1, df2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">state =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Auckland"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canterbury"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">relocate</span>(state) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb11-17">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(</span>
<span id="cb11-18">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>state,</span>
<span id="cb11-19">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.fns =</span> as.numeric</span>
<span id="cb11-20">    )</span>
<span id="cb11-21">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-22">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-23">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>(</span>
<span id="cb11-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decimals =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb11-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale_by =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-3</span></span>
<span id="cb11-26">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-27">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">V1 =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Highest Peak"</span>, </span>
<span id="cb11-28">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">V2 =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Second"</span>,</span>
<span id="cb11-29">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">V3 =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Third"</span>,</span>
<span id="cb11-30">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">state =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Centroid of the State"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-31">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(</span>
<span id="cb11-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance in kilometers"</span></span>
<span id="cb11-33">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-34">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_538</span>()</span></code></pre></div>
<div id="tbl-distance" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-distance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Code output for use of st_centroid() and st_distance()
</figcaption>
<div aria-describedby="tbl-distance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="mhlgwgvzlj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#mhlgwgvzlj table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mhlgwgvzlj thead, #mhlgwgvzlj tbody, #mhlgwgvzlj tfoot, #mhlgwgvzlj tr, #mhlgwgvzlj td, #mhlgwgvzlj th {
  border-style: none;
}

#mhlgwgvzlj p {
  margin: 0;
  padding: 0;
}

#mhlgwgvzlj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mhlgwgvzlj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mhlgwgvzlj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mhlgwgvzlj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mhlgwgvzlj .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mhlgwgvzlj .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mhlgwgvzlj .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mhlgwgvzlj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mhlgwgvzlj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mhlgwgvzlj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mhlgwgvzlj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mhlgwgvzlj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mhlgwgvzlj .gt_spanner_row {
  border-bottom-style: hidden;
}

#mhlgwgvzlj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mhlgwgvzlj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#mhlgwgvzlj .gt_from_md > :first-child {
  margin-top: 0;
}

#mhlgwgvzlj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mhlgwgvzlj .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mhlgwgvzlj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#mhlgwgvzlj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mhlgwgvzlj .gt_row_group_first td {
  border-top-width: 2px;
}

#mhlgwgvzlj .gt_row_group_first th {
  border-top-width: 2px;
}

#mhlgwgvzlj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mhlgwgvzlj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mhlgwgvzlj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mhlgwgvzlj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mhlgwgvzlj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mhlgwgvzlj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mhlgwgvzlj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mhlgwgvzlj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mhlgwgvzlj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mhlgwgvzlj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mhlgwgvzlj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mhlgwgvzlj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mhlgwgvzlj .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mhlgwgvzlj .gt_left {
  text-align: left;
}

#mhlgwgvzlj .gt_center {
  text-align: center;
}

#mhlgwgvzlj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mhlgwgvzlj .gt_font_normal {
  font-weight: normal;
}

#mhlgwgvzlj .gt_font_bold {
  font-weight: bold;
}

#mhlgwgvzlj .gt_font_italic {
  font-style: italic;
}

#mhlgwgvzlj .gt_super {
  font-size: 65%;
}

#mhlgwgvzlj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mhlgwgvzlj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mhlgwgvzlj .gt_indent_1 {
  text-indent: 5px;
}

#mhlgwgvzlj .gt_indent_2 {
  text-indent: 10px;
}

#mhlgwgvzlj .gt_indent_3 {
  text-indent: 15px;
}

#mhlgwgvzlj .gt_indent_4 {
  text-indent: 20px;
}

#mhlgwgvzlj .gt_indent_5 {
  text-indent: 25px;
}

#mhlgwgvzlj .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mhlgwgvzlj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="4" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="font-family: Chivo; font-weight: 700">Distance in kilometers</th>
</tr>
<tr class="odd gt_col_headings">
<th id="Centroid of the State" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Centroid of the State</th>
<th id="Highest Peak" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Highest Peak</th>
<th id="Second" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Second</th>
<th id="Third" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Third</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="state">Auckland</td>
<td class="gt_row gt_right" headers="V1">856.6</td>
<td class="gt_row gt_right" headers="V2">857.3</td>
<td class="gt_row gt_right" headers="V3">856.9</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Canterbury</td>
<td class="gt_row gt_right" headers="V1">115.5</td>
<td class="gt_row gt_right" headers="V2">115.4</td>
<td class="gt_row gt_right" headers="V3">115.5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="de-9im-strings" class="level3">
<h3 class="anchored" data-anchor-id="de-9im-strings">4.2.4 DE-9IM Strings</h3>
<ul>
<li>The <strong>Dimensionally Extended 9-Intersection Model (DE-9IM)</strong> underlies binary spatial predicates. This model forms the basis for many spatial operations and helps create custom spatial predicates.</li>
<li><strong>Origins</strong>:
<ul>
<li>Initially named “DE + 9IM,” it refers to the <strong>dimensions of intersections</strong> between the boundaries, interiors, and exteriors of two geometries (Clementini and Di Felice 1995).</li>
<li>It applies to two-dimensional geometries (points, lines, polygons) in Euclidean space, requiring data in a projected coordinate reference system (CRS).</li>
</ul></li>
<li><strong>How DE-9IM Works</strong>:
<ul>
<li>The model visualizes intersections between components of two geometries (interior, boundary, exterior) in a 3x3 matrix form, indicating the dimension of the intersection (0 for points, 1 for lines, 2 for polygons, and F for false).</li>
<li>Flattening this matrix row-wise results in the DE-9IM string: <strong>“212111212”</strong>.</li>
</ul></li>
<li><strong>Using <code>st_relate()</code></strong>: The <a href="https://r-spatial.github.io/sf/reference/st_relate.html"><code>st_relate()</code></a> function returns DE-9IM strings to describe spatial relations.</li>
<li><strong>Developing Custom Predicates</strong>:
<ul>
<li>By interpreting DE-9IM strings, custom binary spatial predicates like <strong>queen</strong> and <strong>rook</strong> relations can be created:
<ul>
<li><p><strong>Queen relations</strong> (shared border or point): Pattern <code>F***T****</code>.</p></li>
<li><p><strong>Rook relations</strong> (shared linear intersection): Pattern <code>F***1****</code>.</p></li>
</ul></li>
<li>Custom functions using <a href="https://r-spatial.github.io/sf/reference/st_relate.html"><code>st_relate()</code></a>:</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">st_queen <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x, y) </span>
<span id="cb12-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_relate</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"F***T****"</span>)</span>
<span id="cb12-3"></span>
<span id="cb12-4">st_rook <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x, y) </span>
<span id="cb12-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_relate</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"F***1****"</span>)</span></code></pre></div>
<ul>
<li>This identifies which geometries in a grid have queen or rook relations to the central geometry.</li>
</ul>
</section>
<section id="spatial-joining-with-st_join" class="level3">
<h3 class="anchored" data-anchor-id="spatial-joining-with-st_join">4.2.5 Spatial Joining with <code>st_join()</code></h3>
<ul>
<li><p>Spatial joins combine datasets based on spatial relationships instead of shared key variables (as in non-spatial joins). It adds columns from a source object (<code>y</code>) to a target object (<code>x</code>).</p></li>
<li><p><strong>Join Details</strong>:</p>
<ul>
<li><p>Default behavior: A left join, which retains all rows from <code>x</code> and includes rows with no match from <code>y</code>.</p></li>
<li><p>Operators: Uses <code>st_intersects()</code> by default but can be modified via the <code>join</code> argument.</p></li>
<li><p>Handles all geometry types: Works for points, lines, and polygons, though joins involving polygons may create duplicate rows for multiple matches in <code>y</code>.</p></li>
</ul></li>
<li><p><strong>Flexibility</strong>:</p>
<ul>
<li><strong>Inner joins</strong>: Set <code>left = FALSE</code> to include only matched rows.</li>
</ul></li>
<li><p>The <code>st_join()</code> function: The <code>join</code> argument defines the topological operator to determine these relationships, with the default being <code>st_intersects()</code>.</p>
<ul>
<li><p>We can customize this behavior by choosing alternative functions such as <code>st_contains</code>, <code>st_within</code>, <code>st_overlaps</code>, <code>st_touches</code>, or <code>st_disjoint</code>, among others, each defining a different geometric predicate.</p></li>
<li><p>For example, <code>st_contains</code> selects features where geometries of <code>x</code> fully encompass those of <code>y</code>, while <code>st_within</code> does the reverse.</p></li>
<li><p>Additionally, advanced options like <code>st_is_within_distance</code> allow proximity-based joins, and <code>st_relate</code> supports customized spatial relationships using a pattern.</p></li>
</ul></li>
<li><p>Example: Getting 25 random points in the world, and seeing in which countries they fall in Figure&nbsp;3.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Getting 25 random points on the world,a dn then seeing in which countries they fall</span></span>
<span id="cb13-2">random_points <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb13-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(</span>
<span id="cb13-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(</span>
<span id="cb13-5">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, </span>
<span id="cb13-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_bbox</span>(world)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>xmin, </span>
<span id="cb13-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_bbox</span>(world)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>xmax</span>
<span id="cb13-8">    ),</span>
<span id="cb13-9">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb13-10">  ),</span>
<span id="cb13-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(</span>
<span id="cb13-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(</span>
<span id="cb13-13">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, </span>
<span id="cb13-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_bbox</span>(world)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ymin, </span>
<span id="cb13-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_bbox</span>(world)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ymax</span>
<span id="cb13-16">    ),</span>
<span id="cb13-17">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb13-18">  ),</span>
<span id="cb13-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> LETTERS[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>]</span>
<span id="cb13-20">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb13-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coords =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb13-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_set_crs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crs</span>(world))</span>
<span id="cb13-23"></span>
<span id="cb13-24"></span>
<span id="cb13-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Easiest (but not tidyverse) way to subset</span></span>
<span id="cb13-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># world[random_points, ]</span></span>
<span id="cb13-27"></span>
<span id="cb13-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tidyverse way to filter: Names of Countries in which they fall</span></span>
<span id="cb13-29">intersecting_countries <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> world <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb13-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_filter</span>(random_points) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb13-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(name_long)</span>
<span id="cb13-32"></span>
<span id="cb13-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The power of spatial joins: A tibble of countries where each random</span></span>
<span id="cb13-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># point falls. st_join() by default performs a left_join()</span></span>
<span id="cb13-35"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_join</span>(</span>
<span id="cb13-36">  random_points, </span>
<span id="cb13-37">  world <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(name_long)</span>
<span id="cb13-38">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb13-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">drop_na</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb13-40">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb13-41">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_nytimes</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="ztnogmfhwf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#ztnogmfhwf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ztnogmfhwf thead, #ztnogmfhwf tbody, #ztnogmfhwf tfoot, #ztnogmfhwf tr, #ztnogmfhwf td, #ztnogmfhwf th {
  border-style: none;
}

#ztnogmfhwf p {
  margin: 0;
  padding: 0;
}

#ztnogmfhwf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ztnogmfhwf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ztnogmfhwf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ztnogmfhwf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ztnogmfhwf .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ztnogmfhwf .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ztnogmfhwf .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ztnogmfhwf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ztnogmfhwf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ztnogmfhwf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ztnogmfhwf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ztnogmfhwf .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ztnogmfhwf .gt_spanner_row {
  border-bottom-style: hidden;
}

#ztnogmfhwf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ztnogmfhwf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ztnogmfhwf .gt_from_md > :first-child {
  margin-top: 0;
}

#ztnogmfhwf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ztnogmfhwf .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ztnogmfhwf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ztnogmfhwf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ztnogmfhwf .gt_row_group_first td {
  border-top-width: 2px;
}

#ztnogmfhwf .gt_row_group_first th {
  border-top-width: 2px;
}

#ztnogmfhwf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ztnogmfhwf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ztnogmfhwf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ztnogmfhwf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ztnogmfhwf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ztnogmfhwf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ztnogmfhwf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ztnogmfhwf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ztnogmfhwf .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#ztnogmfhwf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ztnogmfhwf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ztnogmfhwf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ztnogmfhwf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ztnogmfhwf .gt_left {
  text-align: left;
}

#ztnogmfhwf .gt_center {
  text-align: center;
}

#ztnogmfhwf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ztnogmfhwf .gt_font_normal {
  font-weight: normal;
}

#ztnogmfhwf .gt_font_bold {
  font-weight: bold;
}

#ztnogmfhwf .gt_font_italic {
  font-style: italic;
}

#ztnogmfhwf .gt_super {
  font-size: 65%;
}

#ztnogmfhwf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ztnogmfhwf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ztnogmfhwf .gt_indent_1 {
  text-indent: 5px;
}

#ztnogmfhwf .gt_indent_2 {
  text-indent: 10px;
}

#ztnogmfhwf .gt_indent_3 {
  text-indent: 15px;
}

#ztnogmfhwf .gt_indent_4 {
  text-indent: 20px;
}

#ztnogmfhwf .gt_indent_5 {
  text-indent: 25px;
}

#ztnogmfhwf .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ztnogmfhwf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="id" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase" scope="col">id</th>
<th id="geometry" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase" scope="col">geometry</th>
<th id="name_long" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase" scope="col">name_long</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="id" style="font-family: 'Source Sans Pro'; font-weight: 400">I</td>
<td class="gt_row gt_center" headers="geometry" style="font-family: 'Source Sans Pro'; font-weight: 400">c(43.05, 61.96)</td>
<td class="gt_row gt_left" headers="name_long" style="font-family: 'Source Sans Pro'; font-weight: 400">Russian Federation</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="id" style="font-family: 'Source Sans Pro'; font-weight: 400">N</td>
<td class="gt_row gt_center" headers="geometry" style="font-family: 'Source Sans Pro'; font-weight: 400">c(112.59, 71.68)</td>
<td class="gt_row gt_left" headers="name_long" style="font-family: 'Source Sans Pro'; font-weight: 400">Russian Federation</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="id" style="font-family: 'Source Sans Pro'; font-weight: 400">O</td>
<td class="gt_row gt_center" headers="geometry" style="font-family: 'Source Sans Pro'; font-weight: 400">c(59.22, 33.55)</td>
<td class="gt_row gt_left" headers="name_long" style="font-family: 'Source Sans Pro'; font-weight: 400">Iran</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="id" style="font-family: 'Source Sans Pro'; font-weight: 400">P</td>
<td class="gt_row gt_center" headers="geometry" style="font-family: 'Source Sans Pro'; font-weight: 400">c(93.88, 52.24)</td>
<td class="gt_row gt_left" headers="name_long" style="font-family: 'Source Sans Pro'; font-weight: 400">Russian Federation</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="id" style="font-family: 'Source Sans Pro'; font-weight: 400">R</td>
<td class="gt_row gt_center" headers="geometry" style="font-family: 'Source Sans Pro'; font-weight: 400">c(62.63, 51.25)</td>
<td class="gt_row gt_left" headers="name_long" style="font-family: 'Source Sans Pro'; font-weight: 400">Kazakhstan</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="id" style="font-family: 'Source Sans Pro'; font-weight: 400">S</td>
<td class="gt_row gt_center" headers="geometry" style="font-family: 'Source Sans Pro'; font-weight: 400">c(-17.61, -88.84)</td>
<td class="gt_row gt_left" headers="name_long" style="font-family: 'Source Sans Pro'; font-weight: 400">Antarctica</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb14-2"></span>
<span id="cb14-3">world <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb14-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">highlight =</span> name_long <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> intersecting_countries) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb14-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb14-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb14-8">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> highlight</span>
<span id="cb14-9">    ),</span>
<span id="cb14-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb14-11">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(</span>
<span id="cb14-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span>
<span id="cb14-14">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb14-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> random_points,</span>
<span id="cb14-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,</span>
<span id="cb14-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb14-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,</span>
<span id="cb14-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb14-21">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-22">  ggrepel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text_repel</span>(</span>
<span id="cb14-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> random_points,</span>
<span id="cb14-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> geometry),</span>
<span id="cb14-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb14-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,</span>
<span id="cb14-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb14-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_y =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb14-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf_coordinates"</span></span>
<span id="cb14-30">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb14-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"25 random points on world map, and Countries in which they fall"</span>,</span>
<span id="cb14-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb14-34">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb14-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span></span>
<span id="cb14-37">  )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-st-join" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-st-join-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-st-join-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;3: Using st_join() to spatially join two data sets, based on the st_intersect() relation"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-st-join-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-st-join-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Using st_join() to spatially join two data sets, based on the st_intersect() relation
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="distance-based-joins" class="level3">
<h3 class="anchored" data-anchor-id="distance-based-joins">4.2.6 Distance-based Joins</h3>
<ul>
<li><p>Distance-based joins are used when geographic datasets are spatially proximate but do not intersect. The <strong>sf</strong> package enables such joins using spatial relationships like proximity.</p></li>
<li><p><strong>Example Dataset used</strong>:</p>
<ul>
<li><code>cycle_hire</code>: Official cycle hire points.</li>
<li><code>cycle_hire_osm</code>: Cycle hire points from OpenStreetMap.</li>
<li>Relationship: These datasets are geographically close but do not overlap, as verified using <a href="https://r-spatial.github.io/sf/reference/st_intersects.html"><code>st_intersects()</code></a>, which returns <code>FALSE</code> for all points.</li>
</ul></li>
<li><p><strong>Implementation</strong>:</p>
<ol type="1">
<li><strong>Check Proximity</strong>:
<ul>
<li>Use <a href="https://r-spatial.github.io/sf/reference/st_is_within_distance.html"><code>st_is_within_distance()</code></a> to determine points within a threshold distance (e.g., 20 meters).</li>
</ul></li>
<li><strong>Perform Distance-based Join</strong>:
<ul>
<li>Apply <a href="https://r-spatial.github.io/sf/reference/st_join.html"><code>st_join()</code></a> with the <code>st_is_within_distance</code> predicate and a <code>dist</code> argument.</li>
<li>The resulting dataset may contain duplicate rows if points in the target object (<code>cycle_hire</code>) match multiple points in the source (<code>cycle_hire_osm</code>).</li>
</ul></li>
</ol></li>
<li><p><strong>Key Observations</strong>:</p>
<ul>
<li>Joins retain the geometry of features in the target dataset (<code>cycle_hire</code>).</li>
<li>Distance-based joins are effective for linking datasets that are close geographically but do not overlap.</li>
</ul></li>
</ul>
<p>Figure&nbsp;4 visualizes the spatial relationship between two datasets, <code>cycle_hire</code> and <code>cycle_hire_osm</code>, using a proximity filter. The <code>st_filter()</code> function from the <strong>sf</strong> package identifies points in the <code>cycle_hire</code> dataset that are within 10 meters of points in <code>cycle_hire_osm</code>, leveraging the <code>st_is_within_distance</code> predicate. The result is a subset of <code>cycle_hire</code> points, which are plotted using <strong>ggplot2</strong>. The plot includes:</p>
<ul>
<li><p>Filtered <code>cycle_hire</code> points (dark blue, fully opaque).</p></li>
<li><p>All <code>cycle_hire</code> points (dark blue, semi-transparent) for context.</p></li>
<li><p>All <code>cycle_hire_osm</code> points (red, semi-transparent) to show the proximity relationship.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cycle_hire"</span>)</span>
<span id="cb15-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cycle_hire_osm"</span>)</span>
<span id="cb15-3"></span>
<span id="cb15-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb15-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cycle_hire,</span>
<span id="cb15-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>,</span>
<span id="cb15-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb15-9">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb15-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cycle_hire_osm,</span>
<span id="cb15-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>,</span>
<span id="cb15-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb15-14">  )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter4_files/figure-html/unnamed-chunk-9-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Official Cycle hire points with added info from OSM points within 10 metres</span></span>
<span id="cb16-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb16-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cycle_hire |&gt; </span></span>
<span id="cb16-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   st_join(</span></span>
<span id="cb16-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     cycle_hire_osm, </span></span>
<span id="cb16-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     join = st_is_within_distance,</span></span>
<span id="cb16-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     dist = units::set_units(10, "m")</span></span>
<span id="cb16-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   )</span></span></code></pre></div>
</details>
</div>
<p>Just checking, whether any of the two points in these two data sets exactly match. Well, they don’t!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersects</span>(cycle_hire, cycle_hire_osm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">any</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p>Now, in Figure&nbsp;4, we highlight only those points of bike hire in the official data, which are within 10 metres of the OSM data. The important function here is <code>st_filter()</code> along with the argument <code>.predicate = st_is_within_distance()</code> and the argument <code>dist = ...</code> .</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot only points which have a OSM point within 10 metres</span></span>
<span id="cb19-2">cycle_hire <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_filter</span>(</span>
<span id="cb19-4">    cycle_hire_osm,</span>
<span id="cb19-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.predicate =</span> st_is_within_distance,</span>
<span id="cb19-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> units<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_units</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"m"</span>)</span>
<span id="cb19-7">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkblue"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb19-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cycle_hire, </span>
<span id="cb19-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, </span>
<span id="cb19-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>,</span>
<span id="cb19-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb19-15">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb19-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cycle_hire_osm, </span>
<span id="cb19-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, </span>
<span id="cb19-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>,</span>
<span id="cb19-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb19-21">  )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-st_join2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-st_join2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-st_join2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;4: Official Cycle Hire Points Within 10 Meters of OpenStreetMap Locations"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-st_join2-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-st_join2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Official Cycle Hire Points Within 10 Meters of OpenStreetMap Locations
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="spatial-aggregation" class="level3">
<h3 class="anchored" data-anchor-id="spatial-aggregation">4.2.7 Spatial Aggregation</h3>
<ul>
<li>Spatial data aggregation condenses data into fewer rows by summarizing multiple values of a variable into a single value per grouping variable, similar to attribute data aggregation. Following two approaches exist: —
<ul>
<li><strong>Base R’s <code>aggregate()</code></strong>: Groups values based on spatial relationships and summarizes them with a specified function (e.g., <code>mean</code>).</li>
<li><strong>Tidyverse Approach (<code>group_by()</code> and <code>summarize()</code>)</strong>: Combines <code>st_join()</code> with grouping and summarizing to perform spatial aggregation while allowing flexibility in function application and column naming. <strong>(This approach is better, as shown in Figure&nbsp;5)</strong></li>
</ul></li>
<li><strong>Output Differences</strong>:
<ul>
<li><code>aggregate()</code> may result in <code>NA</code> for unmatched regions.</li>
<li>Tidyverse methods preserve unmatched region names and allow for more flexible aggregation functions and output formatting.</li>
</ul></li>
<li>Functions like <code>median()</code>, <code>sd()</code>, or other statistical summarizers can replace <code>mean()</code> for different aggregation purposes.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nz_height"</span>)</span>
<span id="cb20-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nz"</span>)</span>
<span id="cb20-3"></span>
<span id="cb20-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_join</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> nz, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> nz_height) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb20-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Name) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb20-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">elevation =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(elevation, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> T)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb20-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb20-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> elevation)</span>
<span id="cb20-9">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-11">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb20-12">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grDevices::Terrain 2"</span>,</span>
<span id="cb20-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb20-14">  )</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-st-join-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-st-join-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-st-join-3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;5: Spatial data aggregation with st_join() from {sf} and summarise() from {tidyverse}"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-st-join-3-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-st-join-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Spatial data aggregation with st_join() from {sf} and summarise() from {tidyverse}
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="joining-in-congruent-layers" class="level3">
<h3 class="anchored" data-anchor-id="joining-in-congruent-layers">4.2.8 Joining In-congruent Layers</h3>
<ul>
<li><p>Spatial congruence occurs when two layers (aggregating object <code>y</code> and target object <code>x</code>) share borders, enabling accurate spatial aggregation. Incongruence arises when no shared borders exist, complicating spatial operations.</p></li>
<li><p>Example of Congruence:</p>
<ul>
<li>Administrative boundaries, such as districts made of smaller units, typically exhibit spatial congruence.</li>
</ul></li>
<li><p>Issue with Incongruence:</p>
<ul>
<li>In-congruent layers, like sub-zones with differing borders from aggregating zones, result in inaccurate aggregations (e.g., centroids of sub-zones).</li>
</ul></li>
<li><p><strong>Solution: Areal Interpolation</strong>: Transfers values between areal units using:</p>
<ul>
<li><strong>Simple area-weighted methods</strong>: Proportionally assigns values based on area overlap. This is implemented using <strong><code>st_interpolate_aw()</code></strong>.</li>
<li><strong>Advanced methods</strong>: Include algorithms like ‘pycnophylactic’ interpolation.</li>
</ul></li>
<li><p><strong>Example Dataset</strong>:</p>
<ul>
<li>The <strong>spData package</strong> includes <code>incongruent</code> (sub-zones) and <code>aggregating_zones</code> (larger zones). The <code>value</code> column in <code>incongruent</code> represents total regional income in million Euros, which must be aggregated into <code>aggregating_zones</code>.</li>
</ul></li>
<li><p><strong>Implementation: <code>st_interpolate_aw()</code></strong>:</p>
<ul>
<li>The <code>st_interpolate_aw()</code> function in the <strong>sf</strong> package performs areal-weighted interpolation of polygon data, allowing attributes from one spatial object (<code>x</code>) to be transferred to another (<code>to</code>) based on area overlap. The <code>extensive</code> argument determines whether attributes are <strong>spatially extensive</strong> (e.g., population, summed across areas) or <strong>spatially intensive</strong> (e.g., density, averaged). Additional options include <code>keep_NA</code> (to retain or exclude <code>NA</code> features) and <code>na.rm</code> (to remove features with <code>NA</code> attributes from <code>x</code>).</li>
<li>Aggregated results depend on the variable type:
<ul>
<li><strong>Extensive variables</strong>: Values increase with area (e.g., total income).</li>
<li><strong>Intensive variables</strong>: Values remain constant irrespective of area (e.g., averages).</li>
</ul></li>
<li><strong><code>st_interpolate_aw()</code></strong> handles <strong>spatially extensive variables</strong> (e.g., total income) by summing values across areas.</li>
<li>In <strong><code>st_interpolate_aw()</code></strong>, for <strong>spatially intensive variables</strong> (e.g., averages, percentages), set <code>extensive = FALSE</code> to use averages instead of sums.</li>
<li>Note: Warning messages indicate the assumption of uniform attribute distribution across areas.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aggregating_zones"</span>)</span>
<span id="cb21-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"incongruent"</span>)</span>
<span id="cb21-3"></span>
<span id="cb21-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The two overall main zones for which the total income needs to be computed</span></span>
<span id="cb21-5">aggregating_zones</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 2 features and 3 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 417686.2 ymin: 443703.6 xmax: 422959.3 ymax: 447036.8
Projected CRS: OSGB 1936 / British National Grid
      geo_code geo_label geo_labelw                       geometry
5164 E02002332 Leeds 003       &lt;NA&gt; MULTIPOLYGON (((418731.9 44...
6631 E02002333 Leeds 004       &lt;NA&gt; MULTIPOLYGON (((419196.4 44...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The 9 smaller counties or districts or sub-units which are not</span></span>
<span id="cb23-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># congruent with the main zones</span></span>
<span id="cb23-3">incongruent</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 9 features and 2 fields
Attribute-geometry relationships: aggregate (1), NA's (1)
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 417686.8 ymin: 443703 xmax: 422963 ymax: 446978
Projected CRS: OSGB 1936 / British National Grid
        level    value                       geometry
1 Incongruent 4.037919 MULTIPOLYGON (((420799.6 44...
2 Incongruent 5.014419 MULTIPOLYGON (((418664 4464...
3 Incongruent 4.933000 MULTIPOLYGON (((419964 4462...
4 Incongruent 5.120139 MULTIPOLYGON (((420368 4441...
5 Incongruent 6.548912 MULTIPOLYGON (((420419.8 44...
6 Incongruent 3.749791 MULTIPOLYGON (((421779 4451...
7 Incongruent 5.432837 MULTIPOLYGON (((419577 4464...
8 Incongruent 4.618049 MULTIPOLYGON (((417687.6 44...
9 Incongruent 5.956771 MULTIPOLYGON (((418859.3 44...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># We are using extensive = TRUE, because our variable is </span></span>
<span id="cb25-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># total income, not average income</span></span>
<span id="cb25-3">incongruent <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb25-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># We need to keep only the numeric variable (and of course,</span></span>
<span id="cb25-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># the sticky geometry. Otherwise, R will not understand what</span></span>
<span id="cb25-6">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># to do with non-numeric columns)</span></span>
<span id="cb25-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(value) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb25-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_interpolate_aw</span>(aggregating_zones, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">extensive =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in st_interpolate_aw.sf(select(incongruent, value), aggregating_zones,
: st_interpolate_aw assumes attributes are constant or uniform over areas of x</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 2 features and 1 field
Attribute-geometry relationship: aggregate (1)
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 417686.2 ymin: 443703.6 xmax: 422959.3 ymax: 447036.8
Projected CRS: OSGB 1936 / British National Grid
     value                       geometry
1 19.61613 MULTIPOLYGON (((418731.9 44...
2 25.66872 MULTIPOLYGON (((419196.4 44...</code></pre>
</div>
</div>
</section>
</section>
<section id="spatial-operations-on-raster-data" class="level2">
<h2 class="anchored" data-anchor-id="spatial-operations-on-raster-data">4.3 Spatial operations on raster data</h2>
<ul>
<li>Demonstrates <strong>advanced spatial raster operations</strong>.</li>
<li>Provides an alternative to manually creating datasets by accessing them from the <strong><code>spData</code></strong> package:
<ul>
<li><code>elev</code>: Represents elevation data.</li>
<li><code>grain</code>: Represents grain-related data.</li>
</ul></li>
</ul>
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1">elev <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/elev.tif"</span>, </span>
<span id="cb28-2">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spData"</span>))</span>
<span id="cb28-3"></span>
<span id="cb28-4">grain <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/grain.tif"</span>, </span>
<span id="cb28-5">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spData"</span>))</span>
<span id="cb28-6"></span>
<span id="cb28-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot(elev)</span></span>
<span id="cb28-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot(grain)</span></span>
<span id="cb28-9"></span>
<span id="cb28-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"elev SpatRaster"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data: {spData}"</span>)</span>
<span id="cb28-13">  </span>
<span id="cb28-14"></span>
<span id="cb28-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> grain) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grain SpatRaster"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data: {spData}"</span>)</span></code></pre></div>
<div id="fig-4-3" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-4-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-4-3" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-4-3-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-4-3-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-4-3-1.png" class="lightbox" data-gallery="fig-4-3" title="Figure&nbsp;6&nbsp;(a): elev"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-4-3-1.png" class="img-fluid figure-img" data-ref-parent="fig-4-3" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-4-3-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) elev
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-4-3" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-4-3-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-4-3-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-4-3-2.png" class="lightbox" data-gallery="fig-4-3" title="Figure&nbsp;6&nbsp;(b): grain"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-4-3-2.png" class="img-fluid figure-img" data-ref-parent="fig-4-3" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-4-3-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) grain
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-4-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Section 4.3: Raster Datasets used: plotted using ggplot2 and {tidyterra}
</figcaption>
</figure>
</div>
<section id="spatial-subsetting" class="level3">
<h3 class="anchored" data-anchor-id="spatial-subsetting">4.3.1 Spatial subsetting</h3>
<ul>
<li>Builds on Section 3.3, which covered retrieving raster values by cell IDs or row/column combinations.</li>
<li>Spatial subsetting allows extraction of raster data by <strong>location (coordinates)</strong> or <strong>spatial objects</strong>:
<ul>
<li><strong><code>terra::extract()</code></strong>: Extracts raster values directly using coordinates. <em>(Note: A function with the same name exists in the <strong>tidyverse</strong>, so be careful to add package name at start)</em>.</li>
</ul></li>
<li><strong>Subsetting with another raster object</strong>:
<ul>
<li>Use a secondary raster as a spatial mask to subset the primary raster, using <code>terra::extract(ext(...))</code> .</li>
<li>Example shown below: Subsetting <code>elev</code> using a smaller raster <code>clip_raster</code> (defining a specific extent).</li>
<li>Two kinds of Spatial outputs from subsetting:
<ul>
<li>Use the <strong><code>drop</code> argument</strong> with the <code>[ ]</code> operator to return subsetting results as raster objects.</li>
<li>Example: Subsets the first two cells of <code>elev</code> with <code>elev[1:2, drop = FALSE]</code>, whereas <code>elev[1:2]</code> returns the cell values of first two cells only.</li>
</ul></li>
</ul></li>
<li><strong>Masking raster data with logical values</strong>:
<ul>
<li>Creates a raster mask (<code>rmask</code>) with <strong>NA</strong> and <strong>TRUE</strong> values.</li>
<li>Masks the primary raster (<code>elev</code>) to retain only values corresponding to <code>TRUE</code> in the mask using:
<ul>
<li><code>[ ]</code> operator - use <code>TRUE</code> and <code>FALSE</code>.</li>
<li><code>mask()</code> function - use <code>TRUE</code> and <code>NA</code>.</li>
</ul></li>
</ul></li>
<li><strong>The <code>mask()</code> function in the terra package</strong> applies a mask to a SpatRaster or SpatVector. It replaces values in a raster (<code>x</code>) with <code>NA</code> (or another value) where another raster or vector (<code>mask</code>) has <code>NA</code> or specified mask values. It’s useful for filtering, clipping, or focusing on specific areas.</li>
<li><strong>The <code>extract()</code> function in the terra package</strong> retrieves values from a <code>SpatRaster</code> based on specified locations or geometries. Locations can be points (as a <code>SpatVector</code>, matrix, or data frame), cell numbers, or spatial objects like polygons. It supports methods for exact or weighted extraction, interpolation, and summary statistics for extracted data. Key arguments include:
<ul>
<li><p><strong><code>x</code></strong>: The <code>SpatRaster</code> to extract values from</p></li>
<li><p><strong><code>y</code></strong>: Locations (e.g., points, polygons, or cell numbers) to extract values for.</p></li>
<li><p><strong><code>fun</code></strong>: Summarizes extracted data for polygons (e.g., mean, sum).</p></li>
<li><p><strong><code>cells</code>/<code>xy</code></strong>: Optionally return cell numbers or coordinates.</p></li>
<li><p><strong><code>weights</code>/<code>exact</code></strong>: Extract weighted or exact fractions for polygons.</p></li>
<li><p><strong><code>bind</code></strong>: Combines extracted values with input geometries (<code>SpatVector</code>).</p></li>
</ul></li>
<li>The code below demonstrates these <strong>spatial operations on raster data</strong>. Initially, it showcases how to extract raster values using coordinates with <code>terra::extract()</code> by specifying a set of coordinate pairs. Next, it demonstrates how to create a new raster (<code>clip_raster</code>) to subset the <code>elev</code> raster, focusing on extracting values only within the extent defined by the clip raster using both the <code>[ ]</code> operator and <code>terra::extract()</code>. The example highlights the importance of the <code>drop = FALSE</code> argument in the <code>[ ]</code> operator, which ensures that spatial structure is preserved when subsetting raster objects. Finally, the code illustrates the use of masking with a logical raster (<code>temporary_mask</code>), where specific cells in the <code>elev</code> raster are retained based on <code>TRUE</code> values in the mask. This process is essential for filtering or replacing values (e.g., assigning <code>NA</code> to erroneous data).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Let us extract some values from "elev" using coordinates</span></span>
<span id="cb29-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># I want to extract coordiantes of </span></span>
<span id="cb29-3">coords_extract <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(</span>
<span id="cb29-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>,</span>
<span id="cb29-5">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>),</span>
<span id="cb29-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb29-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">byrow =</span> T</span>
<span id="cb29-8">)</span>
<span id="cb29-9"></span>
<span id="cb29-10">coords_extract</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,] -1.2 -1.2
[2,]  1.2  1.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1">elev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb31-2">  terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">extract</span>(</span>
<span id="cb31-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> coords_extract</span>
<span id="cb31-4">  )</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  elev
1   31
2    6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Let us create a new raster to clip the central four blocks of the elev raster</span></span>
<span id="cb33-2">clip_raster <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(</span>
<span id="cb33-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, </span>
<span id="cb33-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb33-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resolution =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, </span>
<span id="cb33-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vals =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb33-7">  )</span>
<span id="cb33-8"></span>
<span id="cb33-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extracting only the values</span></span>
<span id="cb33-10">elev[clip_raster]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  elev
1   15
2   16
3   21
4   22</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This code somehow doesn't work for me!</span></span>
<span id="cb35-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># elev |&gt; </span></span>
<span id="cb35-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   terra::extract(ext(clip_raster))</span></span>
<span id="cb35-4"></span>
<span id="cb35-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Explaining the meaning of argument drop = FALSE in the </span></span>
<span id="cb35-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># base R subsetting operator "[]"</span></span>
<span id="cb35-7">elev[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  elev
1    1
2    2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1">elev[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, drop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>]    </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatRaster 
dimensions  : 1, 2, 1  (nrow, ncol, nlyr)
resolution  : 0.5, 0.5  (x, y)
extent      : -1.5, -0.5, 1, 1.5  (xmin, xmax, ymin, ymax)
coord. ref. : lon/lat WGS 84 (EPSG:4326) 
source(s)   : memory
varname     : elev 
name        : elev 
min value   :    1 
max value   :    2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Creating a temporary_mask object</span></span>
<span id="cb39-2">temporary_mask <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> elev</span>
<span id="cb39-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(temporary_mask) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>,</span>
<span id="cb39-4">                                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> T)</span>
<span id="cb39-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># elev |&gt; </span></span>
<span id="cb39-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   mask(temporary_mask)</span></span></code></pre></div>
</div>
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb40-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> clip_raster)</span>
<span id="cb40-3"></span>
<span id="cb40-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb40-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> temporary_mask) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb40-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_discrete</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>)</span>
<span id="cb40-7"></span>
<span id="cb40-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb40-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mask</span>(temporary_mask)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb40-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>)</span></code></pre></div>
<div id="fig-4-3-masking" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-4-3-masking-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-4-3-masking" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-4-3-masking-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-4-3-masking-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-4-3-masking-1.png" class="lightbox" data-gallery="fig-4-3-masking" title="Figure&nbsp;7&nbsp;(a): Plotting clip_raster: a smaller raster"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-4-3-masking-1.png" class="img-fluid figure-img" data-ref-parent="fig-4-3-masking" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-4-3-masking-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Plotting clip_raster: a smaller raster
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-4-3-masking" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-4-3-masking-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-4-3-masking-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-4-3-masking-2.png" class="lightbox" data-gallery="fig-4-3-masking" title="Figure&nbsp;7&nbsp;(b): The temporary_mask raster"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-4-3-masking-2.png" class="img-fluid figure-img" data-ref-parent="fig-4-3-masking" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-4-3-masking-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) The <code>temporary_mask</code> raster
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-4-3-masking" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-4-3-masking-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-4-3-masking-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-4-3-masking-3.png" class="lightbox" data-gallery="fig-4-3-masking" title="Figure&nbsp;7&nbsp;(c): plotting the masked elev, based on a randomly generated temporary_mask"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-4-3-masking-3.png" class="img-fluid figure-img" data-ref-parent="fig-4-3-masking" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-4-3-masking-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) plotting the masked elev, based on a randomly generated <code>temporary_mask</code>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-4-3-masking-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Showing plots from the code of above
</figcaption>
</figure>
</div>
</section>
<section id="local-operations" class="level3">
<h3 class="anchored" data-anchor-id="local-operations">4.3.3 Local operations</h3>
<ul>
<li>Local operations are <strong>cell-by-cell operations</strong> performed on one or more raster layers. Includes operations like addition, subtraction, squaring, logical comparisons, and logarithmic transformations. Examples are shown in Figure&nbsp;8</li>
<li><strong>Reclassification</strong>:
<ul>
<li>Numeric values can be grouped into intervals (e.g., low, middle, high elevations).</li>
<li>Use the <strong><code>classify()</code> function</strong> with a reclassification matrix to assign new values to defined ranges.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb41-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb41-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"`elev` - the original raster"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb41-4">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grDevices::terrain.colors"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb41-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>)</span>
<span id="cb41-6"></span>
<span id="cb41-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb41-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb41-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"elev^2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb41-10">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grDevices::terrain.colors"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb41-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb41-12">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt"</span>))</span>
<span id="cb41-13"></span>
<span id="cb41-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb41-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log2</span>(elev)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb41-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log2(elev)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb41-17">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grDevices::terrain.colors"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb41-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb41-19">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt"</span>))</span>
<span id="cb41-20"></span>
<span id="cb41-21"></span>
<span id="cb41-22"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb41-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb41-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"elev &gt; 10"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb41-25"> paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_d</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggsci::alternating_igv"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb41-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb41-27">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt"</span>))</span></code></pre></div>
<div id="fig-local-op-rasters" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-local-op-rasters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="fig-local-op-rasters-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-local-op-rasters-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-local-op-rasters-1.png" class="lightbox" data-gallery="fig-local-op-rasters" title="Figure&nbsp;8&nbsp;(a): elev"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-local-op-rasters-1.png" class="img-fluid figure-img" data-ref-parent="fig-local-op-rasters" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-local-op-rasters-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) elev
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-local-op-rasters-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-local-op-rasters-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-local-op-rasters-2.png" class="lightbox" data-gallery="fig-local-op-rasters" title="Figure&nbsp;8&nbsp;(b): elev^2"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-local-op-rasters-2.png" class="img-fluid figure-img" data-ref-parent="fig-local-op-rasters" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-local-op-rasters-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) elev^2
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-local-op-rasters-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-local-op-rasters-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-local-op-rasters-3.png" class="lightbox" data-gallery="fig-local-op-rasters" title="Figure&nbsp;8&nbsp;(c): log2(elev)"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-local-op-rasters-3.png" class="img-fluid figure-img" data-ref-parent="fig-local-op-rasters" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-local-op-rasters-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) log2(elev)
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-local-op-rasters-4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-local-op-rasters-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-local-op-rasters-4.png" class="lightbox" data-gallery="fig-local-op-rasters" title="Figure&nbsp;8&nbsp;(d): elev > 10"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-local-op-rasters-4.png" class="img-fluid figure-img" data-ref-parent="fig-local-op-rasters" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-local-op-rasters-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d) elev &gt; 10
</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-local-op-rasters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8
</figcaption>
</figure>
</div>
</div>
<ul>
<li><strong>Efficient alternatives for operations</strong>:
<ul>
<li><strong><code>app()</code></strong>: The <code>app()</code> function in the <code>{terra}</code> package applies a user-defined or pre-existing function to each cell’s values of a <code>SpatRaster</code>, treating layers as columns in a matrix. Functions should return outputs divisible by the total cell count.</li>
<li><strong><code>tapp()</code></strong>: The <code>tapp()</code> function in the <code>{terra}</code> package applies a function to subsets of layers in a <code>SpatRaster</code> grouped by an index. It allows for aggregation or summarization of layers based on grouping criteria such as indices, time periods (e.g., “years”, “months”), or custom functions.</li>
<li><strong><code>lapp()</code></strong>: The <code>lapp()</code> function in the <code>{terra}</code> package applies a user-defined function to the layers of a <code>SpatRaster</code> or <code>SpatRasterDataset</code>, treating each layer as an argument to the function. The function must accept a vector of layer values and return a vector or matrix of the same or compatible size. This is useful for combining or transforming layers, such as performing arithmetic operations between them. An example of <code>lapp()</code> is the NDVI Calculation:
<ul>
<li>NDVI (Normalized Difference Vegetation Index) is a local operation to assess vegetation:
<ul>
<li>Formula: <strong>(NIR - Red) / (NIR + Red)</strong>.</li>
</ul></li>
<li>Calculated from satellite data (e.g., Landsat 8) with red and NIR bands.
<ul>
<li>Positive NDVI values (&gt; 0.2) indicate vegetation.</li>
<li>Largest values correspond to dense forests, while lowest values are related to lakes and snowy areas.</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1">multi_rast <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/landsat.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>)</span>
<span id="cb42-2">multi_rast <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(multi_rast)</span>
<span id="cb42-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Rescale values to actual values (stored integers to save disk space)</span></span>
<span id="cb42-4">multi_rast <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> (multi_rast <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0000275</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span></span>
<span id="cb42-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove negative values due to clouds etc.</span></span>
<span id="cb42-6">multi_rast[multi_rast <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb42-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">object.size</span>(multi_rast)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1304 bytes</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1">ndvi_fun <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(nir, red){</span>
<span id="cb44-2">  (nir <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> red) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (nir <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> red)</span>
<span id="cb44-3">}</span>
<span id="cb44-4"></span>
<span id="cb44-5">ndvi_rast <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapp</span>(multi_rast[[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> ndvi_fun)</span>
<span id="cb44-6"></span>
<span id="cb44-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb44-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> ndvi_rast,</span>
<span id="cb44-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> lyr1)</span>
<span id="cb44-11">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-12">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb44-13">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grDevices::Terrain 2"</span>,</span>
<span id="cb44-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb44-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb44-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">oob =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>squish</span>
<span id="cb44-17">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb44-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Zion National Park - Satellite Photo Raster"</span>,</span>
<span id="cb44-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Using custom nvdi_fun() to find NVDI</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">and plot vegetation areas in {ggplot2}"</span>,</span>
<span id="cb44-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb44-22">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb44-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb44-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt"</span>)</span>
<span id="cb44-26">  )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter4_files/figure-html/unnamed-chunk-18-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="focal-operations" class="level3">
<h3 class="anchored" data-anchor-id="focal-operations">4.3.4 Focal operations</h3>
<ul>
<li>Focal operations consider a central cell and its neighbours within a defined neighbourhood (kernel, filter, or moving window).
<ul>
<li>Common neighbourhood size: <strong>3x3 cells</strong> (central cell + 8 neighbours), but customizable sizes and shapes are supported.</li>
<li>The operation aggregates values within the neighbourhood and assigns the result to the central cell, iterating across all cells.</li>
</ul></li>
<li><strong>Implementation in R</strong>:
<ul>
<li>Use the <strong><code>focal()</code> function</strong> to perform spatial filtering Figure&nbsp;9. Parameters:
<ul>
<li><strong><code>w</code></strong>: Defines the weights of the moving window using a matrix, example in Figure&nbsp;9 (c).</li>
<li><strong><code>fun</code></strong>: Specifies the aggregation function (e.g., <code>min</code>, <code>sum</code>, <code>mean</code>, <code>var</code>), as in Figure&nbsp;9 (b)</li>
</ul></li>
</ul></li>
<li><strong>Applications</strong>:
<ul>
<li>Spatial filtering or convolution for raster operations.</li>
<li>Low-pass filters:
<ul>
<li>Use the mean function to smooth and reduce extreme values.</li>
<li>For categorical data, replace the mean with the mode (most common value).</li>
</ul></li>
<li>High-pass filters:
<ul>
<li>Enhance features using methods like Laplace or Sobel filters (e.g., line detection).</li>
</ul></li>
<li>Terrain processing:
<ul>
<li>Compute topographic characteristics like slope, aspect, and flow directions using focal functions.</li>
</ul></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb45-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb45-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"elev SpatRaster"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data: {spData}"</span>)</span>
<span id="cb45-4"></span>
<span id="cb45-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb45-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb45-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb45-8">        terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">focal</span>(</span>
<span id="cb45-9">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">w =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>),</span>
<span id="cb45-10">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> min</span>
<span id="cb45-11">      )</span>
<span id="cb45-12">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb45-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Focal operation min on a 3X3 matric"</span>,</span>
<span id="cb45-14">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Simple min() function with na.rm = FALSE"</span>)</span>
<span id="cb45-15"></span>
<span id="cb45-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb45-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(</span>
<span id="cb45-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb45-19">        terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">focal</span>(</span>
<span id="cb45-20">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sobel filters (for edge detection):</span></span>
<span id="cb45-21">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">w =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>),</span>
<span id="cb45-22">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> mean,</span>
<span id="cb45-23">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb45-24">      )</span>
<span id="cb45-25">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb45-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb45-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Focal operation min on a 3X3 matric"</span>,</span>
<span id="cb45-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sobel filter matrix for edge detection, with mean() function"</span></span>
<span id="cb45-29">  )</span></code></pre></div>
<div id="fig-focal-op" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-focal-op-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="fig-focal-op-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-focal-op-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-focal-op-1.png" class="lightbox" data-gallery="fig-focal-op" title="Figure&nbsp;9&nbsp;(a): Original elev raster"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-focal-op-1.png" class="img-fluid figure-img" data-ref-parent="fig-focal-op" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-focal-op-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Original elev raster
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-focal-op-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-focal-op-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-focal-op-2.png" class="lightbox" data-gallery="fig-focal-op" title="Figure&nbsp;9&nbsp;(b): Focal operation with min() and a simple matrix of equal weights"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-focal-op-2.png" class="img-fluid figure-img" data-ref-parent="fig-focal-op" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-focal-op-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Focal operation with min() and a simple matrix of equal weights
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-focal-op-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-focal-op-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-focal-op-3.png" class="lightbox" data-gallery="fig-focal-op" title="Figure&nbsp;9&nbsp;(c): Focal operation with mean() and a sobel filter matrix for edge detection"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-focal-op-3.png" class="img-fluid figure-img" data-ref-parent="fig-focal-op" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-focal-op-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Focal operation with mean() and a sobel filter matrix for edge detection
</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-focal-op-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Focal operations on Rasters using terra::focal()
</figcaption>
</figure>
</div>
</div>
</section>
<section id="zonal-operations" class="level3">
<h3 class="anchored" data-anchor-id="zonal-operations">4.3.5 Zonal operations</h3>
<ul>
<li>Zonal operations aggregate raster cell values based on zones defined by a second raster with categorical values. Unlike focal operations, zones in zonal operations do not require neighboring cells to be adjacent.</li>
<li><strong>Key Characteristics</strong>:
<ul>
<li>The <code>zonal()</code> function in the <strong>terra</strong> package computes zonal statistics by summarizing the values of a <code>SpatRaster</code> for each “zone” defined by another <code>SpatRaster</code>. It applies a specified function (<code>fun</code>, e.g., mean, sum) to aggregate the data for each zone.</li>
<li>The result is typically a <strong>summary table</strong>, grouped by zones. Zones are defined by a secondary raster.</li>
<li><strong>Optional Output</strong>: A raster with calculated statistics for each zone can be generated by setting <code>as.raster = TRUE</code>.</li>
</ul></li>
<li><strong>Usage</strong>:
<ul>
<li>Ideal for summarizing raster values based on irregularly spread categorical zones.</li>
<li>Commonly used in <strong>land classification</strong>, <strong>soil analysis</strong>, and other spatial analyses where zones are pre-defined.</li>
</ul></li>
</ul>
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb46-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb46-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"elev SpatRaster"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data: {spData}"</span>)</span>
<span id="cb46-4">  </span>
<span id="cb46-5"></span>
<span id="cb46-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb46-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> grain) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb46-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grain SpatRaster"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data: {spData}"</span>)</span></code></pre></div>
<div id="fig-zonal-op" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-zonal-op-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-zonal-op" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-zonal-op-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-zonal-op-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-zonal-op-1.png" class="lightbox" data-gallery="fig-zonal-op" title="Figure&nbsp;10&nbsp;(a): elev"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-zonal-op-1.png" class="img-fluid figure-img" data-ref-parent="fig-zonal-op" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-zonal-op-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) elev
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-zonal-op" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-zonal-op-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-zonal-op-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-zonal-op-2.png" class="lightbox" data-gallery="fig-zonal-op" title="Figure&nbsp;10&nbsp;(b): grain"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-zonal-op-2.png" class="img-fluid figure-img" data-ref-parent="fig-zonal-op" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-zonal-op-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) grain
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-zonal-op-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: The elev and grain rasters
</figcaption>
</figure>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1">elev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb47-2">  terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">zonal</span>(</span>
<span id="cb47-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> grain,</span>
<span id="cb47-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> mean</span>
<span id="cb47-5">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb47-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  grain  elev
  &lt;chr&gt; &lt;dbl&gt;
1 clay   14.8
2 silt   21.2
3 sand   18.7</code></pre>
</div>
</div>
</section>
<section id="global-operations-and-distances" class="level3">
<h3 class="anchored" data-anchor-id="global-operations-and-distances">4.3.6 Global operations and distances</h3>
<ul>
<li>Global operations consider the entire raster dataset as a <strong>single zone</strong>.</li>
<li>Common operations include:
<ul>
<li><strong>Descriptive statistics</strong>: Minimum, maximum, etc.</li>
<li><strong>Distance calculations</strong>: Compute distance from each cell to a target cell using <strong><code>terra::distance()</code></strong>. The <code>terra::distance()</code> function calculates the shortest distance from each cell in a raster to a set of target cells, which are identified based on a condition (e.g., where raster values are non-NA, equal to a specific value, or greater than a threshold). This is useful for spatial analysis, such as finding proximity to certain features or zones in a raster.</li>
<li><strong>Weighted distances</strong>: Factor in additional variables, such as elevation, to modify distance calculations.</li>
<li><strong>Visibility and viewshed analysis</strong>: Assess visible areas from a specific point.</li>
</ul></li>
<li><strong>Applications</strong>:
<ul>
<li>Distance to coastlines or other target areas.</li>
<li>Topography-aware distance calculations.</li>
<li>Advanced spatial modeling like visibility analysis.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a sample SpatRaster</span></span>
<span id="cb49-2">r <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncols =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrows =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, </span>
<span id="cb49-3">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, </span>
<span id="cb49-4">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb49-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(r) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb49-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(r)[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Assign specific cells as targets</span></span>
<span id="cb49-7"></span>
<span id="cb49-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute the distance to the non-NA cells</span></span>
<span id="cb49-9">dist_raster <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">distance</span>(r)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
|---------|---------|---------|---------|
=========================================
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb51" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1">dist_raster <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dist_raster <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-5</span></span></code></pre></div>
</div>
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># View the raster</span></span>
<span id="cb52-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb52-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> r) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb52-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Original Raster (Targets in Blue)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb52-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb52-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span></span>
<span id="cb52-7">  )</span>
<span id="cb52-8"></span>
<span id="cb52-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># View the distance raster</span></span>
<span id="cb52-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb52-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dist_raster) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb52-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance to Targets (in units)"</span>,</span>
<span id="cb52-13">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance in Degrees"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb52-14">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggthemes::Red-Gold"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb52-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>)</span></code></pre></div>
<div id="fig-terra-distance" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-terra-distance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-terra-distance" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-terra-distance-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-terra-distance-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-terra-distance-1.png" class="lightbox" data-gallery="fig-terra-distance" title="Figure&nbsp;11&nbsp;(a): Original raster"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-terra-distance-1.png" class="img-fluid figure-img" data-ref-parent="fig-terra-distance" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-terra-distance-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Original raster
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-terra-distance" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-terra-distance-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-terra-distance-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-terra-distance-2.png" class="lightbox" data-gallery="fig-terra-distance" title="Figure&nbsp;11&nbsp;(b): Distance raster"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-terra-distance-2.png" class="img-fluid figure-img" data-ref-parent="fig-terra-distance" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-terra-distance-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Distance raster
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-terra-distance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Using the terra::distance()
</figcaption>
</figure>
</div>
</section>
<section id="map-algebra-counterparts-in-vector-processing" class="level3">
<h3 class="anchored" data-anchor-id="map-algebra-counterparts-in-vector-processing">4.3.7 Map algebra counterparts in vector processing</h3>
<ul>
<li>Equivalence between raster and vector operations:
<ul>
<li>Distance raster (global operation) ≈ Buffer operation (vector) (Section 5.2.5).</li>
<li>Raster reclassification ≈ Dissolving vector boundaries (Section 4.2.5).</li>
<li>Raster overlay with masks ≈ Vector clipping (Section 5.2.5).</li>
<li>Zonal operations ≈ Aggregating vector geometries by zone<strong>s</strong>.</li>
</ul></li>
</ul>
</section>
<section id="merging-rasters" class="level3">
<h3 class="anchored" data-anchor-id="merging-rasters">4.3.8 Merging rasters</h3>
<ul>
<li><p>Combines multiple raster datasets into a single raster. Often required for datasets spanning multiple spatial scenes (e.g., satellite imagery, elevation data).</p></li>
<li><p><strong><code>merge()</code></strong>:</p>
<ul>
<li>Places rasters side by side.</li>
<li>For overlapping areas, prioritizes values from the first raster.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb53" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1">aut <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> geodata<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">elevation_30s</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AUT"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tempdir</span>())</span>
<span id="cb53-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb53-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> aut) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb53-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb53-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Austria"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter4_files/figure-html/unnamed-chunk-24-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1">cze <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> geodata<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">elevation_30s</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CZE"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tempdir</span>())</span>
<span id="cb54-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb54-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cze) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb54-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb54-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Czechia"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter4_files/figure-html/unnamed-chunk-24-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1">svk <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> geodata<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">elevation_30s</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SVK"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tempdir</span>())</span>
<span id="cb55-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb55-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> svk) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb55-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb55-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Slovakia"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter4_files/figure-html/unnamed-chunk-24-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/unnamed-chunk-24-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb56" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1">aut_cze_svk <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> aut <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb56-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">merge</span>(svk) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb56-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">merge</span>(cze)</span>
<span id="cb56-4"></span>
<span id="cb56-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb56-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> aut_cze_svk) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb56-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb56-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Austria, Czechia and Slovakia"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter4_files/figure-html/unnamed-chunk-24-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-28"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/unnamed-chunk-24-4.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><strong><code>mosaic()</code></strong>:</p>
<ul>
<li>Handles overlaps by applying a function (e.g., mean) to the overlapping area.</li>
<li>Helps smooth visible borders but may not eliminate them entirely.</li>
</ul></li>
</ul>
</section>
</section>
<section id="exercises" class="level2">
<h2 class="anchored" data-anchor-id="exercises">4.4 Exercises</h2>
<section id="e1." class="level3">
<h3 class="anchored" data-anchor-id="e1.">E1.</h3>
<p><strong>It was established in Section <a href="https://r.geocompx.org/spatial-operations#spatial-vec">4.2</a> that Canterbury was the region of New Zealand containing most of the 101 highest points in the country. How many of these high points does the Canterbury region contain?</strong></p>
<p>Canterbury contains 70 of these high points.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nz"</span>)</span>
<span id="cb57-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nz_height"</span>)</span>
<span id="cb57-3"></span>
<span id="cb57-4">nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb57-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersection</span>(</span>
<span id="cb57-6">    nz <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canterbury"</span>)</span>
<span id="cb57-7">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb57-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 70</code></pre>
</div>
</div>
<p><strong>Bonus: plot the result using the <a href="https://rspatial.github.io/terra/reference/plot.html"><code>plot()</code></a> function to show all of New Zealand, <code>canterbury</code> region highlighted in yellow, high points in Canterbury represented by red crosses (hint: <code>pch = 7</code>) and high points in other parts of New Zealand represented by blue circles. See the help page <a href="https://rspatial.github.io/terra/reference/lines.html"><code>?points</code></a> for details with an illustration of different <code>pch</code> values.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1">nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb59-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb59-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">in_canterbury =</span> nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb59-4">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersects</span>(</span>
<span id="cb59-5">        nz <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canterbury"</span>),</span>
<span id="cb59-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb59-7">      )</span>
<span id="cb59-8">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb59-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb59-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb59-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> nz <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill_var =</span> Name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canterbury"</span>),</span>
<span id="cb59-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> fill_var)</span>
<span id="cb59-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb59-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb59-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> in_canterbury, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> in_canterbury)</span>
<span id="cb59-16">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb59-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_shape_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb59-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb59-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"yellow"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb59-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb59-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Is the region Canterbury?"</span>,</span>
<span id="cb59-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Peaks are in Canterbury?"</span>,</span>
<span id="cb59-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Peaks are in Canterbury?"</span></span>
<span id="cb59-24">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb59-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter4_files/figure-html/unnamed-chunk-26-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-29"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="e2." class="level3">
<h3 class="anchored" data-anchor-id="e2.">E2.</h3>
<p><strong>Which region has the second highest number of <code>nz_height</code> points, and how many does it have?</strong></p>
<p>The region with second highest number of <code>nz_height</code> points is <strong>West Coast</strong>. It has 22 such points.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1">nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb60-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_join</span>(nz) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb60-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb60-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Name) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb60-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 2
# Groups:   Name [7]
  Name                  n
  &lt;chr&gt;             &lt;int&gt;
1 Canterbury           70
2 Manawatu-Wanganui     2
3 Marlborough           1
4 Otago                 2
5 Southland             1
6 Waikato               3
7 West Coast           22</code></pre>
</div>
</div>
<hr>
</section>
<section id="e3." class="level3">
<h3 class="anchored" data-anchor-id="e3.">E3.</h3>
<p><strong>Generalizing the question to all regions: how many of New Zealand’s 16 regions contain points which belong to the top 101 highest points in the country? Which regions?</strong></p>
<ul>
<li><strong>Bonus: create a table listing these regions in order of the number of points and their name.</strong></li>
</ul>
<p>Seven (7) regions of New Zealand contain points which belong to top 101 highest points in the country. The table is shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1">nz_height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb62-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_join</span>(nz) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb62-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb62-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Name) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb62-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of points"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sort =</span> T) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb62-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb62-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">S.No.</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb62-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">relocate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">S.No.</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb62-9">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb62-10">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_538</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb62-11">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(</span>
<span id="cb62-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of highest points in each region of New Zealand"</span></span>
<span id="cb62-13">  )</span></code></pre></div>
<div id="tbl-e3" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-e3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Table listing the regions
</figcaption>
<div aria-describedby="tbl-e3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="ddvrmedbxr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#ddvrmedbxr table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ddvrmedbxr thead, #ddvrmedbxr tbody, #ddvrmedbxr tfoot, #ddvrmedbxr tr, #ddvrmedbxr td, #ddvrmedbxr th {
  border-style: none;
}

#ddvrmedbxr p {
  margin: 0;
  padding: 0;
}

#ddvrmedbxr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ddvrmedbxr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ddvrmedbxr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ddvrmedbxr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ddvrmedbxr .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ddvrmedbxr .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ddvrmedbxr .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ddvrmedbxr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ddvrmedbxr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ddvrmedbxr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ddvrmedbxr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ddvrmedbxr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ddvrmedbxr .gt_spanner_row {
  border-bottom-style: hidden;
}

#ddvrmedbxr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ddvrmedbxr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#ddvrmedbxr .gt_from_md > :first-child {
  margin-top: 0;
}

#ddvrmedbxr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ddvrmedbxr .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ddvrmedbxr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#ddvrmedbxr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ddvrmedbxr .gt_row_group_first td {
  border-top-width: 2px;
}

#ddvrmedbxr .gt_row_group_first th {
  border-top-width: 2px;
}

#ddvrmedbxr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ddvrmedbxr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ddvrmedbxr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ddvrmedbxr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ddvrmedbxr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ddvrmedbxr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ddvrmedbxr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ddvrmedbxr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ddvrmedbxr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ddvrmedbxr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ddvrmedbxr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ddvrmedbxr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ddvrmedbxr .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ddvrmedbxr .gt_left {
  text-align: left;
}

#ddvrmedbxr .gt_center {
  text-align: center;
}

#ddvrmedbxr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ddvrmedbxr .gt_font_normal {
  font-weight: normal;
}

#ddvrmedbxr .gt_font_bold {
  font-weight: bold;
}

#ddvrmedbxr .gt_font_italic {
  font-style: italic;
}

#ddvrmedbxr .gt_super {
  font-size: 65%;
}

#ddvrmedbxr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ddvrmedbxr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ddvrmedbxr .gt_indent_1 {
  text-indent: 5px;
}

#ddvrmedbxr .gt_indent_2 {
  text-indent: 10px;
}

#ddvrmedbxr .gt_indent_3 {
  text-indent: 15px;
}

#ddvrmedbxr .gt_indent_4 {
  text-indent: 20px;
}

#ddvrmedbxr .gt_indent_5 {
  text-indent: 25px;
}

#ddvrmedbxr .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ddvrmedbxr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="3" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="font-family: Chivo; font-weight: 700">Number of highest points in each region of New Zealand</th>
</tr>
<tr class="odd gt_col_headings">
<th id="S.No." class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">S.No.</th>
<th id="Name" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Name</th>
<th id="Number of points" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Number of points</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="S.No.">1</td>
<td class="gt_row gt_left" headers="Name">Canterbury</td>
<td class="gt_row gt_right" headers="Number of points">70</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="S.No.">2</td>
<td class="gt_row gt_left" headers="Name">West Coast</td>
<td class="gt_row gt_right" headers="Number of points">22</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="S.No.">3</td>
<td class="gt_row gt_left" headers="Name">Waikato</td>
<td class="gt_row gt_right" headers="Number of points">3</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="S.No.">4</td>
<td class="gt_row gt_left" headers="Name">Manawatu-Wanganui</td>
<td class="gt_row gt_right" headers="Number of points">2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="S.No.">5</td>
<td class="gt_row gt_left" headers="Name">Otago</td>
<td class="gt_row gt_right" headers="Number of points">2</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="S.No.">6</td>
<td class="gt_row gt_left" headers="Name">Marlborough</td>
<td class="gt_row gt_right" headers="Number of points">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="S.No.">7</td>
<td class="gt_row gt_left" headers="Name">Southland</td>
<td class="gt_row gt_right" headers="Number of points">1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<hr>
<p><strong>Test your knowledge of spatial predicates by finding out and plotting how US states relate to each other and other spatial objects.</strong></p>
</section>
<section id="e4." class="level3">
<h3 class="anchored" data-anchor-id="e4.">E4.</h3>
<p><strong>The starting point of this exercise is to create an object representing Colorado state in the USA. Do this with the command <code>colorado = us_states[us_states$NAME == "Colorado",]</code> (base R) or with the <a href="https://dplyr.tidyverse.org/reference/filter.html"><code>filter()</code></a> function (tidyverse) and plot the resulting object in the context of US states.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"us_states"</span>)</span>
<span id="cb63-2"></span>
<span id="cb63-3">colorado <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb63-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(NAME <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Colorado"</span>)</span>
<span id="cb63-5"></span>
<span id="cb63-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb63-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> colorado) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb63-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Map of Colorado State"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb63-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb63-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:5070"</span></span>
<span id="cb63-11">  )</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-col-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-col-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-col-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-30" title="Figure&nbsp;12: Map of Colorado State"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-col-1-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-col-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: Map of Colorado State
</figcaption>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>Create a new object representing all the states that geographically intersect with Colorado and plot the result (hint: the most concise way to do this is with the subsetting method <code>[</code>)</strong>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb64" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb64-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb64-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> us_states,</span>
<span id="cb64-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb64-5">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb64-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb64-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> colorado,</span>
<span id="cb64-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"yellow"</span></span>
<span id="cb64-9">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb64-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf_text</span>(</span>
<span id="cb64-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> colorado,</span>
<span id="cb64-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb64-13">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> NAME</span>
<span id="cb64-14">    ),</span>
<span id="cb64-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb64-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb64-17">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb64-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb64-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:5070"</span></span>
<span id="cb64-20">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb64-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb64-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb64-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Map of USA states, with Colorado highlighted"</span></span>
<span id="cb64-24">  )</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-col-usa" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-col-usa-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-col-usa-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-31" title="Figure&nbsp;13: Colorado, within USA’s states; with projection changed to Albers Equal Area Projection"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-col-usa-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-col-usa-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13: Colorado, within USA’s states; with projection changed to Albers Equal Area Projection
</figcaption>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>Create another object representing all the objects that touch (have a shared boundary with) Colorado and plot the result (hint: remember you can use the argument <code>op = st_intersects</code> and other spatial relations during spatial subsetting operations in base R).</strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb65" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1">bordering <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb65-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb65-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">border_colorado =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_vector</span>(</span>
<span id="cb65-4">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_vector</span>(</span>
<span id="cb65-5">        us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb65-6">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersects</span>(colorado, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb65-7">      )</span>
<span id="cb65-8">    )</span>
<span id="cb65-9">  )</span>
<span id="cb65-10"></span>
<span id="cb65-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb65-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb65-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> bordering,</span>
<span id="cb65-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb65-15">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> border_colorado</span>
<span id="cb65-16">    )</span>
<span id="cb65-17">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb65-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(</span>
<span id="cb65-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"orange"</span>)</span>
<span id="cb65-20">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb65-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf_text</span>(</span>
<span id="cb65-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(bordering, border_colorado),</span>
<span id="cb65-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb65-24">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> NAME</span>
<span id="cb65-25">    ),</span>
<span id="cb65-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb65-27">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb65-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb65-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> colorado,</span>
<span id="cb65-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span></span>
<span id="cb65-31">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb65-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf_text</span>(</span>
<span id="cb65-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> colorado,</span>
<span id="cb65-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb65-35">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> NAME</span>
<span id="cb65-36">    ),</span>
<span id="cb65-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb65-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb65-39">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb65-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb65-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:5070"</span></span>
<span id="cb65-42">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb65-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb65-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb65-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Map of USA states, with states bordering Colorado highlighted in orange"</span></span>
<span id="cb65-46">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb65-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb65-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span></span>
<span id="cb65-49">  )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter4_files/figure-html/unnamed-chunk-31-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-32"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>Bonus: create a straight line from the centroid of the District of Columbia near the East coast to the centroid of California near the West coast of the USA (hint: functions <a href="https://r-spatial.github.io/sf/reference/geos_unary.html"><code>st_centroid()</code></a>, <a href="https://r-spatial.github.io/sf/reference/geos_combine.html"><code>st_union()</code></a> and <a href="https://r-spatial.github.io/sf/reference/st_cast.html"><code>st_cast()</code></a> described in Chapter 5 may help) and identify which states this long East-West line crosses</strong>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb66" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1">wdc_centre <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_centroid</span>(</span>
<span id="cb66-2">  us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(NAME <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"District of Columbia"</span>)</span>
<span id="cb66-3">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb66-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(geometry)</span>
<span id="cb66-5"></span>
<span id="cb66-6">cal_centre <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_centroid</span>(</span>
<span id="cb66-7">  us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(NAME <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"California"</span>)</span>
<span id="cb66-8">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb66-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(geometry)</span>
<span id="cb66-10"></span>
<span id="cb66-11">straight_line <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_union</span>(</span>
<span id="cb66-12">  wdc_centre,</span>
<span id="cb66-13">  cal_centre</span>
<span id="cb66-14">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb66-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_cast</span>(</span>
<span id="cb66-16">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LINESTRING"</span></span>
<span id="cb66-17">  )</span>
<span id="cb66-18"></span>
<span id="cb66-19">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb66-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb66-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">on_the_way =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_vector</span>(</span>
<span id="cb66-22">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersects</span>(</span>
<span id="cb66-23">        us_states, </span>
<span id="cb66-24">        straight_line, </span>
<span id="cb66-25">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb66-26">      )</span>
<span id="cb66-27">    )</span>
<span id="cb66-28">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb66-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb66-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb66-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb66-32">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> on_the_way</span>
<span id="cb66-33">    )</span>
<span id="cb66-34">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb66-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(</span>
<span id="cb66-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"orange"</span>)</span>
<span id="cb66-37">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb66-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb66-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> straight_line,</span>
<span id="cb66-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb66-41">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb66-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb66-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> cal_centre,</span>
<span id="cb66-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb66-45">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb66-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb66-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> wdc_centre,</span>
<span id="cb66-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb66-49">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb66-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb66-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:5070"</span></span>
<span id="cb66-52">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb66-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb66-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Line from Centroids of District of Columbia and California;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">and highlighting the states that it crosses through"</span></span>
<span id="cb66-55">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb66-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb66-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span></span>
<span id="cb66-58">  )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter4_files/figure-html/unnamed-chunk-32-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-33"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="e5." class="level3">
<h3 class="anchored" data-anchor-id="e5.">E5.</h3>
<p><strong>Use <code>dem = rast(system.file("raster/dem.tif", package = "spDataLarge"))</code>, and reclassify the elevation in three classes: low (&lt;300), medium and high (&gt;500). Secondly, read the NDVI raster (<code>ndvi = rast(system.file("raster/ndvi.tif", package = "spDataLarge"))</code>) and compute the mean NDVI and the mean elevation for each altitudinal class.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1">dem <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/dem.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>))</span>
<span id="cb67-2"></span>
<span id="cb67-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb67-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dem) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb67-5">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grDevices::Terrain 2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb67-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Base raster `dem`"</span>)</span>
<span id="cb67-7"></span>
<span id="cb67-8">dem1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dem</span>
<span id="cb67-9"></span>
<span id="cb67-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(dem1) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(dem) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb67-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb67-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb67-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dem_class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb67-14">      dem <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Low"</span>,</span>
<span id="cb67-15">      dem <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"High"</span>,</span>
<span id="cb67-16">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.default =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Medium"</span></span>
<span id="cb67-17">    )</span>
<span id="cb67-18">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb67-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(dem_class)</span>
<span id="cb67-20"></span>
<span id="cb67-21"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb67-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dem1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb67-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#F1E4E3FF"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#00A600FF"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#EAB550FF"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb67-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The raster `dem` with elevation classified into 3 levels"</span>)</span></code></pre></div>
<div id="fig-e5-1" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-e5-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="fig-e5-1-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e5-1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-e5-1-1.png" class="lightbox" data-gallery="fig-e5-1" title="Figure&nbsp;14&nbsp;(a): Base raster"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-e5-1-1.png" class="img-fluid figure-img" data-ref-parent="fig-e5-1" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e5-1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Base raster
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-e5-1-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e5-1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-e5-1-2.png" class="lightbox" data-gallery="fig-e5-1" title="Figure&nbsp;14&nbsp;(b): Reclassified raster"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-e5-1-2.png" class="img-fluid figure-img" data-ref-parent="fig-e5-1" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e5-1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Reclassified raster
</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-e5-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14: Classifying elevation into high, middle and low
</figcaption>
</figure>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1">ndvi <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/ndvi.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>))</span>
<span id="cb68-2"></span>
<span id="cb68-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb68-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">elevation_class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(dem1),</span>
<span id="cb68-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">elevation =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(dem),</span>
<span id="cb68-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ndvi =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(ndvi)</span>
<span id="cb68-7">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb68-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(elevation_class) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb68-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb68-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_elevation =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(elevation),</span>
<span id="cb68-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_ndvi =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(ndvi)</span>
<span id="cb68-12">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb68-13">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb68-14">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>(</span>
<span id="cb68-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(mean_elevation, mean_ndvi)</span>
<span id="cb68-16">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb68-17">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label_with</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> snakecase<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>to_title_case) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb68-18">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(</span>
<span id="cb68-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mean elevation and NDVI for each altitude class"</span></span>
<span id="cb68-20">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb68-21">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_538</span>()</span></code></pre></div>
<div id="tbl-e5-2" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-e5-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Mean elevation and NDVI for each altitude class
</figcaption>
<div aria-describedby="tbl-e5-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="cxwquzrffb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#cxwquzrffb table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#cxwquzrffb thead, #cxwquzrffb tbody, #cxwquzrffb tfoot, #cxwquzrffb tr, #cxwquzrffb td, #cxwquzrffb th {
  border-style: none;
}

#cxwquzrffb p {
  margin: 0;
  padding: 0;
}

#cxwquzrffb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#cxwquzrffb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#cxwquzrffb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#cxwquzrffb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#cxwquzrffb .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cxwquzrffb .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cxwquzrffb .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cxwquzrffb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#cxwquzrffb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#cxwquzrffb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#cxwquzrffb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#cxwquzrffb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#cxwquzrffb .gt_spanner_row {
  border-bottom-style: hidden;
}

#cxwquzrffb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#cxwquzrffb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#cxwquzrffb .gt_from_md > :first-child {
  margin-top: 0;
}

#cxwquzrffb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#cxwquzrffb .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#cxwquzrffb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#cxwquzrffb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#cxwquzrffb .gt_row_group_first td {
  border-top-width: 2px;
}

#cxwquzrffb .gt_row_group_first th {
  border-top-width: 2px;
}

#cxwquzrffb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cxwquzrffb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#cxwquzrffb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#cxwquzrffb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cxwquzrffb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cxwquzrffb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#cxwquzrffb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#cxwquzrffb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#cxwquzrffb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cxwquzrffb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cxwquzrffb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cxwquzrffb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cxwquzrffb .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cxwquzrffb .gt_left {
  text-align: left;
}

#cxwquzrffb .gt_center {
  text-align: center;
}

#cxwquzrffb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#cxwquzrffb .gt_font_normal {
  font-weight: normal;
}

#cxwquzrffb .gt_font_bold {
  font-weight: bold;
}

#cxwquzrffb .gt_font_italic {
  font-style: italic;
}

#cxwquzrffb .gt_super {
  font-size: 65%;
}

#cxwquzrffb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#cxwquzrffb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#cxwquzrffb .gt_indent_1 {
  text-indent: 5px;
}

#cxwquzrffb .gt_indent_2 {
  text-indent: 10px;
}

#cxwquzrffb .gt_indent_3 {
  text-indent: 15px;
}

#cxwquzrffb .gt_indent_4 {
  text-indent: 20px;
}

#cxwquzrffb .gt_indent_5 {
  text-indent: 25px;
}

#cxwquzrffb .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#cxwquzrffb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="3" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="font-family: Chivo; font-weight: 700">Mean elevation and NDVI for each altitude class</th>
</tr>
<tr class="odd gt_col_headings">
<th id="Elevation Class" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Elevation Class</th>
<th id="Mean Elevation" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Mean Elevation</th>
<th id="Mean Ndvi" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Mean Ndvi</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="elevation_class">1</td>
<td class="gt_row gt_right" headers="mean_elevation">765.22</td>
<td class="gt_row gt_right" headers="mean_ndvi">−0.21</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="elevation_class">2</td>
<td class="gt_row gt_right" headers="mean_elevation">273.79</td>
<td class="gt_row gt_right" headers="mean_ndvi">−0.36</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="elevation_class">3</td>
<td class="gt_row gt_right" headers="mean_elevation">391.61</td>
<td class="gt_row gt_right" headers="mean_ndvi">−0.29</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<hr>
</section>
<section id="e6." class="level3">
<h3 class="anchored" data-anchor-id="e6.">E6.</h3>
<p><strong>Apply a line detection filter to <code>rast(system.file("ex/logo.tif", package = "terra"))</code>. Plot the result. Hint: Read <code>?terra::focal()</code>.</strong></p>
<p>The code below demonstrates edge detection on a raster image using Sobel filters with the <strong>{terra}</strong> package in R. The Sobel filters, represented as matrices <code>fx</code> and <code>fy</code>, are defined for detecting edges in horizontal and vertical directions, respectively. The <code>focal()</code> function applies these filters to the raster image, performing convolution to emphasize areas of rapid intensity change (edges). The processed images are then plotted, one showing <strong>horizontal edges (filtered with <code>fx</code>)</strong> in black and white, and the other showing <strong>vertical edges (filtered with <code>fy</code>)</strong> in white and black. This illustrates how Sobel filters can be used for edge detection in spatial raster data.</p>
<div class="sourceCode cell-code" id="cb69" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1">logo <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ex/logo.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"terra"</span>))</span>
<span id="cb69-2"></span>
<span id="cb69-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(logo)</span>
<span id="cb69-4"></span>
<span id="cb69-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sobel filters (for edge detection):</span></span>
<span id="cb69-6">fx <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb69-7">fy <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb69-8"></span>
<span id="cb69-9">logo <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb69-10">  terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">focal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">w =</span> fx) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb69-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>))</span>
<span id="cb69-12"></span>
<span id="cb69-13">logo <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb69-14">  terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">focal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">w =</span> fy) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb69-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>))</span></code></pre></div>
<div id="fig-e6" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-e6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-e6" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-e6-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e6-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-e6-1.png" class="lightbox" data-gallery="fig-e6" title="Figure&nbsp;15&nbsp;(a): Base raster Logo"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-e6-1.png" class="img-fluid figure-img" data-ref-parent="fig-e6" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e6-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Base raster Logo
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-e6" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-e6-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e6-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-e6-2.png" class="lightbox" data-gallery="fig-e6" title="Figure&nbsp;15&nbsp;(b): Horizontal edges detected with fx"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-e6-2.png" class="img-fluid figure-img" data-ref-parent="fig-e6" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e6-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Horizontal edges detected with fx
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-e6" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-e6-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e6-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-e6-3.png" class="lightbox" data-gallery="fig-e6" title="Figure&nbsp;15&nbsp;(c): Vertical edges detected with fy"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-e6-3.png" class="img-fluid figure-img" data-ref-parent="fig-e6" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e6-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Vertical edges detected with fy
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-e6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15: Edge detection with terra::focal()
</figcaption>
</figure>
</div>
<hr>
</section>
<section id="e7." class="level3">
<h3 class="anchored" data-anchor-id="e7.">E7.</h3>
<p><strong>Calculate the Normalized Difference Water Index (NDWI; <code>(green - nir)/(green + nir)</code>) of a Landsat image. Use the Landsat image provided by the spDataLarge package (<code>system.file("raster/landsat.tif", package = "spDataLarge")</code>). Also, calculate a correlation between NDVI and NDWI for this area (hint: you can use the <a href="https://rspatial.github.io/terra/reference/layerCor.html"><code>layerCor()</code></a> function).</strong></p>
<p>This code processes and visualizes raster data for Zion National Park, performing computations to derive vegetation and water indices and then plotting the results. The raster, containing layers for Red, Green, Blue, and Near Infrared (NIR) bands, is rescaled to real-world values, with negative values replaced by zeros.</p>
<p>Using custom functions, the NDVI (Normalized Difference Vegetation Index) and NDWI (Normalized Difference Water Index) are calculated from the NIR, Red, and Green bands. The resulting indices are converted into a tidy SpatRaster format for plotting.</p>
<p>The code below also calculates the correlation between the NDVI and NDWI layers as <strong>-0.96, thus telling us the NDVI and NDWI are negatively correlated (inversely correlated)</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#################### LONG, BASE R METHOD ########################</span></span>
<span id="cb70-2"></span>
<span id="cb70-3"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#################### I Don't Use This ###########################</span></span>
<span id="cb70-4"></span>
<span id="cb70-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Download the Zion National Park Raster File with layers of </span></span>
<span id="cb70-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Red, Green, Blue and NIR (Near Infra Red)</span></span>
<span id="cb70-7">landsat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(</span>
<span id="cb70-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/landsat.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>)</span>
<span id="cb70-9">)</span>
<span id="cb70-10"></span>
<span id="cb70-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Applying a scale factor to return values to actual ones.</span></span>
<span id="cb70-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The data-set was scaled to save disk space</span></span>
<span id="cb70-13">landsat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> (landsat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0000275</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span></span>
<span id="cb70-14"></span>
<span id="cb70-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove and replace negative values, since these were due to clouds</span></span>
<span id="cb70-16">landsat[landsat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb70-17"></span>
<span id="cb70-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Write a custom function for computing values of </span></span>
<span id="cb70-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># NDVI (normalized difference vegetation index) in R</span></span>
<span id="cb70-20">ndvi_fun <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(nir, red){</span>
<span id="cb70-21">  (nir <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> red) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (nir <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> red)</span>
<span id="cb70-22">}</span>
<span id="cb70-23"></span>
<span id="cb70-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a new raster with NDVI values using terra::lapp()</span></span>
<span id="cb70-25">landsat_ndvi <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapp</span>(landsat[[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> ndvi_fun)</span>
<span id="cb70-26"></span>
<span id="cb70-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Write a custom function for computing values of </span></span>
<span id="cb70-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># NDWI (normalized difference water index) in R</span></span>
<span id="cb70-29">ndwi_fun <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(nir, green){</span>
<span id="cb70-30">  (green <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> nir) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (nir <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> green)</span>
<span id="cb70-31">}</span>
<span id="cb70-32"></span>
<span id="cb70-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a new raster with NDVI values using terra::lapp()</span></span>
<span id="cb70-34">landsat_ndwi <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapp</span>(landsat[[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> ndwi_fun)</span>
<span id="cb70-35"></span>
<span id="cb70-36"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cor</span>(</span>
<span id="cb70-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(landsat_ndvi),</span>
<span id="cb70-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(landsat_ndwi),</span>
<span id="cb70-39">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"complete.obs"</span></span>
<span id="cb70-40">)</span>
<span id="cb70-41"></span>
<span id="cb70-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The correlation is -0.96. NDVI and NDWI are negatively correlated.</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">###################### THE TIDY APPROACH #######################</span></span>
<span id="cb71-2"></span>
<span id="cb71-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Download the Zion National Park Raster File with layers of </span></span>
<span id="cb71-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Red, Green, Blue and NIR (Near Infra Red)</span></span>
<span id="cb71-5">landsat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/landsat.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb71-6">  </span>
<span id="cb71-7">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Applying a scale factor to return values to actual ones,</span></span>
<span id="cb71-8">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The data-set was scaled to save disk space.</span></span>
<span id="cb71-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">multiply_by</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0000275</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb71-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">subtract</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb71-11">  </span>
<span id="cb71-12">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove and replace negative values, since these were due to clouds</span></span>
<span id="cb71-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">everything</span>(), <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(. <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, .)))</span>
<span id="cb71-14"></span>
<span id="cb71-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Write a custom function for computing values of </span></span>
<span id="cb71-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># NDVI (normalized difference vegetation index) in R</span></span>
<span id="cb71-17">ndvi_fun <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(nir, red) {</span>
<span id="cb71-18">  (nir <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> red) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (nir <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> red)</span>
<span id="cb71-19">}</span>
<span id="cb71-20"></span>
<span id="cb71-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Write a custom function for computing values of </span></span>
<span id="cb71-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># NDWI (normalized difference water index) in R</span></span>
<span id="cb71-23">ndwi_fun <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(nir, green) {</span>
<span id="cb71-24">  (green <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> nir) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (green <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> nir)</span>
<span id="cb71-25">}</span>
<span id="cb71-26"></span>
<span id="cb71-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Doing the tidy data wrangling magic with tidyverse and tidyterra</span></span>
<span id="cb71-28">landsat1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> landsat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb71-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xy =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb71-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb71-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ndvi =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ndvi_fun</span>(landsat_4, landsat_3),</span>
<span id="cb71-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ndwi =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ndwi_fun</span>(landsat_4, landsat_2)</span>
<span id="cb71-33">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb71-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"landsat"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb71-35">  tidyterra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_spatraster</span>(</span>
<span id="cb71-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(landsat)</span>
<span id="cb71-37">  )</span>
<span id="cb71-38"></span>
<span id="cb71-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Labeller for the facets</span></span>
<span id="cb71-40">lyr_labels <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb71-41">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"normalized difference vegetation index"</span>,</span>
<span id="cb71-42">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"normalized difference water index"</span></span>
<span id="cb71-43">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb71-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_to_title</span>()</span>
<span id="cb71-45"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(lyr_labels) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ndvi"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ndwi"</span>)</span>
<span id="cb71-46"></span>
<span id="cb71-47"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">layerCor</span>(landsat1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> cor, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"complete.obs"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb71-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]  [,2]
[1,]  1.00 -0.96
[2,] -0.96  1.00</code></pre>
</div>
</div>
<p>The <code>ggplot2</code> visualization in Figure&nbsp;16 uses facets to compare NDVI and NDWI values across the area, with clear labelling and a perceptually uniform colour scale.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The actual final plot</span></span>
<span id="cb73-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb73-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> landsat1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb73-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_grass_c</span>(</span>
<span id="cb73-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb73-6">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb73-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>lyr, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labeller =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labeller</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lyr =</span> lyr_labels)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb73-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb73-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb73-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Comparing NDVI and NDWI values"</span>,</span>
<span id="cb73-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Zion National Park area SpatRaster"</span>,</span>
<span id="cb73-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Value"</span></span>
<span id="cb73-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb73-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb73-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb73-16">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb73-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb73-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb73-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb73-20">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb73-21">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb73-22">    )</span>
<span id="cb73-23">  )</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-e7" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-e7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-e7-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-39" title="Figure&nbsp;16: Comparing NDVI and NDWI values"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-e7-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-e7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16: Comparing NDVI and NDWI values
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="e8." class="level3">
<h3 class="anchored" data-anchor-id="e8.">E8.</h3>
<p><strong>A StackOverflow <a href="https://stackoverflow.com/questions/35555709/global-raster-of-geographic-distances">post (stackoverflow.com/questions/35555709)</a> shows how to compute distances to the nearest coastline using <a href="https://rspatial.github.io/terra/reference/distance.html"><code>raster::distance()</code></a>. Try to do something similar but with <a href="https://rspatial.github.io/terra/reference/distance.html"><code>terra::distance()</code></a>: retrieve a digital elevation model of Spain, and compute a raster which represents distances to the coast across the country (hint: use <a href="https://rdrr.io/pkg/geodata/man/elevation.html"><code>geodata::elevation_30s()</code></a>). Convert the resulting distances from meters to kilometers. Note: it may be wise to increase the cell size of the input raster to reduce compute time during this operation (<a href="https://rspatial.github.io/terra/reference/aggregate.html"><code>aggregate()</code></a>).</strong></p>
<p>This code demonstrates the steps to compute and visualize the distance to the nearest coastline for Spain. First, it loads elevation data for Spain and nearby areas ( Figure&nbsp;17 (a) ), as well as for Spain’s political boundaries ( Figure&nbsp;17 (b) ), ensuring the inclusion of surrounding countries and water bodies. The raster is then aggregated for efficiency.</p>
<p>Initial visualizations are created: one showing elevation for Spain and neighbouring areas, and another isolating only Spain.</p>
<p>A binary raster is created where water is marked as <code>TRUE</code> (1) and land as <code>NA</code>. The <code>distance()</code> function calculates the distance of each land cell to the nearest water cell, with values converted to kilometres. ( Figure&nbsp;17 (c) )</p>
<p>Finally, the raw distance raster is masked to display only distances within Spain, producing a final visualization of Spain with distances to its nearest coastline ( Figure&nbsp;17 (d) ). The Figure&nbsp;17 includes multiple stages of the process, from raw data to the final processed map.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Full Spain and nearby Land Data</span></span>
<span id="cb74-2">spain_land <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> geodata<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">elevation_30s</span>(</span>
<span id="cb74-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Spain"</span>, </span>
<span id="cb74-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tempdir</span>(),</span>
<span id="cb74-5">  </span>
<span id="cb74-6">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use mask = FALSE to ensure that other countries are not shown as NA</span></span>
<span id="cb74-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mask =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb74-8"></span>
<span id="cb74-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data for only Sapin Political Boundaries Land</span></span>
<span id="cb74-10">spain_only <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> geodata<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">elevation_30s</span>(</span>
<span id="cb74-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Spain"</span>, </span>
<span id="cb74-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tempdir</span>()</span>
<span id="cb74-13">  )</span>
<span id="cb74-14"></span>
<span id="cb74-15">spain_working_land <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> spain_land <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb74-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aggregate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fact =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb74-17"></span>
<span id="cb74-18">spain_working_only <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> spain_only <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb74-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aggregate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fact =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb74-20"></span>
<span id="cb74-21"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb74-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> spain_working_land) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb74-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_terrain_c</span>(</span>
<span id="cb74-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb74-25">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb74-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb74-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Land map of Spain and nearby areas"</span>,</span>
<span id="cb74-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Water / Sea is shown as transparent values (NA)"</span>,</span>
<span id="cb74-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Elevation (m)"</span></span>
<span id="cb74-30">  ) </span>
<span id="cb74-31"></span>
<span id="cb74-32"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb74-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> spain_working_only) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb74-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_terrain_c</span>(</span>
<span id="cb74-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb74-36">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb74-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb74-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Land map of only Spain"</span>,</span>
<span id="cb74-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Water + nearby countries are shown as transparent values (NA)"</span>,</span>
<span id="cb74-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill  =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Elevation (m)"</span></span>
<span id="cb74-41">  ) </span>
<span id="cb74-42"></span>
<span id="cb74-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Start with a simple raster where only water is TRUE (1) </span></span>
<span id="cb74-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># and land is FALSE (0)</span></span>
<span id="cb74-45">temp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(spain_working_land)</span>
<span id="cb74-46"></span>
<span id="cb74-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert land (i.e. FALSE) into NA</span></span>
<span id="cb74-48">temp[temp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb74-49"></span>
<span id="cb74-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute distance of from nearest non-NA (i.e. Water / Sea)</span></span>
<span id="cb74-51">temp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">distance</span>(temp)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
|---------|---------|---------|---------|
=========================================
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb76" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Divide by 1000 to convert into KM</span></span>
<span id="cb76-2">temp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> temp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb76-3"></span>
<span id="cb76-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb76-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> temp) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb76-6">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb76-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grDevices::heat.colors"</span>,</span>
<span id="cb76-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb76-9">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb76-10">  </span>
<span id="cb76-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb76-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance from</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">water (km)"</span>,</span>
<span id="cb76-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Raw Spatraster of distance from Sea / Ocean"</span></span>
<span id="cb76-14">  )</span>
<span id="cb76-15"></span>
<span id="cb76-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert this raw distance vector to mask and only show Spain</span></span>
<span id="cb76-17">temp_spain <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> temp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb76-18">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Mask it with only the map of Spain Raster</span></span>
<span id="cb76-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mask</span>(spain_working_only) </span>
<span id="cb76-20"></span>
<span id="cb76-21"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb76-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> temp_spain) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb76-23">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb76-24">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grDevices::heat.colors"</span>,</span>
<span id="cb76-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb76-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb76-27">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb76-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb76-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(km)"</span>,</span>
<span id="cb76-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Spain: distances to nearest Coastline"</span></span>
<span id="cb76-31">  )</span></code></pre></div>
<div id="fig-e8" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-e8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="fig-e8-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e8-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-e8-1.png" class="lightbox" data-gallery="fig-e8" title="Figure&nbsp;17&nbsp;(a): Land map of Spain and nearby areas"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-e8-1.png" class="img-fluid figure-img" data-ref-parent="fig-e8" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e8-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Land map of Spain and nearby areas
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-e8-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e8-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-e8-2.png" class="lightbox" data-gallery="fig-e8" title="Figure&nbsp;17&nbsp;(b): Land map of only Spain"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-e8-2.png" class="img-fluid figure-img" data-ref-parent="fig-e8" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e8-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Land map of only Spain
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-e8-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e8-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-e8-3.png" class="lightbox" data-gallery="fig-e8" title="Figure&nbsp;17&nbsp;(c): Raw Spatraster of distance from coastline for entire landmass"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-e8-3.png" class="img-fluid figure-img" data-ref-parent="fig-e8" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e8-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Raw Spatraster of distance from coastline for entire landmass
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-e8-4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e8-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-e8-4.png" class="lightbox" data-gallery="fig-e8" title="Figure&nbsp;17&nbsp;(d): Final product: Spain with distances to nearest Coastline"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-e8-4.png" class="img-fluid figure-img" data-ref-parent="fig-e8" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e8-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d) Final product: Spain with distances to nearest Coastline
</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-e8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17: Steps in Computing the distance to nearest Coastline for Spain
</figcaption>
</figure>
</div>
</div>
<hr>
</section>
<section id="e9." class="level3">
<h3 class="anchored" data-anchor-id="e9.">E9.</h3>
<p><strong>Try to modify the approach used in the above exercise by weighting the distance raster with the elevation raster; every 100 altitudinal meters should increase the distance to the coast by 10 km. Next, compute and visualize the difference between the raster created using the Euclidean distance (E7) and the raster weighted by elevation.</strong></p>
<p>The code below performs a spatial analysis and visualization of the relationship between elevation and distance to the coastline for Spain. It begins by visualizing Spain’s elevation using a raster dataset (<code>spain_working_only</code>). It then calculates and visualizes the Euclidean distance from each point to the nearest coastline (<code>temp_spain</code>), as already done in Exercise <strong>E7</strong>.</p>
<p>A new raster (<code>spain_weighted</code>) is computed by weighting the Euclidean distance with elevation, where every 100 meters of elevation increases the effective distance to the coastline by 10 km.</p>
<p>The difference between the Euclidean distance raster and the elevation-weighted distance raster is then calculated and visualized (<code>spain_difference</code>).</p>
<p>The code uses the <code>ggplot2</code> package to display these rasters as separate maps, with clear titles and color scales to interpret the elevation, distances, and differences.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb77-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> spain_working_only) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb77-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_wiki_c</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb77-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb77-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Altitude (m)"</span>,</span>
<span id="cb77-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1. Elevation map of Spain"</span></span>
<span id="cb77-7">  )</span>
<span id="cb77-8"></span>
<span id="cb77-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb77-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> temp_spain) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb77-11">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb77-12">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grDevices::heat.colors"</span>,</span>
<span id="cb77-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb77-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb77-15">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb77-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb77-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(km)"</span>,</span>
<span id="cb77-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2. Spain: euclidean distances to nearest Coastline"</span></span>
<span id="cb77-19">  )</span>
<span id="cb77-20"></span>
<span id="cb77-21">spain_weighted <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> temp_spain <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> ((spain_working_only<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb77-22"></span>
<span id="cb77-23"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb77-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> spain_weighted) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb77-25">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb77-26">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grDevices::heat.colors"</span>,</span>
<span id="cb77-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb77-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb77-29">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb77-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb77-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(km)"</span>,</span>
<span id="cb77-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"3. Spain: distance to coastline weighted by elevation"</span></span>
<span id="cb77-33">  )</span>
<span id="cb77-34"></span>
<span id="cb77-35">spain_difference <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> spain_weighted <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> temp_spain</span>
<span id="cb77-36"></span>
<span id="cb77-37"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb77-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_spatraster</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> spain_difference) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb77-39">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb77-40">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grDevices::heat.colors"</span>,</span>
<span id="cb77-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb77-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb77-43">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb77-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb77-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Difference</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">in Distance</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(km)"</span>,</span>
<span id="cb77-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"4. Difference between 2nd and 3rd maps"</span></span>
<span id="cb77-47">  )</span></code></pre></div>
<div id="fig-e9" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-e9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="fig-e9-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e9-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-e9-1.png" class="lightbox" data-gallery="fig-e9" title="Figure&nbsp;18&nbsp;(a): Elevation map of Spain"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-e9-1.png" class="img-fluid figure-img" data-ref-parent="fig-e9" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e9-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Elevation map of Spain
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-e9-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e9-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-e9-2.png" class="lightbox" data-gallery="fig-e9" title="Figure&nbsp;18&nbsp;(b): Spain: euclidean distances to nearest Coastline"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-e9-2.png" class="img-fluid figure-img" data-ref-parent="fig-e9" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e9-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Spain: euclidean distances to nearest Coastline
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-e9-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e9-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-e9-3.png" class="lightbox" data-gallery="fig-e9" title="Figure&nbsp;18&nbsp;(c): Spain: distance to coastline weighted by elevation"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-e9-3.png" class="img-fluid figure-img" data-ref-parent="fig-e9" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e9-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Spain: distance to coastline weighted by elevation
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-e9-4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e9-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter4_files/figure-html/fig-e9-4.png" class="lightbox" data-gallery="fig-e9" title="Figure&nbsp;18&nbsp;(d): Difference between 2nd and 3rd maps"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4_files/figure-html/fig-e9-4.png" class="img-fluid figure-img" data-ref-parent="fig-e9" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e9-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d) Difference between 2nd and 3rd maps
</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-e9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18: Algebra on Rasters
</figcaption>
</figure>
</div>
</div>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-fuzzyjoin" class="csl-entry">
Robinson, David. 2020. <span>“Fuzzyjoin: Join Tables Together on Inexact Matching.”</span> <a href="https://CRAN.R-project.org/package=fuzzyjoin">https://CRAN.R-project.org/package=fuzzyjoin</a>.
</div>
</div></section></div> ]]></description>
  <category>Geocomputation with R</category>
  <category>Textbook Solutions</category>
  <guid>https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter4.html</guid>
  <pubDate>Fri, 15 Nov 2024 18:30:00 GMT</pubDate>
</item>
<item>
  <title>Chapter 3: Attribute data operations</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter3.html</link>
  <description><![CDATA[ 




<section id="prerequisites" class="level3">
<h3 class="anchored" data-anchor-id="prerequisites">Prerequisites</h3>
<ul>
<li><code>sf</code> for vector data manipulation (<a href="https://r-spatial.github.io/sf/">link</a>)</li>
<li><code>terra</code> for raster data manipulation (<a href="https://rspatial.org/terra/">link</a>)</li>
<li><code>dplyr</code> for data frame operations (<a href="https://dplyr.tidyverse.org/">link</a>)</li>
<li><code>spData</code> for example datasets (<a href="https://cran.r-project.org/web/packages/spData/index.html">link</a>)</li>
</ul>
</section>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">3.1 Introduction</h2>
<ul>
<li><strong>Attribute Data</strong>: Non-spatial info tied to geographic data (e.g., bus stop name or elevation).
<ul>
<li><strong>Vector Example</strong>: A bus stop’s location as POINT (-0.098 51.495) with attributes like its name.</li>
<li><strong>Raster Example</strong>: Pixel values represent attributes (e.g., elevation); location defined by matrix indices and resolution.</li>
</ul></li>
<li><strong>Chapter Focus</strong>:
<ul>
<li>Manipulating geographic objects using attributes (e.g., names, elevations).</li>
<li>Techniques: subsetting, aggregation, joining data, creating new variables.</li>
<li>Vector and raster data operations are similar and interchangeable (e.g., subsetting, spatial joins).</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sf)        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handling Simple Features in R</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(terra)     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handling Rasters in R</span></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data Wrangling</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(spData)    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Spatial Data-sets</span></span></code></pre></div>
</details>
</div>
</section>
<section id="vector-attribute-manipulation" class="level2">
<h2 class="anchored" data-anchor-id="vector-attribute-manipulation">3.2 Vector Attribute Manipulation</h2>
<ul>
<li><p><strong><code>sf</code> Package</strong>:</p>
<ul>
<li>Extends base R’s <code>data.frame</code> with a geometry column (<code>sfc</code> class) for spatial features (points, lines, polygons).</li>
<li>Geometry column often named <code>geometry</code> or <code>geom</code>, but <strong>customizable</strong>.</li>
</ul></li>
<li><p><strong>Manipulation Methods</strong>:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">methods</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">class =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb2-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">methods =</span> x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">methods =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace_all</span>(methods, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">",sf"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  "</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">methods =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace_all</span>(methods, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".sf"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  "</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-6">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-7">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(</span>
<span id="cb2-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methods available"</span></span>
<span id="cb2-9">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-10">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>()</span></code></pre></div>
</details>
<div id="tbl-methods-sf" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-methods-sf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Methods available for the class ‘sf’ in R using {sf} package
</figcaption>
<div aria-describedby="tbl-methods-sf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="ykhsfgbdti" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ykhsfgbdti table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ykhsfgbdti thead, #ykhsfgbdti tbody, #ykhsfgbdti tfoot, #ykhsfgbdti tr, #ykhsfgbdti td, #ykhsfgbdti th {
  border-style: none;
}

#ykhsfgbdti p {
  margin: 0;
  padding: 0;
}

#ykhsfgbdti .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ykhsfgbdti .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ykhsfgbdti .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ykhsfgbdti .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ykhsfgbdti .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ykhsfgbdti .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ykhsfgbdti .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ykhsfgbdti .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ykhsfgbdti .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ykhsfgbdti .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ykhsfgbdti .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ykhsfgbdti .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ykhsfgbdti .gt_spanner_row {
  border-bottom-style: hidden;
}

#ykhsfgbdti .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ykhsfgbdti .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ykhsfgbdti .gt_from_md > :first-child {
  margin-top: 0;
}

#ykhsfgbdti .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ykhsfgbdti .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ykhsfgbdti .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ykhsfgbdti .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ykhsfgbdti .gt_row_group_first td {
  border-top-width: 2px;
}

#ykhsfgbdti .gt_row_group_first th {
  border-top-width: 2px;
}

#ykhsfgbdti .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ykhsfgbdti .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ykhsfgbdti .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ykhsfgbdti .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ykhsfgbdti .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ykhsfgbdti .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ykhsfgbdti .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ykhsfgbdti .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ykhsfgbdti .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ykhsfgbdti .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ykhsfgbdti .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ykhsfgbdti .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ykhsfgbdti .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ykhsfgbdti .gt_left {
  text-align: left;
}

#ykhsfgbdti .gt_center {
  text-align: center;
}

#ykhsfgbdti .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ykhsfgbdti .gt_font_normal {
  font-weight: normal;
}

#ykhsfgbdti .gt_font_bold {
  font-weight: bold;
}

#ykhsfgbdti .gt_font_italic {
  font-style: italic;
}

#ykhsfgbdti .gt_super {
  font-size: 65%;
}

#ykhsfgbdti .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ykhsfgbdti .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ykhsfgbdti .gt_indent_1 {
  text-indent: 5px;
}

#ykhsfgbdti .gt_indent_2 {
  text-indent: 10px;
}

#ykhsfgbdti .gt_indent_3 {
  text-indent: 15px;
}

#ykhsfgbdti .gt_indent_4 {
  text-indent: 20px;
}

#ykhsfgbdti .gt_indent_5 {
  text-indent: 25px;
}

#ykhsfgbdti .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ykhsfgbdti div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div style="font-family:system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;border-top-style:solid;border-top-width:2px;border-top-color:#D3D3D3;">
<div class="gt_heading gt_title gt_font_normal" style="text-size:bigger;">Methods available</div>
<div class="gt_heading gt_subtitle "></div>
</div>
<div id="ykhsfgbdti" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="ykhsfgbdti">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"methods":["$<-  ","[  ","[[<-  ","[<-  ","aggregate  ","anti_join  ","arrange  ","as.data.frame  ","cbind  ","coerce,oldClass,S3-method","coerce  ,Spatial-method","coerce  ,SpatRaster-method","coerce  ,SpatVector-method","coerce,Spatial  -method","crs  -method","dbDataType,DBIObject  -method","dbDataType,PostgreSQLConnection  -method","dbWriteTable,DBIObject,character  -method","dbWriteTable,PostgreSQLConnection,character  -method","distance,SpatRaster  -method","distinct  ","dplyr_reconstruct  ","drop_na  ","duplicated  ","ext  -method","extract,SpatRaster  -method","filter  ","full_join  ","gather  ","group_by  ","group_split  ","identify  ","initialize,oldClass-method","inner_join  ","left_join  ","lines  -method","mask,SpatRaster  -method","merge  ","mutate  ","nest  ","pivot_longer  ","pivot_wider  ","plot  ","points  -method","points  ","polys  -method","print  ","rasterize  ,SpatRaster-method","rbind  ","rename  ","rename_with  ","right_join  ","rowwise  ","sample_frac  ","sample_n  ","select  ","semi_join  ","separate  ","separate_rows  ","show,oldClass-method","slice  ","slotsFromS3,oldClass-method","spread  ","st_agr  ","st_agr<-  ","st_area  ","st_as_s2  ","st_as    ","st_as  c  ","st_bbox  ","st_boundary  ","st_break_antimeridian  ","st_buffer  ","st_cast  ","st_centroid  ","st_collection_extract  ","st_concave_hull  ","st_convex_hull  ","st_coordinates  ","st_crop  ","st_crs  ","st_crs<-  ","st_difference  ","st_drop_geometry  ","st_exterior_ring  ","st_filter  ","st_geometry  ","st_geometry<-  ","st_inscribed_circle  ","st_interpolate_aw  ","st_intersection  ","st_intersects  ","st_is  ","st_is_valid  ","st_join  ","st_line_merge  ","st_m_range  ","st_make_valid  ","st_minimum_rotated_rectangle  ","st_nearest_points  ","st_node  ","st_normalize  ","st_point_on_surface  ","st_polygonize  ","st_precision  ","st_reverse  ","st_sample  ","st_segmentize  ","st_set_precision  ","st_shift_longitude  ","st_simplify  ","st_snap  ","st_sym_difference  ","st_tra  orm  ","st_triangulate  ","st_triangulate_constrained  ","st_union  ","st_voronoi  ","st_wrap_dateline  ","st_write  ","st_z_range  ","st_zm  ","summarise  ","svc  -method","text  ","tra  orm  ","transmute  ","ungroup  ","unite  ","unnest  ","vect  -method"]},"columns":[{"id":"methods","name":"methods","type":"character","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left","headerStyle":{"font-weight":"normal"}}],"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"rgba(128,128,128,0.05)","style":{"fontFamily":"system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"}},"elementId":"ykhsfgbdti","dataKey":"cca70f43f6631eb080efbbc9d14d448b"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>
<ul>
<li><p>Methods like <code>aggregate()</code>, <code>cbind()</code>, <code>merge()</code>, and <code>rbind()</code> work seamlessly with <code>sf</code> objects.</p></li>
<li><p>Compatible with tidyverse functions (<code>dplyr</code>, <code>tidyr</code>) and can be used with <code>data.table</code> (partial compatibility noted in issue <a href="https://github.com/Rdatatable/data.table/issues/2273">#2273</a>).</p></li>
<li><p>Dropping geometry (<code>st_drop_geometry()</code>) can speed up attribute data operations when spatial data is not required.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Original 'world' dataset</span></span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(world)</span>
<span id="cb3-3"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] 177  11</span></span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>(world)</span>
<span id="cb3-5"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] "sf"         "tbl_df"     "tbl"        "data.frame"</span></span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Dropping the geometry column: Effects</span></span>
<span id="cb3-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>(world) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>()</span>
<span id="cb3-10"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] 177  10</span></span>
<span id="cb3-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>(world) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>()</span>
<span id="cb3-13"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] "tbl_df"     "tbl"        "data.frame"</span></span></code></pre></div>
</div></li>
<li><p><strong>Advantages</strong>:</p>
<ul>
<li><code>sf</code>’s integration with the tidyverse allows robust, efficient data manipulation.</li>
<li>Compatible with tidyverse functions (e.g., <code>dplyr</code>), making it versatile for data analysis.</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-keylearning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Relevant Topic
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Major Pitfalls of Using Spatial Data with the Tidyverse</strong></p>
<ol type="1">
<li><strong>Name Clashes</strong>
<ul>
<li>Functions like <code>select()</code> from <a href="https://dplyr.tidyverse.org/reference/select.html"><code>dplyr</code></a> can mask similar functions from the <a href="https://rspatial.github.io/raster/reference/select.html"><code>raster</code></a> package.</li>
<li>Use fully qualified names (e.g., <a href="https://dplyr.tidyverse.org/reference/select.html"><code>dplyr::select()</code></a>) to avoid conflicts.</li>
</ul></li>
<li><strong>Compatibility Issues with <code>sp</code> Package</strong>
<ul>
<li>The older <a href="https://cran.r-project.org/web/packages/sp/index.html"><code>sp</code></a> package does not integrate well with tidyverse functions.</li>
<li>Requires conversion between <code>sp</code> to <a href="https://r-spatial.github.io/sf/articles/sf1.html"><code>sf</code></a> object types using functions like <a href="https://r-spatial.github.io/sf/reference/st_as_sf.html"><code>st_as_sf()</code></a>.</li>
</ul></li>
<li><strong>Handling Multipolygon Objects</strong>
<ul>
<li>Multiple geometries in objects can cause unexpected plotting results.</li>
<li>Resolve issues by casting to simpler geometry types using <code>st_cast(to = "POLYGON")</code>.</li>
</ul></li>
<li><strong>Spatial Subsetting Challenges</strong>
<ul>
<li><p>Verbose syntax when using tidyverse functions like <a href="https://dplyr.tidyverse.org/reference/filter.html"><code>filter()</code></a> with spatial predicates like <a href="https://r-spatial.github.io/sf/reference/st_intersects.html"><code>st_intersects()</code></a>.</p></li>
<li><p>May result in altered row names, complicating joins and comparisons.</p></li>
<li><p>Other option is spatial subsetting using base <code>R</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">lnd_buff <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> lnd[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">27700</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># uk CRS</span></span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_buffer</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span>)</span>
<span id="cb4-5">near_lnd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> world[lnd_buff, ]</span>
<span id="cb4-6">world_poly <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> world <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_cast</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"POLYGON"</span>)</span>
<span id="cb4-8">near_lnd_new <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> world_poly[lnd_buff, ]</span>
<span id="cb4-9">near_lnd_tidy <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> world <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersects</span>(., lnd_buff, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparse =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>))</span></code></pre></div>
</div></li>
</ul></li>
<li><strong>Row Name Alterations</strong>
<ul>
<li>Tidyverse operations may drop or alter row names, affecting joins and comparisons. See related discussion in <a href="https://github.com/tidyverse/dplyr/issues/366">tidyverse/dplyr#366</a>.</li>
</ul></li>
<li><strong>Attribute Alteration Pitfall</strong>
<ul>
<li>Results from tidyverse functions may differ from base R operations due to row name discrepancies.</li>
<li>Example functions: <a href="https://dplyr.tidyverse.org/reference/filter.html"><code>filter()</code></a> vs base R subsetting (<code>[]</code>).</li>
</ul></li>
<li><strong>Issues with <code>bind_rows()</code></strong>
<ul>
<li><a href="https://dplyr.tidyverse.org/reference/bind.html"><code>bind_rows()</code></a> fails on spatial objects; use alternatives like setting geometries to NULL with <a href="https://r-spatial.github.io/sf/reference/st_set_geometry.html"><code>st_set_geometry()</code></a> before combining.</li>
</ul></li>
<li><strong>Limited Raster Data Support</strong>
<ul>
<li>Tidyverse integration with <a href="https://rspatial.github.io/raster/"><code>raster</code></a> data is minimal.</li>
<li>Initial efforts like <a href="https://cran.r-project.org/web/packages/tabularaster/index.html"><code>tabularaster</code></a>, <a href="https://cran.r-project.org/web/packages/sfraster/index.html"><code>sfraster</code></a>, and <a href="https://r-spatial.github.io/stars/"><code>stars</code></a> aim to enhance support.</li>
</ul></li>
</ol>
</div>
</div>
<section id="vector-attribute-sub-setting" class="level3">
<h3 class="anchored" data-anchor-id="vector-attribute-sub-setting">3.2.1 Vector Attribute Sub-setting</h3>
<ul>
<li><strong>Base R Sub-setting</strong>:
<ul>
<li><p>Uses <code>[</code> operator and <code>subset()</code> function for rows and columns selection.</p></li>
<li><p>Syntax: <code>object[i, j]</code> returns rows indexed by <code>i</code> and columns by <code>j</code>.</p></li>
</ul></li>
<li><strong><code>dplyr</code> Sub-setting Functions</strong>:
<ul>
<li><p><code>filter()</code> and <code>slice()</code> for rows, <code>select()</code> for columns.</p></li>
<li><p><strong><code>select()</code></strong>: Subsets columns by name or position.</p></li>
<li><p>Helper functions in <code>select()</code> like <code>contains()</code>, <code>starts_with()</code>, <code>num_range()</code>.</p></li>
</ul></li>
<li><strong>Extracting a Single Column</strong>:
<ul>
<li>Use <code>pull()</code> (<code>dplyr</code>), <code>$</code>, or <code>[[</code> (base <code>R</code>).</li>
</ul></li>
<li><strong>Row Selection</strong>:
<ul>
<li><p><strong><code>slice()</code></strong>: Selects rows by index.</p></li>
<li><p><strong><code>filter()</code></strong>: Filters rows based on conditions.</p></li>
</ul></li>
<li><strong>Comparison Operators</strong>:
<ul>
<li>Standard operators can be used in <code>filter()</code>: <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>==</code>, <code>!=</code>.</li>
</ul></li>
</ul>
<p>The <code>dplyr</code> functions (<code>filter()</code>, <code>select()</code>, <code>pull()</code>) are intuitive and integrate well with the tidyverse workflows.</p>
</section>
<section id="chaining-commands-with-pipes" class="level3">
<h3 class="anchored" data-anchor-id="chaining-commands-with-pipes">3.2.2 Chaining Commands with Pipes</h3>
<ul>
<li><strong>Pipe Operator</strong>:
<ul>
<li><strong><code>%&gt;%</code></strong> (from the <strong><code>magrittr</code></strong> package) and native <strong><code>|&gt;</code></strong> (from R 4.1.0 onwards) enable chaining commands, improving readability and flow of code.</li>
<li>The output of one function becomes the input of the next.</li>
<li>Alternative: Nested Function Calls: The same operation without pipes uses nested functions, which is harder to read.</li>
</ul></li>
<li><strong>Splitting into Multiple Lines</strong>:
<ul>
<li>Useful for debugging and inspecting intermediate results but can clutter the environment.</li>
</ul></li>
<li><strong>Key Packages</strong>:
<ul>
<li><a href="https://dplyr.tidyverse.org/"><strong><code>dplyr</code></strong></a>: Provides verbs like <code>filter()</code>, <code>select()</code>, <code>slice()</code>, and supports pipe workflows.</li>
<li><a href="https://magrittr.tidyverse.org/"><strong><code>magrittr</code></strong></a>: Provides <code>%&gt;%</code> operator for chaining functions.</li>
</ul></li>
</ul>
</section>
<section id="vector-attribute-aggregation" class="level3">
<h3 class="anchored" data-anchor-id="vector-attribute-aggregation">3.2.3 Vector Attribute Aggregation</h3>
<ul>
<li>Aggregation is summarizing data using one or more grouping variables, often leading to a smaller dataset. It is useful for data reduction, especially when working with large datasets.</li>
<li><strong>Base R Approach</strong>
<ul>
<li><strong>Using <code>aggregate()</code></strong>:
<ul>
<li><a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/aggregate"><strong><code>aggregate()</code></strong></a> groups data and applies a function (e.g., <code>sum</code>). Result: A non-spatial data frame with two columns (<code>continent</code>, <code>pop</code>).</li>
</ul></li>
<li><strong>Using <code>aggregate.sf()</code></strong>:
<ul>
<li>For spatial objects (<code>sf</code>), use <code>aggregate()</code> with <code>by</code> argument. This results in an <strong><code>sf</code></strong> object with eight features representing continents.</li>
</ul></li>
</ul></li>
<li><strong><code>dplyr</code> Approach</strong>
<ul>
<li><strong>Using <code>group_by()</code> and <code>summarize()</code></strong>:
<ul>
<li><p>Equivalent to <code>aggregate()</code>, but offers flexibility and control:</p>
<ul>
<li><a href="https://dplyr.tidyverse.org/reference/group_by.html"><strong><code>group_by()</code></strong></a> defines grouping variables.</li>
<li><a href="https://dplyr.tidyverse.org/reference/summarise.html"><strong><code>summarize()</code></strong></a> applies aggregation functions.</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb5-2">world <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(continent) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pop =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(pop, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 8 features and 2 fields
Geometry type: GEOMETRY
Dimension:     XY
Bounding box:  xmin: -180 ymin: -89.9 xmax: 180 ymax: 83.64513
Geodetic CRS:  WGS 84
# A tibble: 8 × 3
  continent                      pop                                        geom
  &lt;chr&gt;                        &lt;dbl&gt;                              &lt;GEOMETRY [°]&gt;
1 Africa                  1154946633 MULTIPOLYGON (((36.86623 22, 36.69069 22.2…
2 Antarctica                       0 MULTIPOLYGON (((-180 -89.9, 180 -89.9, 180…
3 Asia                    4311408059 MULTIPOLYGON (((36.14976 35.82153, 35.9050…
4 Europe                   669036256 MULTIPOLYGON (((26.29 35.29999, 25.74502 3…
5 North America            565028684 MULTIPOLYGON (((-82.26815 23.18861, -82.51…
6 Oceania                   37757833 MULTIPOLYGON (((166.7932 -15.66881, 167.00…
7 Seven seas (open ocean)          0 POLYGON ((68.935 -48.625, 68.8675 -48.83, …
8 South America            412060811 MULTIPOLYGON (((-66.95992 -54.89681, -66.4…</code></pre>
</div>
</div>
<ul>
<li>More details on grouped data and <a href="https://dplyr.tidyverse.org/reference/summarise.html"><code>summarize()</code></a> from the <strong>dplyr</strong> package vignettes.</li>
</ul>
<div class="callout callout-style-default callout-keylearning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Relevant Topic
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong><code>dplyr</code></strong> functions are highly effective when applied to grouped data frames (<code>grouped_df</code> objects). Here are the main points covered:</p>
<ul>
<li><p><strong>Grouping Data</strong>: Use <a href="https://dplyr.tidyverse.org/reference/group_by.html"><strong><code>group_by()</code></strong></a> to create groups within a data frame based on one or more variables.</p>
<ul>
<li>To count rows in each group, use <a href="https://dplyr.tidyverse.org/reference/tally.html"><strong><code>tally()</code></strong></a>.</li>
</ul></li>
<li><p><strong>Accessing Group Metadata</strong>:</p>
<ul>
<li><strong><code>group_keys()</code></strong>: Shows underlying group data. <a href="https://dplyr.tidyverse.org/reference/group_keys.html">Details here</a>.</li>
<li><strong><code>group_vars()</code></strong>: Retrieves names of the grouping variables. <a href="https://dplyr.tidyverse.org/reference/group_vars.html">Details here</a>.</li>
</ul></li>
<li><p><strong>Modifying Groups</strong>:</p>
<ul>
<li>To overwrite or add grouping variables, use <code>.add = TRUE</code> with <strong><code>group_by()</code></strong>. <a href="https://dplyr.tidyverse.org/reference/group_by.html">Read more</a>.</li>
<li>To remove groups, use <a href="https://dplyr.tidyverse.org/reference/ungroup.html"><strong><code>ungroup()</code></strong></a>.</li>
</ul></li>
<li><p><strong>Verbs and Grouping</strong>:</p>
<ul>
<li><strong><code>summarise()</code></strong>: Computes summary statistics per group. The <code>.groups</code> argument controls grouping structure. <a href="https://dplyr.tidyverse.org/reference/summarise.html">More on <code>summarise()</code></a>.</li>
</ul></li>
<li><p><strong>Column Manipulation</strong>:</p>
<ul>
<li><strong><code>select()</code></strong> retains grouping variables by default. <a href="https://dplyr.tidyverse.org/reference/select.html">More on <code>select()</code></a>.</li>
<li><strong><code>rename()</code></strong> and <strong><code>relocate()</code></strong> function the same way for grouped and ungrouped data. <a href="https://dplyr.tidyverse.org/reference/relocate.html">Details here</a>.</li>
</ul></li>
<li><p><strong>Sorting Groups</strong>:</p>
<ul>
<li><strong><code>arrange()</code></strong>: Sorts data, with <code>.by_group = TRUE</code> option to sort within groups. <a href="https://dplyr.tidyverse.org/reference/arrange.html">More on <code>arrange()</code></a>.</li>
</ul></li>
</ul>
</div>
</div>
<ul>
<li>Check out <a href="https://r4ds.had.co.nz/transform.html">Chapter 5</a> of <a href="https://r4ds.had.co.nz/"><em>R for Data Science</em></a>.</li>
</ul>
</section>
<section id="vector-attribute-joining" class="level3">
<h3 class="anchored" data-anchor-id="vector-attribute-joining">3.2.4 Vector Attribute Joining</h3>
<ul>
<li><p>Joining involves combining tables based on a shared key variable. In R, <code>dplyr</code> functions like <code>left_join()</code> and <code>inner_join()</code> are commonly used for this purpose.</p>
<ul>
<li>The join functions in <code>dplyr</code> (<code>left_join</code>, <code>inner_join</code>, etc.) follow conventions from SQL, allowing easy and consistent data merging.</li>
<li>These functions work similarly for both non-spatial (<code>data.frame</code>) and spatial (<code>sf</code>) objects. The geometry list column in <code>sf</code> objects is the key difference.</li>
</ul></li>
<li><p><strong>When merging an <code>sf</code> object with a data.frame</strong></p>
<ul>
<li>The resulting object remains an <code>sf</code> object, keeping its spatial features intact while adding new columns for coffee production.</li>
</ul></li>
<li><p><strong>Handling Key Variables</strong>:</p>
<ul>
<li>If datasets have key variables with matching names (e.g., <code>name_long</code>), joining works automatically.</li>
<li>If the key variables differ, either:
<ul>
<li>Rename the variable to match, or</li>
<li>Use the <code>by</code> argument to specify the joining variables explicitly.</li>
</ul></li>
</ul></li>
<li><p><strong>Inner Joins</strong>:</p>
<ul>
<li>An <strong>inner join</strong> keeps only the rows with matching key variables in both datasets. This reduces the number of rows, depending on the overlap in key variables.</li>
</ul></li>
<li><p><strong>Troubleshooting Joins</strong>:</p>
<ul>
<li>If some rows are missing in the result (e.g., due to differing key names like “Congo, Dem. Rep.&nbsp;of”), identify mismatches using <code>setdiff()</code>.</li>
<li>Use regex matching from the <code>stringr</code> package to identify correct key names for adjustments.</li>
</ul></li>
<li><p><strong>Reversing Joins</strong>:</p>
<ul>
<li>You can also join starting with a non-spatial dataset and adding spatial variables from an <code>sf</code> object.</li>
<li><strong>The result will be a non-spatial <code>data.frame</code> (tibble), unless explicitly converted to an <code>sf</code> object using <code>st_as_sf()</code>.</strong></li>
</ul></li>
<li><p><strong>Further Resources</strong>:</p>
<ul>
<li><p><a href="https://r4ds.had.co.nz/relational-data.html?q=join#relational-data">Chapter 13</a> on Relational Data in <a href="https://r4ds.had.co.nz/relational-data.html?q=join#relational-data">R for Data Science</a> by Grolemund and Wickham (2016)</p></li>
<li><p>The <a href="https://asardaes.github.io/table.express/articles/joins.html">documentation</a>&nbsp;describing joins with&nbsp;<strong><code>data.table</code></strong> package.</p></li>
<li><p>The join <a href="https://geocompx.github.io/geocompkg/articles/join.html">vignette</a> in the <code>geocompkg</code> package, which is summarized below: —</p></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-keylearning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Relevant Topic
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Spatial Joins Extended</strong></p>
<ul>
<li>Spatial Joins: Combines attributes from different datasets based on a common key, useful for integrating non-spatial (attribute) data with spatial data.</li>
</ul>
<section id="left-join" class="level4">
<h4 class="anchored" data-anchor-id="left-join">Left Join</h4>
<ul>
<li>Adds attributes to all observations from the left dataset with matched values from the right.</li>
</ul>
</section>
<section id="joining-by-different-column-names" class="level4">
<h4 class="anchored" data-anchor-id="joining-by-different-column-names">Joining by Different Column Names</h4>
<ul>
<li><p>Case: If key columns have different names, use a named vector to specify the keys</p></li>
<li><p>Issue: Duplicate columns (e.g., <code>tbl_1_var.x</code> and <code>tbl_2_var.y</code>). Resolved by specifying all keys.</p></li>
</ul>
</section>
<section id="joining-with-a-non-spatial-first-argument" class="level4">
<h4 class="anchored" data-anchor-id="joining-with-a-non-spatial-first-argument">Joining with a Non-Spatial First Argument</h4>
<ul>
<li>Dropping Geometry: <code>st_drop_geometry()</code> removes spatial attributes, allowing joins with standard data frames.</li>
</ul>
</section>
<section id="inner-join" class="level4">
<h4 class="anchored" data-anchor-id="inner-join">Inner Join</h4>
<ul>
<li>Keeps only rows with matching keys in both datasets.</li>
</ul>
</section>
</div>
</div>
</section>
<section id="creating-attributes-and-removing-spatial-information" class="level3">
<h3 class="anchored" data-anchor-id="creating-attributes-and-removing-spatial-information">3.2.5 Creating attributes and removing spatial information</h3>
<ul>
<li><strong>Creating new attributes</strong>:
<ul>
<li>Calculate a new attribute using <code>mutate()</code> from <code>dplyr</code>. Example: <code>population / area</code>.</li>
<li>Use <code>mutate()</code> to add the new column without overwriting the geometry column.</li>
</ul></li>
<li><strong>Combining columns</strong>:
<ul>
<li>Use <a href="https://tidyr.tidyverse.org/reference/unite.html"><code>unite()</code></a> from <code>tidyr</code> to merge two or more columns into one (e.g., <code>continent</code> and <code>region_un</code>).</li>
<li><code>unite()</code> allows setting a separator (e.g., <code>:</code>) and can optionally remove the original columns.</li>
</ul></li>
<li><strong>Splitting columns</strong>:
<ul>
<li>Use <a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html"><code>separate_wider_position()</code></a> and <a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html"><code>separate_wider_delim()</code></a>from <code>tidyr</code> to split a combined column back into its original components.</li>
</ul></li>
<li><strong>Renaming columns</strong>:
<ul>
<li>Use <a href="https://dplyr.tidyverse.org/reference/rename.html"><code>rename()</code></a> from <code>dplyr</code> for renaming specific columns.</li>
<li>For renaming all columns, use <a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/setNames"><code>setNames()</code></a> with a character vector for new names.</li>
</ul></li>
<li><strong>Removing geometry</strong>:
<ul>
<li>Use <a href="https://r-spatial.github.io/sf/reference/st_geometry.html"><code>st_drop_geometry()</code></a> to drop the spatial information while retaining the attributes in a non-spatial <code>data.frame</code>. This method is preferred over manually selecting non-geometry columns as it avoids unintended issues.</li>
</ul></li>
</ul>
</section>
</section>
<section id="manipulating-raster-objects" class="level2">
<h2 class="anchored" data-anchor-id="manipulating-raster-objects">3.3 Manipulating Raster Objects</h2>
<ul>
<li><strong>Raster Data Model</strong>:
<ul>
<li>Represents continuous surfaces, unlike vector data which use discrete entities (points, lines, polygons).</li>
<li>Useful for representing spatial phenomena like elevation, temperature, and land cover.</li>
</ul></li>
<li><strong>Creating a Raster Object</strong>:
<ul>
<li>Use <code>rast()</code> function to create raster objects.</li>
<li>The <code>vals</code> argument assigns numeric values to each cell.</li>
</ul></li>
<li><strong>Categorical Raster Values</strong>:
<ul>
<li>Can hold logical or factor (categorical) values.</li>
<li>Example: Creating a raster for soil types (<code>clay</code>, <code>silt</code>, <code>sand</code>).</li>
</ul></li>
<li><strong>Raster Attribute Table (RAT)</strong>:
<ul>
<li>Stores additional information about raster values, accessible with <code>cats()</code>.</li>
<li>Each layer’s attribute data can be modified with <code>levels()</code>.</li>
</ul></li>
<li><strong>Color Table</strong>:
<ul>
<li>Categorical rasters can store color information using a color table with RGB (Red, Green, Blue) or RGBA (Red, Green, Blue, Alpha) columns.</li>
<li>Use <code>coltab()</code> to view or set color tables.</li>
<li>Saving the raster (e.g., as GeoTIFF) includes the color table information.</li>
</ul></li>
</ul>
<section id="raster-subsetting" class="level3">
<h3 class="anchored" data-anchor-id="raster-subsetting">3.3.1 Raster subsetting</h3>
<ul>
<li><p><strong>Raster Subsetting</strong>:</p>
<ul>
<li>Involves selecting specific parts of a raster dataset using the base R subsetting operator <code>[ , ]</code>.</li>
<li><strong>Subsetting Methods</strong>:
<ol type="1">
<li><strong>Row-Column Indexing</strong>: Accesses cells using specific row and column coordinates.</li>
<li><strong>Cell IDs</strong>: Accesses cells using unique numeric identifiers for each raster cell.</li>
<li><strong>Coordinates and Spatial Objects</strong>: These methods are used for spatial subsetting, using another spatial object to subset a raster.</li>
</ol></li>
</ul></li>
<li><p><strong>Examples</strong>:</p>
<ul>
<li>Accessing the top-left pixel value using row-column indexing:</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A simple raster</span></span>
<span id="cb7-2">  elev <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(</span>
<span id="cb7-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrows =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncols =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb7-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>,</span>
<span id="cb7-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vals =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb7-6">    ) </span>
<span id="cb7-7"></span>
<span id="cb7-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A raster with categorical levels</span></span>
<span id="cb7-9">grain <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(</span>
<span id="cb7-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrows =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncols =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb7-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>,</span>
<span id="cb7-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vals =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(</span>
<span id="cb7-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Wheat"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rice"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Maize"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Others"</span>),</span>
<span id="cb7-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,</span>
<span id="cb7-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb7-16">  )</span>
<span id="cb7-17">)</span>
<span id="cb7-18"></span>
<span id="cb7-19">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print the "elev" object to visualize the design</span></span>
<span id="cb7-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(elev)</span>
<span id="cb7-21"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## class       : SpatRaster </span></span>
<span id="cb7-22"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## dimensions  : 10, 10, 1  (nrow, ncol, nlyr)</span></span>
<span id="cb7-23"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## resolution  : 0.3, 0.3  (x, y)</span></span>
<span id="cb7-24"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## extent      : -1.5, 1.5, -1.5, 1.5  (xmin, xmax, ymin, ymax)</span></span>
<span id="cb7-25"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## coord. ref. : lon/lat WGS 84 (CRS84) (OGC:CRS84) </span></span>
<span id="cb7-26"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## source(s)   : memory</span></span>
<span id="cb7-27"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## name        : lyr.1 </span></span>
<span id="cb7-28"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## min value   :     1 </span></span>
<span id="cb7-29"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## max value   :   100</span></span>
<span id="cb7-30"></span>
<span id="cb7-31">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the raster object to visualize the matrix as an image</span></span>
<span id="cb7-32">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(</span>
<span id="cb7-33">      elev, </span>
<span id="cb7-34">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Raster Object with a Sequential Pattern"</span></span>
<span id="cb7-35">    )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter3_files/figure-html/raster-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter3_files/figure-html/raster-1-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"></span>
<span id="cb8-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Accessing using row number and column number</span></span>
<span id="cb8-3">    elev[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb8-4"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##   lyr.1</span></span>
<span id="cb8-5"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1     1</span></span>
<span id="cb8-6"></span>
<span id="cb8-7">    elev[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]</span>
<span id="cb8-8"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##   lyr.1</span></span>
<span id="cb8-9"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1    95</span></span>
<span id="cb8-10"></span>
<span id="cb8-11">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(</span>
<span id="cb8-12">      grain,</span>
<span id="cb8-13">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Raster Object with 4 categorical levels"</span></span>
<span id="cb8-14">    )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter3_files/figure-html/raster-1-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter3_files/figure-html/raster-1-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"></span>
<span id="cb9-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Accessing using row number and column number</span></span>
<span id="cb9-3"></span>
<span id="cb9-4">    grain[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb9-5"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##   lyr.1</span></span>
<span id="cb9-6"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1  Rice</span></span>
<span id="cb9-7"></span>
<span id="cb9-8">    grain[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]</span>
<span id="cb9-9"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##    lyr.1</span></span>
<span id="cb9-10"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1 Others</span></span>
<span id="cb9-11"></span>
<span id="cb9-12">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A multilayered raster - combining both</span></span>
<span id="cb9-13">    two_layers <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(elev, grain)</span>
<span id="cb9-14"></span>
<span id="cb9-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(two_layers)</span>
<span id="cb9-16"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## class       : SpatRaster </span></span>
<span id="cb9-17"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## dimensions  : 10, 10, 2  (nrow, ncol, nlyr)</span></span>
<span id="cb9-18"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## resolution  : 0.3, 0.3  (x, y)</span></span>
<span id="cb9-19"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## extent      : -1.5, 1.5, -1.5, 1.5  (xmin, xmax, ymin, ymax)</span></span>
<span id="cb9-20"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## coord. ref. : lon/lat WGS 84 (CRS84) (OGC:CRS84) </span></span>
<span id="cb9-21"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## source(s)   : memory</span></span>
<span id="cb9-22"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## names       : lyr.1, lyr.1 </span></span>
<span id="cb9-23"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## min values  :     1, Maize </span></span>
<span id="cb9-24"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## max values  :   100, Wheat</span></span>
<span id="cb9-25">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(two_layers) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Continuous variable"</span>, </span>
<span id="cb9-26">                           <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Categorical variable"</span>)</span>
<span id="cb9-27">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(</span>
<span id="cb9-28">      two_layers</span>
<span id="cb9-29">    )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter3_files/figure-html/raster-1-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter3_files/figure-html/raster-1-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Accessing the first cell using its Cell ID:</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Accessing raster values using cell ID</span></span>
<span id="cb10-2">elev[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb10-3"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##   lyr.1</span></span>
<span id="cb10-4"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1     1</span></span>
<span id="cb10-5">elev[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">95</span>]</span>
<span id="cb10-6"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##   lyr.1</span></span>
<span id="cb10-7"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1    95</span></span></code></pre></div>
</details>
</div>
<ul>
<li><p><strong>Subsetting Multi-layered Rasters</strong>:</p>
<ul>
<li>For multi-layer raster objects (e.g., <code>two_layers = c(grain, elev)</code>), subsetting returns values from each layer:</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">two_layers[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Continuous variable Categorical variable
1                   1                 Rice</code></pre>
</div>
</div>
<ul>
<li>To extract all cell values from a raster:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extracting all values - single layer raster</span></span>
<span id="cb13-2">elev[][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]  </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># It is Equivalent to using the values() function</span></span>
<span id="cb15-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(elev)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extracting all values - multi-layer raster</span></span>
<span id="cb17-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># It returns a data.frame</span></span>
<span id="cb17-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(two_layers) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb17-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 2
   `Continuous variable` `Categorical variable`
                   &lt;int&gt;                  &lt;int&gt;
 1                     1                      3
 2                     2                      3
 3                     3                      3
 4                     4                      2
 5                     5                      1
 6                     6                      1
 7                     7                      3
 8                     8                      3
 9                     9                      1
10                    10                      2
# ℹ 90 more rows</code></pre>
</div>
</div>
<ul>
<li><p><strong>Modifying Raster Values</strong>:</p>
<ul>
<li>Change specific cell values by combining subsetting with assignment:</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">elev[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sets the value of the 1 central cells to 0</span></span>
<span id="cb19-2"></span>
<span id="cb19-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(elev)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter3_files/figure-html/unnamed-chunk-10-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter3_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Modify multiple cells simultaneously:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1">elev[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sets the value of the central 2 cells to 0</span></span>
<span id="cb20-2"></span>
<span id="cb20-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(elev)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter3_files/figure-html/unnamed-chunk-11-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter3_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><strong>Replacing Values in Multi-layered Rasters</strong>:</p>
<ul>
<li>Modify cell values in a multi-layer raster using a matrix with corresponding layers and cell indices:</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Assigns new values for Cell ID 1 in both layers</span></span>
<span id="cb21-2">two_layers[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))  </span>
<span id="cb21-3"></span>
<span id="cb21-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(two_layers)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter3_files/figure-html/unnamed-chunk-12-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter3_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>This subsetting approach allows efficient extraction and manipulation of raster cell values, enabling the customization of raster datasets for specific analytical needs.</p>
</section>
<section id="summarizing-raster-objects" class="level3">
<h3 class="anchored" data-anchor-id="summarizing-raster-objects">3.3.2 Summarizing Raster Objects</h3>
<ul>
<li><strong>Descriptive Statistics</strong>:
<ul>
<li>The <strong>terra</strong> package provides functions for summarizing raster objects.</li>
<li>Printing a raster object directly shows the <strong>minimum</strong> and <strong>maximum</strong> values.</li>
<li>The <a href="https://rspatial.github.io/terra/reference/summary.html"><code>summary()</code></a> function provides detailed statistics:
<ul>
<li>For <strong>continuous rasters</strong>: Minimum, maximum, quartiles, and count of NAs.</li>
<li>For <strong>categorical rasters</strong>: Counts of each unique class.</li>
</ul></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(two_layers)</span>
<span id="cb22-2"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##  Continuous.variable Categorical.variable</span></span>
<span id="cb22-3"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##  Min.   :  1.00      Maize :18           </span></span>
<span id="cb22-4"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##  1st Qu.: 24.75      Others:26           </span></span>
<span id="cb22-5"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##  Median : 50.50      Rice  :31           </span></span>
<span id="cb22-6"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##  Mean   : 50.06      Wheat :25           </span></span>
<span id="cb22-7"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##  3rd Qu.: 75.25                          </span></span>
<span id="cb22-8"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##  Max.   :100.00</span></span></code></pre></div>
</div>
<ul>
<li><strong>Custom Summary Statistics</strong>:
<ul>
<li>The <a href="https://rspatial.github.io/terra/reference/global.html"><code>global()</code></a> function calculates additional statistics like <strong>standard deviation</strong> and can be used to apply custom summary statistics.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">global</span>(two_layers, sum)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      sum
Continuous variable  5006
Categorical variable  263</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">global</span>(two_layers, mean)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      mean
Continuous variable  50.06
Categorical variable  2.63</code></pre>
</div>
</div>
<ul>
<li><strong>Frequency Table</strong>:
<ul>
<li>The <a href="https://rspatial.github.io/terra/reference/freq.html"><code>freq()</code></a> function generates a frequency table for categorical raster values, showing counts of each category.</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">freq</span>(two_layers<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Categorical variable</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb27-2">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb27-3">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_538</span>()</span></code></pre></div>
</details>
<div id="tbl-freq-raster" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-freq-raster-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Frequency table using freq() on raster objects
</figcaption>
<div aria-describedby="tbl-freq-raster-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="rzlnkjibln" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#rzlnkjibln table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rzlnkjibln thead, #rzlnkjibln tbody, #rzlnkjibln tfoot, #rzlnkjibln tr, #rzlnkjibln td, #rzlnkjibln th {
  border-style: none;
}

#rzlnkjibln p {
  margin: 0;
  padding: 0;
}

#rzlnkjibln .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rzlnkjibln .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rzlnkjibln .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rzlnkjibln .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rzlnkjibln .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rzlnkjibln .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rzlnkjibln .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rzlnkjibln .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rzlnkjibln .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rzlnkjibln .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rzlnkjibln .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rzlnkjibln .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rzlnkjibln .gt_spanner_row {
  border-bottom-style: hidden;
}

#rzlnkjibln .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rzlnkjibln .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#rzlnkjibln .gt_from_md > :first-child {
  margin-top: 0;
}

#rzlnkjibln .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rzlnkjibln .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rzlnkjibln .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#rzlnkjibln .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rzlnkjibln .gt_row_group_first td {
  border-top-width: 2px;
}

#rzlnkjibln .gt_row_group_first th {
  border-top-width: 2px;
}

#rzlnkjibln .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rzlnkjibln .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rzlnkjibln .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rzlnkjibln .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rzlnkjibln .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rzlnkjibln .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rzlnkjibln .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rzlnkjibln .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rzlnkjibln .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rzlnkjibln .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rzlnkjibln .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rzlnkjibln .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rzlnkjibln .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rzlnkjibln .gt_left {
  text-align: left;
}

#rzlnkjibln .gt_center {
  text-align: center;
}

#rzlnkjibln .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rzlnkjibln .gt_font_normal {
  font-weight: normal;
}

#rzlnkjibln .gt_font_bold {
  font-weight: bold;
}

#rzlnkjibln .gt_font_italic {
  font-style: italic;
}

#rzlnkjibln .gt_super {
  font-size: 65%;
}

#rzlnkjibln .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rzlnkjibln .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rzlnkjibln .gt_indent_1 {
  text-indent: 5px;
}

#rzlnkjibln .gt_indent_2 {
  text-indent: 10px;
}

#rzlnkjibln .gt_indent_3 {
  text-indent: 15px;
}

#rzlnkjibln .gt_indent_4 {
  text-indent: 20px;
}

#rzlnkjibln .gt_indent_5 {
  text-indent: 25px;
}

#rzlnkjibln .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#rzlnkjibln div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="layer" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">layer</th>
<th id="value" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">value</th>
<th id="count" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">count</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="layer">1</td>
<td class="gt_row gt_left" headers="value">Maize</td>
<td class="gt_row gt_right" headers="count">18</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="layer">1</td>
<td class="gt_row gt_left" headers="value">Others</td>
<td class="gt_row gt_right" headers="count">26</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="layer">1</td>
<td class="gt_row gt_left" headers="value">Rice</td>
<td class="gt_row gt_right" headers="count">31</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="layer">1</td>
<td class="gt_row gt_left" headers="value">Wheat</td>
<td class="gt_row gt_right" headers="count">25</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<ul>
<li><strong>Visualization of Raster Statistics</strong>:
<ul>
<li>Several functions like <a href="https://rspatial.github.io/terra/reference/hist.html"><code>hist()</code></a>, <a href="https://rspatial.github.io/terra/reference/boxplot.html"><code>boxplot()</code></a>, and <a href="https://rspatial.github.io/terra/reference/density.html"><code>density()</code></a> work directly with raster objects to visualize statistics.</li>
<li>If visualization functions do not support raster objects, values can be extracted using <a href="https://rspatial.github.io/terra/reference/values.html"><code>values()</code></a> for further plotting.</li>
</ul></li>
<li><strong>Handling Function Name Clashes</strong>:
<ul>
<li>Some functions (e.g., <code>extract()</code>) exist in multiple packages like <strong>terra</strong> and <strong>tidyr</strong>, leading to conflicts.</li>
<li>To avoid issues, call functions with full namespaces (e.g., <code>tidyr::extract()</code>).
<ul>
<li>Use <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/detach.html"><code>detach()</code></a> to unload conflicting packages, but be cautious as it may impact dependent packages.</li>
</ul></li>
</ul></li>
</ul>
</section>
</section>
<section id="exercises" class="level2">
<h2 class="anchored" data-anchor-id="exercises">3.4 Exercises</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sf)</span>
<span id="cb28-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb28-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(terra)</span>
<span id="cb28-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(spData)</span>
<span id="cb28-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(us_states)</span>
<span id="cb28-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(us_states_df)</span></code></pre></div>
</div>
<section id="e1" class="level3">
<h3 class="anchored" data-anchor-id="e1">E1</h3>
<p><strong>Create a new object called <code>us_states_name</code> that contains only the <code>NAME</code> column from the <code>us_states</code> object using either base R (<code>[</code>) or tidyverse (<a href="https://dplyr.tidyverse.org/reference/select.html"><code>select()</code></a>) syntax. What is the class of the new object and what makes it geographic?</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1">us_states_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb29-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(NAME)</span>
<span id="cb29-3"></span>
<span id="cb29-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>(us_states_name)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sf"         "data.frame"</code></pre>
</div>
</div>
<p>The new object of the class <code>sf</code>, and the stickiness of the <code>geometry</code> column makes it a geographical dataset.</p>
<hr>
</section>
<section id="e2" class="level3">
<h3 class="anchored" data-anchor-id="e2">E2</h3>
<p><strong>Select columns from the <code>us_states</code> object which contain population data. Obtain the same result using a different command (bonus: try to find three ways of obtaining the same result). Hint: try to use helper functions, such as <code>contains</code> or <code>matches</code> from dplyr (see <a href="https://tidyselect.r-lib.org/reference/starts_with.html"><code>?contains</code></a>).</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb31-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">contains</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pop"</span>))</span>
<span id="cb31-3"></span>
<span id="cb31-4">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb31-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">where</span>(is.double)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb31-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>AREA)</span>
<span id="cb31-7"></span>
<span id="cb31-8">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb31-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)</span></code></pre></div>
</div>
<p>The above three methods all select the columns <code>total_pop_10</code> and <code>total_pop_15</code> . Notice that the column <code>geometry</code> is sticky, and can be removed using <code>st_drop_geometry()</code>.</p>
<hr>
</section>
<section id="e3" class="level3">
<h3 class="anchored" data-anchor-id="e3">E3</h3>
<p><strong>Find all states with the following characteristics (bonus: find <em>and</em> plot them):</strong></p>
<ul>
<li><p><strong>Belong to the Midwest region.</strong></p>
<p>The code shown below gives out the names of all such states.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb32-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(REGION <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Midwest"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb32-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(NAME) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb32-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", "</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Indiana, Kansas, Minnesota, Missouri, North Dakota, South Dakota, Illinois, Iowa, Michigan, Nebraska, Ohio, Wisconsin"</code></pre>
</div>
</div>
<ul>
<li><p><strong>Belong to the West region, have an area below 250,000 km<sup>2</sup><em>and</em> in 2015 a population greater than 5,000,000 residents (hint: you may need to use the function <a href="https://r-quantities.github.io/units/reference/units.html"><code>units::set_units()</code></a> or <a href="https://rdrr.io/r/base/numeric.html"><code>as.numeric()</code></a>).</strong></p>
<p>Only Washington State qualifies all three conditions. Code is shown below.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb34-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(REGION <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"West"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb34-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(total_pop_15 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5e6</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb34-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(AREA) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250000</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 1 feature and 6 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -124.7042 ymin: 45.54774 xmax: -116.916 ymax: 49.00236
Geodetic CRS:  NAD83
  GEOID       NAME REGION          AREA total_pop_10 total_pop_15
1    53 Washington   West 175436 [km^2]      6561297      6985464
                        geometry
1 MULTIPOLYGON (((-122.7699 4...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb36-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(REGION <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"West"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb36-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(total_pop_15 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5e6</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb36-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(AREA <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> units<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_units</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250000</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"km2"</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 1 feature and 6 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -124.7042 ymin: 45.54774 xmax: -116.916 ymax: 49.00236
Geodetic CRS:  NAD83
  GEOID       NAME REGION          AREA total_pop_10 total_pop_15
1    53 Washington   West 175436 [km^2]      6561297      6985464
                        geometry
1 MULTIPOLYGON (((-122.7699 4...</code></pre>
</div>
</div>
<ul>
<li><p><strong>Belong to the South region, had an area larger than 150,000 km<sup>2</sup> and a total population in 2015 larger than 7,000,000 residents.</strong></p>
<p>The states that fulfil these conditions are Florida, Georgia and Texas.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb38-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(REGION <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"South"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb38-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(AREA <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> units<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_units</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">150000</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"km2"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb38-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(total_pop_15 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7e6</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb38-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(NAME)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Florida" "Georgia" "Texas"  </code></pre>
</div>
</div>
<hr>
</section>
<section id="e4" class="level3">
<h3 class="anchored" data-anchor-id="e4">E4</h3>
<p><strong>What was the total population in 2015 in the <code>us_states</code> dataset? What was the minimum and maximum total population in 2015?</strong></p>
<p>The total population in the <code>us_states</code> dataset in the year 2015 was 314,375,347. The minimum total population in 2015 was 579,679 (Wyoming), and the maximum total population was 38,421,464 (California).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb40-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb40-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb40-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb40-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">total_pop_15 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(total_pop_15)</span>
<span id="cb40-6">  )</span>
<span id="cb40-7"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## # A tibble: 1 × 1</span></span>
<span id="cb40-8"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##   total_pop_15</span></span>
<span id="cb40-9"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##          &lt;dbl&gt;</span></span>
<span id="cb40-10"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1    314375347</span></span>
<span id="cb40-11"></span>
<span id="cb40-12">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb40-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb40-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_min</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order_by =</span> total_pop_15, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb40-15"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##   GEOID    NAME REGION            AREA total_pop_10 total_pop_15</span></span>
<span id="cb40-16"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1    56 Wyoming   West 253309.6 [km^2]       545579       579679</span></span>
<span id="cb40-17"></span>
<span id="cb40-18">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb40-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb40-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_max</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order_by =</span> total_pop_15, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb40-21"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##   GEOID       NAME REGION            AREA total_pop_10 total_pop_15</span></span>
<span id="cb40-22"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1    06 California   West 409747.1 [km^2]     36637290     38421464</span></span></code></pre></div>
</div>
<hr>
</section>
<section id="e5" class="level3">
<h3 class="anchored" data-anchor-id="e5">E5</h3>
<p><strong>How many states are there in each region?</strong></p>
<p>The number of states in each region are shown in Table&nbsp;3 below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb41-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb41-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(REGION, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of States"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb41-4">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb41-5">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_538</span>()</span></code></pre></div>
</details>
<div id="tbl-st-region" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-st-region-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Table showing number of states in each region.
</figcaption>
<div aria-describedby="tbl-st-region-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="clpnyxitaf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#clpnyxitaf table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#clpnyxitaf thead, #clpnyxitaf tbody, #clpnyxitaf tfoot, #clpnyxitaf tr, #clpnyxitaf td, #clpnyxitaf th {
  border-style: none;
}

#clpnyxitaf p {
  margin: 0;
  padding: 0;
}

#clpnyxitaf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#clpnyxitaf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#clpnyxitaf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#clpnyxitaf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#clpnyxitaf .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#clpnyxitaf .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#clpnyxitaf .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#clpnyxitaf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#clpnyxitaf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#clpnyxitaf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#clpnyxitaf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#clpnyxitaf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#clpnyxitaf .gt_spanner_row {
  border-bottom-style: hidden;
}

#clpnyxitaf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#clpnyxitaf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#clpnyxitaf .gt_from_md > :first-child {
  margin-top: 0;
}

#clpnyxitaf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#clpnyxitaf .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#clpnyxitaf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#clpnyxitaf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#clpnyxitaf .gt_row_group_first td {
  border-top-width: 2px;
}

#clpnyxitaf .gt_row_group_first th {
  border-top-width: 2px;
}

#clpnyxitaf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#clpnyxitaf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#clpnyxitaf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#clpnyxitaf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#clpnyxitaf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#clpnyxitaf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#clpnyxitaf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#clpnyxitaf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#clpnyxitaf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#clpnyxitaf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#clpnyxitaf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#clpnyxitaf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#clpnyxitaf .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#clpnyxitaf .gt_left {
  text-align: left;
}

#clpnyxitaf .gt_center {
  text-align: center;
}

#clpnyxitaf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#clpnyxitaf .gt_font_normal {
  font-weight: normal;
}

#clpnyxitaf .gt_font_bold {
  font-weight: bold;
}

#clpnyxitaf .gt_font_italic {
  font-style: italic;
}

#clpnyxitaf .gt_super {
  font-size: 65%;
}

#clpnyxitaf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#clpnyxitaf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#clpnyxitaf .gt_indent_1 {
  text-indent: 5px;
}

#clpnyxitaf .gt_indent_2 {
  text-indent: 10px;
}

#clpnyxitaf .gt_indent_3 {
  text-indent: 15px;
}

#clpnyxitaf .gt_indent_4 {
  text-indent: 20px;
}

#clpnyxitaf .gt_indent_5 {
  text-indent: 25px;
}

#clpnyxitaf .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#clpnyxitaf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="REGION" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">REGION</th>
<th id="Number of States" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Number of States</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="REGION">Norteast</td>
<td class="gt_row gt_right" headers="Number of States">9</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="REGION">Midwest</td>
<td class="gt_row gt_right" headers="Number of States">12</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="REGION">South</td>
<td class="gt_row gt_right" headers="Number of States">17</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="REGION">West</td>
<td class="gt_row gt_right" headers="Number of States">11</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<hr>
</section>
<section id="e6" class="level3">
<h3 class="anchored" data-anchor-id="e6">E6</h3>
<p><strong>What was the minimum and maximum total population in 2015 in each region? What was the total population in 2015 in each region?</strong></p>
<p>The minimum and maximum total population in 2015 in each region is shown in Table&nbsp;4 (a). The total population in each region in 2015 is shown in Table&nbsp;4 (b).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(REGION) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_min</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order_by =</span> total_pop_15, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(REGION, NAME, total_pop_15) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-7">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-8">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>(</span>
<span id="cb42-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> total_pop_15,</span>
<span id="cb42-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decimals =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb42-11">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-12">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label_with</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> snakecase<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>to_title_case) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-13">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_538</span>()</span>
<span id="cb42-14">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(REGION) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb42-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">total_population_2015 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(total_pop_15)</span>
<span id="cb42-19">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(REGION, total_population_2015) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-22">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-23">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>(</span>
<span id="cb42-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> total_population_2015,</span>
<span id="cb42-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decimals =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb42-26">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-27">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label_with</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> snakecase<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>to_title_case) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb42-28">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_538</span>()</span></code></pre></div>
</details>
<div id="tbl-e6" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-e6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Region-wise total and minimum-maximum populations
</figcaption>
<div aria-describedby="tbl-e6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="umqaednlmw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#umqaednlmw table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#umqaednlmw thead, #umqaednlmw tbody, #umqaednlmw tfoot, #umqaednlmw tr, #umqaednlmw td, #umqaednlmw th {
  border-style: none;
}

#umqaednlmw p {
  margin: 0;
  padding: 0;
}

#umqaednlmw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#umqaednlmw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#umqaednlmw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#umqaednlmw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#umqaednlmw .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#umqaednlmw .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#umqaednlmw .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#umqaednlmw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#umqaednlmw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#umqaednlmw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#umqaednlmw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#umqaednlmw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#umqaednlmw .gt_spanner_row {
  border-bottom-style: hidden;
}

#umqaednlmw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#umqaednlmw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#umqaednlmw .gt_from_md > :first-child {
  margin-top: 0;
}

#umqaednlmw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#umqaednlmw .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#umqaednlmw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#umqaednlmw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#umqaednlmw .gt_row_group_first td {
  border-top-width: 2px;
}

#umqaednlmw .gt_row_group_first th {
  border-top-width: 2px;
}

#umqaednlmw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#umqaednlmw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#umqaednlmw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#umqaednlmw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#umqaednlmw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#umqaednlmw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#umqaednlmw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#umqaednlmw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#umqaednlmw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#umqaednlmw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#umqaednlmw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#umqaednlmw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#umqaednlmw .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#umqaednlmw .gt_left {
  text-align: left;
}

#umqaednlmw .gt_center {
  text-align: center;
}

#umqaednlmw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#umqaednlmw .gt_font_normal {
  font-weight: normal;
}

#umqaednlmw .gt_font_bold {
  font-weight: bold;
}

#umqaednlmw .gt_font_italic {
  font-style: italic;
}

#umqaednlmw .gt_super {
  font-size: 65%;
}

#umqaednlmw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#umqaednlmw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#umqaednlmw .gt_indent_1 {
  text-indent: 5px;
}

#umqaednlmw .gt_indent_2 {
  text-indent: 10px;
}

#umqaednlmw .gt_indent_3 {
  text-indent: 15px;
}

#umqaednlmw .gt_indent_4 {
  text-indent: 20px;
}

#umqaednlmw .gt_indent_5 {
  text-indent: 25px;
}

#umqaednlmw .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#umqaednlmw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>

<div id="tbl-e6-1" class="gt_table do-not-create-environment quarto-float quarto-figure quarto-figure-center anchored" data-quarto-disable-processing="false" data-quarto-postprocess="true" data-quarto-bootstrap="false">
<figure class="quarto-float quarto-subfloat-tbl figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-e6-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Minimum and maximum populations, region-wise, in 2015
</figcaption>
<div aria-describedby="tbl-e6-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-e6-1" class="gt_table do-not-create-environment caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="Region" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Region</th>
<th id="Name" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Name</th>
<th id="Total Pop 15" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Total Pop 15</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="REGION">Norteast</td>
<td class="gt_row gt_left" headers="NAME">Vermont</td>
<td class="gt_row gt_right" headers="total_pop_15">626,604</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="REGION">Midwest</td>
<td class="gt_row gt_left" headers="NAME">North Dakota</td>
<td class="gt_row gt_right" headers="total_pop_15">721,640</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="REGION">South</td>
<td class="gt_row gt_left" headers="NAME">District of Columbia</td>
<td class="gt_row gt_right" headers="total_pop_15">647,484</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="REGION">West</td>
<td class="gt_row gt_left" headers="NAME">Wyoming</td>
<td class="gt_row gt_right" headers="total_pop_15">579,679</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>

</div>
</div>
<div class="cell-output-display">
<div id="ghhngiuwgq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#ghhngiuwgq table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ghhngiuwgq thead, #ghhngiuwgq tbody, #ghhngiuwgq tfoot, #ghhngiuwgq tr, #ghhngiuwgq td, #ghhngiuwgq th {
  border-style: none;
}

#ghhngiuwgq p {
  margin: 0;
  padding: 0;
}

#ghhngiuwgq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ghhngiuwgq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ghhngiuwgq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ghhngiuwgq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ghhngiuwgq .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ghhngiuwgq .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ghhngiuwgq .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ghhngiuwgq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ghhngiuwgq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ghhngiuwgq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ghhngiuwgq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ghhngiuwgq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ghhngiuwgq .gt_spanner_row {
  border-bottom-style: hidden;
}

#ghhngiuwgq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ghhngiuwgq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#ghhngiuwgq .gt_from_md > :first-child {
  margin-top: 0;
}

#ghhngiuwgq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ghhngiuwgq .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ghhngiuwgq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#ghhngiuwgq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ghhngiuwgq .gt_row_group_first td {
  border-top-width: 2px;
}

#ghhngiuwgq .gt_row_group_first th {
  border-top-width: 2px;
}

#ghhngiuwgq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ghhngiuwgq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ghhngiuwgq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ghhngiuwgq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ghhngiuwgq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ghhngiuwgq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ghhngiuwgq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ghhngiuwgq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ghhngiuwgq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ghhngiuwgq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ghhngiuwgq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ghhngiuwgq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ghhngiuwgq .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ghhngiuwgq .gt_left {
  text-align: left;
}

#ghhngiuwgq .gt_center {
  text-align: center;
}

#ghhngiuwgq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ghhngiuwgq .gt_font_normal {
  font-weight: normal;
}

#ghhngiuwgq .gt_font_bold {
  font-weight: bold;
}

#ghhngiuwgq .gt_font_italic {
  font-style: italic;
}

#ghhngiuwgq .gt_super {
  font-size: 65%;
}

#ghhngiuwgq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ghhngiuwgq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ghhngiuwgq .gt_indent_1 {
  text-indent: 5px;
}

#ghhngiuwgq .gt_indent_2 {
  text-indent: 10px;
}

#ghhngiuwgq .gt_indent_3 {
  text-indent: 15px;
}

#ghhngiuwgq .gt_indent_4 {
  text-indent: 20px;
}

#ghhngiuwgq .gt_indent_5 {
  text-indent: 25px;
}

#ghhngiuwgq .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ghhngiuwgq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>

<div id="tbl-e6-2" class="gt_table do-not-create-environment quarto-float quarto-figure quarto-figure-center anchored" data-quarto-disable-processing="false" data-quarto-postprocess="true" data-quarto-bootstrap="false">
<figure class="quarto-float quarto-subfloat-tbl figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-e6-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Total population, region-wise, in 2015
</figcaption>
<div aria-describedby="tbl-e6-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-e6-2" class="gt_table do-not-create-environment caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="Region" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Region</th>
<th id="Total Population 2015" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Total Population 2015</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="REGION">Norteast</td>
<td class="gt_row gt_right" headers="total_population_2015">55,989,520</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="REGION">Midwest</td>
<td class="gt_row gt_right" headers="total_population_2015">67,546,398</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="REGION">South</td>
<td class="gt_row gt_right" headers="total_population_2015">118,575,377</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="REGION">West</td>
<td class="gt_row gt_right" headers="total_population_2015">72,264,052</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>

</div>
</div>
</div>
</figure>
</div>
</div>
<hr>
</section>
<section id="e7" class="level3">
<h3 class="anchored" data-anchor-id="e7">E7</h3>
<p><strong>Add variables from <code>us_states_df</code> to <code>us_states</code>, and create a new object called <code>us_states_stats</code>. What function did you use and why? Which variable is the key in both datasets? What is the class of the new object?</strong></p>
<p>The function we use to accomplish this task is <code>left_join()</code> and the key in both datasets are the state names, called <code>NAME</code> in <code>us_states</code> dataset, and <code>state</code> in <code>us_states_df</code> dataset.</p>
<p>The class of the new object depends on which object is used first on the <code>left_join()</code> function, if <code>us_states</code> (an sf object) is used first, the class of new object is <code>sf</code> . However, if the <code>us_states_df</code> (a data frame) is used first, the resulting object is a <code>data.frame</code> or <code>tibble</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb43-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(us_states_df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">join_by</span>(NAME <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> state)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb43-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>()</span>
<span id="cb43-4"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] "sf"         "data.frame"</span></span>
<span id="cb43-5"></span>
<span id="cb43-6">us_states_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb43-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(us_states, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">join_by</span>(state <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> NAME)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb43-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>()</span>
<span id="cb43-9"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] "tbl_df"     "tbl"        "data.frame"</span></span></code></pre></div>
</div>
<hr>
</section>
<section id="e8" class="level3">
<h3 class="anchored" data-anchor-id="e8">E8</h3>
<p><strong><code>us_states_df</code> has two more rows than <code>us_states</code>. How can you find them? (Hint: try to use the <a href="https://dplyr.tidyverse.org/reference/filter-joins.html"><code>dplyr::anti_join()</code></a> function.)</strong></p>
<p>The two rows that more more in <code>us_states_df</code> are shown below: —</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1">us_states_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb44-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anti_join</span>(us_states, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">join_by</span>(state <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> NAME)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb44-3">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb44-4">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_538</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb44-5">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label_with</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> snakecase<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>to_title_case)</span></code></pre></div>
<div id="tbl-e8" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-e8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: The two extra rows in <code>us_states_df</code>
</figcaption>
<div aria-describedby="tbl-e8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="rziicvdicq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#rziicvdicq table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rziicvdicq thead, #rziicvdicq tbody, #rziicvdicq tfoot, #rziicvdicq tr, #rziicvdicq td, #rziicvdicq th {
  border-style: none;
}

#rziicvdicq p {
  margin: 0;
  padding: 0;
}

#rziicvdicq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rziicvdicq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rziicvdicq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rziicvdicq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rziicvdicq .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rziicvdicq .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rziicvdicq .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rziicvdicq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rziicvdicq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rziicvdicq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rziicvdicq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rziicvdicq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rziicvdicq .gt_spanner_row {
  border-bottom-style: hidden;
}

#rziicvdicq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rziicvdicq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#rziicvdicq .gt_from_md > :first-child {
  margin-top: 0;
}

#rziicvdicq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rziicvdicq .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rziicvdicq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#rziicvdicq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rziicvdicq .gt_row_group_first td {
  border-top-width: 2px;
}

#rziicvdicq .gt_row_group_first th {
  border-top-width: 2px;
}

#rziicvdicq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rziicvdicq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rziicvdicq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rziicvdicq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rziicvdicq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rziicvdicq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rziicvdicq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rziicvdicq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rziicvdicq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rziicvdicq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rziicvdicq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rziicvdicq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rziicvdicq .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rziicvdicq .gt_left {
  text-align: left;
}

#rziicvdicq .gt_center {
  text-align: center;
}

#rziicvdicq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rziicvdicq .gt_font_normal {
  font-weight: normal;
}

#rziicvdicq .gt_font_bold {
  font-weight: bold;
}

#rziicvdicq .gt_font_italic {
  font-style: italic;
}

#rziicvdicq .gt_super {
  font-size: 65%;
}

#rziicvdicq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rziicvdicq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rziicvdicq .gt_indent_1 {
  text-indent: 5px;
}

#rziicvdicq .gt_indent_2 {
  text-indent: 10px;
}

#rziicvdicq .gt_indent_3 {
  text-indent: 15px;
}

#rziicvdicq .gt_indent_4 {
  text-indent: 20px;
}

#rziicvdicq .gt_indent_5 {
  text-indent: 25px;
}

#rziicvdicq .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#rziicvdicq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="State" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">State</th>
<th id="Median Income 10" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Median Income 10</th>
<th id="Median Income 15" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Median Income 15</th>
<th id="Poverty Level 10" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Poverty Level 10</th>
<th id="Poverty Level 15" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">Poverty Level 15</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="state">Alaska</td>
<td class="gt_row gt_right" headers="median_income_10">29509</td>
<td class="gt_row gt_right" headers="median_income_15">31455</td>
<td class="gt_row gt_right" headers="poverty_level_10">64245</td>
<td class="gt_row gt_right" headers="poverty_level_15">72957</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="state">Hawaii</td>
<td class="gt_row gt_right" headers="median_income_10">29945</td>
<td class="gt_row gt_right" headers="median_income_15">31051</td>
<td class="gt_row gt_right" headers="poverty_level_10">124627</td>
<td class="gt_row gt_right" headers="poverty_level_15">153944</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<hr>
</section>
<section id="e9" class="level3">
<h3 class="anchored" data-anchor-id="e9">E9</h3>
<p><strong>What was the population density in 2015 in each state? What was the population density in 2010 in each state?</strong></p>
<p>The Table&nbsp;6 shows the population density.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb45-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb45-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb45-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb45-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">population_density_2010 =</span> total_pop_10 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(AREA),</span>
<span id="cb45-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">population_density_2015 =</span> total_pop_15 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(AREA),</span>
<span id="cb45-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.keep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"unused"</span></span>
<span id="cb45-8">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb45-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>GEOID) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb45-10">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb45-11">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb45-12">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_espn</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb45-13">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>(</span>
<span id="cb45-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decimals =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb45-15">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb45-16">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label_with</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> snakecase<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>to_title_case)</span></code></pre></div>
</details>
<div id="tbl-e9" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-e9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6: A table showing population density in 2010 and 2015 in each state
</figcaption>
<div aria-describedby="tbl-e9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="jxauekonpt" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#jxauekonpt table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jxauekonpt thead, #jxauekonpt tbody, #jxauekonpt tfoot, #jxauekonpt tr, #jxauekonpt td, #jxauekonpt th {
  border-style: none;
}

#jxauekonpt p {
  margin: 0;
  padding: 0;
}

#jxauekonpt .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jxauekonpt .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jxauekonpt .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jxauekonpt .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jxauekonpt .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jxauekonpt .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jxauekonpt .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jxauekonpt .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jxauekonpt .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jxauekonpt .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jxauekonpt .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jxauekonpt .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jxauekonpt .gt_spanner_row {
  border-bottom-style: hidden;
}

#jxauekonpt .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jxauekonpt .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jxauekonpt .gt_from_md > :first-child {
  margin-top: 0;
}

#jxauekonpt .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jxauekonpt .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jxauekonpt .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jxauekonpt .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jxauekonpt .gt_row_group_first td {
  border-top-width: 2px;
}

#jxauekonpt .gt_row_group_first th {
  border-top-width: 2px;
}

#jxauekonpt .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jxauekonpt .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jxauekonpt .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jxauekonpt .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jxauekonpt .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jxauekonpt .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jxauekonpt .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jxauekonpt .gt_striped {
  background-color: #FAFAFA;
}

#jxauekonpt .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jxauekonpt .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jxauekonpt .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jxauekonpt .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jxauekonpt .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jxauekonpt .gt_left {
  text-align: left;
}

#jxauekonpt .gt_center {
  text-align: center;
}

#jxauekonpt .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jxauekonpt .gt_font_normal {
  font-weight: normal;
}

#jxauekonpt .gt_font_bold {
  font-weight: bold;
}

#jxauekonpt .gt_font_italic {
  font-style: italic;
}

#jxauekonpt .gt_super {
  font-size: 65%;
}

#jxauekonpt .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jxauekonpt .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jxauekonpt .gt_indent_1 {
  text-indent: 5px;
}

#jxauekonpt .gt_indent_2 {
  text-indent: 10px;
}

#jxauekonpt .gt_indent_3 {
  text-indent: 15px;
}

#jxauekonpt .gt_indent_4 {
  text-indent: 20px;
}

#jxauekonpt .gt_indent_5 {
  text-indent: 25px;
}

#jxauekonpt .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#jxauekonpt div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="jxauekonpt" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="jxauekonpt">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"NAME":["Alabama","Arizona","Colorado","Connecticut","Florida","Georgia","Idaho","Indiana","Kansas","Louisiana","Massachusetts","Minnesota","Missouri","Montana","Nevada","New Jersey","New York","North Dakota","Oklahoma","Pennsylvania","South Carolina","South Dakota","Texas","Vermont","West Virginia","Arkansas","California","Delaware","District of Columbia","Illinois","Iowa","Kentucky","Maine","Maryland","Michigan","Mississippi","Nebraska","New Hampshire","New Mexico","North Carolina","Ohio","Oregon","Rhode Island","Tennessee","Utah","Virginia","Washington","Wisconsin","Wyoming"],"REGION":["South","West","West","Norteast","South","South","West","Midwest","Midwest","South","Norteast","Midwest","Midwest","West","West","Norteast","Norteast","Midwest","South","Norteast","South","Midwest","South","Norteast","South","South","West","South","South","Midwest","Midwest","South","Norteast","South","Midwest","South","Midwest","Norteast","West","South","Midwest","West","Norteast","South","West","South","West","Midwest","West"],"population_density_2010":[35.2455062155994,21.1554776934259,18.1288925599977,273.248787851967,122.551302651402,61.9990293874535,7.05176782570392,68.5265134388798,13.1870421652331,36.2083647394599,309.749575062158,23.9831548616216,32.771334634104,2.55689180372898,9.19575649028921,430.19229100202,151.174915659046,3.60228091420056,20.3089496545739,107.57796435811,55.7630195534436,4.00197562829728,35.3517320608069,25.1047229234309,29.3059258992919,20.8634375390697,89.4144027631312,170.070352571492,3279.27688882004,87.3011013739212,20.6956966291401,41.0292695677935,15.5246585554078,212.167384177209,65.8599260353045,23.7746744195534,8.98339244237298,54.6871218916389,6.39317524771536,71.740160082088,107.541193575778,14.9671027216726,385.113820057529,57.141830766349,12.0860477325452,74.3966527211482,37.3999362639842,38.8946381994903,2.15380344081465],"population_density_2015":[36.1277860879574,22.4935646648374,19.5824688311292,276.900363999535,130.059657133867,65.5208971110139,7.46629324221766,70.1415651433386,13.579734360935,37.8047665738771,320.676490520251,24.7941529209767,33.4527009917196,2.66444658820484,9.77301188531067,439.210687298658,154.660882792235,3.93955972182453,21.2726046986554,109.001117731237,59.0527132220802,4.22087082315856,38.5895926973833,25.1990680178924,29.4749665246273,21.4845725584771,93.768732808708,178.788484929011,3633.26371848178,88.1806086532857,21.225798515303,42.0969254066532,15.5414383040846,220.887166248633,65.515058774307,24.147134683367,9.33411486863702,55.1142339910987,6.61863772674621,76.1829581398894,108.134796498303,15.6725359903779,384.119309038276,59.5672504456195,13.2055930220986,78.332683575258,39.8177232907391,39.6132782401365,2.28842133727287]},"columns":[{"id":"NAME","name":"Name","type":"character","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left","headerStyle":{"font-weight":"normal"}},{"id":"REGION","name":"Region","type":"factor","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"center","headerStyle":{"font-weight":"normal"}},{"id":"population_density_2010","name":"Population Density 2010","type":"numeric","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["35.2","21.2","18.1","273.2","122.6","62.0","7.1","68.5","13.2","36.2","309.7","24.0","32.8","2.6","9.2","430.2","151.2","3.6","20.3","107.6","55.8","4.0","35.4","25.1","29.3","20.9","89.4","170.1","3,279.3","87.3","20.7","41.0","15.5","212.2","65.9","23.8","9.0","54.7","6.4","71.7","107.5","15.0","385.1","57.1","12.1","74.4","37.4","38.9","2.2"],"html":true,"align":"right","headerStyle":{"font-weight":"normal"}},{"id":"population_density_2015","name":"Population Density 2015","type":"numeric","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["36.1","22.5","19.6","276.9","130.1","65.5","7.5","70.1","13.6","37.8","320.7","24.8","33.5","2.7","9.8","439.2","154.7","3.9","21.3","109.0","59.1","4.2","38.6","25.2","29.5","21.5","93.8","178.8","3,633.3","88.2","21.2","42.1","15.5","220.9","65.5","24.1","9.3","55.1","6.6","76.2","108.1","15.7","384.1","59.6","13.2","78.3","39.8","39.6","2.3"],"html":true,"align":"right","headerStyle":{"font-weight":"normal"}}],"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"striped":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"#fafafa","style":{"fontFamily":"Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"}},"elementId":"jxauekonpt","dataKey":"9efb56d490c8761af53ee104b65af28d"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>
<hr>
</section>
<section id="e10" class="level3">
<h3 class="anchored" data-anchor-id="e10">E10</h3>
<p><strong>How much has population density changed between 2010 and 2015 in each state? Calculate the change in percentages and map them.</strong></p>
<p>The Table&nbsp;7 shows how much the population density has changed between 2010 and 2015 in each state. The Figure&nbsp;1 shows the percentage change in a map of the US.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb46-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb46-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb46-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb46-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">population_density_2010 =</span> total_pop_10 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(AREA),</span>
<span id="cb46-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">population_density_2015 =</span> total_pop_15 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(AREA),</span>
<span id="cb46-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">change_in_density =</span> (population_density_2015 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> population_density_2010)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>population_density_2010,</span>
<span id="cb46-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.keep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"unused"</span></span>
<span id="cb46-9">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb46-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>GEOID) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb46-11">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb46-12">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb46-13">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_espn</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb46-14">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>(</span>
<span id="cb46-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decimals =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb46-16">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb46-17">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_percent</span>(</span>
<span id="cb46-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> change_in_density</span>
<span id="cb46-19">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb46-20">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label_with</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> snakecase<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>to_title_case)</span></code></pre></div>
</details>
<div id="tbl-e10" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-e10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7: Table showing change in population density between 2010 and 2015
</figcaption>
<div aria-describedby="tbl-e10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="alpbljfmss" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#alpbljfmss table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#alpbljfmss thead, #alpbljfmss tbody, #alpbljfmss tfoot, #alpbljfmss tr, #alpbljfmss td, #alpbljfmss th {
  border-style: none;
}

#alpbljfmss p {
  margin: 0;
  padding: 0;
}

#alpbljfmss .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#alpbljfmss .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#alpbljfmss .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#alpbljfmss .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#alpbljfmss .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#alpbljfmss .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#alpbljfmss .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#alpbljfmss .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#alpbljfmss .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#alpbljfmss .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#alpbljfmss .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#alpbljfmss .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#alpbljfmss .gt_spanner_row {
  border-bottom-style: hidden;
}

#alpbljfmss .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#alpbljfmss .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#alpbljfmss .gt_from_md > :first-child {
  margin-top: 0;
}

#alpbljfmss .gt_from_md > :last-child {
  margin-bottom: 0;
}

#alpbljfmss .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#alpbljfmss .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#alpbljfmss .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#alpbljfmss .gt_row_group_first td {
  border-top-width: 2px;
}

#alpbljfmss .gt_row_group_first th {
  border-top-width: 2px;
}

#alpbljfmss .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#alpbljfmss .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#alpbljfmss .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#alpbljfmss .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#alpbljfmss .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#alpbljfmss .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#alpbljfmss .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#alpbljfmss .gt_striped {
  background-color: #FAFAFA;
}

#alpbljfmss .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#alpbljfmss .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#alpbljfmss .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#alpbljfmss .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#alpbljfmss .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#alpbljfmss .gt_left {
  text-align: left;
}

#alpbljfmss .gt_center {
  text-align: center;
}

#alpbljfmss .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#alpbljfmss .gt_font_normal {
  font-weight: normal;
}

#alpbljfmss .gt_font_bold {
  font-weight: bold;
}

#alpbljfmss .gt_font_italic {
  font-style: italic;
}

#alpbljfmss .gt_super {
  font-size: 65%;
}

#alpbljfmss .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#alpbljfmss .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#alpbljfmss .gt_indent_1 {
  text-indent: 5px;
}

#alpbljfmss .gt_indent_2 {
  text-indent: 10px;
}

#alpbljfmss .gt_indent_3 {
  text-indent: 15px;
}

#alpbljfmss .gt_indent_4 {
  text-indent: 20px;
}

#alpbljfmss .gt_indent_5 {
  text-indent: 25px;
}

#alpbljfmss .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#alpbljfmss div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="alpbljfmss" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="alpbljfmss">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"NAME":["Alabama","Arizona","Colorado","Connecticut","Florida","Georgia","Idaho","Indiana","Kansas","Louisiana","Massachusetts","Minnesota","Missouri","Montana","Nevada","New Jersey","New York","North Dakota","Oklahoma","Pennsylvania","South Carolina","South Dakota","Texas","Vermont","West Virginia","Arkansas","California","Delaware","District of Columbia","Illinois","Iowa","Kentucky","Maine","Maryland","Michigan","Mississippi","Nebraska","New Hampshire","New Mexico","North Carolina","Ohio","Oregon","Rhode Island","Tennessee","Utah","Virginia","Washington","Wisconsin","Wyoming"],"REGION":["South","West","West","Norteast","South","South","West","Midwest","Midwest","South","Norteast","Midwest","Midwest","West","West","Norteast","Norteast","Midwest","South","Norteast","South","Midwest","South","Norteast","South","South","West","South","South","Midwest","Midwest","South","Norteast","South","Midwest","South","Midwest","Norteast","West","South","Midwest","West","Norteast","South","West","South","West","Midwest","West"],"population_density_2010":[35.2455062155994,21.1554776934259,18.1288925599977,273.248787851967,122.551302651402,61.9990293874535,7.05176782570392,68.5265134388798,13.1870421652331,36.2083647394599,309.749575062158,23.9831548616216,32.771334634104,2.55689180372898,9.19575649028921,430.19229100202,151.174915659046,3.60228091420056,20.3089496545739,107.57796435811,55.7630195534436,4.00197562829728,35.3517320608069,25.1047229234309,29.3059258992919,20.8634375390697,89.4144027631312,170.070352571492,3279.27688882004,87.3011013739212,20.6956966291401,41.0292695677935,15.5246585554078,212.167384177209,65.8599260353045,23.7746744195534,8.98339244237298,54.6871218916389,6.39317524771536,71.740160082088,107.541193575778,14.9671027216726,385.113820057529,57.141830766349,12.0860477325452,74.3966527211482,37.3999362639842,38.8946381994903,2.15380344081465],"population_density_2015":[36.1277860879574,22.4935646648374,19.5824688311292,276.900363999535,130.059657133867,65.5208971110139,7.46629324221766,70.1415651433386,13.579734360935,37.8047665738771,320.676490520251,24.7941529209767,33.4527009917196,2.66444658820484,9.77301188531067,439.210687298658,154.660882792235,3.93955972182453,21.2726046986554,109.001117731237,59.0527132220802,4.22087082315856,38.5895926973833,25.1990680178924,29.4749665246273,21.4845725584771,93.768732808708,178.788484929011,3633.26371848178,88.1806086532857,21.225798515303,42.0969254066532,15.5414383040846,220.887166248633,65.515058774307,24.147134683367,9.33411486863702,55.1142339910987,6.61863772674621,76.1829581398894,108.134796498303,15.6725359903779,384.119309038276,59.5672504456195,13.2055930220986,78.332683575258,39.8177232907391,39.6132782401365,2.28842133727287],"change_in_density":[0.0250324074496498,0.0632501421524182,0.0801800918793524,0.0133635584489642,0.0612670311944605,0.0568052074097973,0.0587831912166451,0.0235682748677891,0.0297786410918764,0.0440893104647016,0.035276611617305,0.0338153201292504,0.020791535200599,0.042064660037238,0.0627741062555374,0.0209636399472251,0.0230591637375251,0.0936292353809456,0.0474497726604267,0.0132290416686983,0.0589941809998963,0.0546967835869622,0.0915898726265267,0.00375806157069671,0.00576813801810305,0.0297714611144142,0.0486983071073215,0.0512619173518457,0.107946611909651,0.0100744121840742,0.0256141117480648,0.0260218095546532,0.00108084494205992,0.0410985981904784,-0.00523637486037683,0.0156662613855718,0.0390412005836171,0.00781010381760501,0.0352661189932851,0.0619290234746868,0.00551977249635632,0.0471322527695263,-0.00258238205812448,0.0424456067777733,0.0926312152928832,0.0529060207703532,0.064646822114591,0.018476583763558,0.0625024057010992]},"columns":[{"id":"NAME","name":"Name","type":"character","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left","headerStyle":{"font-weight":"normal"}},{"id":"REGION","name":"Region","type":"factor","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"center","headerStyle":{"font-weight":"normal"}},{"id":"population_density_2010","name":"Population Density 2010","type":"numeric","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["35.2","21.2","18.1","273.2","122.6","62.0","7.1","68.5","13.2","36.2","309.7","24.0","32.8","2.6","9.2","430.2","151.2","3.6","20.3","107.6","55.8","4.0","35.4","25.1","29.3","20.9","89.4","170.1","3,279.3","87.3","20.7","41.0","15.5","212.2","65.9","23.8","9.0","54.7","6.4","71.7","107.5","15.0","385.1","57.1","12.1","74.4","37.4","38.9","2.2"],"html":true,"align":"right","headerStyle":{"font-weight":"normal"}},{"id":"population_density_2015","name":"Population Density 2015","type":"numeric","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["36.1","22.5","19.6","276.9","130.1","65.5","7.5","70.1","13.6","37.8","320.7","24.8","33.5","2.7","9.8","439.2","154.7","3.9","21.3","109.0","59.1","4.2","38.6","25.2","29.5","21.5","93.8","178.8","3,633.3","88.2","21.2","42.1","15.5","220.9","65.5","24.1","9.3","55.1","6.6","76.2","108.1","15.7","384.1","59.6","13.2","78.3","39.8","39.6","2.3"],"html":true,"align":"right","headerStyle":{"font-weight":"normal"}},{"id":"change_in_density","name":"Change in Density","type":"numeric","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["2.50%","6.33%","8.02%","1.34%","6.13%","5.68%","5.88%","2.36%","2.98%","4.41%","3.53%","3.38%","2.08%","4.21%","6.28%","2.10%","2.31%","9.36%","4.74%","1.32%","5.90%","5.47%","9.16%","0.38%","0.58%","2.98%","4.87%","5.13%","10.79%","1.01%","2.56%","2.60%","0.11%","4.11%","−0.52%","1.57%","3.90%","0.78%","3.53%","6.19%","0.55%","4.71%","−0.26%","4.24%","9.26%","5.29%","6.46%","1.85%","6.25%"],"html":true,"align":"right","headerStyle":{"font-weight":"normal"}}],"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"striped":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"#fafafa","style":{"fontFamily":"Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"}},"elementId":"alpbljfmss","dataKey":"abee78ac07c3f015164b21eb3963c378"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style","tag.attribs.columns.4.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb47-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb47-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">population_density_2010 =</span> total_pop_10 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(AREA),</span>
<span id="cb47-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">population_density_2015 =</span> total_pop_15 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(AREA),</span>
<span id="cb47-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">change_in_density =</span> (population_density_2015 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> population_density_2010)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>population_density_2010,</span>
<span id="cb47-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.keep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"unused"</span></span>
<span id="cb47-7">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb47-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb47-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb47-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb47-11">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> change_in_density</span>
<span id="cb47-12">    )</span>
<span id="cb47-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb47-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf_text</span>(</span>
<span id="cb47-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb47-16">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb47-17">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(</span>
<span id="cb47-18">          change_in_density <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,</span>
<span id="cb47-19">          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb47-20">        ),</span>
<span id="cb47-21">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%"</span></span>
<span id="cb47-22">      )</span>
<span id="cb47-23">    ),</span>
<span id="cb47-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb47-25">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb47-26">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb47-27">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggthemes::Red-Green Diverging"</span>,</span>
<span id="cb47-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_percent</span>(),</span>
<span id="cb47-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Change in population density between 2010 and 2015"</span>,</span>
<span id="cb47-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span>
<span id="cb47-31">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb47-32">  ggthemes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_map</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb47-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb47-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb47-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span></span>
<span id="cb47-36">  )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-e10" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-e10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter3_files/figure-html/fig-e10-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;1: Map of the change in population density"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter3_files/figure-html/fig-e10-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-e10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Map of the change in population density
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="e11" class="level3">
<h3 class="anchored" data-anchor-id="e11">E11</h3>
<p><strong>Change the columns’ names in <code>us_states</code> to lowercase. (Hint: helper functions - <a href="https://rdrr.io/r/base/chartr.html"><code>tolower()</code></a> and <a href="https://rdrr.io/r/base/colnames.html"><code>colnames()</code></a> may help.)</strong></p>
<p>A very easy method is using the <code>janitor</code> package and the function <code>clean_names()</code></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb48-2">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb48-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb48-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 49 × 7
  geoid name   region   area total_pop_10 total_pop_15                  geometry
  &lt;chr&gt; &lt;chr&gt;  &lt;fct&gt;  [km^2]        &lt;dbl&gt;        &lt;dbl&gt;        &lt;MULTIPOLYGON [°]&gt;
1 01    Alaba… South  1.34e5      4712651      4830620 (((-88.20006 34.99563, -…
2 04    Arizo… West   2.95e5      6246816      6641928 (((-114.7196 32.71876, -…
3 08    Color… West   2.70e5      4887061      5278906 (((-109.0501 41.00066, -…
4 09    Conne… Norte… 1.30e4      3545837      3593222 (((-73.48731 42.04964, -…
5 12    Flori… South  1.51e5     18511620     19645772 (((-81.81169 24.56874, -…
# ℹ 44 more rows</code></pre>
</div>
</div>
<hr>
</section>
<section id="e12" class="level3">
<h3 class="anchored" data-anchor-id="e12">E12</h3>
<p><strong>Using <code>us_states</code> and <code>us_states_df</code> create a new object called <code>us_states_sel</code>. The new object should have only two variables: <code>median_income_15</code> and <code>geometry</code>. Change the name of the <code>median_income_15</code> column to <code>Income</code>.</strong></p>
<p>The new object <code>us_states_sel</code> is created as shown below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1">us_states_sel <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb50-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(us_states_df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">join_by</span>(NAME <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> state)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb50-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Income =</span> median_income_15, geometry)</span>
<span id="cb50-4"></span>
<span id="cb50-5">us_states_sel</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 49 features and 1 field
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -124.7042 ymin: 24.55868 xmax: -66.9824 ymax: 49.38436
Geodetic CRS:  NAD83
First 10 features:
   Income                       geometry
1   22890 MULTIPOLYGON (((-88.20006 3...
2   26156 MULTIPOLYGON (((-114.7196 3...
3   30752 MULTIPOLYGON (((-109.0501 4...
4   33226 MULTIPOLYGON (((-73.48731 4...
5   24654 MULTIPOLYGON (((-81.81169 2...
6   25588 MULTIPOLYGON (((-85.60516 3...
7   23558 MULTIPOLYGON (((-116.916 45...
8   25834 MULTIPOLYGON (((-87.52404 4...
9   27315 MULTIPOLYGON (((-102.0517 4...
10  24014 MULTIPOLYGON (((-92.01783 2...</code></pre>
</div>
</div>
<hr>
</section>
<section id="e13" class="level3">
<h3 class="anchored" data-anchor-id="e13">E13</h3>
<p><strong>Calculate the change in the number of residents living below the poverty level between 2010 and 2015 for each state. (Hint: See <code>?us_states_df</code> for documentation on the poverty level columns.) Bonus: Calculate the change in the <em>percentage</em> of residents living below the poverty level in each state.</strong></p>
<p>The Table&nbsp;8 shows the change in the number of residents living below the poverty level between 2010 and 2015 for each state.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1">us_states_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb52-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb52-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">change_in_poverty =</span> poverty_level_15 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> poverty_level_10</span>
<span id="cb52-4">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb52-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(state, change_in_poverty) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb52-6">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb52-7">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decimals =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb52-8">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label_with</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> snakecase<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>to_title_case) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb52-9">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>() </span></code></pre></div>
</details>
<div id="tbl-e13-a" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-e13-a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8: The change in the number of residents living below the poverty level between 2010 and 2015 for each state
</figcaption>
<div aria-describedby="tbl-e13-a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="ucvfgzyblo" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ucvfgzyblo table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ucvfgzyblo thead, #ucvfgzyblo tbody, #ucvfgzyblo tfoot, #ucvfgzyblo tr, #ucvfgzyblo td, #ucvfgzyblo th {
  border-style: none;
}

#ucvfgzyblo p {
  margin: 0;
  padding: 0;
}

#ucvfgzyblo .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ucvfgzyblo .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ucvfgzyblo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ucvfgzyblo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ucvfgzyblo .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ucvfgzyblo .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ucvfgzyblo .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ucvfgzyblo .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ucvfgzyblo .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ucvfgzyblo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ucvfgzyblo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ucvfgzyblo .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ucvfgzyblo .gt_spanner_row {
  border-bottom-style: hidden;
}

#ucvfgzyblo .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ucvfgzyblo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ucvfgzyblo .gt_from_md > :first-child {
  margin-top: 0;
}

#ucvfgzyblo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ucvfgzyblo .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ucvfgzyblo .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ucvfgzyblo .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ucvfgzyblo .gt_row_group_first td {
  border-top-width: 2px;
}

#ucvfgzyblo .gt_row_group_first th {
  border-top-width: 2px;
}

#ucvfgzyblo .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ucvfgzyblo .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ucvfgzyblo .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ucvfgzyblo .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ucvfgzyblo .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ucvfgzyblo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ucvfgzyblo .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ucvfgzyblo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ucvfgzyblo .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ucvfgzyblo .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ucvfgzyblo .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ucvfgzyblo .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ucvfgzyblo .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ucvfgzyblo .gt_left {
  text-align: left;
}

#ucvfgzyblo .gt_center {
  text-align: center;
}

#ucvfgzyblo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ucvfgzyblo .gt_font_normal {
  font-weight: normal;
}

#ucvfgzyblo .gt_font_bold {
  font-weight: bold;
}

#ucvfgzyblo .gt_font_italic {
  font-style: italic;
}

#ucvfgzyblo .gt_super {
  font-size: 65%;
}

#ucvfgzyblo .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ucvfgzyblo .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ucvfgzyblo .gt_indent_1 {
  text-indent: 5px;
}

#ucvfgzyblo .gt_indent_2 {
  text-indent: 10px;
}

#ucvfgzyblo .gt_indent_3 {
  text-indent: 15px;
}

#ucvfgzyblo .gt_indent_4 {
  text-indent: 20px;
}

#ucvfgzyblo .gt_indent_5 {
  text-indent: 25px;
}

#ucvfgzyblo .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ucvfgzyblo div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="ucvfgzyblo" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="ucvfgzyblo">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"state":["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","District of Columbia","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"],"change_in_poverty":[100716,8712,247577,50960,1215197,69785,52045,14458,8598,677744,343195,29317,42000,229070,135503,35620,42561,70059,107921,17920,100073,90514,172866,54529,47273,113376,12477,24888,117911,14313,166879,67590,355777,267520,1353,189544,46796,120676,156711,20827,114364,9088,115127,500397,68065,2507,140306,128503,12889,86735,12698]},"columns":[{"id":"state","name":"State","type":"character","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left","headerStyle":{"font-weight":"normal"}},{"id":"change_in_poverty","name":"Change in Poverty","type":"numeric","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["100,716","8,712","247,577","50,960","1,215,197","69,785","52,045","14,458","8,598","677,744","343,195","29,317","42,000","229,070","135,503","35,620","42,561","70,059","107,921","17,920","100,073","90,514","172,866","54,529","47,273","113,376","12,477","24,888","117,911","14,313","166,879","67,590","355,777","267,520","1,353","189,544","46,796","120,676","156,711","20,827","114,364","9,088","115,127","500,397","68,065","2,507","140,306","128,503","12,889","86,735","12,698"],"html":true,"align":"right","headerStyle":{"font-weight":"normal"}}],"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"rgba(128,128,128,0.05)","style":{"fontFamily":"system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"}},"elementId":"ucvfgzyblo","dataKey":"c7487f3a976b6a26dfa0d25133c1c26e"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>The Table&nbsp;9 shows the change in the <em>percentage</em> of residents living below the poverty level in each state.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb53-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb53-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(us_states_df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">join_by</span>(NAME <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> state)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb53-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb53-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb53-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">state =</span> NAME,</span>
<span id="cb53-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">poverty_2010 =</span> poverty_level_10 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> total_pop_10,</span>
<span id="cb53-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">poverty_2015 =</span> poverty_level_15 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> total_pop_15,</span>
<span id="cb53-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">change_in_poverty =</span> poverty_2015 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> poverty_2010,</span>
<span id="cb53-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.keep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span></span>
<span id="cb53-11">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb53-12">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb53-13">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_percent</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb53-14">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label_with</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> snakecase<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>to_title_case) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb53-15">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>()</span></code></pre></div>
</details>
<div id="tbl-e13-b" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-e13-b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9: Table showing the change in the percentage of residents living below the poverty level in each state.
</figcaption>
<div aria-describedby="tbl-e13-b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="pphqdixxxt" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#pphqdixxxt table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pphqdixxxt thead, #pphqdixxxt tbody, #pphqdixxxt tfoot, #pphqdixxxt tr, #pphqdixxxt td, #pphqdixxxt th {
  border-style: none;
}

#pphqdixxxt p {
  margin: 0;
  padding: 0;
}

#pphqdixxxt .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pphqdixxxt .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pphqdixxxt .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pphqdixxxt .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pphqdixxxt .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pphqdixxxt .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pphqdixxxt .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pphqdixxxt .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pphqdixxxt .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pphqdixxxt .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pphqdixxxt .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pphqdixxxt .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pphqdixxxt .gt_spanner_row {
  border-bottom-style: hidden;
}

#pphqdixxxt .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pphqdixxxt .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pphqdixxxt .gt_from_md > :first-child {
  margin-top: 0;
}

#pphqdixxxt .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pphqdixxxt .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pphqdixxxt .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#pphqdixxxt .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pphqdixxxt .gt_row_group_first td {
  border-top-width: 2px;
}

#pphqdixxxt .gt_row_group_first th {
  border-top-width: 2px;
}

#pphqdixxxt .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pphqdixxxt .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pphqdixxxt .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pphqdixxxt .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pphqdixxxt .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pphqdixxxt .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pphqdixxxt .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pphqdixxxt .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pphqdixxxt .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pphqdixxxt .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pphqdixxxt .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pphqdixxxt .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pphqdixxxt .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pphqdixxxt .gt_left {
  text-align: left;
}

#pphqdixxxt .gt_center {
  text-align: center;
}

#pphqdixxxt .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pphqdixxxt .gt_font_normal {
  font-weight: normal;
}

#pphqdixxxt .gt_font_bold {
  font-weight: bold;
}

#pphqdixxxt .gt_font_italic {
  font-style: italic;
}

#pphqdixxxt .gt_super {
  font-size: 65%;
}

#pphqdixxxt .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pphqdixxxt .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pphqdixxxt .gt_indent_1 {
  text-indent: 5px;
}

#pphqdixxxt .gt_indent_2 {
  text-indent: 10px;
}

#pphqdixxxt .gt_indent_3 {
  text-indent: 15px;
}

#pphqdixxxt .gt_indent_4 {
  text-indent: 20px;
}

#pphqdixxxt .gt_indent_5 {
  text-indent: 25px;
}

#pphqdixxxt .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#pphqdixxxt div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="pphqdixxxt" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="pphqdixxxt">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"state":["Alabama","Arizona","Colorado","Connecticut","Florida","Georgia","Idaho","Indiana","Kansas","Louisiana","Massachusetts","Minnesota","Missouri","Montana","Nevada","New Jersey","New York","North Dakota","Oklahoma","Pennsylvania","South Carolina","South Dakota","Texas","Vermont","West Virginia","Arkansas","California","Delaware","District of Columbia","Illinois","Iowa","Kentucky","Maine","Maryland","Michigan","Mississippi","Nebraska","New Hampshire","New Mexico","North Carolina","Ohio","Oregon","Rhode Island","Tennessee","Utah","Virginia","Washington","Wisconsin","Wyoming"],"poverty_2010":[0.16690054069355,0.149374177180823,0.119536875025706,0.0886408484089934,0.135178066533345,0.152685631728997,0.133074010493864,0.131289971418322,0.120595345009431,0.176155658993124,0.101649103240094,0.103422719258652,0.135520676546363,0.141833694655344,0.117123901249026,0.0892003819951369,0.137815921911005,0.118821019067739,0.157059525665524,0.119709293129428,0.158827094214958,0.132362763958762,0.163379064178924,0.106888498024855,0.168673762849019,0.174987572597613,0.134287907211478,0.106501013301138,0.174139288158795,0.123342779124543,0.112146239043162,0.171677911479415,0.122288378468966,0.0836897119473045,0.145086849410616,0.205395597743161,0.114626276662266,0.0757470476178879,0.179706446007743,0.150999689575586,0.137789490334405,0.137235856642543,0.116809243564634,0.160781418605517,0.106703356419979,0.0996608666887536,0.118880306744231,0.113093117051295,0.0958559621979585],"poverty_2015":[0.183674145347802,0.177763143472799,0.123883433423516,0.101956127397639,0.161872437489349,0.178775045861805,0.151667102781422,0.148895700711486,0.131819811150206,0.192050034884578,0.111683751427541,0.110102080189018,0.151514329459124,0.148404600773234,0.152337424373874,0.106109970415793,0.152794002635264,0.11052325259132,0.162100332672422,0.130408960121394,0.173916856581664,0.136276521305993,0.168526170959795,0.110489240413403,0.174668092599194,0.187155196659599,0.159680068411761,0.116913521880201,0.170452088391373,0.139906123781543,0.120859821446466,0.183255926917853,0.13563915431495,0.0972601473930358,0.163310782782124,0.218047971256469,0.123632891382903,0.0859688219537668,0.206015785102276,0.169366033632382,0.153407008324222,0.161693151941,0.136877990169514,0.171947723057443,0.121100621035008,0.111646276991945,0.130057502264703,0.1261465065933,0.112122398775874],"change_in_poverty":[0.016773604654252,0.0283889662919759,0.00434655839781052,0.0133152789886458,0.0266943709560039,0.026089414132808,0.0185930922875584,0.0176057292931637,0.0112244661407746,0.0158943758914541,0.0100346481874471,0.00667936093036536,0.0159936529127602,0.00657090611789024,0.0352135231248471,0.0169095884206558,0.0149780807242582,-0.00829776647641904,0.00504080700689805,0.010699666991966,0.0150897623667059,0.00391375734723046,0.00514710678087085,0.00360074238854793,0.00599432975017505,0.0121676240619868,0.025392161200283,0.0104125085790636,-0.00368719976742196,0.0165633446570004,0.0087135824033043,0.0115780154384372,0.0133507758459838,0.0135704354457314,0.0182239333715079,0.0126523735133076,0.00900661472063637,0.010221774335879,0.0263093390945327,0.0183663440567962,0.0156175179898172,0.0244572952984563,0.0200687466048799,0.0111663044519261,0.0143972646150286,0.0119854103031911,0.0111771955204722,0.0130533895420045,0.0162664365779157]},"columns":[{"id":"state","name":"State","type":"character","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left","headerStyle":{"font-weight":"normal"}},{"id":"poverty_2010","name":"Poverty 2010","type":"numeric","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["16.69%","14.94%","11.95%","8.86%","13.52%","15.27%","13.31%","13.13%","12.06%","17.62%","10.16%","10.34%","13.55%","14.18%","11.71%","8.92%","13.78%","11.88%","15.71%","11.97%","15.88%","13.24%","16.34%","10.69%","16.87%","17.50%","13.43%","10.65%","17.41%","12.33%","11.21%","17.17%","12.23%","8.37%","14.51%","20.54%","11.46%","7.57%","17.97%","15.10%","13.78%","13.72%","11.68%","16.08%","10.67%","9.97%","11.89%","11.31%","9.59%"],"html":true,"align":"right","headerStyle":{"font-weight":"normal"}},{"id":"poverty_2015","name":"Poverty 2015","type":"numeric","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["18.37%","17.78%","12.39%","10.20%","16.19%","17.88%","15.17%","14.89%","13.18%","19.21%","11.17%","11.01%","15.15%","14.84%","15.23%","10.61%","15.28%","11.05%","16.21%","13.04%","17.39%","13.63%","16.85%","11.05%","17.47%","18.72%","15.97%","11.69%","17.05%","13.99%","12.09%","18.33%","13.56%","9.73%","16.33%","21.80%","12.36%","8.60%","20.60%","16.94%","15.34%","16.17%","13.69%","17.19%","12.11%","11.16%","13.01%","12.61%","11.21%"],"html":true,"align":"right","headerStyle":{"font-weight":"normal"}},{"id":"change_in_poverty","name":"Change in Poverty","type":"numeric","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","cell":["1.68%","2.84%","0.43%","1.33%","2.67%","2.61%","1.86%","1.76%","1.12%","1.59%","1.00%","0.67%","1.60%","0.66%","3.52%","1.69%","1.50%","−0.83%","0.50%","1.07%","1.51%","0.39%","0.51%","0.36%","0.60%","1.22%","2.54%","1.04%","−0.37%","1.66%","0.87%","1.16%","1.34%","1.36%","1.82%","1.27%","0.90%","1.02%","2.63%","1.84%","1.56%","2.45%","2.01%","1.12%","1.44%","1.20%","1.12%","1.31%","1.63%"],"html":true,"align":"right","headerStyle":{"font-weight":"normal"}}],"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"rgba(128,128,128,0.05)","style":{"fontFamily":"system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"}},"elementId":"pphqdixxxt","dataKey":"3c82ceb62f643ab88b7629dbb60a572c"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>
<hr>
</section>
<section id="e14" class="level3">
<h3 class="anchored" data-anchor-id="e14">E14</h3>
<p><strong>What was the minimum, average and maximum state’s number of people living below the poverty line in 2015 for each region? Bonus: What is the region with the largest increase in people living below the poverty line?</strong></p>
<p>The the minimum, average and maximum state’s number of people living below the poverty line in 2015 for each region are shown in Table&nbsp;10 below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb54-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb54-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">state =</span> NAME, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">region =</span> REGION) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb54-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(us_states_df) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb54-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb54-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(region) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb54-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb54-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">minimum_poverty_2015 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(poverty_level_15),</span>
<span id="cb54-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">maximum_poverty_2015 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(poverty_level_15),</span>
<span id="cb54-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">average_poverty_2015 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(poverty_level_15)</span>
<span id="cb54-11">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb54-12">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb54-13">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label_with</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> snakecase<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>to_title_case) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb54-14">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decimals =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span></code></pre></div>
</details>
<div id="tbl-e14-a" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-e14-a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;10: A table showing the minimum, average and maximum state’s number of people living below the poverty line in 2015 for each region
</figcaption>
<div aria-describedby="tbl-e14-a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="vgjmqijyhf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vgjmqijyhf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vgjmqijyhf thead, #vgjmqijyhf tbody, #vgjmqijyhf tfoot, #vgjmqijyhf tr, #vgjmqijyhf td, #vgjmqijyhf th {
  border-style: none;
}

#vgjmqijyhf p {
  margin: 0;
  padding: 0;
}

#vgjmqijyhf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vgjmqijyhf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vgjmqijyhf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vgjmqijyhf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vgjmqijyhf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vgjmqijyhf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vgjmqijyhf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vgjmqijyhf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vgjmqijyhf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vgjmqijyhf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vgjmqijyhf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vgjmqijyhf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vgjmqijyhf .gt_spanner_row {
  border-bottom-style: hidden;
}

#vgjmqijyhf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vgjmqijyhf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vgjmqijyhf .gt_from_md > :first-child {
  margin-top: 0;
}

#vgjmqijyhf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vgjmqijyhf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vgjmqijyhf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vgjmqijyhf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vgjmqijyhf .gt_row_group_first td {
  border-top-width: 2px;
}

#vgjmqijyhf .gt_row_group_first th {
  border-top-width: 2px;
}

#vgjmqijyhf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vgjmqijyhf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vgjmqijyhf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vgjmqijyhf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vgjmqijyhf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vgjmqijyhf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vgjmqijyhf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vgjmqijyhf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vgjmqijyhf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vgjmqijyhf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vgjmqijyhf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vgjmqijyhf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vgjmqijyhf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vgjmqijyhf .gt_left {
  text-align: left;
}

#vgjmqijyhf .gt_center {
  text-align: center;
}

#vgjmqijyhf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vgjmqijyhf .gt_font_normal {
  font-weight: normal;
}

#vgjmqijyhf .gt_font_bold {
  font-weight: bold;
}

#vgjmqijyhf .gt_font_italic {
  font-style: italic;
}

#vgjmqijyhf .gt_super {
  font-size: 65%;
}

#vgjmqijyhf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vgjmqijyhf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vgjmqijyhf .gt_indent_1 {
  text-indent: 5px;
}

#vgjmqijyhf .gt_indent_2 {
  text-indent: 10px;
}

#vgjmqijyhf .gt_indent_3 {
  text-indent: 15px;
}

#vgjmqijyhf .gt_indent_4 {
  text-indent: 20px;
}

#vgjmqijyhf .gt_indent_5 {
  text-indent: 25px;
}

#vgjmqijyhf .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#vgjmqijyhf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="Region" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Region</th>
<th id="Minimum Poverty 2015" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Minimum Poverty 2015</th>
<th id="Maximum Poverty 2015" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Maximum Poverty 2015</th>
<th id="Average Poverty 2015" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Average Poverty 2015</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="region">Norteast</td>
<td class="gt_row gt_right" headers="minimum_poverty_2015">69,233</td>
<td class="gt_row gt_right" headers="maximum_poverty_2015">3,005,943</td>
<td class="gt_row gt_right" headers="average_poverty_2015">804,465</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="region">Midwest</td>
<td class="gt_row gt_right" headers="minimum_poverty_2015">79,758</td>
<td class="gt_row gt_right" headers="maximum_poverty_2015">1,801,118</td>
<td class="gt_row gt_right" headers="average_poverty_2015">799,155</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="region">South</td>
<td class="gt_row gt_right" headers="minimum_poverty_2015">108,315</td>
<td class="gt_row gt_right" headers="maximum_poverty_2015">4,472,451</td>
<td class="gt_row gt_right" headers="average_poverty_2015">1,147,575</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="region">West</td>
<td class="gt_row gt_right" headers="minimum_poverty_2015">64,995</td>
<td class="gt_row gt_right" headers="maximum_poverty_2015">6,135,142</td>
<td class="gt_row gt_right" headers="average_poverty_2015">1,016,665</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<p>As evident in Table&nbsp;11, the region with the largest increase in people living below the poverty line is <strong>the South Region</strong>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1">us_states <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb55-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb55-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">state =</span> NAME, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">region =</span> REGION) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb55-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb55-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(us_states_df) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb55-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(region) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb55-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb55-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">change_total_poverty =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(poverty_level_15) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(poverty_level_10)</span>
<span id="cb55-9">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb55-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(change_total_poverty)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb55-11">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb55-12">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label_with</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> snakecase<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>to_title_case) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb55-13">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fmt_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decimals =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span></code></pre></div>
</details>
<div id="tbl-e14-b" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-e14-b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11: Table showing the region with the largest increase in people living below the poverty line
</figcaption>
<div aria-describedby="tbl-e14-b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="sqrdcibqsm" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#sqrdcibqsm table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#sqrdcibqsm thead, #sqrdcibqsm tbody, #sqrdcibqsm tfoot, #sqrdcibqsm tr, #sqrdcibqsm td, #sqrdcibqsm th {
  border-style: none;
}

#sqrdcibqsm p {
  margin: 0;
  padding: 0;
}

#sqrdcibqsm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#sqrdcibqsm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#sqrdcibqsm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#sqrdcibqsm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#sqrdcibqsm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sqrdcibqsm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sqrdcibqsm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sqrdcibqsm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#sqrdcibqsm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#sqrdcibqsm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#sqrdcibqsm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#sqrdcibqsm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#sqrdcibqsm .gt_spanner_row {
  border-bottom-style: hidden;
}

#sqrdcibqsm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#sqrdcibqsm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#sqrdcibqsm .gt_from_md > :first-child {
  margin-top: 0;
}

#sqrdcibqsm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#sqrdcibqsm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#sqrdcibqsm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#sqrdcibqsm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#sqrdcibqsm .gt_row_group_first td {
  border-top-width: 2px;
}

#sqrdcibqsm .gt_row_group_first th {
  border-top-width: 2px;
}

#sqrdcibqsm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sqrdcibqsm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#sqrdcibqsm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#sqrdcibqsm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sqrdcibqsm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sqrdcibqsm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#sqrdcibqsm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#sqrdcibqsm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#sqrdcibqsm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sqrdcibqsm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sqrdcibqsm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sqrdcibqsm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sqrdcibqsm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sqrdcibqsm .gt_left {
  text-align: left;
}

#sqrdcibqsm .gt_center {
  text-align: center;
}

#sqrdcibqsm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#sqrdcibqsm .gt_font_normal {
  font-weight: normal;
}

#sqrdcibqsm .gt_font_bold {
  font-weight: bold;
}

#sqrdcibqsm .gt_font_italic {
  font-style: italic;
}

#sqrdcibqsm .gt_super {
  font-size: 65%;
}

#sqrdcibqsm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#sqrdcibqsm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#sqrdcibqsm .gt_indent_1 {
  text-indent: 5px;
}

#sqrdcibqsm .gt_indent_2 {
  text-indent: 10px;
}

#sqrdcibqsm .gt_indent_3 {
  text-indent: 15px;
}

#sqrdcibqsm .gt_indent_4 {
  text-indent: 20px;
}

#sqrdcibqsm .gt_indent_5 {
  text-indent: 25px;
}

#sqrdcibqsm .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#sqrdcibqsm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="Region" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Region</th>
<th id="Change Total Poverty" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Change Total Poverty</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="region">South</td>
<td class="gt_row gt_right" headers="change_total_poverty">2,718,396</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="region">West</td>
<td class="gt_row gt_right" headers="change_total_poverty">2,102,479</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="region">Midwest</td>
<td class="gt_row gt_right" headers="change_total_poverty">1,095,133</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="region">Norteast</td>
<td class="gt_row gt_right" headers="change_total_poverty">877,493</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<hr>
</section>
<section id="e15" class="level3">
<h3 class="anchored" data-anchor-id="e15">E15</h3>
<p><strong>Create a raster from scratch, with nine rows and columns and a resolution of 0.5 decimal degrees (WGS84). Fill it with random numbers. Extract the values of the four corner cells.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load the terra package</span></span>
<span id="cb56-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(terra)</span>
<span id="cb56-3"></span>
<span id="cb56-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a raster with 9 rows and 9 columns, resolution of 0.5 degrees</span></span>
<span id="cb56-5">r <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrows =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncols =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, </span>
<span id="cb56-6">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resolution =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, </span>
<span id="cb56-7">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>)</span>
<span id="cb56-8"></span>
<span id="cb56-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fill the raster with random numbers</span></span>
<span id="cb56-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(r) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncell</span>(r))</span>
<span id="cb56-11"></span>
<span id="cb56-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print the raster</span></span>
<span id="cb56-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(r)</span>
<span id="cb56-14"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## class       : SpatRaster </span></span>
<span id="cb56-15"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## dimensions  : 360, 720, 1  (nrow, ncol, nlyr)</span></span>
<span id="cb56-16"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## resolution  : 0.5, 0.5  (x, y)</span></span>
<span id="cb56-17"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)</span></span>
<span id="cb56-18"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span id="cb56-19"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## source(s)   : memory</span></span>
<span id="cb56-20"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## name        :        lyr.1 </span></span>
<span id="cb56-21"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## min value   : 4.599569e-06 </span></span>
<span id="cb56-22"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## max value   : 9.999993e-01</span></span>
<span id="cb56-23"></span>
<span id="cb56-24"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(r)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter3_files/figure-html/unnamed-chunk-36-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter3_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb57" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract the values of the four corner cells</span></span>
<span id="cb57-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Top-left (1, 1), Top-right (1, 9), Bottom-left (9, 1), </span></span>
<span id="cb57-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # Bottom-right (9, 9)</span></span>
<span id="cb57-4"></span>
<span id="cb57-5">r[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb57-6"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       lyr.1</span></span>
<span id="cb57-7"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1 0.3572785</span></span>
<span id="cb57-8">r[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>]</span>
<span id="cb57-9"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       lyr.1</span></span>
<span id="cb57-10"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1 0.2861174</span></span>
<span id="cb57-11">r[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb57-12"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       lyr.1</span></span>
<span id="cb57-13"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1 0.2665531</span></span>
<span id="cb57-14">r[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>]</span>
<span id="cb57-15"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##       lyr.1</span></span>
<span id="cb57-16"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## 1 0.5069412</span></span></code></pre></div>
</div>
<hr>
</section>
<section id="e16" class="level3">
<h3 class="anchored" data-anchor-id="e16">E16</h3>
<p><strong>What is the most common class of our example raster <code>grain</code>?</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1">grain_order <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"clay"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"silt"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sand"</span>)</span>
<span id="cb58-2">grain_char <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(grain_order, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb58-3">grain_fact <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(grain_char, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> grain_order)</span>
<span id="cb58-4">grain <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrows =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncols =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, </span>
<span id="cb58-5">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, </span>
<span id="cb58-6">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>,</span>
<span id="cb58-7">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vals =</span> grain_fact)</span>
<span id="cb58-8"></span>
<span id="cb58-9">answer <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">freq</span>(grain) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb58-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(count))</span>
<span id="cb58-11"></span>
<span id="cb58-12">gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>(answer) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb58-13">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label_with</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> snakecase<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>to_title_case)</span></code></pre></div>
</details>
<div id="tbl-e16" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-e16-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;12: The count of different classes in the example raster <code>grain</code>.
</figcaption>
<div aria-describedby="tbl-e16-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="iruzhlnzvw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#iruzhlnzvw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#iruzhlnzvw thead, #iruzhlnzvw tbody, #iruzhlnzvw tfoot, #iruzhlnzvw tr, #iruzhlnzvw td, #iruzhlnzvw th {
  border-style: none;
}

#iruzhlnzvw p {
  margin: 0;
  padding: 0;
}

#iruzhlnzvw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#iruzhlnzvw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#iruzhlnzvw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#iruzhlnzvw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#iruzhlnzvw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iruzhlnzvw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iruzhlnzvw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iruzhlnzvw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#iruzhlnzvw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#iruzhlnzvw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#iruzhlnzvw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#iruzhlnzvw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#iruzhlnzvw .gt_spanner_row {
  border-bottom-style: hidden;
}

#iruzhlnzvw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#iruzhlnzvw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#iruzhlnzvw .gt_from_md > :first-child {
  margin-top: 0;
}

#iruzhlnzvw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#iruzhlnzvw .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#iruzhlnzvw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#iruzhlnzvw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#iruzhlnzvw .gt_row_group_first td {
  border-top-width: 2px;
}

#iruzhlnzvw .gt_row_group_first th {
  border-top-width: 2px;
}

#iruzhlnzvw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iruzhlnzvw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#iruzhlnzvw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#iruzhlnzvw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iruzhlnzvw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iruzhlnzvw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#iruzhlnzvw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#iruzhlnzvw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#iruzhlnzvw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iruzhlnzvw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iruzhlnzvw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#iruzhlnzvw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iruzhlnzvw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#iruzhlnzvw .gt_left {
  text-align: left;
}

#iruzhlnzvw .gt_center {
  text-align: center;
}

#iruzhlnzvw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#iruzhlnzvw .gt_font_normal {
  font-weight: normal;
}

#iruzhlnzvw .gt_font_bold {
  font-weight: bold;
}

#iruzhlnzvw .gt_font_italic {
  font-style: italic;
}

#iruzhlnzvw .gt_super {
  font-size: 65%;
}

#iruzhlnzvw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#iruzhlnzvw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#iruzhlnzvw .gt_indent_1 {
  text-indent: 5px;
}

#iruzhlnzvw .gt_indent_2 {
  text-indent: 10px;
}

#iruzhlnzvw .gt_indent_3 {
  text-indent: 15px;
}

#iruzhlnzvw .gt_indent_4 {
  text-indent: 20px;
}

#iruzhlnzvw .gt_indent_5 {
  text-indent: 25px;
}

#iruzhlnzvw .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#iruzhlnzvw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="Layer" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Layer</th>
<th id="Value" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Value</th>
<th id="Count" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Count</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="layer">1</td>
<td class="gt_row gt_left" headers="value">silt</td>
<td class="gt_row gt_right" headers="count">14</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="layer">1</td>
<td class="gt_row gt_left" headers="value">clay</td>
<td class="gt_row gt_right" headers="count">13</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="layer">1</td>
<td class="gt_row gt_left" headers="value">sand</td>
<td class="gt_row gt_right" headers="count">9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<p>The most common class is the silt .</p>
<hr>
</section>
<section id="e17" class="level3">
<h3 class="anchored" data-anchor-id="e17">E17</h3>
<p><strong>Plot the histogram and the boxplot of the <code>dem.tif</code> file from the spDataLarge package (<code>system.file("raster/dem.tif", package = "spDataLarge")</code>).</strong></p>
<p>The plots are shown in Figure&nbsp;2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1">temp_rast <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/dem.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>))</span>
<span id="cb59-2"></span>
<span id="cb59-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(temp_rast)</span>
<span id="cb59-4"></span>
<span id="cb59-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">boxplot</span>(temp_rast)</span>
<span id="cb59-6"></span>
<span id="cb59-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Using ggplot2 methods</span></span>
<span id="cb59-8"></span>
<span id="cb59-9">temp_rast <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb59-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb59-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb59-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(dem)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb59-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(</span>
<span id="cb59-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>,</span>
<span id="cb59-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey20"</span></span>
<span id="cb59-16">  )</span>
<span id="cb59-17"></span>
<span id="cb59-18">temp_rast <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb59-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb59-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb59-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(dem)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb59-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>(</span>
<span id="cb59-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>,</span>
<span id="cb59-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey20"</span>,</span>
<span id="cb59-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">staplewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb59-26">  )</span></code></pre></div>
<div id="fig-e17" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-e17-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="fig-e17-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e17-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter3_files/figure-html/fig-e17-1.png" class="lightbox" data-gallery="fig-e17" title="Figure&nbsp;2&nbsp;(a): Histogram of the raster dem.tif using base R hist()"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter3_files/figure-html/fig-e17-1.png" class="img-fluid figure-img" data-ref-parent="fig-e17" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e17-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Histogram of the raster dem.tif using base R hist()
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-e17-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e17-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter3_files/figure-html/fig-e17-2.png" class="lightbox" data-gallery="fig-e17" title="Figure&nbsp;2&nbsp;(b): Boxplot of the raster dem.tif using base R boxplot()"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter3_files/figure-html/fig-e17-2.png" class="img-fluid figure-img" data-ref-parent="fig-e17" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e17-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Boxplot of the raster dem.tif using base R boxplot()
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-e17-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e17-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter3_files/figure-html/fig-e17-3.png" class="lightbox" data-gallery="fig-e17" title="Figure&nbsp;2&nbsp;(c): Histogram of the values in raster dem.tif using ggplot2"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter3_files/figure-html/fig-e17-3.png" class="img-fluid figure-img" data-ref-parent="fig-e17" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e17-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Histogram of the values in raster dem.tif using ggplot2
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-e17-4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-e17-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter3_files/figure-html/fig-e17-4.png" class="lightbox" data-gallery="fig-e17" title="Figure&nbsp;2&nbsp;(d): Boxplot of the values in raster dem.tif using ggplot2"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter3_files/figure-html/fig-e17-4.png" class="img-fluid figure-img" data-ref-parent="fig-e17" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-e17-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d) Boxplot of the values in raster dem.tif using ggplot2
</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-e17-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Plots produced for question E17
</figcaption>
</figure>
</div>
</div>


</section>
</section>

 ]]></description>
  <category>Geocomputation with R</category>
  <category>Textbook Solutions</category>
  <guid>https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter3.html</guid>
  <pubDate>Thu, 07 Nov 2024 18:30:00 GMT</pubDate>
</item>
<item>
  <title>Chapter 2: Geographic data in R</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">2.1 Introduction</h2>
<ul>
<li><strong>Geographic Data Models</strong>: Vector and raster models are foundational.
<ul>
<li><strong>Vector Model</strong>: Represents geographic data as points, lines, and polygons with precise boundaries; commonly used in social sciences for features like human settlements.</li>
<li><strong>Raster Model</strong>: Divides surfaces into cells; useful in environmental sciences, often based on remote sensing and aerial data. Scalable and consistent over large areas.</li>
</ul></li>
<li><strong>Choosing a Model</strong>:
<ul>
<li>Vector is often used in social sciences.</li>
<li>Raster is prevalent in environmental studies.</li>
</ul></li>
<li><strong>R Implementation</strong>:
<ul>
<li>Use <a href="https://r-spatial.github.io/sf/"><strong><code>sf</code></strong></a> for vector data.</li>
<li>Use <a href="https://rspatial.org/terra/"><strong><code>terra</code></strong></a> for raster data.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sf)           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simple Features in R</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(terra)        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Raster Data in R</span></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(spData)       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Spatial Datasets</span></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(spDataLarge)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Large Spatial Datasets</span></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data Wrangling and Visualization</span></span></code></pre></div>
</div>
</section>
<section id="vector-data" class="level2">
<h2 class="anchored" data-anchor-id="vector-data">2.2 Vector Data</h2>
<ul>
<li><strong>Vector Data</strong>: Represents geographic features using points, lines, and polygons based on coordinate reference systems (CRS).
<ul>
<li>Example: London’s coordinates <code>c(-0.1, 51.5)</code> in geographic CRS or <code>c(530000, 180000)</code> in projected CRS (<a href="https://en.wikipedia.org/wiki/Ordnance_Survey_National_Grid#:~:text=The%20Ordnance%20Survey%20National%20Grid,to%20the%20west%20of%20the">British National Grid</a>).</li>
</ul></li>
<li><strong>CRS Overview</strong>:
<ul>
<li>Geographic CRS uses <code>lon/lat</code> (0° longitude and latitude origin).</li>
<li>Projected CRS, like the British National Grid, is based on <code>Easting/Northing</code> coordinates with positive values.</li>
</ul></li>
<li><strong>Key dependencies / libraries used by the <code>sf</code> Package</strong>:
<ul>
<li><a href="https://gdal.org/"><strong><code>GDAL</code></strong></a>: Handles geographic data formats</li>
<li><a href="https://proj.org/"><strong><code>PROJ</code></strong></a>: For CRS transformations</li>
<li><a href="https://cran.r-project.org/package=geos"><strong><code>GEOS</code></strong></a>: Supports planar geometry for projected data</li>
<li><a href="https://s2geometry.io/"><strong><code>S2</code></strong></a>: Manages spherical geometry for unprojected data (e.g., <code>lon/lat</code>), toggleable with <code>sf::sf_use_s2(FALSE)</code>.</li>
</ul></li>
<li><strong>Geometry Engines</strong>:
<ul>
<li><strong>Planar (GEOS)</strong>: For 2D projected data.</li>
<li><strong>Spherical (S2)</strong>: For 3D unprojected data.</li>
</ul></li>
</ul>
<section id="introduction-to-simple-features" class="level3">
<h3 class="anchored" data-anchor-id="introduction-to-simple-features">2.2.1 Introduction to Simple Features</h3>
<ul>
<li><strong>Simple Features (SF)</strong>: Hierarchical model by <a href="https://www.ogc.org/">OGC</a> (Open Geospatial Consortium); supports multiple geometry types.</li>
<li><strong>Core Types</strong>: <code>sf</code> package in R supports 7 core geometry types (points, lines, polygons, and their “multi” versions).</li>
<li><strong>Library Integration</strong>: <code>sf</code> replaces <code>sp</code>, <code>rgdal</code>, <code>rgeos</code>; unified interface for GEOS (geometry), GDAL (data I/O), PROJ (CRS).</li>
<li><strong>Non-Planar Support</strong>: Integrates <code>s2</code> for geographic (lon/lat) operations, used by default for accuracy on spherical geometries.</li>
<li><strong>Data Storage</strong>: SF objects are data frames with a spatial column (<code>geometry</code> or <code>geom</code>).</li>
<li><strong>Vignettes</strong>: Documentation accessible with <code>vignette(package = "sf")</code> for practical use and examples.</li>
<li><strong>Plotting</strong>: <code>plot(sf_object)</code> maps all variables, unlike single-map GIS tools.</li>
<li><strong>Summary</strong>: <code>summary()</code> gives spatial and attribute data insights.</li>
<li><strong>Subset</strong>: SF objects subsettable like data frames, retaining spatial metadata.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">world</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 177 features and 10 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -180 ymin: -89.9 xmax: 180 ymax: 83.64513
Geodetic CRS:  WGS 84
# A tibble: 177 × 11
   iso_a2 name_long continent region_un subregion type  area_km2     pop lifeExp
 * &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
 1 FJ     Fiji      Oceania   Oceania   Melanesia Sove…   1.93e4  8.86e5    70.0
 2 TZ     Tanzania  Africa    Africa    Eastern … Sove…   9.33e5  5.22e7    64.2
 3 EH     Western … Africa    Africa    Northern… Inde…   9.63e4 NA         NA  
 4 CA     Canada    North Am… Americas  Northern… Sove…   1.00e7  3.55e7    82.0
 5 US     United S… North Am… Americas  Northern… Coun…   9.51e6  3.19e8    78.8
 6 KZ     Kazakhst… Asia      Asia      Central … Sove…   2.73e6  1.73e7    71.6
 7 UZ     Uzbekist… Asia      Asia      Central … Sove…   4.61e5  3.08e7    71.0
 8 PG     Papua Ne… Oceania   Oceania   Melanesia Sove…   4.65e5  7.76e6    65.2
 9 ID     Indonesia Asia      Asia      South-Ea… Sove…   1.82e6  2.55e8    68.9
10 AR     Argentina South Am… Americas  South Am… Sove…   2.78e6  4.30e7    76.3
# ℹ 167 more rows
# ℹ 2 more variables: gdpPercap &lt;dbl&gt;, geom &lt;MULTIPOLYGON [°]&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(world)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "iso_a2"    "name_long" "continent" "region_un" "subregion" "type"     
 [7] "area_km2"  "pop"       "lifeExp"   "gdpPercap" "geom"     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>(world)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sf"         "tbl_df"     "tbl"        "data.frame"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">########### THE GEOMETRY COLUMN IS STICKY ################</span></span>
<span id="cb8-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(world[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lifeExp"</span>])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    lifeExp                 geom    
 Min.   :50.62   MULTIPOLYGON :177  
 1st Qu.:64.96   epsg:4326    :  0  
 Median :72.87   +proj=long...:  0  
 Mean   :70.85                      
 3rd Qu.:76.78                      
 Max.   :83.59                      
 NA's   :10                         </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(world)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-basic-plot-on-sf" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-basic-plot-on-sf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter2_files/figure-html/fig-basic-plot-on-sf-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: The basic plot() function on a sf object produced multiple plots, one for each of the non-geometry variables (columns) in the plotted dataset."><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/fig-basic-plot-on-sf-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-basic-plot-on-sf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: The basic plot() function on a sf object produced multiple plots, one for each of the non-geometry variables (columns) in the plotted dataset.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="why-simple-features" class="level3">
<h3 class="anchored" data-anchor-id="why-simple-features">2.2.2 Why Simple Features?</h3>
<ul>
<li><strong>Cross-Compatibility</strong>: SF model is compatible with many GIS tools (e.g., <a href="https://www.qgis.org/">QGIS</a>, <a href="https://postgis.net/">PostGIS</a>), enabling easy data transfer.</li>
<li><strong>Advantages of <code>sf</code> in <code>R</code></strong>:
<ul>
<li>Data Handling: Fast reading/writing of spatial data.</li>
<li>Plotting: Improved plotting speed and performance.</li>
<li>Data Frame-Like: <code>sf</code> objects behave like data frames.</li>
<li>Consistent Naming: <code>sf</code> functions are intuitive, starting with <code>st_</code>.</li>
<li>Tidyverse-Friendly: Works well with <code>|&gt;</code> and integrates with tidyverse packages.</li>
</ul></li>
<li><strong>Data Import Options</strong>:
<ul>
<li><code>read_sf()</code>: Imports data as a tidy tibble (quietly).</li>
<li><code>st_read()</code>: Imports data as a base R data frame (verbose).</li>
</ul></li>
<li><strong>Popularity</strong>: <code>sf</code> is the primary package for spatial vector data in R, preferred over alternatives like <code>spatstat</code> and <code>terra</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">world_dfr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_read</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"shapes/world.shp"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spData"</span>))</span>
<span id="cb11-2"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Reading layer `world' from data source </span></span>
<span id="cb11-3"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##   `C:\Users\dradi\AppData\Local\R\win-library\4.3\spData\shapes\world.shp' </span></span>
<span id="cb11-4"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##   using driver `ESRI Shapefile'</span></span>
<span id="cb11-5"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Simple feature collection with 177 features and 10 fields</span></span>
<span id="cb11-6"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Geometry type: MULTIPOLYGON</span></span>
<span id="cb11-7"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Dimension:     XY</span></span>
<span id="cb11-8"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Bounding box:  xmin: -180 ymin: -89.9 xmax: 180 ymax: 83.64513</span></span>
<span id="cb11-9"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Geodetic CRS:  WGS 84</span></span>
<span id="cb11-10">world_dfr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_sf</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"shapes/world.shp"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spData"</span>))</span>
<span id="cb11-11"></span>
<span id="cb11-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>(world_dfr)</span>
<span id="cb11-13"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] "sf"         "tbl_df"     "tbl"        "data.frame"</span></span></code></pre></div>
</div>
</section>
<section id="basic-maps" class="level3">
<h3 class="anchored" data-anchor-id="basic-maps">2.2.3 Basic Maps</h3>
<ul>
<li><strong>Plotting in <code>sf</code></strong>:
<ul>
<li><code>plot()</code> creates multi-panel plots for multiple variables or a single-panel plot for one variable.</li>
<li>Supports fixed color customization using <code>col</code> and <code>border</code> arguments.</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(world)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-base-plot-fn" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-base-plot-fn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter2_files/figure-html/fig-base-plot-fn-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: The base plot() function creates a faceted output with a map for each variable other than geometry"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/fig-base-plot-fn-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-base-plot-fn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: The base plot() function creates a faceted output with a map for each variable other than geometry
</figcaption>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>Layering Plots</strong>: Add layers to existing plots with <code>add = TRUE</code>. Use <code>reset = FALSE</code> for plots with a key.</li>
<li><strong>Overlaying Data</strong>: Circles representing population size can be plotted using <code>cex</code> and <code>st_centroid()</code>.</li>
<li><strong>Bounding Box Expansion</strong>: <code>expandBB</code> adjusts the plot boundaries (bottom, left, top, right).</li>
<li><strong>Limitations</strong>: Base <code>plot()</code> is simple but limited in functionality; use <code>tmap</code> for advanced maps.</li>
</ul>
</section>
<section id="geometry-types" class="level3">
<h3 class="anchored" data-anchor-id="geometry-types">2.2.4 Geometry Types</h3>
<ul>
<li><strong>Geometry Basics:</strong>
<ul>
<li>Core components of simple features; <code>sf</code> supports 18 types.</li>
<li>Focus on 7 common types: POINT, LINESTRING, POLYGON, MULTIPOINT, MULTILINESTRING, MULTIPOLYGON, GEOMETRYCOLLECTION.</li>
</ul></li>
<li><strong>Encoding Standards:</strong>
<ul>
<li>WKB (Well-known binary): Hexadecimal, computer-friendly format.</li>
<li>WKT (Well-known text): Human-readable format, often shown for explanation.</li>
</ul></li>
<li><strong>Common Geometries:</strong>
<ul>
<li>POINT: Single coordinate (e.g., <code>POINT (5 2)</code>).</li>
<li>LINESTRING: Connected sequence of points (e.g., <code>LINESTRING (1 5, 4 4, 4 1, 2 2, 3 2)</code>).</li>
<li>POLYGON: Closed ring of points (e.g., <code>POLYGON ((1 5, 2 2, 4 1, 4 4, 1 5))</code>).</li>
</ul></li>
<li><strong>Multi-Geometries:</strong>
<ul>
<li>MULTIPOINT: Multiple points (e.g., <code>MULTIPOINT (5 2, 1 3, 3 4, 3 2)</code>).</li>
<li>MULTILINESTRING: Multiple linestrings (e.g., <code>MULTILINESTRING ((1 5, 4 4, 4 1, 2 2, 3 2), (1 2, 2 4))</code>).</li>
<li>MULTIPOLYGON: Multiple polygons (e.g., <code>MULTIPOLYGON (((1 5, 2 2, 4 1, 4 4, 1 5), (0 2, 1 2, 1 3, 0 3, 0 2)))</code>).</li>
</ul></li>
<li><strong>Geometry Collection:</strong>
<ul>
<li>Mix of geometry types (e.g., <code>GEOMETRYCOLLECTION (MULTIPOINT (5 2, 1 3, 3 4, 3 2), LINESTRING (1 5, 4 4, 4 1, 2 2, 3 2))</code>).</li>
</ul></li>
</ul>
</section>
<section id="the-sf-class" class="level3">
<h3 class="anchored" data-anchor-id="the-sf-class">2.2.5 The sf Class</h3>
<ul>
<li><p><strong>Structure of sf Objects</strong>: Composed of geometries (<code>sfc</code> object) and non-geographic attributes (<code>data.frame</code> or <code>tibble</code>).</p></li>
<li><p><strong>Creation of sf Objects</strong>: Steps:</p>
<ol type="1">
<li><p>Create geometry (<code>sfg</code>) with functions like <code>st_point()</code></p></li>
<li><p>Convert to geometry column (<code>sfc</code>) with CRS using function <code>st_sfc(..., crs = "...")</code></p></li>
<li><p>Combine attributes (<code>data.frame</code>) with <code>sfc</code> using function <code>st_sf(..., geometry = ...)</code></p></li>
</ol></li>
</ul>
<!-- -->
<ul>
<li><p><strong>Characteristics</strong>:</p>
<ul>
<li><code>sf</code> objects have dual class: <code>sf</code> and <code>data.frame</code>.</li>
<li>Spatial attributes stored in a <code>geometry</code> column.</li>
<li><code>sf</code> behaves like a <code>data.frame</code> but with spatial extension.</li>
</ul></li>
</ul>
</section>
<section id="simple-feature-geometries-sfg" class="level3">
<h3 class="anchored" data-anchor-id="simple-feature-geometries-sfg">2.2.6 Simple Feature Geometries (<code>sfg</code>)</h3>
<p>An <em>sfg</em> object represents a single simple feature geometry. A simple feature geometry column (<em>sfc</em>) is a collection of <em>sfg</em> objects and can also include information about the coordinate reference system (CRS) being used.</p>
<p>Geometries can be created using <code>st_</code> functions or imported from existing spatial files.</p>
<ul>
<li><strong>sfg Creation Functions</strong>:
<ul>
<li><code>st_point()</code>: Create a single point.</li>
<li><code>st_linestring()</code>: Create a linestring.</li>
<li><code>st_polygon()</code>: Create a polygon.</li>
<li><code>st_multipoint()</code>: Create a multipoint.</li>
<li><code>st_multilinestring()</code>: Create a multilinestring.</li>
<li><code>st_multipolygon()</code>: Create a multipolygon.</li>
<li><code>st_geometrycollection()</code>: Create a geometry collection.</li>
</ul></li>
<li><strong>Input Data Types</strong>:
<ul>
<li><strong>Numeric Vector</strong>: Single points.</li>
<li><strong>Matrix</strong>: Sets of points for multipoint or linestring.</li>
<li><strong>List</strong>: Complex structures for multilinestrings, (multi)polygons, or geometry collections.</li>
</ul></li>
<li><strong>Examples</strong>:</li>
</ul>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"></span>
<span id="cb13-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a point</span></span>
<span id="cb13-3">point <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># POINT (8 3)</span></span>
<span id="cb13-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(point)</span>
<span id="cb13-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(point) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>()</span>
<span id="cb13-7"></span>
<span id="cb13-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a multipoint</span></span>
<span id="cb13-9">multipoint_matrix <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))</span>
<span id="cb13-10">multipoint <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_multipoint</span>(multipoint_matrix)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># MULTIPOINT ((8 3), (2 5), (5 7), (7 3))</span></span>
<span id="cb13-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(multipoint)</span>
<span id="cb13-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(multipoint) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>()</span>
<span id="cb13-14"></span>
<span id="cb13-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a linestring</span></span>
<span id="cb13-16">linestring_matrix <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb13-17">linestring <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_linestring</span>(linestring_matrix)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># LINESTRING (2 8, 6 6, 7 2, 5 3, 8 4)</span></span>
<span id="cb13-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(linestring)</span>
<span id="cb13-19"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(linestring) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>()</span>
<span id="cb13-21"></span>
<span id="cb13-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a polygon</span></span>
<span id="cb13-23">polygon_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)))</span>
<span id="cb13-24">polygon <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_polygon</span>(polygon_list)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># POLYGON ((2 8, 4 3, 7 2, 6 7, 2 8))</span></span>
<span id="cb13-25"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(polygon)</span>
<span id="cb13-26"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(polygon) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>()</span>
<span id="cb13-28"></span>
<span id="cb13-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Polygon with a hole</span></span>
<span id="cb13-30">polygon_border <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>))</span>
<span id="cb13-31">polygon_hole <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb13-32">polygon_with_hole_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(polygon_border, polygon_hole)</span>
<span id="cb13-33">polygon_with_hole <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_polygon</span>(polygon_with_hole_list)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># POLYGON with a hole</span></span>
<span id="cb13-34"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(polygon_with_hole)</span>
<span id="cb13-35"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(polygon_with_hole) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>()</span>
<span id="cb13-37"></span>
<span id="cb13-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a multilinestring</span></span>
<span id="cb13-39">multilinestring_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb13-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)),</span>
<span id="cb13-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>))</span>
<span id="cb13-42">)</span>
<span id="cb13-43">multilinestring <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_multilinestring</span>(multilinestring_list)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># MULTILINESTRING</span></span>
<span id="cb13-44"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(multilinestring)</span>
<span id="cb13-45"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(multilinestring) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>()</span>
<span id="cb13-47"></span>
<span id="cb13-48"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a multipolygon</span></span>
<span id="cb13-49">multipolygon_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb13-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>))),</span>
<span id="cb13-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)))</span>
<span id="cb13-52">)</span>
<span id="cb13-53">multipolygon <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_multipolygon</span>(multipolygon_list)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># MULTIPOLYGON</span></span>
<span id="cb13-54"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(multipolygon)</span>
<span id="cb13-55"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(multipolygon) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>()</span>
<span id="cb13-57"></span>
<span id="cb13-58"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a geometry collection</span></span>
<span id="cb13-59">geometrycollection_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_multipoint</span>(multipoint_matrix), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_linestring</span>(linestring_matrix))</span>
<span id="cb13-60">geometry_collection <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_geometrycollection</span>(geometrycollection_list)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># GEOMETRYCOLLECTION</span></span>
<span id="cb13-61"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(geometry_collection)</span>
<span id="cb13-62"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(geometry_collection) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-63">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>()</span></code></pre></div>
</details>
<div id="fig-geometries" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-geometries-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-geometries" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-geometries-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-geometries-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter2_files/figure-html/fig-geometries-1.png" class="lightbox" data-gallery="fig-geometries" title="Figure&nbsp;3&nbsp;(a): A point"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/fig-geometries-1.png" class="img-fluid figure-img" data-ref-parent="fig-geometries" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-geometries-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) A point
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-geometries" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-geometries-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-geometries-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter2_files/figure-html/fig-geometries-2.png" class="lightbox" data-gallery="fig-geometries" title="Figure&nbsp;3&nbsp;(b): A multipoint"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/fig-geometries-2.png" class="img-fluid figure-img" data-ref-parent="fig-geometries" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-geometries-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) A multipoint
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-geometries" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-geometries-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-geometries-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter2_files/figure-html/fig-geometries-3.png" class="lightbox" data-gallery="fig-geometries" title="Figure&nbsp;3&nbsp;(c): A linestring"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/fig-geometries-3.png" class="img-fluid figure-img" data-ref-parent="fig-geometries" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-geometries-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) A linestring
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-geometries" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-geometries-4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-geometries-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter2_files/figure-html/fig-geometries-4.png" class="lightbox" data-gallery="fig-geometries" title="Figure&nbsp;3&nbsp;(d): A polygon"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/fig-geometries-4.png" class="img-fluid figure-img" data-ref-parent="fig-geometries" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-geometries-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d) A polygon
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-geometries" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-geometries-5" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-geometries-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter2_files/figure-html/fig-geometries-5.png" class="lightbox" data-gallery="fig-geometries" title="Figure&nbsp;3&nbsp;(e): Polygon with a hole"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/fig-geometries-5.png" class="img-fluid figure-img" data-ref-parent="fig-geometries" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-geometries-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(e) Polygon with a hole
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-geometries" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-geometries-6" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-geometries-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter2_files/figure-html/fig-geometries-6.png" class="lightbox" data-gallery="fig-geometries" title="Figure&nbsp;3&nbsp;(f): Multilinestring"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/fig-geometries-6.png" class="img-fluid figure-img" data-ref-parent="fig-geometries" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-geometries-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(f) Multilinestring
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-geometries" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-geometries-7" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-geometries-7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter2_files/figure-html/fig-geometries-7.png" class="lightbox" data-gallery="fig-geometries" title="Figure&nbsp;3&nbsp;(g): Multipolygon"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/fig-geometries-7.png" class="img-fluid figure-img" data-ref-parent="fig-geometries" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-geometries-7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(g) Multipolygon
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-geometries" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-geometries-8" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-geometries-8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter2_files/figure-html/fig-geometries-8.png" class="lightbox" data-gallery="fig-geometries" title="Figure&nbsp;3&nbsp;(h): Geometry Collection"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/fig-geometries-8.png" class="img-fluid figure-img" data-ref-parent="fig-geometries" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-geometries-8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(h) Geometry Collection
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-geometries-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Creating different sample geometry objects in R with {sf}
</figcaption>
</figure>
</div>
</section>
<section id="the-sfheaders-package" class="level3">
<h3 class="anchored" data-anchor-id="the-sfheaders-package">2.2.8 The <code>sfheaders</code> Package</h3>
<ul>
<li><strong>Overview</strong>:
<ul>
<li><code>sfheaders</code> <span class="citation" data-cites="sfheaders">(Cooley 2024)</span> is an R package designed to efficiently create and manipulate <code>sf</code> objects from vectors, matrices, and data frames.</li>
<li>It does not rely on the <code>sf</code> library and instead uses underlying C++ code, enabling faster operations and the potential for further development with compiled code.</li>
</ul></li>
<li><strong>Compatibility</strong>:
<ul>
<li>Although separate from <code>sf</code>, it is fully compatible, producing valid <code>sf</code> objects like <code>sfg</code>, <code>sfc</code>, and <code>sf</code>.</li>
</ul></li>
<li><strong>Key Functionality</strong>:
<ul>
<li>Converts:
<ul>
<li><strong>Vector</strong> → <code>sfg_POINT</code></li>
<li><strong>Matrix</strong> → <code>sfg_LINESTRING</code></li>
<li><strong>Data Frame</strong> → <code>sfg_POLYGON</code></li>
</ul></li>
<li>Creates <code>sfc</code> and <code>sf</code> objects using similar syntax.</li>
</ul></li>
<li><strong>Advantages</strong>:
<ul>
<li><code>sfheaders</code> is optimized for high-speed ‘deconstruction’ and ‘reconstruction’ of <code>sf</code> objects and casting between geometry types, offering faster performance than <code>sf</code> in many cases.</li>
</ul></li>
</ul>
</section>
<section id="spherical-geometry-operations-with-s2" class="level3">
<h3 class="anchored" data-anchor-id="spherical-geometry-operations-with-s2">2.2.9 Spherical Geometry Operations with S2</h3>
<ul>
<li><strong>Concept</strong>:
<ul>
<li>Spherical geometry operations acknowledge Earth’s roundness, as opposed to planar operations that assume flat surfaces.</li>
<li>Since <code>sf</code> version 1.0.0, R integrates with Google’s S2 spherical geometry engine, enabling accurate global spatial operations.</li>
<li>S2 supports operations like distance, buffer, and area calculations, allowing accurate geocomputation on a spherical Earth model.</li>
<li>Known as a Discrete Global Grid System (DGGS), S2 is similar to other systems like H3, which is a global hexagonal index.</li>
</ul></li>
<li><strong>S2 Mode</strong>:
<ul>
<li><p>By default, S2 is enabled in <code>sf</code>. Verify with:</p>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sf_use_s2</span>()</span></code></pre></div></li>
<li><p><strong>Turning Off S2</strong>:</p>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sf_use_s2</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div></li>
</ul></li>
<li><strong>S2 Limitations and Edge Cases</strong>:
<ul>
<li>Some operations may fail due to S2’s stricter definitions, potentially affecting legacy code. Error messages such as <code>Error in s2_geography_from_wkb ...</code> might require turning off S2.</li>
</ul></li>
<li><strong>Recommendation</strong>:
<ul>
<li>Keep S2 enabled for accurate global calculations unless specific operations necessitate its deactivation.</li>
</ul></li>
</ul>
</section>
</section>
<section id="raster-data" class="level2">
<h2 class="anchored" data-anchor-id="raster-data">2.3 Raster Data</h2>
<ul>
<li>The raster data model represents the world as a continuous grid of cells (pixels). Focuses on <strong>regular grids</strong>, where each cell is of constant size, though other grid types (e.g., rotated, sheared) exist.</li>
<li><strong>Structure</strong>:
<ul>
<li>Comprises a raster header and a matrix of equally spaced cells.</li>
<li>The raster header includes:
<ul>
<li>CRS (Coordinate Reference System)</li>
<li>Extent (geographical area covered)</li>
<li>Origin (starting point, often the lower left corner; the <code>terra</code> package defaults to the upper left).</li>
</ul></li>
<li>Extent is defined by:
<ul>
<li>Number of columns (ncol)</li>
<li>Number of rows (nrow)</li>
<li>Cell size resolution</li>
</ul></li>
</ul></li>
<li><strong>Cell Access and Modification</strong>:
<ul>
<li>Cells can be accessed and modified by:
<ul>
<li>Cell ID</li>
<li>Explicitly specifying row and column indices.</li>
</ul></li>
<li>This matrix representation is efficient as it avoids storing corner coordinates (unlike vector polygons).</li>
</ul></li>
<li><strong>Data Characteristics</strong>:
<ul>
<li>Each cell can hold a single value, which can be either:
<ul>
<li>Continuous (e.g., elevation, temperature)</li>
<li>Categorical (e.g., land cover classes).</li>
</ul></li>
</ul></li>
<li><strong>Applications</strong>:
<ul>
<li>Raster maps are useful for continuous phenomena (e.g., temperature, population density) and can also represent discrete features (e.g., soil classes).</li>
</ul></li>
</ul>
<section id="r-packages-for-working-with-raster-data" class="level3">
<h3 class="anchored" data-anchor-id="r-packages-for-working-with-raster-data">2.3.1 <code>R</code> Packages for Working with Raster Data</h3>
<ul>
<li>Several R packages for reading and processing raster datasets have emerged over the last two decades. The <strong><code>raster</code></strong> package was the first significant advancement in R’s raster capabilities when launched in 2010. It was the premier package until the development of <strong><code>terra</code></strong> and <strong><code>stars</code></strong>, both offering powerful functions for raster data.</li>
<li>This book emphasizes <strong><code>terra</code></strong>, which replaces the older, slower raster package.</li>
<li><strong>Comparison of <code>terra</code> and <code>stars</code></strong>:</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 31%">
<col style="width: 43%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Feature</strong></th>
<th><strong><code>terra</code></strong></th>
<th><strong><code>stars</code></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Primary Focus</strong></td>
<td>Regular grids</td>
<td>Supports regular, rotated, sheared, rectilinear, and curvilinear grids</td>
</tr>
<tr class="even">
<td><strong>Data Structure</strong></td>
<td>One or multi-layered rasters</td>
<td>Raster data cubes with multiple layers, time steps, and attributes</td>
</tr>
<tr class="odd">
<td><strong>Memory Management</strong></td>
<td>Uses C++ code and pointers for data storage</td>
<td>Uses lists of arrays for smaller rasters; file paths for larger ones</td>
</tr>
<tr class="even">
<td><strong>Vector Data Integration</strong></td>
<td>Uses its own class <code>SpatVector</code> but supports <code>sf</code> objects</td>
<td>Closely related to vector objects/functions in <code>sf</code></td>
</tr>
<tr class="odd">
<td><strong>Functions &amp; Methods</strong></td>
<td>Large number of built-in, purpose-specific functions (e.g., re-sampling, cropping)</td>
<td>Mix of built-in functions (<code>st_</code> prefix), existing <code>dplyr</code> functions, and custom methods for <code>R</code> functions</td>
</tr>
<tr class="even">
<td><strong>Conversion Between Packages</strong></td>
<td>Conversion to <code>stars</code> with <code>st_as_stars()</code></td>
<td>Conversion to <code>terra</code> with <code>rast()</code></td>
</tr>
<tr class="odd">
<td><strong>Performance</strong></td>
<td>Generally optimized for speed and memory efficiency</td>
<td>Flexible, but performance varies based on data type and structure</td>
</tr>
<tr class="even">
<td><strong>Best Use Cases</strong></td>
<td>Single or multi-layer rasters; fast processing</td>
<td>Complex data cubes with layers over time and multiple attributes</td>
</tr>
<tr class="odd">
<td><strong>Programming Language Basis</strong></td>
<td>Primarily C++</td>
<td><code>R</code> with some C++ integration</td>
</tr>
</tbody>
</table>
</section>
<section id="introduction-to-terra" class="level3">
<h3 class="anchored" data-anchor-id="introduction-to-terra">2.3.2 Introduction to <strong><code>terra</code></strong></h3>
<ul>
<li>The <strong><code>terra</code></strong> package is designed for handling raster objects in R, supporting a range of functions to create, read, export, manipulate, and process raster datasets.
<ul>
<li>While its functionality is similar to the older <strong><code>raster</code></strong> package, <strong><code>terra</code></strong> offers improved computational efficiency.</li>
<li>Despite <strong><code>terra</code></strong>’s advantages, the <strong><code>raster</code></strong> class system remains popular due to its widespread use in other R packages.</li>
<li><strong><code>terra</code></strong> provides seamless translation between the two object types using functions like <strong><code>raster()</code></strong>, <strong><code>stack()</code></strong>, and <strong><code>brick()</code></strong> for backward compatibility.</li>
</ul></li>
<li><strong>Key Features</strong>:
<ul>
<li>Low-Level Functionality: Includes functions that help in building new tools for raster data processing.</li>
<li>Memory Management: Supports processing of large raster datasets by dividing them into smaller chunks for iterative processing, allowing operations beyond available RAM capacity.</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">raster_filepath <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/srtm.tif"</span>, </span>
<span id="cb16-2">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>)</span>
<span id="cb16-3">my_rast <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(raster_filepath)</span>
<span id="cb16-4"></span>
<span id="cb16-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>(my_rast)</span>
<span id="cb16-6"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] "SpatRaster"</span></span>
<span id="cb16-7"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## attr(,"package")</span></span>
<span id="cb16-8"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## [1] "terra"</span></span>
<span id="cb16-9"></span>
<span id="cb16-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ext</span>(my_rast)</span>
<span id="cb16-11"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## SpatExtent : -113.239583212784, -112.85208321281, 37.1320834298579, 37.5129167631658 (xmin, xmax, ymin, ymax)</span></span>
<span id="cb16-12"></span>
<span id="cb16-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(my_rast)</span>
<span id="cb16-14"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## class       : SpatRaster </span></span>
<span id="cb16-15"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## dimensions  : 457, 465, 1  (nrow, ncol, nlyr)</span></span>
<span id="cb16-16"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## resolution  : 0.0008333333, 0.0008333333  (x, y)</span></span>
<span id="cb16-17"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## extent      : -113.2396, -112.8521, 37.13208, 37.51292  (xmin, xmax, ymin, ymax)</span></span>
<span id="cb16-18"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span id="cb16-19"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## source      : srtm.tif </span></span>
<span id="cb16-20"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## name        : srtm </span></span>
<span id="cb16-21"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## min value   : 1024 </span></span>
<span id="cb16-22"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## max value   : 2892</span></span></code></pre></div>
</details>
</div>
<ul>
<li><strong>Dedicated Reporting Functions</strong>:
<ul>
<li><strong><code>dim()</code></strong>: Number of rows, columns, and layers.</li>
<li><strong><code>ncell()</code></strong>: Total number of cells (pixels).</li>
<li><strong><code>res()</code></strong>: Spatial resolution.</li>
<li><strong><code>ext()</code></strong>: Spatial extent.</li>
<li><strong><code>crs()</code></strong>: Coordinate reference system (CRS).</li>
<li><strong><code>inMemory()</code></strong>: Checks if data is stored in memory or on disk.</li>
<li><strong><code>sources</code></strong>: Shows file location.</li>
</ul></li>
<li><strong>Accessing Full Function List</strong>:
<ul>
<li>Run <code>help("terra-package")</code> to see all available <strong><code>terra</code></strong> functions.</li>
</ul></li>
</ul>
</section>
<section id="basic-map-making" class="level3">
<h3 class="anchored" data-anchor-id="basic-map-making">2.3.3 Basic Map-Making</h3>
<ul>
<li><strong>Plotting with</strong> <code>terra</code>:
<ul>
<li>The <strong>terra</strong> package offers a simple way to create basic visualizations using the <strong>plot()</strong> function, specifically designed for <strong>SpatRaster</strong> objects.</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(my_rast)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-terra-examples2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-terra-examples2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter2_files/figure-html/fig-terra-examples2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Figure&nbsp;4: An example raster data displayed with {terra} using plot()"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/fig-terra-examples2-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-terra-examples2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: An example raster data displayed with {terra} using plot()
</figcaption>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>Advanced Plotting Options</strong>:
<ul>
<li><strong><code>plotRGB()</code></strong>: A specialized function in <strong>terra</strong> for creating color composite plots using three layers (e.g., red, green, blue bands) from a <strong>SpatRaster</strong> object.</li>
<li><strong><code>tmap</code> Package</strong> <span class="citation" data-cites="tmap">(Tennekes 2018)</span>: Useful for creating both static and interactive maps for raster and vector data.</li>
<li><strong><code>rasterVis</code> Package</strong> <span class="citation" data-cites="rasterVis">(2023)</span>: Includes functions such as <strong><code>levelplot()</code></strong> to create advanced visualizations, including faceted plots for displaying changes over time.</li>
</ul></li>
</ul>
</section>
<section id="raster-classes" class="level3">
<h3 class="anchored" data-anchor-id="raster-classes">2.3.4 Raster Classes</h3>
<ul>
<li>The SpatRaster class in <code>terra</code> represents raster objects. Rasters are commonly created by reading a file using <code>rast()</code>
<ul>
<li><code>terra</code> supports reading various formats via GDAL, only loading the header and a file pointer into RAM.</li>
</ul></li>
<li><strong>Creating Rasters from Scratch</strong>: Use <strong>rast()</strong> to make new raster objects:
<ul>
<li>Fills values row-wise from the top left corner.</li>
<li>Resolution depends on rows, columns, and extent; defaults to degrees (WGS84 CRS).</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a new SpatRaster object: a checkerboard design</span></span>
<span id="cb18-2">new_raster <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrows =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncols =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, </span>
<span id="cb18-3">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, </span>
<span id="cb18-4">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb18-5">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vals =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>), </span>
<span id="cb18-6">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)) </span>
<span id="cb18-7"></span>
<span id="cb18-8"></span>
<span id="cb18-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the new raster</span></span>
<span id="cb18-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(new_raster, </span>
<span id="cb18-11">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkblue"</span>, </span>
<span id="cb18-12">             <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>,</span>
<span id="cb18-13">             <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>,</span>
<span id="cb18-14">             <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightblue"</span>), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use blue and white for the design</span></span>
<span id="cb18-15">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb18-16">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-new-raster" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-new-raster-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter2_files/figure-html/fig-new-raster-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Figure&nbsp;5: Creating a new raster from scratch"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/fig-new-raster-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-new-raster-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Creating a new raster from scratch
</figcaption>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>Handling Multi-Layer Rasters</strong>:
<ul>
<li><p><strong>SpatRaster</strong> supports multi-layer rasters, such as satellite or time-series data:</p>
<ul>
<li><p>Use <strong><code>nlyr()</code></strong> to get the number of layers:</p></li>
<li><p>Access layers with <strong><code>[[</code></strong> or <strong><code>$</code></strong>.</p></li>
<li><p>Use <strong><code>subset()</code></strong> for layer extraction:</p></li>
</ul></li>
</ul></li>
<li><strong>Combining Raster Layers</strong>:
<ul>
<li>Merge <strong>SpatRaster</strong> layers using <strong>c()</strong>:</li>
</ul></li>
<li><strong>Saving SpatRaster Objects</strong>:
<ul>
<li>Since they often point to files, direct saving to <strong>.rds</strong> or <strong>.rda</strong> isn’t feasible.</li>
<li>Solutions:
<ol type="1">
<li><strong><code>wrap()</code></strong>: Creates a temporary object for saving or cluster use.</li>
<li><strong><code>writeRaster()</code></strong>: Saves as a regular raster file.</li>
</ol></li>
</ul></li>
</ul>
</section>
</section>
<section id="coordinate-reference-systems" class="level2">
<h2 class="anchored" data-anchor-id="coordinate-reference-systems">2.4 Coordinate Reference Systems</h2>
<ul>
<li>CRSs (Coordinate Reference Systems) are essential for spatial data, defining how spatial elements correspond to the Earth’s surface (or other celestial bodies).</li>
<li><strong>Types of CRSs</strong>:
<ul>
<li><strong>Geographic CRSs</strong>:
<ul>
<li>Represent data on a three-dimensional surface (e.g., latitude and longitude).</li>
<li>Coordinate units are typically degrees.</li>
</ul></li>
<li><strong>Projected CRSs</strong>:
<ul>
<li>Represent data on a two-dimensional, flat plane.</li>
<li>Transform spherical Earth data into a flat map.</li>
<li>Coordinate units can be in meters, feet, etc.</li>
</ul></li>
</ul></li>
</ul>
<section id="geographic-coordinate-reference-systems" class="level3">
<h3 class="anchored" data-anchor-id="geographic-coordinate-reference-systems">2.4.1 Geographic Coordinate Reference Systems</h3>
<ul>
<li>Geographic CRSs use longitude and latitude to identify locations on Earth.
<ul>
<li>Longitude: Measures East-West position relative to the Prime Meridian.</li>
<li>Latitude: Measures North-South position relative to the equatorial plane.</li>
<li>Distances are measured in <strong>angular units (degrees)</strong>, not meters, impacting spatial measurements (explored further in Section 7).</li>
</ul></li>
<li>The Earth can be modeled as spherical or ellipsoidal.
<ul>
<li><strong>Spherical models</strong>: Simplify calculations by assuming Earth is a perfect sphere.</li>
<li><strong>Ellipsoidal models</strong>: More accurately represent Earth with distinct equatorial and polar radii. The equatorial radius is about 11.5 km longer than the polar radius due to Earth’s compression.</li>
</ul></li>
<li><strong>Datum</strong> refers to the model describing the relationship between coordinate values and actual locations on Earth. A datum consists of:
<ol type="1">
<li><p><strong>Ellipsoid</strong>: An idealized mathematical model of the Earth’s shape, which helps to approximate the Earth’s surface.</p></li>
<li><p><strong>Origin Point</strong>: A fixed starting point for the coordinate system, where the ellipsoid is anchored to Earth.</p></li>
<li><p><strong>Offset and Orientation</strong>: How the ellipsoid is aligned with respect to the actual shape of the Earth.</p></li>
</ol></li>
</ul>
<!-- -->
<ul>
<li>The two types of Datums are: —
<ul>
<li><strong>Geocentric datum</strong> (e.g., WGS84): Centered at Earth’s center of gravity, providing global consistency but less local accuracy.</li>
<li><strong>Local datum</strong> (e.g., NAD83): Adjusted for specific regions to better align with the Earth’s surface, accounting for local geographic variations (e.g., mountain ranges).</li>
</ul></li>
</ul>
</section>
<section id="projected-coordinate-reference-systems" class="level3">
<h3 class="anchored" data-anchor-id="projected-coordinate-reference-systems">2.4.2 Projected Coordinate Reference Systems</h3>
<ul>
<li>Projected CRSs are based on geographic CRSs and use map projections to represent Earth’s three-dimensional surface in <strong>Easting</strong> and <strong>Northing</strong> (x and y) values. These CRSs rely on Cartesian coordinates on a flat surface, with an origin and linear units (<em>e.g.,</em> meters).</li>
<li><strong>Deformations</strong>:
<ul>
<li>The conversion from 3D to 2D inherently introduces distortions. Projected CRSs can only preserve one or two of the following properties:
<ul>
<li><strong>Area</strong>: Preserved in <strong>equal-area</strong> projections.</li>
<li><strong>Direction</strong>: Preserved in <strong>azimuthal</strong> projections.</li>
<li><strong>Distance</strong>: Preserved in <strong>equidistant</strong> projections.</li>
<li><strong>Shape</strong>: Preserved in <strong>conformal</strong> projections.</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="types-of-projections-and-their-characteristics" class="level3">
<h3 class="anchored" data-anchor-id="types-of-projections-and-their-characteristics">Types of Projections and Their Characteristics</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 30%">
<col style="width: 23%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Type of Projection</strong></th>
<th><strong>Description</strong></th>
<th><strong>Common Properties Preserved</strong></th>
<th><strong>Best Used For</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Conic</strong></td>
<td>Projects Earth’s surface onto a cone.</td>
<td>Area, shape</td>
<td>Maps of mid-latitude regions</td>
</tr>
<tr class="even">
<td><strong>Cylindrical</strong></td>
<td>Projects Earth’s surface onto a cylinder.</td>
<td>Direction, shape</td>
<td>World maps</td>
</tr>
<tr class="odd">
<td><strong>Planar (Azimuthal)</strong></td>
<td>Projects onto a flat surface at a point or line.</td>
<td>Distance, direction</td>
<td>Polar region maps</td>
</tr>
</tbody>
</table>
</section>
<section id="deformations-by-projection-type" class="level3">
<h3 class="anchored" data-anchor-id="deformations-by-projection-type">Deformations by Projection Type</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 47%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Property</strong></th>
<th><strong>Definition</strong></th>
<th><strong>Projection Type That Preserves It</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Area</strong></td>
<td>The relative size of regions is maintained.</td>
<td>Equal-area projections (e.g., Albers)</td>
</tr>
<tr class="even">
<td><strong>Direction</strong></td>
<td>Bearings from the center are accurate.</td>
<td>Azimuthal projections (e.g., Lambert)</td>
</tr>
<tr class="odd">
<td><strong>Distance</strong></td>
<td>Correct distances are preserved along specific lines or from specific points.</td>
<td>Equidistant projections (e.g., Equirectangular)</td>
</tr>
<tr class="even">
<td><strong>Shape</strong></td>
<td>Local angles and shapes are maintained, though areas are distorted.</td>
<td>Conformal projections (e.g., Mercator)</td>
</tr>
</tbody>
</table>
<ul>
<li>Use the <a href="https://www.geo-projections.com/">Map Projection Explorer</a> for details.</li>
<li>Use <code>st_crs()</code> for querying CRSs in <strong>sf objects</strong> and <code>crs()</code> for <strong>terra objects</strong>.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sf_proj_info</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"proj"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-3">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-4">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label_with</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fn =</span> snakecase<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>to_title_case) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-5">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_espn</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-6">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>()</span></code></pre></div>
</details>
<div id="tbl-projection-types" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-projection-types-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: A list of the available projections supported by the PROJ library
</figcaption>
<div aria-describedby="tbl-projection-types-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="qrmhsgtppx" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#qrmhsgtppx table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qrmhsgtppx thead, #qrmhsgtppx tbody, #qrmhsgtppx tfoot, #qrmhsgtppx tr, #qrmhsgtppx td, #qrmhsgtppx th {
  border-style: none;
}

#qrmhsgtppx p {
  margin: 0;
  padding: 0;
}

#qrmhsgtppx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qrmhsgtppx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qrmhsgtppx .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qrmhsgtppx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qrmhsgtppx .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qrmhsgtppx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qrmhsgtppx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qrmhsgtppx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qrmhsgtppx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qrmhsgtppx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qrmhsgtppx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qrmhsgtppx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qrmhsgtppx .gt_spanner_row {
  border-bottom-style: hidden;
}

#qrmhsgtppx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qrmhsgtppx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qrmhsgtppx .gt_from_md > :first-child {
  margin-top: 0;
}

#qrmhsgtppx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qrmhsgtppx .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qrmhsgtppx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qrmhsgtppx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qrmhsgtppx .gt_row_group_first td {
  border-top-width: 2px;
}

#qrmhsgtppx .gt_row_group_first th {
  border-top-width: 2px;
}

#qrmhsgtppx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qrmhsgtppx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qrmhsgtppx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qrmhsgtppx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qrmhsgtppx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qrmhsgtppx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qrmhsgtppx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#qrmhsgtppx .gt_striped {
  background-color: #FAFAFA;
}

#qrmhsgtppx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qrmhsgtppx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qrmhsgtppx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qrmhsgtppx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qrmhsgtppx .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qrmhsgtppx .gt_left {
  text-align: left;
}

#qrmhsgtppx .gt_center {
  text-align: center;
}

#qrmhsgtppx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qrmhsgtppx .gt_font_normal {
  font-weight: normal;
}

#qrmhsgtppx .gt_font_bold {
  font-weight: bold;
}

#qrmhsgtppx .gt_font_italic {
  font-style: italic;
}

#qrmhsgtppx .gt_super {
  font-size: 65%;
}

#qrmhsgtppx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#qrmhsgtppx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qrmhsgtppx .gt_indent_1 {
  text-indent: 5px;
}

#qrmhsgtppx .gt_indent_2 {
  text-indent: 10px;
}

#qrmhsgtppx .gt_indent_3 {
  text-indent: 15px;
}

#qrmhsgtppx .gt_indent_4 {
  text-indent: 20px;
}

#qrmhsgtppx .gt_indent_5 {
  text-indent: 25px;
}

#qrmhsgtppx .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#qrmhsgtppx div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="qrmhsgtppx" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="qrmhsgtppx">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"name":["adams_hemi","adams_ws1","adams_ws2","aea","aeqd","affine","airy","aitoff","alsk","apian","august","axisswap","bacon","bertin1953","bipc","boggs","bonne","calcofi","cart","cass","cc","ccon","cea","chamb","collg","col_urban","comill","crast","defmodel","deformation","denoy","eck1","eck2","eck3","eck4","eck5","eck6","eqearth","eqc","eqdc","euler","etmerc","fahey","fouc","fouc_s","gall","geoc","geogoffset","geos","gins8","gn_sinu","gnom","goode","gridshift","gs48","gs50","guyou","hammer","hatano","healpix","rhealpix","helmert","hgridshift","horner","igh","igh_o","imoll","imoll_o","imw_p","isea","kav5","kav7","krovak","labrd","laea","lagrng","larr","lask","lonlat","latlon","lcc","lcca","leac","lee_os","loxim","lsat","mbt_s","mbt_fps","mbtfpp","mbtfpq","mbtfps","merc","mil_os","mill","misrsom","moll","molobadekas","molodensky","murd1","murd2","murd3","natearth","natearth2","nell","nell_h","nicol","nsper","nzmg","noop","ob_tran","ocea","oea","omerc","ortel","ortho","pconic","patterson","peirce_q","pipeline","poly","pop","push","putp1","putp2","putp3","putp3p","putp4p","putp5","putp5p","putp6","putp6p","qua_aut","qsc","robin","rouss","rpoly","s2","sch","set","sinu","som","somerc","stere","sterea","gstmerc","tcc","tcea","times","tinshift","tissot","tmerc","tobmerc","topocentric","tpeqd","tpers","unitconvert","ups","urm5","urmfps","utm","vandg","vandg2","vandg3","vandg4","vertoffset","vitk1","vgridshift","wag1","wag2","wag3","wag4","wag5","wag6","wag7","webmerc","weren","wink1","wink2","wintri","xyzgridshift"],"description":["Adams Hemisphere in a Square","Adams World in a Square I","Adams World in a Square II","Albers Equal Area","Azimuthal Equidistant","Affine transformation","Airy","Aitoff","Modified Stereographic of Alaska","Apian Globular I","August Epicycloidal","Axis ordering","Bacon Globular","Bertin 1953","Bipolar conic of western hemisphere","Boggs Eumorphic","Bonne (Werner lat_1=90)","Cal Coop Ocean Fish Invest Lines/Stations","Geodetic/cartesian conversions","Cassini","Central Cylindrical","Central Conic","Equal Area Cylindrical","Chamberlin Trimetric","Collignon","Colombia Urban","Compact Miller","Craster Parabolic (Putnins P4)","Deformation model","Kinematic grid shift","Denoyer Semi-Elliptical","Eckert I","Eckert II","Eckert III","Eckert IV","Eckert V","Eckert VI","Equal Earth","Equidistant Cylindrical (Plate Carree)","Equidistant Conic","Euler","Extended Transverse Mercator","Fahey","Foucaut","Foucaut Sinusoidal","Gall (Gall Stereographic)","Geocentric Latitude","Geographic Offset","Geostationary Satellite View","Ginsburg VIII (TsNIIGAiK)","General Sinusoidal Series","Gnomonic","Goode Homolosine","Generic grid shift","Modified Stereographic of 48 U.S.","Modified Stereographic of 50 U.S.","Guyou","Hammer & Eckert-Greifendorff","Hatano Asymmetrical Equal Area","HEALPix","rHEALPix","3(6)-, 4(8)- and 7(14)-parameter Helmert shift","Horizontal grid shift","Horner polynomial evaluation","Interrupted Goode Homolosine","Interrupted Goode Homolosine Oceanic View","Interrupted Mollweide","Interrupted Mollweide Oceanic View","International Map of the World Polyconic","Icosahedral Snyder Equal Area","Kavrayskiy V","Kavrayskiy VII","Krovak","Laborde","Lambert Azimuthal Equal Area","Lagrange","Larrivee","Laskowski","Lat/long (Geodetic)","Lat/long (Geodetic alias)","Lambert Conformal Conic","Lambert Conformal Conic Alternative","Lambert Equal Area Conic","Lee Oblated Stereographic","Loximuthal","Space oblique for LANDSAT","McBryde-Thomas Flat-Polar Sine (No. 1)","McBryde-Thomas Flat-Pole Sine (No. 2)","McBride-Thomas Flat-Polar Parabolic","McBryde-Thomas Flat-Polar Quartic","McBryde-Thomas Flat-Polar Sinusoidal","Mercator","Miller Oblated Stereographic","Miller Cylindrical","Space oblique for MISR","Mollweide","Molodensky-Badekas transformation","Molodensky transform","Murdoch I","Murdoch II","Murdoch III","Natural Earth","Natural Earth 2","Nell","Nell-Hammer","Nicolosi Globular","Near-sided perspective","New Zealand Map Grid","No operation","General Oblique Transformation","Oblique Cylindrical Equal Area","Oblated Equal Area","Oblique Mercator","Ortelius Oval","Orthographic","Perspective Conic","Patterson Cylindrical","Peirce Quincuncial","Transformation pipeline manager","Polyconic (American)","Retrieve coordinate value from pipeline stack","Save coordinate value on pipeline stack","Putnins P1","Putnins P2","Putnins P3","Putnins P3'","Putnins P4'","Putnins P5","Putnins P5'","Putnins P6","Putnins P6'","Quartic Authalic","Quadrilateralized Spherical Cube","Robinson","Roussilhe Stereographic","Rectangular Polyconic","S2","Spherical Cross-track Height","Set coordinate value","Sinusoidal (Sanson-Flamsteed)","Space Oblique Mercator","Swiss. Obl. Mercator","Stereographic","Oblique Stereographic Alternative","Gauss-Schreiber Transverse Mercator (aka Gauss-Laborde Reunion)","Transverse Central Cylindrical","Transverse Cylindrical Equal Area","Times","Triangulation based transformation","Tissot","Transverse Mercator","Tobler-Mercator","Geocentric/Topocentric conversion","Two Point Equidistant","Tilted perspective","Unit conversion","Universal Polar Stereographic","Urmaev V","Urmaev Flat-Polar Sinusoidal","Universal Transverse Mercator (UTM)","van der Grinten (I)","van der Grinten II","van der Grinten III","van der Grinten IV","Vertical Offset and Slope","Vitkovsky I","Vertical grid shift","Wagner I (Kavrayskiy VI)","Wagner II","Wagner III","Wagner IV","Wagner V","Wagner VI","Wagner VII","Web Mercator / Pseudo Mercator","Werenskiold I","Winkel I","Winkel II","Winkel Tripel","Geocentric grid shift"]},"columns":[{"id":"name","name":"Name","type":"character","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left","headerStyle":{"font-weight":"normal"}},{"id":"description","name":"Description","type":"character","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left","headerStyle":{"font-weight":"normal"}}],"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"striped":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"#fafafa","style":{"fontFamily":"Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"}},"elementId":"qrmhsgtppx","dataKey":"da11b8da9a0c61d44ce66a7aaa35fe9c"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>
</section>
</section>
<section id="units" class="level2">
<h2 class="anchored" data-anchor-id="units">2.5 Units</h2>
<ul>
<li><p>CRSs include spatial units information, which is crucial for accurately interpreting distance and area.</p></li>
<li><p>Cartographic best practices suggest adding scale indicators on maps to show the relationship between map and ground distances.</p></li>
<li><p><strong>Units in <code>sf</code> Objects</strong>:</p>
<ul>
<li><code>sf</code> objects natively support units for geometric data, ensuring outputs from functions like <code>st_area()</code> come with a <code>units</code> attribute.</li>
<li>This feature, supported by the <code>units</code> package, avoids confusion across different CRSs, which may use meters, feet, etc.</li>
<li>To convert units, use <code>units::set_units()</code></li>
</ul></li>
<li><p><strong>Units in Raster Data</strong>:</p>
<ul>
<li>Unlike <code>sf</code>, raster packages do not natively support units.</li>
<li>Users should be cautious when working with raster data to convert units properly.</li>
<li>An example to calculate the area of India in square meters and then, square kilometres</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load required libraries</span></span>
<span id="cb20-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sf)</span>
<span id="cb20-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(units)</span>
<span id="cb20-4"></span>
<span id="cb20-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate the area of India in square meters</span></span>
<span id="cb20-6">india_area <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rnaturalearth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ne_countries</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb20-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(admin <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"India"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb20-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_area</span>()</span>
<span id="cb20-9">india_area</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3.150428e+12 [m^2]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert area to square kilometers</span></span>
<span id="cb22-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Area of India in square kilometers:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_units</span>(india_area, km<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Area of India in square kilometers: 3150428 [km^2]"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert area to hectares</span></span>
<span id="cb24-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Area of India in hectares:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_units</span>(india_area, ha))))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Area of India in hectares: 315042827 [ha]"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert area to acres</span></span>
<span id="cb26-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Area of India in acres:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_units</span>(india_area, acre))))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Area of India in acres: 778484666 [acre]"</code></pre>
</div>
</div>
</section>
<section id="exercises" class="level2">
<h2 class="anchored" data-anchor-id="exercises"><strong>2.6 Exercises</strong></h2>
<hr>
<section id="e1" class="level3">
<h3 class="anchored" data-anchor-id="e1">E1</h3>
<p>Using <code>summary()</code> on the geometry column of the <code>world</code> data object in the <code>spData</code> package provides valuable information about the spatial characteristics of the dataset:</p>
<ol type="1">
<li><strong>Geometry Type</strong>:
<ul>
<li>The output will indicate the type of geometries present in the <code>world</code> data object. Here, it is <code>MULTIPOLYGON</code> suggesting that the dataset represents the outlines of countries or regions in <strong>MULTIPLOYGON</strong> formats.</li>
</ul></li>
<li><strong>Number of Countries</strong>:
<ul>
<li>The summary will show the number of geometries or features present, which corresponds to the number of countries or regions represented in the <code>world</code> dataset. Here, it is <strong>177 countries</strong>.</li>
</ul></li>
<li><strong>Coordinate Reference System (CRS)</strong>:
<ul>
<li>The output will include details about the CRS, and in the present case it is <strong>EPSG:4326</strong>.</li>
</ul></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>((spData<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>world<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>geom))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> MULTIPOLYGON     epsg:4326 +proj=long... 
          177             0             0 </code></pre>
</div>
</div>
<hr>
</section>
<section id="e2" class="level3">
<h3 class="anchored" data-anchor-id="e2">E2</h3>
<p>To generate the world map, you can run the following code (as shown in Section 2.2.3):</p>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(spData)</span>
<span id="cb30-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(world[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>])</span>
<span id="cb30-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(world[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pop"</span>])</span></code></pre></div>
</details>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-ex2-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ex2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter2_files/figure-html/fig-ex2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Figure&nbsp;6: Reproducing Figure 2.4 of the book"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/fig-ex2-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ex2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Reproducing Figure 2.4 of the book
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-ex2-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ex2-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="chapter2_files/figure-html/fig-ex2-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Figure&nbsp;7: Reproducing Figure 2.4 of the book"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/fig-ex2-2.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ex2-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Reproducing Figure 2.4 of the book
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<ul>
<li><strong>Similarities</strong>:
<ol type="1">
<li>The map displays country boundaries and highlights the global population distribution as shown in the book.</li>
<li>The color scale representing population data is consistent with that described in the book, with larger populations shown with more intense colors.</li>
</ol></li>
<li><strong>Differences</strong>:
<ol type="1">
<li>The aspect ratio or positioning of the map might vary depending on your screen resolution and window size.</li>
<li>The color theme and legend display may differ if your R setup or graphic device uses default settings different from those in the book.</li>
</ol></li>
<li><strong><code>cex</code> Argument</strong>: This parameter controls the size of plotting symbols in R. It is a numeric value that acts as a multiplier for the default size of symbols.
<ul>
<li>Setting <code>cex</code> to values larger than 1 enlarges symbols, while values less than 1 shrink them.</li>
</ul></li>
<li><strong>Reason for <code>cex = sqrt(world$pop) / 10000</code></strong> : The code sets <code>cex</code> to <code>sqrt(world$pop) / 10000</code> to scale the size of the points on the map in proportion to the population of each country. This square root transformation is used to moderate the variation in symbol sizes because population values can vary significantly between countries. Dividing by 10,000 helps to reduce the symbol size to a reasonable range for plotting.</li>
</ul>
<p><strong>Other Ideas: —</strong></p>
<ul>
<li><strong>Bubble Plot</strong>: Overlay a bubble plot on the map with points sized by population.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(world[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pop"</span>])</span>
<span id="cb31-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">points</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_coordinates</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_centroid</span>(world<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>geom)), </span>
<span id="cb31-3">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cex =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(world<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>pop) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span>, </span>
<span id="cb31-4">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter2_files/figure-html/unnamed-chunk-14-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>Choropleth Map</strong>: Use color gradients to represent population density.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tmap)</span>
<span id="cb32-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tm_shape</span>(world) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb32-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tm_polygons</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pop"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"jenks"</span>, </span>
<span id="cb32-4">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Blues"</span>, </span>
<span id="cb32-5">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Population"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter2_files/figure-html/unnamed-chunk-15-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>Log Transformation</strong>: Visualize population using a log scale for better differentiation.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1">world<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>log_pop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log10</span>(world<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>pop <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb33-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(world[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log_pop"</span>])</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter2_files/figure-html/unnamed-chunk-16-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="e3" class="level3">
<h3 class="anchored" data-anchor-id="e3">E3</h3>
<p>To create a map of Nigeria in context and customize it using the <code>plot()</code> function, you can follow these steps:</p>
<p><strong>Step 1:</strong> Load Necessary Libraries and Data: Make sure you have the <code>spData</code> package loaded and access to the world spatial data.</p>
<p><strong>Step 2:</strong> Plotting Nigeria in Context: You can plot Nigeria by subsetting the <code>world</code> data and adjusting parameters such as <code>lwd</code> (line width), <code>col</code> (color), and <code>expandBB</code> (expanding the bounding box). Here’s an example code snippet:</p>
<p><strong>Step 3:</strong> Annotating the Map: To annotate the map with text labels, you can use the <code>text()</code> function. Here’s an example where we add the name of Nigeria and its capital, Abuja:</p>
<p><strong>Step 4:</strong> Exploring the <code>text()</code> Documentation</p>
<ul>
<li><strong><code>lwd</code></strong>: This argument controls the line width for the borders of the countries.</li>
<li><strong><code>col</code></strong>: This argument sets the fill color for the countries. You can customize it based on your preference.</li>
<li><strong><code>expandBB</code></strong>: This argument expands the bounding box of the plot, which can help visualize nearby areas more clearly.</li>
</ul>
<hr>
</section>
<section id="e4" class="level3">
<h3 class="anchored" data-anchor-id="e4">E4</h3>
<p>To create an empty <code>SpatRaster</code> object with 10 columns and 10 rows, assign random values between 0 and 10, and then plot it, you can use the <code>terra</code> package in R. Here’s how you can do it:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(terra)</span>
<span id="cb34-2"></span>
<span id="cb34-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create an empty SpatRaster object with 10 columns and 10 rows</span></span>
<span id="cb34-4">my_raster <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrows =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncols =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb34-5"></span>
<span id="cb34-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Assign random values between 0 and 10</span></span>
<span id="cb34-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(my_raster) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncell</span>(my_raster), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb34-8"></span>
<span id="cb34-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the raster</span></span>
<span id="cb34-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(my_raster, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Random Values Raster"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter2_files/figure-html/unnamed-chunk-17-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img src="https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="e5" class="level3">
<h3 class="anchored" data-anchor-id="e5">E5</h3>
<p>To read in the <code>raster/nlcd.tif</code> file from the <code>spDataLarge</code> package and examine its properties, you can follow these steps in R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(spDataLarge)</span>
<span id="cb35-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(terra)</span>
<span id="cb35-3"></span>
<span id="cb35-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read the raster file</span></span>
<span id="cb35-5">nlcd_raster <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/nlcd.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>))</span></code></pre></div>
</div>
<p><strong>Information You Can Obtain: —</strong></p>
<ol type="1">
<li><p><strong>Basic Properties</strong>: The <code>print(nlcd_raster)</code> command will provide you with information about the raster, including its dimensions, number of layers, and type of data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check the basic properties of the raster</span></span>
<span id="cb36-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(nlcd_raster)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatRaster 
dimensions  : 1359, 1073, 1  (nrow, ncol, nlyr)
resolution  : 31.5303, 31.52466  (x, y)
extent      : 301903.3, 335735.4, 4111244, 4154086  (xmin, xmax, ymin, ymax)
coord. ref. : NAD83 / UTM zone 12N (EPSG:26912) 
source      : nlcd.tif 
color table : 1 
categories  : levels 
name        :   levels 
min value   :    Water 
max value   : Wetlands </code></pre>
</div>
</div></li>
<li><p><strong>Summary Statistics</strong>: The <code>summary(nlcd_raster)</code> function will give you basic statistics about the raster values, such as minimum, maximum, and mean values. In this case, it tells the number of cells with Forest, Shrubland, Barren, Developed, Cultivated, Wetlands and Other land-use types.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get summary statistics</span></span>
<span id="cb38-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(nlcd_raster)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        levels     
 Forest    :52620  
 Shrubland :37463  
 Barren    : 7290  
 Developed : 1203  
 Cultivated:  596  
 Wetlands  :  443  
 (Other)   :  421  </code></pre>
</div>
</div></li>
<li><p><strong>Extent</strong>: The <code>ext(nlcd_raster)</code> command will provide the geographical extent of the raster, showing the minimum and maximum x and y coordinates.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check the extent of the raster</span></span>
<span id="cb40-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ext</span>(nlcd_raster)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SpatExtent : 301903.344386758, 335735.354381954, 4111244.46098842, 4154086.47216415 (xmin, xmax, ymin, ymax)</code></pre>
</div>
</div></li>
<li><p><strong>Rows and Columns</strong>: You can find the number of rows and columns in the raster using <code>nrow(nlcd_raster)</code> and <code>ncol(nlcd_raster)</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the number of rows and columns</span></span>
<span id="cb42-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(nlcd_raster)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1359</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(nlcd_raster)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1073</code></pre>
</div>
</div></li>
<li><p><strong>Coordinate Reference System (CRS)</strong>: The <code>crs(nlcd_raster)</code> command will return the CRS of the raster, which is essential for spatial analyses.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the coordinate reference system (CRS)</span></span>
<span id="cb46-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crs</span>(nlcd_raster))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] │ PROJCRS["NAD83 / UTM zone 12N",
    │     BASEGEOGCRS["NAD83",
    │         DATUM["North American Datum 1983",
    │             ELLIPSOID["GRS 1980",6378137,298.257222101,
    │                 LENGTHUNIT["metre",1]]],
    │         PRIMEM["Greenwich",0,
    │             ANGLEUNIT["degree",0.0174532925199433]],
    │         ID["EPSG",4269]],
    │     CONVERSION["UTM zone 12N",
    │         METHOD["Transverse Mercator",
    │             ID["EPSG",9807]],
    │         PARAMETER["Latitude of natural origin",0,
    │             ANGLEUNIT["degree",0.0174532925199433],
    │             ID["EPSG",8801]],
    │         PARAMETER["Longitude of natural origin",-111,
    │             ANGLEUNIT["degree",0.0174532925199433],
    │             ID["EPSG",8802]],
    │         PARAMETER["Scale factor at natural origin",0.9996,
    │             SCALEUNIT["unity",1],
    │             ID["EPSG",8805]],
    │         PARAMETER["False easting",500000,
    │             LENGTHUNIT["metre",1],
    │             ID["EPSG",8806]],
    │         PARAMETER["False northing",0,
    │             LENGTHUNIT["metre",1],
    │             ID["EPSG",8807]]],
    │     CS[Cartesian,2],
    │         AXIS["(E)",east,
    │             ORDER[1],
    │             LENGTHUNIT["metre",1]],
    │         AXIS["(N)",north,
    │             ORDER[2],
    │             LENGTHUNIT["metre",1]],
    │     USAGE[
    │         SCOPE["Engineering survey, topographic mapping."],
    │         AREA["North America - between 114°W and 108°W - onshore and offshore. Canada - Alberta; Northwest Territories; Nunavut; Saskatchewan. United States (USA) - Arizona; Colorado; Idaho; Montana; New Mexico; Utah; Wyoming."],
    │         BBOX[31.33,-114,84,-108]],
    │     ID["EPSG",26912]]</code></pre>
</div>
</div></li>
<li><p><strong>Resolution</strong>: You can check the resolution of the raster with the <code>res(nlcd_raster)</code> function, which will indicate the size of each pixel.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check the resolution of the raster</span></span>
<span id="cb48-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">res</span>(nlcd_raster)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 31.53030 31.52466</code></pre>
</div>
</div></li>
<li><p><strong>Values</strong>: The <code>values(nlcd_raster)</code> command allows you to access the actual values contained in the raster. Here, I am printing only the first few values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the values of the raster</span></span>
<span id="cb50-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(nlcd_raster) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     levels
[1,]      4
[2,]      4
[3,]      5
[4,]      4
[5,]      4
[6,]      4</code></pre>
</div>
</div></li>
</ol>
<hr>
</section>
<section id="e6" class="level3">
<h3 class="anchored" data-anchor-id="e6">E6</h3>
<p>To check the Coordinate Reference System (CRS) of the <code>raster/nlcd.tif</code> file from the <code>spDataLarge</code> package, you can use the following steps in R. The CRS provides essential information about how the spatial data is projected on the Earth’s surface.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(spDataLarge)</span>
<span id="cb52-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(terra)</span>
<span id="cb52-3"></span>
<span id="cb52-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read the raster file</span></span>
<span id="cb52-5">nlcd_raster <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raster/nlcd.tif"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spDataLarge"</span>))</span>
<span id="cb52-6"></span>
<span id="cb52-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check the coordinate reference system (CRS)</span></span>
<span id="cb52-8">nlcd_crs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crs</span>(nlcd_raster)</span>
<span id="cb52-9">nlcd_crs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] │ PROJCRS["NAD83 / UTM zone 12N",
    │     BASEGEOGCRS["NAD83",
    │         DATUM["North American Datum 1983",
    │             ELLIPSOID["GRS 1980",6378137,298.257222101,
    │                 LENGTHUNIT["metre",1]]],
    │         PRIMEM["Greenwich",0,
    │             ANGLEUNIT["degree",0.0174532925199433]],
    │         ID["EPSG",4269]],
    │     CONVERSION["UTM zone 12N",
    │         METHOD["Transverse Mercator",
    │             ID["EPSG",9807]],
    │         PARAMETER["Latitude of natural origin",0,
    │             ANGLEUNIT["degree",0.0174532925199433],
    │             ID["EPSG",8801]],
    │         PARAMETER["Longitude of natural origin",-111,
    │             ANGLEUNIT["degree",0.0174532925199433],
    │             ID["EPSG",8802]],
    │         PARAMETER["Scale factor at natural origin",0.9996,
    │             SCALEUNIT["unity",1],
    │             ID["EPSG",8805]],
    │         PARAMETER["False easting",500000,
    │             LENGTHUNIT["metre",1],
    │             ID["EPSG",8806]],
    │         PARAMETER["False northing",0,
    │             LENGTHUNIT["metre",1],
    │             ID["EPSG",8807]]],
    │     CS[Cartesian,2],
    │         AXIS["(E)",east,
    │             ORDER[1],
    │             LENGTHUNIT["metre",1]],
    │         AXIS["(N)",north,
    │             ORDER[2],
    │             LENGTHUNIT["metre",1]],
    │     USAGE[
    │         SCOPE["Engineering survey, topographic mapping."],
    │         AREA["North America - between 114°W and 108°W - onshore and offshore. Canada - Alberta; Northwest Territories; Nunavut; Saskatchewan. United States (USA) - Arizona; Colorado; Idaho; Montana; New Mexico; Utah; Wyoming."],
    │         BBOX[31.33,-114,84,-108]],
    │     ID["EPSG",26912]]</code></pre>
</div>
</div>
<p><strong>Understanding the CRS Information: —</strong></p>
<p>The output from the <code>crs(nlcd_raster)</code> command will typically include details such as:</p>
<ol type="1">
<li><p><strong>Projection Type</strong>: Indicates whether the CRS is geographic (latitude and longitude) or projected (a flat representation). Here, it is North American <strong>NAD83 / UTM Zone 12 N</strong></p></li>
<li><p><strong>Datum</strong>: Information about the geodetic datum used, which is crucial for accurately locating points on the Earth’s surface. Here, it is North American Datum 1983.</p></li>
<li><p><strong>Coordinate Units</strong>: Specifies the units of measurement used for the coordinates, such as degrees (for geographic CRSs) or meters (for projected CRSs). Here, it is in metres, as shown in:</p>
<pre><code>LENGTHUNIT["metre",1]</code></pre></li>
<li><p><strong>EPSG Code</strong>: If applicable, the output might include an EPSG code, which is a standardized reference number for a specific CRS. This code can be used to look up more detailed information about the CRS. Here, it is: —</p>
<pre><code>ID["EPSG",26912]</code></pre></li>
<li><p><strong>Transformation Parameters</strong>: If it’s a projected CRS, the output may include parameters related to the projection method, such as central meridian, standard parallels, and false easting/northing. Here, they are: —</p>
<pre><code>|         PRIMEM["Greenwich",0,     
│             ANGLEUNIT["degree",0.0174532925199433]],     
│         ID["EPSG",4269]], 
|
|
│     CONVERSION["UTM zone 12N",     
│         METHOD["Transverse Mercator",     
│             ID["EPSG",9807]],     
│         PARAMETER["Latitude of natural origin",0,     
│             ANGLEUNIT["degree",0.0174532925199433],     
│             ID["EPSG",8801]],     
│         PARAMETER["Longitude of natural origin",-111,     
|             ANGLEUNIT["degree",0.0174532925199433],     
│             ID["EPSG",8802]],     
│         PARAMETER["Scale factor at natural origin",0.9996,
│             SCALEUNIT["unity",1],     
│             ID["EPSG",8805]],     
│         PARAMETER["False easting",500000,     
│             LENGTHUNIT["metre",1],     
│             ID["EPSG",8806]],     
│         PARAMETER["False northing",0,     
│             LENGTHUNIT["metre",1],     
│             ID["EPSG",8807]]],</code></pre></li>
</ol>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-sfheaders" class="csl-entry">
Cooley, David. 2024. <span>“Sfheaders: Converts Between r Objects and Simple Feature Objects.”</span> <a href="https://CRAN.R-project.org/package=sfheaders">https://CRAN.R-project.org/package=sfheaders</a>.
</div>
<div id="ref-rasterVis" class="csl-entry">
Oscar Perpiñán, and Robert Hijmans. 2023. <span>“<span></span>rasterVis<span></span>.”</span> <a href="https://oscarperpinan.github.io/rastervis/">https://oscarperpinan.github.io/rastervis/</a>.
</div>
<div id="ref-tmap" class="csl-entry">
Tennekes, Martijn. 2018. <span>“<span></span>Tmap<span></span>: Thematic Maps in <span></span>r<span></span>”</span> 84. <a href="https://doi.org/10.18637/jss.v084.i06">https://doi.org/10.18637/jss.v084.i06</a>.
</div>
</div></section></div> ]]></description>
  <category>Geocomputation with R</category>
  <category>Textbook Solutions</category>
  <guid>https://aditya-dahiya.github.io/visage/index.html/book_solutions/chapter2.html</guid>
  <pubDate>Sat, 02 Nov 2024 18:30:00 GMT</pubDate>
</item>
</channel>
</rss>
